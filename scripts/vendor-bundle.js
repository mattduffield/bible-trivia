!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.Promise=e()}}(function(){var e,t,n;return function o(a,s,u){function c(n,e){if(!s[n]){if(!a[n]){var t="function"==typeof _dereq_&&_dereq_;if(!e&&t)return t(n,!0);if(l)return l(n,!0);var r=new Error("Cannot find module '"+n+"'");throw r.code="MODULE_NOT_FOUND",r}var i=s[n]={exports:{}};a[n][0].call(i.exports,function(e){var t=a[n][1][e];return c(t||e)},i,i.exports,o,a,s,u)}return s[n].exports}for(var l="function"==typeof _dereq_&&_dereq_,e=0;e<u.length;e++)c(u[e]);return c}({1:[function(e,t,n){"use strict";var r;try{throw new Error}catch(e){r=e}var i=e("./schedule"),o=e("./queue"),a=e("./util");function s(){this._customScheduler=!1,this._isTickUsed=!1,this._lateQueue=new o(16),this._normalQueue=new o(16),this._haveDrainedQueues=!1,this._trampolineEnabled=!0;var e=this;this.drainQueues=function(){e._drainQueues()},this._schedule=i}function u(e,t,n){this._lateQueue.push(e,t,n),this._queueTick()}function c(e,t,n){this._normalQueue.push(e,t,n),this._queueTick()}function l(e){this._normalQueue._pushOne(e),this._queueTick()}s.prototype.setScheduler=function(e){var t=this._schedule;return this._schedule=e,this._customScheduler=!0,t},s.prototype.hasCustomScheduler=function(){return this._customScheduler},s.prototype.enableTrampoline=function(){this._trampolineEnabled=!0},s.prototype.disableTrampolineIfNecessary=function(){a.hasDevTools&&(this._trampolineEnabled=!1)},s.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},s.prototype.fatalError=function(e,t){t?(process.stderr.write("Fatal "+(e instanceof Error?e.stack:e)+"\n"),process.exit(2)):this.throwLater(e)},s.prototype.throwLater=function(e,t){if(1===arguments.length&&(t=e,e=function(){throw t}),"undefined"!=typeof setTimeout)setTimeout(function(){e(t)},0);else try{this._schedule(function(){e(t)})}catch(e){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}},a.hasDevTools?(s.prototype.invokeLater=function(e,t,n){this._trampolineEnabled?u.call(this,e,t,n):this._schedule(function(){setTimeout(function(){e.call(t,n)},100)})},s.prototype.invoke=function(e,t,n){this._trampolineEnabled?c.call(this,e,t,n):this._schedule(function(){e.call(t,n)})},s.prototype.settlePromises=function(e){this._trampolineEnabled?l.call(this,e):this._schedule(function(){e._settlePromises()})}):(s.prototype.invokeLater=u,s.prototype.invoke=c,s.prototype.settlePromises=l),s.prototype._drainQueue=function(e){for(;0<e.length();){var t=e.shift();if("function"==typeof t){var n=e.shift(),r=e.shift();t.call(n,r)}else t._settlePromises()}},s.prototype._drainQueues=function(){this._drainQueue(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,this._drainQueue(this._lateQueue)},s.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},s.prototype._reset=function(){this._isTickUsed=!1},t.exports=s,t.exports.firstLineError=r},{"./queue":17,"./schedule":18,"./util":21}],2:[function(e,t,n){"use strict";t.exports=function(o,a,s,u){var c=!1,n=function(e,t){this._reject(t)},l=function(e,t){t.promiseRejectionQueued=!0,t.bindingPromise._then(n,n,null,this,e)},h=function(e,t){0==(50397184&this._bitField)&&this._resolveCallback(t.target)},f=function(e,t){t.promiseRejectionQueued||this._reject(e)};o.prototype.bind=function(e){c||(c=!0,o.prototype._propagateFrom=u.propagateFromFunction(),o.prototype._boundValue=u.boundValueFunction());var t=s(e),n=new o(a);n._propagateFrom(this,1);var r=this._target();if(n._setBoundTo(t),t instanceof o){var i={promiseRejectionQueued:!1,promise:n,target:r,bindingPromise:t};r._then(a,l,void 0,n,i),t._then(h,f,void 0,n,i),n._setOnCancel(t)}else n._resolveCallback(r);return n},o.prototype._setBoundTo=function(e){void 0!==e?(this._bitField=2097152|this._bitField,this._boundTo=e):this._bitField=-2097153&this._bitField},o.prototype._isBound=function(){return 2097152==(2097152&this._bitField)},o.bind=function(e,t){return o.resolve(t).bind(e)}}},{}],3:[function(e,t,n){"use strict";var r;"undefined"!=typeof Promise&&(r=Promise);var i=e("./promise")();i.noConflict=function(){try{Promise===i&&(Promise=r)}catch(e){}return i},t.exports=i},{"./promise":15}],4:[function(u,e,t){"use strict";e.exports=function(e,t,n,r){var i=u("./util"),o=i.tryCatch,a=i.errorObj,s=e._async;e.prototype.break=e.prototype.cancel=function(){if(!r.cancellation())return this._warn("cancellation is disabled");for(var e=this,t=e;e._isCancellable();){if(!e._cancelBy(t)){t._isFollowing()?t._followee().cancel():t._cancelBranched();break}var n=e._cancellationParent;if(null==n||!n._isCancellable()){e._isFollowing()?e._followee().cancel():e._cancelBranched();break}e._isFollowing()&&e._followee().cancel(),e._setWillBeCancelled(),t=e,e=n}},e.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},e.prototype._enoughBranchesHaveCancelled=function(){return void 0===this._branchesRemainingToCancel||this._branchesRemainingToCancel<=0},e.prototype._cancelBy=function(e){return e===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),!!this._enoughBranchesHaveCancelled()&&(this._invokeOnCancel(),!0))},e.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},e.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),s.invoke(this._cancelPromises,this,void 0))},e.prototype._cancelPromises=function(){0<this._length()&&this._settlePromises()},e.prototype._unsetOnCancel=function(){this._onCancelField=void 0},e.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()},e.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},e.prototype._doInvokeOnCancel=function(e,t){if(i.isArray(e))for(var n=0;n<e.length;++n)this._doInvokeOnCancel(e[n],t);else if(void 0!==e)if("function"==typeof e){if(!t){var r=o(e).call(this._boundValue());r===a&&(this._attachExtraTrace(r.e),s.throwLater(r.e))}}else e._resultCancelled(this)},e.prototype._invokeOnCancel=function(){var e=this._onCancel();this._unsetOnCancel(),s.invoke(this._doInvokeOnCancel,this,e)},e.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},e.prototype._resultCancelled=function(){this.cancel()}}},{"./util":21}],5:[function(e,t,n){"use strict";t.exports=function(h){var f=e("./util"),d=e("./es5").keys,p=f.tryCatch,v=f.errorObj;return function(u,c,l){return function(e){var t=l._boundValue();e:for(var n=0;n<u.length;++n){var r=u[n];if(r===Error||null!=r&&r.prototype instanceof Error){if(e instanceof r)return p(c).call(t,e)}else if("function"==typeof r){var i=p(r).call(t,e);if(i===v)return i;if(i)return p(c).call(t,e)}else if(f.isObject(e)){for(var o=d(r),a=0;a<o.length;++a){var s=o[a];if(r[s]!=e[s])continue e}return p(c).call(t,e)}}return h}}}},{"./es5":10,"./util":21}],6:[function(e,t,n){"use strict";t.exports=function(o){var a=!1,n=[];function s(){this._trace=new s.CapturedTrace(u())}function u(){var e=n.length-1;if(0<=e)return n[e]}return o.prototype._promiseCreated=function(){},o.prototype._pushContext=function(){},o.prototype._popContext=function(){return null},o._peekContext=o.prototype._peekContext=function(){},s.prototype._pushContext=function(){void 0!==this._trace&&(this._trace._promiseCreated=null,n.push(this._trace))},s.prototype._popContext=function(){if(void 0!==this._trace){var e=n.pop(),t=e._promiseCreated;return e._promiseCreated=null,t}return null},s.CapturedTrace=null,s.create=function(){if(a)return new s},s.deactivateLongStackTraces=function(){},s.activateLongStackTraces=function(){var e=o.prototype._pushContext,t=o.prototype._popContext,n=o._peekContext,r=o.prototype._peekContext,i=o.prototype._promiseCreated;s.deactivateLongStackTraces=function(){o.prototype._pushContext=e,o.prototype._popContext=t,o._peekContext=n,o.prototype._peekContext=r,o.prototype._promiseCreated=i,a=!1},a=!0,o.prototype._pushContext=s.prototype._pushContext,o.prototype._popContext=s.prototype._popContext,o._peekContext=o.prototype._peekContext=u,o.prototype._promiseCreated=function(){var e=this._peekContext();e&&null==e._promiseCreated&&(e._promiseCreated=this)}},s}},{}],7:[function(Y,e,t){"use strict";e.exports=function(a,n){var r,i,o,s=a._getDomain,u=a._async,c=Y("./errors").Warning,l=Y("./util"),h=l.canAttachTrace,f=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,p=/\((?:timers\.js):\d+:\d+\)/,v=/[\/<\(](.+?):(\d+):(\d+)\)?\s*$/,d=null,m=null,g=!1,e=!(0==l.env("BLUEBIRD_DEBUG")),t=!(0==l.env("BLUEBIRD_WARNINGS")||!e&&!l.env("BLUEBIRD_WARNINGS")),y=!(0==l.env("BLUEBIRD_LONG_STACK_TRACES")||!e&&!l.env("BLUEBIRD_LONG_STACK_TRACES")),b=0!=l.env("BLUEBIRD_W_FORGOTTEN_RETURN")&&(t||!!l.env("BLUEBIRD_W_FORGOTTEN_RETURN"));a.prototype.suppressUnhandledRejections=function(){var e=this._target();e._bitField=-1048577&e._bitField|524288},a.prototype._ensurePossibleRejectionHandled=function(){if(0==(524288&this._bitField)){this._setRejectionIsUnhandled();var e=this;setTimeout(function(){e._notifyUnhandledRejection()},1)}},a.prototype._notifyUnhandledRejectionIsHandled=function(){B("rejectionHandled",r,void 0,this)},a.prototype._setReturnedNonUndefined=function(){this._bitField=268435456|this._bitField},a.prototype._returnedNonUndefined=function(){return 0!=(268435456&this._bitField)},a.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var e=this._settledValue();this._setUnhandledRejectionIsNotified(),B("unhandledRejection",i,e,this)}},a.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=262144|this._bitField},a.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-262145&this._bitField},a.prototype._isUnhandledRejectionNotified=function(){return 0<(262144&this._bitField)},a.prototype._setRejectionIsUnhandled=function(){this._bitField=1048576|this._bitField},a.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-1048577&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},a.prototype._isRejectionUnhandled=function(){return 0<(1048576&this._bitField)},a.prototype._warn=function(e,t,n){return F(e,t,n||this)},a.onPossiblyUnhandledRejection=function(e){var t=s();i="function"==typeof e?null===t?e:l.domainBind(t,e):void 0},a.onUnhandledRejectionHandled=function(e){var t=s();r="function"==typeof e?null===t?e:l.domainBind(t,e):void 0};var _=function(){};a.longStackTraces=function(){if(u.haveItemsQueued()&&!Q.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");if(!Q.longStackTraces&&W()){var e=a.prototype._captureStackTrace,t=a.prototype._attachExtraTrace;Q.longStackTraces=!0,_=function(){if(u.haveItemsQueued()&&!Q.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");a.prototype._captureStackTrace=e,a.prototype._attachExtraTrace=t,n.deactivateLongStackTraces(),u.enableTrampoline(),Q.longStackTraces=!1},a.prototype._captureStackTrace=M,a.prototype._attachExtraTrace=L,n.activateLongStackTraces(),u.disableTrampolineIfNecessary()}},a.hasLongStackTraces=function(){return Q.longStackTraces&&W()};var w=function(){try{if("function"==typeof CustomEvent){var e=new CustomEvent("CustomEvent");return l.global.dispatchEvent(e),function(e,t){var n=new CustomEvent(e.toLowerCase(),{detail:t,cancelable:!0});return!l.global.dispatchEvent(n)}}if("function"==typeof Event){e=new Event("CustomEvent");return l.global.dispatchEvent(e),function(e,t){var n=new Event(e.toLowerCase(),{cancelable:!0});return n.detail=t,!l.global.dispatchEvent(n)}}return(e=document.createEvent("CustomEvent")).initCustomEvent("testingtheevent",!1,!0,{}),l.global.dispatchEvent(e),function(e,t){var n=document.createEvent("CustomEvent");return n.initCustomEvent(e.toLowerCase(),!1,!0,t),!l.global.dispatchEvent(n)}}catch(e){}return function(){return!1}}(),E=l.isNode?function(){return process.emit.apply(process,arguments)}:l.global?function(e){var t="on"+e.toLowerCase(),n=l.global[t];return!!n&&(n.apply(l.global,[].slice.call(arguments,1)),!0)}:function(){return!1};function S(e,t){return{promise:t}}var C={promiseCreated:S,promiseFulfilled:S,promiseRejected:S,promiseResolved:S,promiseCancelled:S,promiseChained:function(e,t,n){return{promise:t,child:n}},warning:function(e,t){return{warning:t}},unhandledRejection:function(e,t,n){return{reason:t,promise:n}},rejectionHandled:S},T=function(e){var t=!1;try{t=E.apply(null,arguments)}catch(e){u.throwLater(e),t=!0}var n=!1;try{n=w(e,C[e].apply(null,arguments))}catch(e){u.throwLater(e),n=!0}return n||t};function O(){return!1}function R(e,t,n){var r=this;try{e(t,n,function(e){if("function"!=typeof e)throw new TypeError("onCancel must be a function, got: "+l.toString(e));r._attachCancellationCallback(e)})}catch(e){return e}}function A(e){if(!this._isCancellable())return this;var t=this._onCancel();void 0!==t?l.isArray(t)?t.push(e):this._setOnCancel([t,e]):this._setOnCancel(e)}function I(){return this._onCancelField}function N(e){this._onCancelField=e}function k(){this._cancellationParent=void 0,this._onCancelField=void 0}function P(e,t){if(0!=(1&t)){var n=(this._cancellationParent=e)._branchesRemainingToCancel;void 0===n&&(n=0),e._branchesRemainingToCancel=n+1}0!=(2&t)&&e._isBound()&&this._setBoundTo(e._boundTo)}a.config=function(e){if("longStackTraces"in(e=Object(e))&&(e.longStackTraces?a.longStackTraces():!e.longStackTraces&&a.hasLongStackTraces()&&_()),"warnings"in e){var t=e.warnings;Q.warnings=!!t,b=Q.warnings,l.isObject(t)&&"wForgottenReturn"in t&&(b=!!t.wForgottenReturn)}if("cancellation"in e&&e.cancellation&&!Q.cancellation){if(u.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");a.prototype._clearCancellationData=k,a.prototype._propagateFrom=P,a.prototype._onCancel=I,a.prototype._setOnCancel=N,a.prototype._attachCancellationCallback=A,a.prototype._execute=R,x=P,Q.cancellation=!0}return"monitoring"in e&&(e.monitoring&&!Q.monitoring?(Q.monitoring=!0,a.prototype._fireEvent=T):!e.monitoring&&Q.monitoring&&(Q.monitoring=!1,a.prototype._fireEvent=O)),a},a.prototype._fireEvent=O,a.prototype._execute=function(e,t,n){try{e(t,n)}catch(e){return e}},a.prototype._onCancel=function(){},a.prototype._setOnCancel=function(e){},a.prototype._attachCancellationCallback=function(e){},a.prototype._captureStackTrace=function(){},a.prototype._attachExtraTrace=function(){},a.prototype._clearCancellationData=function(){},a.prototype._propagateFrom=function(e,t){};var x=function(e,t){0!=(2&t)&&e._isBound()&&this._setBoundTo(e._boundTo)};function D(){var e=this._boundTo;return void 0!==e&&e instanceof a?e.isFulfilled()?e.value():void 0:e}function M(){this._trace=new $(this._peekContext())}function L(e,t){if(h(e)){var n=this._trace;if(void 0!==n&&t&&(n=n._parent),void 0!==n)n.attachExtraTrace(e);else if(!e.__stackCleaned__){var r=j(e);l.notEnumerableProp(e,"stack",r.message+"\n"+r.stack.join("\n")),l.notEnumerableProp(e,"__stackCleaned__",!0)}}}function F(e,t,n){if(Q.warnings){var r,i=new c(e);if(t)n._attachExtraTrace(i);else if(Q.longStackTraces&&(r=a._peekContext()))r.attachExtraTrace(i);else{var o=j(i);i.stack=o.message+"\n"+o.stack.join("\n")}T("warning",i)||U(i,"",!0)}}function V(e){for(var t=[],n=0;n<e.length;++n){var r=e[n],i="    (No stack trace)"===r||d.test(r),o=i&&H(r);i&&!o&&(g&&" "!==r.charAt(0)&&(r="    "+r),t.push(r))}return t}function j(e){var t=e.stack,n=e.toString();return t="string"==typeof t&&0<t.length?function(e){for(var t=e.stack.replace(/\s+$/g,"").split("\n"),n=0;n<t.length;++n){var r=t[n];if("    (No stack trace)"===r||d.test(r))break}return 0<n&&"SyntaxError"!=e.name&&(t=t.slice(n)),t}(e):["    (No stack trace)"],{message:n,stack:"SyntaxError"==e.name?t:V(t)}}function U(e,t,n){if("undefined"!=typeof console){var r;if(l.isObject(e)){var i=e.stack;r=t+m(i,e)}else r=t+String(e);"function"==typeof o?o(r,n):"function"!=typeof console.log&&"object"!=typeof console.log||console.log(r)}}function B(e,t,n,r){var i=!1;try{"function"==typeof t&&(i=!0,"rejectionHandled"===e?t(r):t(n,r))}catch(e){u.throwLater(e)}"unhandledRejection"===e?T(e,n,r)||i||U(n,"Unhandled rejection "):T(e,r)}function q(e){var t;if("function"==typeof e)t="[function "+(e.name||"anonymous")+"]";else{t=e&&"function"==typeof e.toString?e.toString():l.toString(e);if(/\[object [a-zA-Z0-9$_]+\]/.test(t))try{t=JSON.stringify(e)}catch(e){}0===t.length&&(t="(empty array)")}return"(<"+function(e){if(e.length<41)return e;return e.substr(0,38)+"..."}(t)+">, no stack trace)"}function W(){return"function"==typeof z}var H=function(){return!1},G=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;function K(e){var t=e.match(G);if(t)return{fileName:t[1],line:parseInt(t[2],10)}}function $(e){this._parent=e,this._promisesCreated=0;var t=this._length=1+(void 0===e?0:e._length);z(this,$),32<t&&this.uncycle()}l.inherits($,Error),(n.CapturedTrace=$).prototype.uncycle=function(){var e=this._length;if(!(e<2)){for(var t=[],n={},r=0,i=this;void 0!==i;++r)t.push(i),i=i._parent;for(r=(e=this._length=r)-1;0<=r;--r){var o=t[r].stack;void 0===n[o]&&(n[o]=r)}for(r=0;r<e;++r){var a=n[t[r].stack];if(void 0!==a&&a!==r){0<a&&(t[a-1]._parent=void 0,t[a-1]._length=1),t[r]._parent=void 0,t[r]._length=1;var s=0<r?t[r-1]:this;a<e-1?(s._parent=t[a+1],s._parent.uncycle(),s._length=s._parent._length+1):(s._parent=void 0,s._length=1);for(var u=s._length+1,c=r-2;0<=c;--c)t[c]._length=u,u++;return}}}},$.prototype.attachExtraTrace=function(e){if(!e.__stackCleaned__){this.uncycle();for(var t=j(e),n=t.message,r=[t.stack],i=this;void 0!==i;)r.push(V(i.stack.split("\n"))),i=i._parent;!function(e){for(var t=e[0],n=1;n<e.length;++n){for(var r=e[n],i=t.length-1,o=t[i],a=-1,s=r.length-1;0<=s;--s)if(r[s]===o){a=s;break}for(s=a;0<=s;--s){var u=r[s];if(t[i]!==u)break;t.pop(),i--}t=r}}(r),function(e){for(var t=0;t<e.length;++t)(0===e[t].length||t+1<e.length&&e[t][0]===e[t+1][0])&&(e.splice(t,1),t--)}(r),l.notEnumerableProp(e,"stack",function(e,t){for(var n=0;n<t.length-1;++n)t[n].push("From previous event:"),t[n]=t[n].join("\n");return n<t.length&&(t[n]=t[n].join("\n")),e+"\n"+t.join("\n")}(n,r)),l.notEnumerableProp(e,"__stackCleaned__",!0)}};var z=function(){var e=/^\s*at\s*/,t=function(e,t){return"string"==typeof e?e:void 0!==t.name&&void 0!==t.message?t.toString():q(t)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit+=6,d=e,m=t;var n=Error.captureStackTrace;return H=function(e){return f.test(e)},function(e,t){Error.stackTraceLimit+=6,n(e,t),Error.stackTraceLimit-=6}}var r,i=new Error;if("string"==typeof i.stack&&0<=i.stack.split("\n")[0].indexOf("stackDetection@"))return d=/@/,m=t,g=!0,function(e){e.stack=(new Error).stack};try{throw new Error}catch(e){r="stack"in e}return"stack"in i||!r||"number"!=typeof Error.stackTraceLimit?(m=function(e,t){return"string"==typeof e?e:"object"!=typeof t&&"function"!=typeof t||void 0===t.name||void 0===t.message?q(t):t.toString()},null):(d=e,m=t,function(t){Error.stackTraceLimit+=6;try{throw new Error}catch(e){t.stack=e.stack}Error.stackTraceLimit-=6})}();"undefined"!=typeof console&&void 0!==console.warn&&(o=function(e){console.warn(e)},l.isNode&&process.stderr.isTTY?o=function(e,t){var n=t?"[33m":"[31m";console.warn(n+e+"[0m\n")}:l.isNode||"string"!=typeof(new Error).stack||(o=function(e,t){console.warn("%c"+e,t?"color: darkorange":"color: red")}));var Q={warnings:t,longStackTraces:!1,cancellation:!1,monitoring:!1};return y&&a.longStackTraces(),{longStackTraces:function(){return Q.longStackTraces},warnings:function(){return Q.warnings},cancellation:function(){return Q.cancellation},monitoring:function(){return Q.monitoring},propagateFromFunction:function(){return x},boundValueFunction:function(){return D},checkForgottenReturns:function(e,t,n,r,i){if(void 0===e&&null!==t&&b){if(void 0!==i&&i._returnedNonUndefined())return;if(0==(65535&r._bitField))return;n&&(n+=" ");var o="",a="";if(t._trace){for(var s=t._trace.stack.split("\n"),u=V(s),c=u.length-1;0<=c;--c){var l=u[c];if(!p.test(l)){var h=l.match(v);h&&(o="at "+h[1]+":"+h[2]+":"+h[3]+" ");break}}if(0<u.length){var f=u[0];for(c=0;c<s.length;++c)if(s[c]===f){0<c&&(a="\n"+s[c-1]);break}}}var d="a promise was created in a "+n+"handler "+o+"but was not returned from it, see http://goo.gl/rRqMUw"+a;r._warn(d,!0,t)}},setBounds:function(e,t){if(W()){for(var n,r,i=e.stack.split("\n"),o=t.stack.split("\n"),a=-1,s=-1,u=0;u<i.length;++u)if(c=K(i[u])){n=c.fileName,a=c.line;break}for(u=0;u<o.length;++u){var c;if(c=K(o[u])){r=c.fileName,s=c.line;break}}a<0||s<0||!n||!r||n!==r||s<=a||(H=function(e){if(f.test(e))return!0;var t=K(e);return!!(t&&t.fileName===n&&a<=t.line&&t.line<=s)})}},warn:F,deprecated:function(e,t){var n=e+" is deprecated and will be removed in a future version.";return t&&(n+=" Use "+t+" instead."),F(n)},CapturedTrace:$,fireDomEvent:w,fireGlobalEvent:E}}},{"./errors":9,"./util":21}],8:[function(e,t,n){"use strict";t.exports=function(n){function r(){return this.value}function i(){throw this.reason}n.prototype.return=n.prototype.thenReturn=function(e){return e instanceof n&&e.suppressUnhandledRejections(),this._then(r,void 0,void 0,{value:e},void 0)},n.prototype.throw=n.prototype.thenThrow=function(e){return this._then(i,void 0,void 0,{reason:e},void 0)},n.prototype.catchThrow=function(e){if(arguments.length<=1)return this._then(void 0,i,void 0,{reason:e},void 0);var t=arguments[1];return this.caught(e,function(){throw t})},n.prototype.catchReturn=function(e){if(arguments.length<=1)return e instanceof n&&e.suppressUnhandledRejections(),this._then(void 0,r,void 0,{value:e},void 0);var t=arguments[1];t instanceof n&&t.suppressUnhandledRejections();return this.caught(e,function(){return t})}}},{}],9:[function(e,t,n){"use strict";var r,i,o=e("./es5"),a=o.freeze,s=e("./util"),u=s.inherits,c=s.notEnumerableProp;function l(t,n){function r(e){if(!(this instanceof r))return new r(e);c(this,"message","string"==typeof e?e:n),c(this,"name",t),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this)}return u(r,Error),r}var h=l("Warning","warning"),f=l("CancellationError","cancellation error"),d=l("TimeoutError","timeout error"),p=l("AggregateError","aggregate error");try{r=TypeError,i=RangeError}catch(e){r=l("TypeError","type error"),i=l("RangeError","range error")}for(var v="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),m=0;m<v.length;++m)"function"==typeof Array.prototype[v[m]]&&(p.prototype[v[m]]=Array.prototype[v[m]]);o.defineProperty(p.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),p.prototype.isOperational=!0;var g=0;function y(e){if(!(this instanceof y))return new y(e);c(this,"name","OperationalError"),c(this,"message",e),this.cause=e,this.isOperational=!0,e instanceof Error?(c(this,"message",e.message),c(this,"stack",e.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}p.prototype.toString=function(){var e=Array(4*g+1).join(" "),t="\n"+e+"AggregateError of:\n";g++,e=Array(4*g+1).join(" ");for(var n=0;n<this.length;++n){for(var r=this[n]===this?"[Circular AggregateError]":this[n]+"",i=r.split("\n"),o=0;o<i.length;++o)i[o]=e+i[o];t+=(r=i.join("\n"))+"\n"}return g--,t},u(y,Error);var b=Error.__BluebirdErrorTypes__;b||(b=a({CancellationError:f,TimeoutError:d,OperationalError:y,RejectionError:y,AggregateError:p}),o.defineProperty(Error,"__BluebirdErrorTypes__",{value:b,writable:!1,enumerable:!1,configurable:!1})),t.exports={Error:Error,TypeError:r,RangeError:i,CancellationError:b.CancellationError,OperationalError:b.OperationalError,TimeoutError:b.TimeoutError,AggregateError:b.AggregateError,Warning:h}},{"./es5":10,"./util":21}],10:[function(e,t,n){var r=function(){"use strict";return void 0===this}();if(r)t.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:r,propertyIsWritable:function(e,t){var n=Object.getOwnPropertyDescriptor(e,t);return!(n&&!n.writable&&!n.set)}};else{var i={}.hasOwnProperty,o={}.toString,a={}.constructor.prototype,s=function(e){var t=[];for(var n in e)i.call(e,n)&&t.push(n);return t};t.exports={isArray:function(e){try{return"[object Array]"===o.call(e)}catch(e){return!1}},keys:s,names:s,defineProperty:function(e,t,n){return e[t]=n.value,e},getDescriptor:function(e,t){return{value:e[t]}},freeze:function(e){return e},getPrototypeOf:function(e){try{return Object(e).constructor.prototype}catch(e){return a}},isES5:r,propertyIsWritable:function(){return!0}}}},{}],11:[function(e,t,n){"use strict";t.exports=function(s,a,u){var c=e("./util"),l=s.CancellationError,h=c.errorObj,f=e("./catch_filter")(u);function i(e,t,n){this.promise=e,this.type=t,this.handler=n,this.called=!1,this.cancelPromise=null}function d(e){this.finallyHandler=e}function p(e,t){return null!=e.cancelPromise&&(1<arguments.length?e.cancelPromise._reject(t):e.cancelPromise._cancel(),!(e.cancelPromise=null))}function v(){return g.call(this,this.promise._target()._settledValue())}function m(e){if(!p(this,e))return h.e=e,h}function g(e){var t=this.promise,n=this.handler;if(!this.called){this.called=!0;var r=this.isFinallyHandler()?n.call(t._boundValue()):n.call(t._boundValue(),e);if(r===u)return r;if(void 0!==r){t._setReturnedNonUndefined();var i=a(r,t);if(i instanceof s){if(null!=this.cancelPromise){if(i._isCancelled()){var o=new l("late cancellation observer");return t._attachExtraTrace(o),h.e=o,h}i.isPending()&&i._attachCancellationCallback(new d(this))}return i._then(v,m,void 0,this,void 0)}}}return t.isRejected()?(p(this),h.e=e,h):(p(this),e)}return i.prototype.isFinallyHandler=function(){return 0===this.type},d.prototype._resultCancelled=function(){p(this.finallyHandler)},s.prototype._passThrough=function(e,t,n,r){return"function"!=typeof e?this.then():this._then(n,r,void 0,new i(this,t,e),void 0)},s.prototype.lastly=s.prototype.finally=function(e){return this._passThrough(e,0,g,g)},s.prototype.tap=function(e){return this._passThrough(e,1,g)},s.prototype.tapCatch=function(e){var t=arguments.length;if(1===t)return this._passThrough(e,1,void 0,g);var n,r=new Array(t-1),i=0;for(n=0;n<t-1;++n){var o=arguments[n];if(!c.isObject(o))return s.reject(new TypeError("tapCatch statement predicate: expecting an object but got "+c.classString(o)));r[i++]=o}r.length=i;var a=arguments[n];return this._passThrough(f(r,a,this),1,void 0,g)},i}},{"./catch_filter":5,"./util":21}],12:[function(s,e,t){"use strict";e.exports=function(e,i,t,n,r,o){var a=s("./util");a.canEvaluate,a.tryCatch,a.errorObj;e.join=function(){var e,t=arguments.length-1;0<t&&"function"==typeof arguments[t]&&(e=arguments[t]);var n=[].slice.call(arguments);e&&n.pop();var r=new i(n).promise();return void 0!==e?r.spread(e):r}}},{"./util":21}],13:[function(t,e,n){"use strict";e.exports=function(a,s,e,u,c){var l=t("./util"),h=l.tryCatch;a.method=function(r){if("function"!=typeof r)throw new a.TypeError("expecting a function but got "+l.classString(r));return function(){var e=new a(s);e._captureStackTrace(),e._pushContext();var t=h(r).apply(this,arguments),n=e._popContext();return c.checkForgottenReturns(t,n,"Promise.method",e),e._resolveFromSyncValue(t),e}},a.attempt=a.try=function(e){if("function"!=typeof e)return u("expecting a function but got "+l.classString(e));var t,n=new a(s);if(n._captureStackTrace(),n._pushContext(),1<arguments.length){c.deprecated("calling Promise.try with more than 1 argument");var r=arguments[1],i=arguments[2];t=l.isArray(r)?h(e).apply(i,r):h(e).call(i,r)}else t=h(e)();var o=n._popContext();return c.checkForgottenReturns(t,o,"Promise.try",n),n._resolveFromSyncValue(t),n},a.prototype._resolveFromSyncValue=function(e){e===l.errorObj?this._rejectCallback(e.e,!1):this._resolveCallback(e,!0)}}},{"./util":21}],14:[function(e,t,n){"use strict";var a=e("./util"),s=a.maybeWrapAsError,u=e("./errors").OperationalError,c=e("./es5");var l=/^(?:name|message|stack|cause)$/;function h(e){var t,n;if((n=e)instanceof Error&&c.getPrototypeOf(n)===Error.prototype){(t=new u(e)).name=e.name,t.message=e.message,t.stack=e.stack;for(var r=c.keys(e),i=0;i<r.length;++i){var o=r[i];l.test(o)||(t[o]=e[o])}return t}return a.markAsOriginatingFromRejection(e),e}t.exports=function(i,o){return function(e,t){if(null!==i){if(e){var n=h(s(e));i._attachExtraTrace(n),i._reject(n)}else if(o){var r=[].slice.call(arguments,1);i._fulfill(r)}else i._fulfill(t);i=null}}}},{"./errors":9,"./es5":10,"./util":21}],15:[function(I,N,e){"use strict";N.exports=function(){var u=function(){return new h("circular promise resolution chain\n\n    See http://goo.gl/MqrFmX\n")},s=function(){return new O.PromiseInspection(this._target())},a=function(e){return O.reject(new h(e))};function c(){}var d,l={},p=I("./util");d=p.isNode?function(){var e=process.domain;return void 0===e&&(e=null),e}:function(){return null},p.notEnumerableProp(O,"_getDomain",d);var e=I("./es5"),t=I("./async"),v=new t;e.defineProperty(O,"_async",{value:v});var n=I("./errors"),h=O.TypeError=n.TypeError;O.RangeError=n.RangeError;var m=O.CancellationError=n.CancellationError;O.TimeoutError=n.TimeoutError,O.OperationalError=n.OperationalError,O.RejectionError=n.OperationalError,O.AggregateError=n.AggregateError;var g=function(){},f={},y={},b=I("./thenables")(O,g),_=I("./promise_array")(O,g,b,a,c),r=I("./context")(O),w=(r.create,I("./debuggability")(O,r)),E=(w.CapturedTrace,I("./finally")(O,b,y)),S=I("./catch_filter")(y),i=I("./nodeback"),C=p.errorObj,T=p.tryCatch;function O(e){e!==g&&function(e,t){if(null==e||e.constructor!==O)throw new h("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/MqrFmX\n");if("function"!=typeof t)throw new h("expecting a function but got "+p.classString(t))}(this,e),this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._resolveFromExecutor(e),this._promiseCreated(),this._fireEvent("promiseCreated",this)}function o(e){this.promise._resolveCallback(e)}function R(e){this.promise._rejectCallback(e,!1)}function A(e){var t=new O(g);t._fulfillmentHandler0=e,t._rejectionHandler0=e,t._promise0=e,t._receiver0=e}return O.prototype.toString=function(){return"[object Promise]"},O.prototype.caught=O.prototype.catch=function(e){var t=arguments.length;if(1<t){var n,r=new Array(t-1),i=0;for(n=0;n<t-1;++n){var o=arguments[n];if(!p.isObject(o))return a("Catch statement predicate: expecting an object but got "+p.classString(o));r[i++]=o}return r.length=i,e=arguments[n],this.then(void 0,S(r,e,this))}return this.then(void 0,e)},O.prototype.reflect=function(){return this._then(s,s,void 0,this,void 0)},O.prototype.then=function(e,t){if(w.warnings()&&0<arguments.length&&"function"!=typeof e&&"function"!=typeof t){var n=".then() only accepts functions but was passed: "+p.classString(e);1<arguments.length&&(n+=", "+p.classString(t)),this._warn(n)}return this._then(e,t,void 0,void 0,void 0)},O.prototype.done=function(e,t){this._then(e,t,void 0,void 0,void 0)._setIsFinal()},O.prototype.spread=function(e){return"function"!=typeof e?a("expecting a function but got "+p.classString(e)):this.all()._then(e,void 0,void 0,f,void 0)},O.prototype.toJSON=function(){var e={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(e.fulfillmentValue=this.value(),e.isFulfilled=!0):this.isRejected()&&(e.rejectionReason=this.reason(),e.isRejected=!0),e},O.prototype.all=function(){return 0<arguments.length&&this._warn(".all() was passed arguments but it does not take any"),new _(this).promise()},O.prototype.error=function(e){return this.caught(p.originatesFromRejection,e)},O.getNewLibraryCopy=N.exports,O.is=function(e){return e instanceof O},O.fromNode=O.fromCallback=function(e){var t=new O(g);t._captureStackTrace();var n=1<arguments.length&&!!Object(arguments[1]).multiArgs,r=T(e)(i(t,n));return r===C&&t._rejectCallback(r.e,!0),t._isFateSealed()||t._setAsyncGuaranteed(),t},O.all=function(e){return new _(e).promise()},O.resolve=O.fulfilled=O.cast=function(e){var t=b(e);return t instanceof O||((t=new O(g))._captureStackTrace(),t._setFulfilled(),t._rejectionHandler0=e),t},O.reject=O.rejected=function(e){var t=new O(g);return t._captureStackTrace(),t._rejectCallback(e,!0),t},O.setScheduler=function(e){if("function"!=typeof e)throw new h("expecting a function but got "+p.classString(e));return v.setScheduler(e)},O.prototype._then=function(e,t,n,r,i){var o=void 0!==i,a=o?i:new O(g),s=this._target(),u=s._bitField;o||(a._propagateFrom(this,3),a._captureStackTrace(),void 0===r&&0!=(2097152&this._bitField)&&(r=0!=(50397184&u)?this._boundValue():s===this?void 0:this._boundTo),this._fireEvent("promiseChained",this,a));var c=d();if(0!=(50397184&u)){var l,h,f=s._settlePromiseCtx;0!=(33554432&u)?(h=s._rejectionHandler0,l=e):0!=(16777216&u)?(h=s._fulfillmentHandler0,l=t,s._unsetRejectionIsUnhandled()):(f=s._settlePromiseLateCancellationObserver,h=new m("late cancellation observer"),s._attachExtraTrace(h),l=t),v.invoke(f,s,{handler:null===c?l:"function"==typeof l&&p.domainBind(c,l),promise:a,receiver:r,value:h})}else s._addCallbacks(e,t,a,r,c);return a},O.prototype._length=function(){return 65535&this._bitField},O.prototype._isFateSealed=function(){return 0!=(117506048&this._bitField)},O.prototype._isFollowing=function(){return 67108864==(67108864&this._bitField)},O.prototype._setLength=function(e){this._bitField=-65536&this._bitField|65535&e},O.prototype._setFulfilled=function(){this._bitField=33554432|this._bitField,this._fireEvent("promiseFulfilled",this)},O.prototype._setRejected=function(){this._bitField=16777216|this._bitField,this._fireEvent("promiseRejected",this)},O.prototype._setFollowing=function(){this._bitField=67108864|this._bitField,this._fireEvent("promiseResolved",this)},O.prototype._setIsFinal=function(){this._bitField=4194304|this._bitField},O.prototype._isFinal=function(){return 0<(4194304&this._bitField)},O.prototype._unsetCancelled=function(){this._bitField=-65537&this._bitField},O.prototype._setCancelled=function(){this._bitField=65536|this._bitField,this._fireEvent("promiseCancelled",this)},O.prototype._setWillBeCancelled=function(){this._bitField=8388608|this._bitField},O.prototype._setAsyncGuaranteed=function(){v.hasCustomScheduler()||(this._bitField=134217728|this._bitField)},O.prototype._receiverAt=function(e){var t=0===e?this._receiver0:this[4*e-4+3];if(t!==l)return void 0===t&&this._isBound()?this._boundValue():t},O.prototype._promiseAt=function(e){return this[4*e-4+2]},O.prototype._fulfillmentHandlerAt=function(e){return this[4*e-4+0]},O.prototype._rejectionHandlerAt=function(e){return this[4*e-4+1]},O.prototype._boundValue=function(){},O.prototype._migrateCallback0=function(e){e._bitField;var t=e._fulfillmentHandler0,n=e._rejectionHandler0,r=e._promise0,i=e._receiverAt(0);void 0===i&&(i=l),this._addCallbacks(t,n,r,i,null)},O.prototype._migrateCallbackAt=function(e,t){var n=e._fulfillmentHandlerAt(t),r=e._rejectionHandlerAt(t),i=e._promiseAt(t),o=e._receiverAt(t);void 0===o&&(o=l),this._addCallbacks(n,r,i,o,null)},O.prototype._addCallbacks=function(e,t,n,r,i){var o=this._length();if(65531<=o&&(o=0,this._setLength(0)),0===o)this._promise0=n,this._receiver0=r,"function"==typeof e&&(this._fulfillmentHandler0=null===i?e:p.domainBind(i,e)),"function"==typeof t&&(this._rejectionHandler0=null===i?t:p.domainBind(i,t));else{var a=4*o-4;this[a+2]=n,this[a+3]=r,"function"==typeof e&&(this[a+0]=null===i?e:p.domainBind(i,e)),"function"==typeof t&&(this[a+1]=null===i?t:p.domainBind(i,t))}return this._setLength(o+1),o},O.prototype._proxy=function(e,t){this._addCallbacks(void 0,void 0,t,e,null)},O.prototype._resolveCallback=function(e,t){if(0==(117506048&this._bitField)){if(e===this)return this._rejectCallback(u(),!1);var n=b(e,this);if(!(n instanceof O))return this._fulfill(e);t&&this._propagateFrom(n,2);var r=n._target();if(r!==this){var i=r._bitField;if(0==(50397184&i)){var o=this._length();0<o&&r._migrateCallback0(this);for(var a=1;a<o;++a)r._migrateCallbackAt(this,a);this._setFollowing(),this._setLength(0),this._setFollowee(r)}else if(0!=(33554432&i))this._fulfill(r._value());else if(0!=(16777216&i))this._reject(r._reason());else{var s=new m("late cancellation observer");r._attachExtraTrace(s),this._reject(s)}}else this._reject(u())}},O.prototype._rejectCallback=function(e,t,n){var r=p.ensureErrorObject(e),i=r===e;if(!i&&!n&&w.warnings()){var o="a promise was rejected with a non-error: "+p.classString(e);this._warn(o,!0)}this._attachExtraTrace(r,!!t&&i),this._reject(e)},O.prototype._resolveFromExecutor=function(e){if(e!==g){var t=this;this._captureStackTrace(),this._pushContext();var n=!0,r=this._execute(e,function(e){t._resolveCallback(e)},function(e){t._rejectCallback(e,n)});n=!1,this._popContext(),void 0!==r&&t._rejectCallback(r,!0)}},O.prototype._settlePromiseFromHandler=function(e,t,n,r){var i=r._bitField;if(0==(65536&i)){var o;r._pushContext(),t===f?n&&"number"==typeof n.length?o=T(e).apply(this._boundValue(),n):(o=C).e=new h("cannot .spread() a non-array: "+p.classString(n)):o=T(e).call(t,n);var a=r._popContext();0==(65536&(i=r._bitField))&&(o===y?r._reject(n):o===C?r._rejectCallback(o.e,!1):(w.checkForgottenReturns(o,a,"",r,this),r._resolveCallback(o)))}},O.prototype._target=function(){for(var e=this;e._isFollowing();)e=e._followee();return e},O.prototype._followee=function(){return this._rejectionHandler0},O.prototype._setFollowee=function(e){this._rejectionHandler0=e},O.prototype._settlePromise=function(e,t,n,r){var i=e instanceof O,o=this._bitField,a=0!=(134217728&o);0!=(65536&o)?(i&&e._invokeInternalOnCancel(),n instanceof E&&n.isFinallyHandler()?(n.cancelPromise=e,T(t).call(n,r)===C&&e._reject(C.e)):t===s?e._fulfill(s.call(n)):n instanceof c?n._promiseCancelled(e):i||e instanceof _?e._cancel():n.cancel()):"function"==typeof t?i?(a&&e._setAsyncGuaranteed(),this._settlePromiseFromHandler(t,n,r,e)):t.call(n,r,e):n instanceof c?n._isResolved()||(0!=(33554432&o)?n._promiseFulfilled(r,e):n._promiseRejected(r,e)):i&&(a&&e._setAsyncGuaranteed(),0!=(33554432&o)?e._fulfill(r):e._reject(r))},O.prototype._settlePromiseLateCancellationObserver=function(e){var t=e.handler,n=e.promise,r=e.receiver,i=e.value;"function"==typeof t?n instanceof O?this._settlePromiseFromHandler(t,r,i,n):t.call(r,i,n):n instanceof O&&n._reject(i)},O.prototype._settlePromiseCtx=function(e){this._settlePromise(e.promise,e.handler,e.receiver,e.value)},O.prototype._settlePromise0=function(e,t,n){var r=this._promise0,i=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(r,e,i,t)},O.prototype._clearCallbackDataAtIndex=function(e){var t=4*e-4;this[t+2]=this[t+3]=this[t+0]=this[t+1]=void 0},O.prototype._fulfill=function(e){var t=this._bitField;if(!((117506048&t)>>>16)){if(e===this){var n=u();return this._attachExtraTrace(n),this._reject(n)}this._setFulfilled(),this._rejectionHandler0=e,0<(65535&t)&&(0!=(134217728&t)?this._settlePromises():v.settlePromises(this))}},O.prototype._reject=function(e){var t=this._bitField;if(!((117506048&t)>>>16)){if(this._setRejected(),this._fulfillmentHandler0=e,this._isFinal())return v.fatalError(e,p.isNode);0<(65535&t)?v.settlePromises(this):this._ensurePossibleRejectionHandled()}},O.prototype._fulfillPromises=function(e,t){for(var n=1;n<e;n++){var r=this._fulfillmentHandlerAt(n),i=this._promiseAt(n),o=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(i,r,o,t)}},O.prototype._rejectPromises=function(e,t){for(var n=1;n<e;n++){var r=this._rejectionHandlerAt(n),i=this._promiseAt(n),o=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(i,r,o,t)}},O.prototype._settlePromises=function(){var e=this._bitField,t=65535&e;if(0<t){if(0!=(16842752&e)){var n=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,n,e),this._rejectPromises(t,n)}else{var r=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,r,e),this._fulfillPromises(t,r)}this._setLength(0)}this._clearCancellationData()},O.prototype._settledValue=function(){var e=this._bitField;return 0!=(33554432&e)?this._rejectionHandler0:0!=(16777216&e)?this._fulfillmentHandler0:void 0},O.defer=O.pending=function(){return w.deprecated("Promise.defer","new Promise"),{promise:new O(g),resolve:o,reject:R}},p.notEnumerableProp(O,"_makeSelfResolutionError",u),I("./method")(O,g,b,a,w),I("./bind")(O,g,b,w),I("./cancel")(O,_,a,w),I("./direct_resolve")(O),I("./synchronous_inspection")(O),I("./join")(O,_,b,g,v,d),(O.Promise=O).version="3.5.1",p.toFastProperties(O),p.toFastProperties(O.prototype),A({a:1}),A({b:2}),A({c:3}),A(1),A(function(){}),A(void 0),A(!1),A(new O(g)),w.setBounds(t.firstLineError,p.lastLineError),O}},{"./async":1,"./bind":2,"./cancel":4,"./catch_filter":5,"./context":6,"./debuggability":7,"./direct_resolve":8,"./errors":9,"./es5":10,"./finally":11,"./join":12,"./method":13,"./nodeback":14,"./promise_array":16,"./synchronous_inspection":19,"./thenables":20,"./util":21}],16:[function(r,e,t){"use strict";e.exports=function(s,n,u,a,e){var c=r("./util");c.isArray;function t(e){var t=this._promise=new s(n);e instanceof s&&t._propagateFrom(e,3),t._setOnCancel(this),this._values=e,this._length=0,this._totalResolved=0,this._init(void 0,-2)}return c.inherits(t,e),t.prototype.length=function(){return this._length},t.prototype.promise=function(){return this._promise},t.prototype._init=function e(t,n){var r=u(this._values,this._promise);if(r instanceof s){var i=(r=r._target())._bitField;if(this._values=r,0==(50397184&i))return this._promise._setAsyncGuaranteed(),r._then(e,this._reject,void 0,this,n);if(0==(33554432&i))return 0!=(16777216&i)?this._reject(r._reason()):this._cancel();r=r._value()}if(null!==(r=c.asArray(r)))0!==r.length?this._iterate(r):-5===n?this._resolveEmptyArray():this._resolve(function(e){switch(e){case-2:return[];case-3:return{};case-6:return new Map}}(n));else{var o=a("expecting an array or an iterable object but got "+c.classString(r)).reason();this._promise._rejectCallback(o,!1)}},t.prototype._iterate=function(e){var t=this.getActualLength(e.length);this._length=t,this._values=this.shouldCopyValues()?new Array(t):this._values;for(var n=this._promise,r=!1,i=null,o=0;o<t;++o){var a=u(e[o],n);i=a instanceof s?(a=a._target())._bitField:null,r?null!==i&&a.suppressUnhandledRejections():null!==i?0==(50397184&i)?(a._proxy(this,o),this._values[o]=a):r=0!=(33554432&i)?this._promiseFulfilled(a._value(),o):0!=(16777216&i)?this._promiseRejected(a._reason(),o):this._promiseCancelled(o):r=this._promiseFulfilled(a,o)}r||n._setAsyncGuaranteed()},t.prototype._isResolved=function(){return null===this._values},t.prototype._resolve=function(e){this._values=null,this._promise._fulfill(e)},t.prototype._cancel=function(){!this._isResolved()&&this._promise._isCancellable()&&(this._values=null,this._promise._cancel())},t.prototype._reject=function(e){this._values=null,this._promise._rejectCallback(e,!1)},t.prototype._promiseFulfilled=function(e,t){return this._values[t]=e,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},t.prototype._promiseCancelled=function(){return this._cancel(),!0},t.prototype._promiseRejected=function(e){return this._totalResolved++,this._reject(e),!0},t.prototype._resultCancelled=function(){if(!this._isResolved()){var e=this._values;if(this._cancel(),e instanceof s)e.cancel();else for(var t=0;t<e.length;++t)e[t]instanceof s&&e[t].cancel()}},t.prototype.shouldCopyValues=function(){return!0},t.prototype.getActualLength=function(e){return e},t}},{"./util":21}],17:[function(e,t,n){"use strict";function r(e){this._capacity=e,this._length=0,this._front=0}r.prototype._willBeOverCapacity=function(e){return this._capacity<e},r.prototype._pushOne=function(e){var t=this.length();this._checkCapacity(t+1),this[this._front+t&this._capacity-1]=e,this._length=t+1},r.prototype.push=function(e,t,n){var r=this.length()+3;if(this._willBeOverCapacity(r))return this._pushOne(e),this._pushOne(t),void this._pushOne(n);var i=this._front+r-3;this._checkCapacity(r);var o=this._capacity-1;this[i+0&o]=e,this[i+1&o]=t,this[i+2&o]=n,this._length=r},r.prototype.shift=function(){var e=this._front,t=this[e];return this[e]=void 0,this._front=e+1&this._capacity-1,this._length--,t},r.prototype.length=function(){return this._length},r.prototype._checkCapacity=function(e){this._capacity<e&&this._resizeTo(this._capacity<<1)},r.prototype._resizeTo=function(e){var t=this._capacity;this._capacity=e,function(e,t,n,r,i){for(var o=0;o<i;++o)n[o+r]=e[o+t],e[o+t]=void 0}(this,0,this,t,this._front+this._length&t-1)},t.exports=r},{}],18:[function(e,t,n){"use strict";var r,i=e("./util"),o=i.getNativePromise();if(i.isNode&&"undefined"==typeof MutationObserver){var a=global.setImmediate,s=process.nextTick;r=i.isRecentNode?function(e){a.call(global,e)}:function(e){s.call(process,e)}}else if("function"==typeof o&&"function"==typeof o.resolve){var u=o.resolve();r=function(e){u.then(e)}}else r="undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&(window.navigator.standalone||window.cordova)?"undefined"!=typeof setImmediate?function(e){setImmediate(e)}:"undefined"!=typeof setTimeout?function(e){setTimeout(e,0)}:function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}:function(){var n=document.createElement("div"),r={attributes:!0},i=!1,o=document.createElement("div");new MutationObserver(function(){n.classList.toggle("foo"),i=!1}).observe(o,r);return function(e){var t=new MutationObserver(function(){t.disconnect(),e()});t.observe(n,r),i||(i=!0,o.classList.toggle("foo"))}}();t.exports=r},{"./util":21}],19:[function(e,t,n){"use strict";t.exports=function(e){function t(e){void 0!==e?(e=e._target(),this._bitField=e._bitField,this._settledValueField=e._isFateSealed()?e._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}t.prototype._settledValue=function(){return this._settledValueField};var n=t.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},r=t.prototype.error=t.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},i=t.prototype.isFulfilled=function(){return 0!=(33554432&this._bitField)},o=t.prototype.isRejected=function(){return 0!=(16777216&this._bitField)},a=t.prototype.isPending=function(){return 0==(50397184&this._bitField)},s=t.prototype.isResolved=function(){return 0!=(50331648&this._bitField)};t.prototype.isCancelled=function(){return 0!=(8454144&this._bitField)},e.prototype.__isCancelled=function(){return 65536==(65536&this._bitField)},e.prototype._isCancelled=function(){return this._target().__isCancelled()},e.prototype.isCancelled=function(){return 0!=(8454144&this._target()._bitField)},e.prototype.isPending=function(){return a.call(this._target())},e.prototype.isRejected=function(){return o.call(this._target())},e.prototype.isFulfilled=function(){return i.call(this._target())},e.prototype.isResolved=function(){return s.call(this._target())},e.prototype.value=function(){return n.call(this._target())},e.prototype.reason=function(){var e=this._target();return e._unsetRejectionIsUnhandled(),r.call(e)},e.prototype._value=function(){return this._settledValue()},e.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},e.PromiseInspection=t}},{}],20:[function(e,t,n){"use strict";t.exports=function(s,u){var c=e("./util"),l=c.errorObj,i=c.isObject;var o={}.hasOwnProperty;return function(e,t){if(i(e)){if(e instanceof s)return e;var n=function(e){try{return e.then}catch(e){return l.e=e,l}}(e);if(n===l){t&&t._pushContext();var r=s.reject(n.e);return t&&t._popContext(),r}if("function"==typeof n)return function(e){try{return o.call(e,"_promise0")}catch(e){return!1}}(e)?(r=new s(u),e._then(r._fulfill,r._reject,void 0,r,null),r):function(e,t,n){var r=new s(u),i=r;n&&n._pushContext(),r._captureStackTrace(),n&&n._popContext();var o=!0,a=c.tryCatch(t).call(e,function(e){r&&(r._resolveCallback(e),r=null)},function(e){r&&(r._rejectCallback(e,o,!0),r=null)});return o=!1,r&&a===l&&(r._rejectCallback(a.e,!0,!0),r=null),i}(e,n,t)}return e}}},{"./util":21}],21:[function(e,t,n){"use strict";var c=e("./es5"),r="undefined"==typeof navigator,i={e:{}},o,a="undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:void 0!==this?this:null;function s(){try{var e=o;return o=null,e.apply(this,arguments)}catch(e){return i.e=e,i}}function u(e){return o=e,s}var l=function(t,n){var r={}.hasOwnProperty;function e(){for(var e in this.constructor=t,(this.constructor$=n).prototype)r.call(n.prototype,e)&&"$"!==e.charAt(e.length-1)&&(this[e+"$"]=n.prototype[e])}return e.prototype=n.prototype,t.prototype=new e,t.prototype};function h(e){return null==e||!0===e||!1===e||"string"==typeof e||"number"==typeof e}function f(e){return"function"==typeof e||"object"==typeof e&&null!==e}function d(e){return h(e)?new Error(T(e)):e}function p(e,t){var n,r=e.length,i=new Array(r+1);for(n=0;n<r;++n)i[n]=e[n];return i[n]=t,i}function v(e,t,n){if(!c.isES5)return{}.hasOwnProperty.call(e,t)?e[t]:void 0;var r=Object.getOwnPropertyDescriptor(e,t);return null!=r?null==r.get&&null==r.set?r.value:n:void 0}function m(e,t,n){if(h(e))return e;var r={value:n,configurable:!0,enumerable:!1,writable:!0};return c.defineProperty(e,t,r),e}function g(e){throw e}var y=function(){var i=[Array.prototype,Object.prototype,Function.prototype],s=function(e){for(var t=0;t<i.length;++t)if(i[t]===e)return!0;return!1};if(c.isES5){var u=Object.getOwnPropertyNames;return function(e){for(var t=[],n=Object.create(null);null!=e&&!s(e);){var r;try{r=u(e)}catch(e){return t}for(var i=0;i<r.length;++i){var o=r[i];if(!n[o]){n[o]=!0;var a=Object.getOwnPropertyDescriptor(e,o);null!=a&&null==a.get&&null==a.set&&t.push(o)}}e=c.getPrototypeOf(e)}return t}}var o={}.hasOwnProperty;return function(e){if(s(e))return[];var t=[];e:for(var n in e)if(o.call(e,n))t.push(n);else{for(var r=0;r<i.length;++r)if(o.call(i[r],n))continue e;t.push(n)}return t}}(),b=/this\s*\.\s*\S+\s*=/;function _(e){try{if("function"==typeof e){var t=c.names(e.prototype),n=c.isES5&&1<t.length,r=0<t.length&&!(1===t.length&&"constructor"===t[0]),i=b.test(e+"")&&0<c.names(e).length;if(n||r||i)return!0}return!1}catch(e){return!1}}function w(e){function t(){}t.prototype=e;for(var n=8;n--;)new t;return e}var E=/^[a-z$_][a-z$_0-9]*$/i;function S(e){return E.test(e)}function C(e,t,n){for(var r=new Array(e),i=0;i<e;++i)r[i]=t+i+n;return r}function T(e){try{return e+""}catch(e){return"[no string representation]"}}function O(e){return e instanceof Error||null!==e&&"object"==typeof e&&"string"==typeof e.message&&"string"==typeof e.name}function R(e){try{m(e,"isOperational",!0)}catch(e){}}function A(e){return null!=e&&(e instanceof Error.__BluebirdErrorTypes__.OperationalError||!0===e.isOperational)}function I(e){return O(e)&&c.propertyIsWritable(e,"stack")}var N="stack"in new Error?function(e){return I(e)?e:new Error(T(e))}:function(e){if(I(e))return e;try{throw new Error(T(e))}catch(e){return e}};function k(e){return{}.toString.call(e)}function P(e,t,n){for(var r=c.names(e),i=0;i<r.length;++i){var o=r[i];if(n(o))try{c.defineProperty(t,o,c.getDescriptor(e,o))}catch(e){}}}var x=function(e){return c.isArray(e)?e:null};if("undefined"!=typeof Symbol&&Symbol.iterator){var D="function"==typeof Array.from?function(e){return Array.from(e)}:function(e){for(var t,n=[],r=e[Symbol.iterator]();!(t=r.next()).done;)n.push(t.value);return n};x=function(e){return c.isArray(e)?e:null!=e&&"function"==typeof e[Symbol.iterator]?D(e):null}}var M="undefined"!=typeof process&&"[object process]"===k(process).toLowerCase(),L="undefined"!=typeof process&&void 0!==process.env;function F(e){return L?process.env[e]:void 0}function V(){if("function"==typeof Promise)try{var e=new Promise(function(){});if("[object Promise]"==={}.toString.call(e))return Promise}catch(e){}}function j(e,t){return e.bind(t)}var U={isClass:_,isIdentifier:S,inheritedDataKeys:y,getDataPropertyOrDefault:v,thrower:g,isArray:c.isArray,asArray:x,notEnumerableProp:m,isPrimitive:h,isObject:f,isError:O,canEvaluate:r,errorObj:i,tryCatch:u,inherits:l,withAppended:p,maybeWrapAsError:d,toFastProperties:w,filledRange:C,toString:T,canAttachTrace:I,ensureErrorObject:N,originatesFromRejection:A,markAsOriginatingFromRejection:R,classString:k,copyDescriptors:P,hasDevTools:"undefined"!=typeof chrome&&chrome&&"function"==typeof chrome.loadTimes,isNode:M,hasEnvVariables:L,env:F,global:a,getNativePromise:V,domainBind:j},B;U.isRecentNode=U.isNode&&(B=process.versions.node.split(".").map(Number),0===B[0]&&10<B[1]||0<B[0]),U.isNode&&U.toFastProperties(process);try{throw new Error}catch(e){U.lastLineError=e}t.exports=U},{"./es5":10}]},{},[3])(3)}),"undefined"!=typeof window&&null!==window?window.P=window.Promise:"undefined"!=typeof self&&null!==self&&(self.P=self.Promise),Promise.config({longStackTraces:!1,warnings:{wForgottenReturn:!1}}),function o(a,s,u){function c(t,e){if(!s[t]){if(!a[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(l)return l(t,!0);var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}var i=s[t]={exports:{}};a[t][0].call(i.exports,function(e){return c(a[t][1][e]||e)},i,i.exports,o,a,s,u)}return s[t].exports}for(var l="function"==typeof require&&require,e=0;e<u.length;e++)c(u[e]);return c}({1:[function(n,e,t){(function(e){"use strict";function t(e,t,n){e[t]||Object.defineProperty(e,t,{writable:!0,configurable:!0,value:n})}if(n(327),n(328),n(2),e._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed");e._babelPolyfill=!0;t(String.prototype,"padLeft","".padStart),t(String.prototype,"padRight","".padEnd),"pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach(function(e){[][e]&&t(Array,e,Function.call.bind([][e]))})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2,327:327,328:328}],2:[function(e,t,n){e(130),t.exports=e(23).RegExp.escape},{130:130,23:23}],3:[function(e,t,n){t.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},{}],4:[function(e,t,n){var r=e(18);t.exports=function(e,t){if("number"!=typeof e&&"Number"!=r(e))throw TypeError(t);return+e}},{18:18}],5:[function(e,t,n){var r=e(128)("unscopables"),i=Array.prototype;null==i[r]&&e(42)(i,r,{}),t.exports=function(e){i[r][e]=!0}},{128:128,42:42}],6:[function(e,t,n){t.exports=function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!");return e}},{}],7:[function(e,t,n){var r=e(51);t.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},{51:51}],8:[function(e,t,n){"use strict";var c=e(119),l=e(114),h=e(118);t.exports=[].copyWithin||function(e,t){var n=c(this),r=h(n.length),i=l(e,r),o=l(t,r),a=2<arguments.length?arguments[2]:void 0,s=Math.min((void 0===a?r:l(a,r))-o,r-i),u=1;for(o<i&&i<o+s&&(u=-1,o+=s-1,i+=s-1);0<s--;)o in n?n[i]=n[o]:delete n[i],i+=u,o+=u;return n}},{114:114,118:118,119:119}],9:[function(e,t,n){"use strict";var s=e(119),u=e(114),c=e(118);t.exports=function(e){for(var t=s(this),n=c(t.length),r=arguments.length,i=u(1<r?arguments[1]:void 0,n),o=2<r?arguments[2]:void 0,a=void 0===o?n:u(o,n);i<a;)t[i++]=e;return t}},{114:114,118:118,119:119}],10:[function(e,t,n){var r=e(39);t.exports=function(e,t){var n=[];return r(e,!1,n.push,n,t),n}},{39:39}],11:[function(e,t,n){var u=e(117),c=e(118),l=e(114);t.exports=function(s){return function(e,t,n){var r,i=u(e),o=c(i.length),a=l(n,o);if(s&&t!=t){for(;a<o;)if((r=i[a++])!=r)return!0}else for(;a<o;a++)if((s||a in i)&&i[a]===t)return s||a||0;return!s&&-1}}},{114:114,117:117,118:118}],12:[function(e,t,n){var b=e(25),_=e(47),w=e(119),E=e(118),r=e(15);t.exports=function(h,e){var f=1==h,d=2==h,p=3==h,v=4==h,m=6==h,g=5==h||m,y=e||r;return function(e,t,n){for(var r,i,o=w(e),a=_(o),s=b(t,n,3),u=E(a.length),c=0,l=f?y(e,u):d?y(e,0):void 0;c<u;c++)if((g||c in a)&&(i=s(r=a[c],c,o),h))if(f)l[c]=i;else if(i)switch(h){case 3:return!0;case 5:return r;case 6:return c;case 2:l.push(r)}else if(v)return!1;return m?-1:p||v?v:l}}},{118:118,119:119,15:15,25:25,47:47}],13:[function(e,t,n){var l=e(3),h=e(119),f=e(47),d=e(118);t.exports=function(e,t,n,r,i){l(t);var o=h(e),a=f(o),s=d(o.length),u=i?s-1:0,c=i?-1:1;if(n<2)for(;;){if(u in a){r=a[u],u+=c;break}if(u+=c,i?u<0:s<=u)throw TypeError("Reduce of empty array with no initial value")}for(;i?0<=u:u<s;u+=c)u in a&&(r=t(r,a[u],u,o));return r}},{118:118,119:119,3:3,47:47}],14:[function(e,t,n){var r=e(51),i=e(49),o=e(128)("species");t.exports=function(e){var t;return i(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!i(t.prototype)||(t=void 0),r(t)&&null===(t=t[o])&&(t=void 0)),void 0===t?Array:t}},{128:128,49:49,51:51}],15:[function(e,t,n){var r=e(14);t.exports=function(e,t){return new(r(e))(t)}},{14:14}],16:[function(e,t,n){"use strict";var o=e(3),a=e(51),s=e(46),u=[].slice,c={};t.exports=Function.bind||function(t){var n=o(this),r=u.call(arguments,1),i=function(){var e=r.concat(u.call(arguments));return this instanceof i?function(e,t,n){if(!(t in c)){for(var r=[],i=0;i<t;i++)r[i]="a["+i+"]";c[t]=Function("F,a","return new F("+r.join(",")+")")}return c[t](e,n)}(n,e.length,e):s(n,e,t)};return a(n.prototype)&&(i.prototype=n.prototype),i}},{3:3,46:46,51:51}],17:[function(e,t,n){var i=e(18),o=e(128)("toStringTag"),a="Arguments"==i(function(){return arguments}());t.exports=function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),o))?n:a?i(t):"Object"==(r=i(t))&&"function"==typeof t.callee?"Arguments":r}},{128:128,18:18}],18:[function(e,t,n){var r={}.toString;t.exports=function(e){return r.call(e).slice(8,-1)}},{}],19:[function(e,t,n){"use strict";var a=e(72).f,s=e(71),u=e(93),c=e(25),l=e(6),h=e(39),r=e(55),i=e(57),o=e(100),f=e(29),d=e(66).fastKey,p=e(125),v=f?"_s":"size",m=function(e,t){var n,r=d(t);if("F"!==r)return e._i[r];for(n=e._f;n;n=n.n)if(n.k==t)return n};t.exports={getConstructor:function(e,o,n,r){var i=e(function(e,t){l(e,i,o,"_i"),e._t=o,e._i=s(null),e._f=void 0,e._l=void 0,e[v]=0,null!=t&&h(t,n,e[r],e)});return u(i.prototype,{clear:function(){for(var e=p(this,o),t=e._i,n=e._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete t[n.i];e._f=e._l=void 0,e[v]=0},delete:function(e){var t=p(this,o),n=m(t,e);if(n){var r=n.n,i=n.p;delete t._i[n.i],n.r=!0,i&&(i.n=r),r&&(r.p=i),t._f==n&&(t._f=r),t._l==n&&(t._l=i),t[v]--}return!!n},forEach:function(e){p(this,o);for(var t,n=c(e,1<arguments.length?arguments[1]:void 0,3);t=t?t.n:this._f;)for(n(t.v,t.k,this);t&&t.r;)t=t.p},has:function(e){return!!m(p(this,o),e)}}),f&&a(i.prototype,"size",{get:function(){return p(this,o)[v]}}),i},def:function(e,t,n){var r,i,o=m(e,t);return o?o.v=n:(e._l=o={i:i=d(t,!0),k:t,v:n,p:r=e._l,n:void 0,r:!1},e._f||(e._f=o),r&&(r.n=o),e[v]++,"F"!==i&&(e._i[i]=o)),e},getEntry:m,setStrong:function(e,n,t){r(e,n,function(e,t){this._t=p(e,n),this._k=t,this._l=void 0},function(){for(var e=this,t=e._k,n=e._l;n&&n.r;)n=n.p;return e._t&&(e._l=n=n?n.n:e._t._f)?i(0,"keys"==t?n.k:"values"==t?n.v:[n.k,n.v]):(e._t=void 0,i(1))},t?"entries":"values",!t,!0),o(n)}}},{100:100,125:125,25:25,29:29,39:39,55:55,57:57,6:6,66:66,71:71,72:72,93:93}],20:[function(e,t,n){var r=e(17),i=e(10);t.exports=function(e){return function(){if(r(this)!=e)throw TypeError(e+"#toJSON isn't generic");return i(this)}}},{10:10,17:17}],21:[function(e,t,n){"use strict";var a=e(93),s=e(66).getWeak,i=e(7),u=e(51),c=e(6),l=e(39),r=e(12),h=e(41),f=e(125),o=r(5),d=r(6),p=0,v=function(e){return e._l||(e._l=new m)},m=function(){this.a=[]},g=function(e,t){return o(e.a,function(e){return e[0]===t})};m.prototype={get:function(e){var t=g(this,e);if(t)return t[1]},has:function(e){return!!g(this,e)},set:function(e,t){var n=g(this,e);n?n[1]=t:this.a.push([e,t])},delete:function(t){var e=d(this.a,function(e){return e[0]===t});return~e&&this.a.splice(e,1),!!~e}},t.exports={getConstructor:function(e,n,r,i){var o=e(function(e,t){c(e,o,n,"_i"),e._t=n,e._i=p++,e._l=void 0,null!=t&&l(t,r,e[i],e)});return a(o.prototype,{delete:function(e){if(!u(e))return!1;var t=s(e);return!0===t?v(f(this,n)).delete(e):t&&h(t,this._i)&&delete t[this._i]},has:function(e){if(!u(e))return!1;var t=s(e);return!0===t?v(f(this,n)).has(e):t&&h(t,this._i)}}),o},def:function(e,t,n){var r=s(i(t),!0);return!0===r?v(e).set(t,n):r[e._i]=n,e},ufstore:v}},{12:12,125:125,39:39,41:41,51:51,6:6,66:66,7:7,93:93}],22:[function(e,t,n){"use strict";var g=e(40),y=e(33),b=e(94),_=e(93),w=e(66),E=e(39),S=e(6),C=e(51),T=e(35),O=e(56),R=e(101),A=e(45);t.exports=function(r,e,t,n,i,o){var a=g[r],s=a,u=i?"set":"add",c=s&&s.prototype,l={},h=function(e){var n=c[e];b(c,e,"delete"==e?function(e){return!(o&&!C(e))&&n.call(this,0===e?0:e)}:"has"==e?function(e){return!(o&&!C(e))&&n.call(this,0===e?0:e)}:"get"==e?function(e){return o&&!C(e)?void 0:n.call(this,0===e?0:e)}:"add"==e?function(e){return n.call(this,0===e?0:e),this}:function(e,t){return n.call(this,0===e?0:e,t),this})};if("function"==typeof s&&(o||c.forEach&&!T(function(){(new s).entries().next()}))){var f=new s,d=f[u](o?{}:-0,1)!=f,p=T(function(){f.has(1)}),v=O(function(e){new s(e)}),m=!o&&T(function(){for(var e=new s,t=5;t--;)e[u](t,t);return!e.has(-0)});v||(((s=e(function(e,t){S(e,s,r);var n=A(new a,e,s);return null!=t&&E(t,i,n[u],n),n})).prototype=c).constructor=s),(p||m)&&(h("delete"),h("has"),i&&h("get")),(m||d)&&h(u),o&&c.clear&&delete c.clear}else s=n.getConstructor(e,r,i,u),_(s.prototype,t),w.NEED=!0;return R(s,r),l[r]=s,y(y.G+y.W+y.F*(s!=a),l),o||n.setStrong(s,r,i),s}},{101:101,33:33,35:35,39:39,40:40,45:45,51:51,56:56,6:6,66:66,93:93,94:94}],23:[function(e,t,n){var r=t.exports={version:"2.5.0"};"number"==typeof __e&&(__e=r)},{}],24:[function(e,t,n){"use strict";var r=e(72),i=e(92);t.exports=function(e,t,n){t in e?r.f(e,t,i(0,n)):e[t]=n}},{72:72,92:92}],25:[function(e,t,n){var o=e(3);t.exports=function(r,i,e){if(o(r),void 0===i)return r;switch(e){case 1:return function(e){return r.call(i,e)};case 2:return function(e,t){return r.call(i,e,t)};case 3:return function(e,t,n){return r.call(i,e,t,n)}}return function(){return r.apply(i,arguments)}}},{3:3}],26:[function(e,t,n){"use strict";var r=e(35),i=Date.prototype.getTime,o=Date.prototype.toISOString,a=function(e){return 9<e?e:"0"+e};t.exports=r(function(){return"0385-07-25T07:06:39.999Z"!=o.call(new Date(-5e13-1))})||!r(function(){o.call(new Date(NaN))})?function(){if(!isFinite(i.call(this)))throw RangeError("Invalid time value");var e=this,t=e.getUTCFullYear(),n=e.getUTCMilliseconds(),r=t<0?"-":9999<t?"+":"";return r+("00000"+Math.abs(t)).slice(r?-6:-4)+"-"+a(e.getUTCMonth()+1)+"-"+a(e.getUTCDate())+"T"+a(e.getUTCHours())+":"+a(e.getUTCMinutes())+":"+a(e.getUTCSeconds())+"."+(99<n?n:"0"+a(n))+"Z"}:o},{35:35}],27:[function(e,t,n){"use strict";var r=e(7),i=e(120);t.exports=function(e){if("string"!==e&&"number"!==e&&"default"!==e)throw TypeError("Incorrect hint");return i(r(this),"number"!=e)}},{120:120,7:7}],28:[function(e,t,n){t.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},{}],29:[function(e,t,n){t.exports=!e(35)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},{35:35}],30:[function(e,t,n){var r=e(51),i=e(40).document,o=r(i)&&r(i.createElement);t.exports=function(e){return o?i.createElement(e):{}}},{40:40,51:51}],31:[function(e,t,n){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},{}],32:[function(e,t,n){var s=e(81),u=e(78),c=e(82);t.exports=function(e){var t=s(e),n=u.f;if(n)for(var r,i=n(e),o=c.f,a=0;i.length>a;)o.call(e,r=i[a++])&&t.push(r);return t}},{78:78,81:81,82:82}],33:[function(e,t,n){var v=e(40),m=e(23),g=e(42),y=e(94),b=e(25),_=function(e,t,n){var r,i,o,a,s=e&_.F,u=e&_.G,c=e&_.S,l=e&_.P,h=e&_.B,f=u?v:c?v[t]||(v[t]={}):(v[t]||{}).prototype,d=u?m:m[t]||(m[t]={}),p=d.prototype||(d.prototype={});for(r in u&&(n=t),n)o=((i=!s&&f&&void 0!==f[r])?f:n)[r],a=h&&i?b(o,v):l&&"function"==typeof o?b(Function.call,o):o,f&&y(f,r,o,e&_.U),d[r]!=o&&g(d,r,a),l&&p[r]!=o&&(p[r]=o)};v.core=m,_.F=1,_.G=2,_.S=4,_.P=8,_.B=16,_.W=32,_.U=64,_.R=128,t.exports=_},{23:23,25:25,40:40,42:42,94:94}],34:[function(e,t,n){var r=e(128)("match");t.exports=function(t){var n=/./;try{"/./"[t](n)}catch(e){try{return n[r]=!1,!"/./"[t](n)}catch(t){}}return!0}},{128:128}],35:[function(e,t,n){t.exports=function(e){try{return!!e()}catch(e){return!0}}},{}],36:[function(e,t,n){"use strict";var s=e(42),u=e(94),c=e(35),l=e(28),h=e(128);t.exports=function(t,e,n){var r=h(t),i=n(l,r,""[t]),o=i[0],a=i[1];c(function(){var e={};return e[r]=function(){return 7},7!=""[t](e)})&&(u(String.prototype,t,o),s(RegExp.prototype,r,2==e?function(e,t){return a.call(e,this,t)}:function(e){return a.call(e,this)}))}},{128:128,28:28,35:35,42:42,94:94}],37:[function(e,t,n){"use strict";var r=e(7);t.exports=function(){var e=r(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},{7:7}],38:[function(e,t,n){"use strict";var p=e(49),v=e(51),m=e(118),g=e(25),y=e(128)("isConcatSpreadable");t.exports=function e(t,n,r,i,o,a,s,u){for(var c,l,h=o,f=0,d=!!s&&g(s,u,3);f<i;){if(f in r){if(c=d?d(r[f],f,n):r[f],l=!1,v(c)&&(l=void 0!==(l=c[y])?!!l:p(c)),l&&0<a)h=e(t,n,c,m(c.length),h,a-1)-1;else{if(9007199254740991<=h)throw TypeError();t[h]=c}h++}f++}return h}},{118:118,128:128,25:25,49:49,51:51}],39:[function(e,t,n){var f=e(25),d=e(53),p=e(48),v=e(7),m=e(118),g=e(129),y={},b={};(n=t.exports=function(e,t,n,r,i){var o,a,s,u,c=i?function(){return e}:g(e),l=f(n,r,t?2:1),h=0;if("function"!=typeof c)throw TypeError(e+" is not iterable!");if(p(c)){for(o=m(e.length);h<o;h++)if((u=t?l(v(a=e[h])[0],a[1]):l(e[h]))===y||u===b)return u}else for(s=c.call(e);!(a=s.next()).done;)if((u=d(s,l,a.value,t))===y||u===b)return u}).BREAK=y,n.RETURN=b},{118:118,129:129,25:25,48:48,53:53,7:7}],40:[function(e,t,n){var r=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},{}],41:[function(e,t,n){var r={}.hasOwnProperty;t.exports=function(e,t){return r.call(e,t)}},{}],42:[function(e,t,n){var r=e(72),i=e(92);t.exports=e(29)?function(e,t,n){return r.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},{29:29,72:72,92:92}],43:[function(e,t,n){var r=e(40).document;t.exports=r&&r.documentElement},{40:40}],44:[function(e,t,n){t.exports=!e(29)&&!e(35)(function(){return 7!=Object.defineProperty(e(30)("div"),"a",{get:function(){return 7}}).a})},{29:29,30:30,35:35}],45:[function(e,t,n){var o=e(51),a=e(99).set;t.exports=function(e,t,n){var r,i=t.constructor;return i!==n&&"function"==typeof i&&(r=i.prototype)!==n.prototype&&o(r)&&a&&a(e,r),e}},{51:51,99:99}],46:[function(e,t,n){t.exports=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},{}],47:[function(e,t,n){var r=e(18);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},{18:18}],48:[function(e,t,n){var r=e(58),i=e(128)("iterator"),o=Array.prototype;t.exports=function(e){return void 0!==e&&(r.Array===e||o[i]===e)}},{128:128,58:58}],49:[function(e,t,n){var r=e(18);t.exports=Array.isArray||function(e){return"Array"==r(e)}},{18:18}],50:[function(e,t,n){var r=e(51),i=Math.floor;t.exports=function(e){return!r(e)&&isFinite(e)&&i(e)===e}},{51:51}],51:[function(e,t,n){t.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},{}],52:[function(e,t,n){var r=e(51),i=e(18),o=e(128)("match");t.exports=function(e){var t;return r(e)&&(void 0!==(t=e[o])?!!t:"RegExp"==i(e))}},{128:128,18:18,51:51}],53:[function(e,t,n){var o=e(7);t.exports=function(e,t,n,r){try{return r?t(o(n)[0],n[1]):t(n)}catch(t){var i=e.return;throw void 0!==i&&o(i.call(e)),t}}},{7:7}],54:[function(e,t,n){"use strict";var r=e(71),i=e(92),o=e(101),a={};e(42)(a,e(128)("iterator"),function(){return this}),t.exports=function(e,t,n){e.prototype=r(a,{next:i(1,n)}),o(e,t+" Iterator")}},{101:101,128:128,42:42,71:71,92:92}],55:[function(e,t,n){"use strict";var b=e(60),_=e(33),w=e(94),E=e(42),S=e(41),C=e(58),T=e(54),O=e(101),R=e(79),A=e(128)("iterator"),I=!([].keys&&"next"in[].keys()),N=function(){return this};t.exports=function(e,t,n,r,i,o,a){T(n,t,r);var s,u,c,l=function(e){if(!I&&e in p)return p[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},h=t+" Iterator",f="values"==i,d=!1,p=e.prototype,v=p[A]||p["@@iterator"]||i&&p[i],m=v||l(i),g=i?f?l("entries"):m:void 0,y="Array"==t&&p.entries||v;if(y&&(c=R(y.call(new e)))!==Object.prototype&&c.next&&(O(c,h,!0),b||S(c,A)||E(c,A,N)),f&&v&&"values"!==v.name&&(d=!0,m=function(){return v.call(this)}),b&&!a||!I&&!d&&p[A]||E(p,A,m),C[t]=m,C[h]=N,i)if(s={values:f?m:l("values"),keys:o?m:l("keys"),entries:g},a)for(u in s)u in p||w(p,u,s[u]);else _(_.P+_.F*(I||d),t,s);return s}},{101:101,128:128,33:33,41:41,42:42,54:54,58:58,60:60,79:79,94:94}],56:[function(e,t,n){var o=e(128)("iterator"),a=!1;try{var r=[7][o]();r.return=function(){a=!0},Array.from(r,function(){throw 2})}catch(e){}t.exports=function(e,t){if(!t&&!a)return!1;var n=!1;try{var r=[7],i=r[o]();i.next=function(){return{done:n=!0}},r[o]=function(){return i},e(r)}catch(e){}return n}},{128:128}],57:[function(e,t,n){t.exports=function(e,t){return{value:t,done:!!e}}},{}],58:[function(e,t,n){t.exports={}},{}],59:[function(e,t,n){var s=e(81),u=e(117);t.exports=function(e,t){for(var n,r=u(e),i=s(r),o=i.length,a=0;a<o;)if(r[n=i[a++]]===t)return n}},{117:117,81:81}],60:[function(e,t,n){t.exports=!1},{}],61:[function(e,t,n){var r=Math.expm1;t.exports=!r||22025.465794806718<r(10)||r(10)<22025.465794806718||-2e-17!=r(-2e-17)?function(e){return 0==(e=+e)?e:-1e-6<e&&e<1e-6?e+e*e/2:Math.exp(e)-1}:r},{}],62:[function(e,t,n){var o=e(65),r=Math.pow,a=r(2,-52),s=r(2,-23),u=r(2,127)*(2-s),c=r(2,-126);t.exports=Math.fround||function(e){var t,n,r=Math.abs(e),i=o(e);return r<c?i*(r/c/s+1/a-1/a)*c*s:u<(n=(t=(1+s/a)*r)-(t-r))||n!=n?i*(1/0):i*n}},{65:65}],63:[function(e,t,n){t.exports=Math.log1p||function(e){return-1e-8<(e=+e)&&e<1e-8?e-e*e/2:Math.log(1+e)}},{}],64:[function(e,t,n){t.exports=Math.scale||function(e,t,n,r,i){return 0===arguments.length||e!=e||t!=t||n!=n||r!=r||i!=i?NaN:e===1/0||e===-1/0?e:(e-t)*(i-r)/(n-t)+r}},{}],65:[function(e,t,n){t.exports=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1}},{}],66:[function(e,t,n){var r=e(124)("meta"),i=e(51),o=e(41),a=e(72).f,s=0,u=Object.isExtensible||function(){return!0},c=!e(35)(function(){return u(Object.preventExtensions({}))}),l=function(e){a(e,r,{value:{i:"O"+ ++s,w:{}}})},h=t.exports={KEY:r,NEED:!1,fastKey:function(e,t){if(!i(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!o(e,r)){if(!u(e))return"F";if(!t)return"E";l(e)}return e[r].i},getWeak:function(e,t){if(!o(e,r)){if(!u(e))return!0;if(!t)return!1;l(e)}return e[r].w},onFreeze:function(e){return c&&h.NEED&&u(e)&&!o(e,r)&&l(e),e}}},{124:124,35:35,41:41,51:51,72:72}],67:[function(e,t,n){var o=e(160),r=e(33),i=e(103)("metadata"),a=i.store||(i.store=new(e(266))),s=function(e,t,n){var r=a.get(e);if(!r){if(!n)return;a.set(e,r=new o)}var i=r.get(t);if(!i){if(!n)return;r.set(t,i=new o)}return i};t.exports={store:a,map:s,has:function(e,t,n){var r=s(t,n,!1);return void 0!==r&&r.has(e)},get:function(e,t,n){var r=s(t,n,!1);return void 0===r?void 0:r.get(e)},set:function(e,t,n,r){s(n,r,!0).set(e,t)},keys:function(e,t){var n=s(e,t,!1),r=[];return n&&n.forEach(function(e,t){r.push(t)}),r},key:function(e){return void 0===e||"symbol"==typeof e?e:String(e)},exp:function(e){r(r.S,"Reflect",e)}}},{103:103,160:160,266:266,33:33}],68:[function(e,t,n){var s=e(40),u=e(113).set,c=s.MutationObserver||s.WebKitMutationObserver,l=s.process,h=s.Promise,f="process"==e(18)(l);t.exports=function(){var n,r,i,e=function(){var e,t;for(f&&(e=l.domain)&&e.exit();n;){t=n.fn,n=n.next;try{t()}catch(e){throw n?i():r=void 0,e}}r=void 0,e&&e.enter()};if(f)i=function(){l.nextTick(e)};else if(c){var t=!0,o=document.createTextNode("");new c(e).observe(o,{characterData:!0}),i=function(){o.data=t=!t}}else if(h&&h.resolve){var a=h.resolve();i=function(){a.then(e)}}else i=function(){u.call(s,e)};return function(e){var t={fn:e,next:void 0};r&&(r.next=t),n||(n=t,i()),r=t}}},{113:113,18:18,40:40}],69:[function(e,t,n){"use strict";function r(e){var n,r;this.promise=new e(function(e,t){if(void 0!==n||void 0!==r)throw TypeError("Bad Promise constructor");n=e,r=t}),this.resolve=i(n),this.reject=i(r)}var i=e(3);t.exports.f=function(e){return new r(e)}},{3:3}],70:[function(e,t,n){"use strict";var f=e(81),d=e(78),p=e(82),v=e(119),m=e(47),i=Object.assign;t.exports=!i||e(35)(function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach(function(e){t[e]=e}),7!=i({},e)[n]||Object.keys(i({},t)).join("")!=r})?function(e,t){for(var n=v(e),r=arguments.length,i=1,o=d.f,a=p.f;i<r;)for(var s,u=m(arguments[i++]),c=o?f(u).concat(o(u)):f(u),l=c.length,h=0;h<l;)a.call(u,s=c[h++])&&(n[s]=u[s]);return n}:i},{119:119,35:35,47:47,78:78,81:81,82:82}],71:[function(r,e,t){var i=r(7),o=r(73),a=r(31),s=r(102)("IE_PROTO"),u=function(){},c=function(){var e,t=r(30)("iframe"),n=a.length;for(t.style.display="none",r(43).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),c=e.F;n--;)delete c.prototype[a[n]];return c()};e.exports=Object.create||function(e,t){var n;return null!==e?(u.prototype=i(e),n=new u,u.prototype=null,n[s]=e):n=c(),void 0===t?n:o(n,t)}},{102:102,30:30,31:31,43:43,7:7,73:73}],72:[function(e,t,n){var r=e(7),i=e(44),o=e(120),a=Object.defineProperty;n.f=e(29)?Object.defineProperty:function(e,t,n){if(r(e),t=o(t,!0),r(n),i)try{return a(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},{120:120,29:29,44:44,7:7}],73:[function(e,t,n){var a=e(72),s=e(7),u=e(81);t.exports=e(29)?Object.defineProperties:function(e,t){s(e);for(var n,r=u(t),i=r.length,o=0;o<i;)a.f(e,n=r[o++],t[n]);return e}},{29:29,7:7,72:72,81:81}],74:[function(t,e,n){"use strict";e.exports=t(60)||!t(35)(function(){var e=Math.random();__defineSetter__.call(null,e,function(){}),delete t(40)[e]})},{35:35,40:40,60:60}],75:[function(e,t,n){var r=e(82),i=e(92),o=e(117),a=e(120),s=e(41),u=e(44),c=Object.getOwnPropertyDescriptor;n.f=e(29)?c:function(e,t){if(e=o(e),t=a(t,!0),u)try{return c(e,t)}catch(e){}if(s(e,t))return i(!r.f.call(e,t),e[t])}},{117:117,120:120,29:29,41:41,44:44,82:82,92:92}],76:[function(e,t,n){var r=e(117),i=e(77).f,o={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(e){return a&&"[object Window]"==o.call(e)?function(e){try{return i(e)}catch(e){return a.slice()}}(e):i(r(e))}},{117:117,77:77}],77:[function(e,t,n){var r=e(80),i=e(31).concat("length","prototype");n.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},{31:31,80:80}],78:[function(e,t,n){n.f=Object.getOwnPropertySymbols},{}],79:[function(e,t,n){var r=e(41),i=e(119),o=e(102)("IE_PROTO"),a=Object.prototype;t.exports=Object.getPrototypeOf||function(e){return e=i(e),r(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},{102:102,119:119,41:41}],80:[function(e,t,n){var a=e(41),s=e(117),u=e(11)(!1),c=e(102)("IE_PROTO");t.exports=function(e,t){var n,r=s(e),i=0,o=[];for(n in r)n!=c&&a(r,n)&&o.push(n);for(;t.length>i;)a(r,n=t[i++])&&(~u(o,n)||o.push(n));return o}},{102:102,11:11,117:117,41:41}],81:[function(e,t,n){var r=e(80),i=e(31);t.exports=Object.keys||function(e){return r(e,i)}},{31:31,80:80}],82:[function(e,t,n){n.f={}.propertyIsEnumerable},{}],83:[function(e,t,n){var i=e(33),o=e(23),a=e(35);t.exports=function(e,t){var n=(o.Object||{})[e]||Object[e],r={};r[e]=t(n),i(i.S+i.F*a(function(){n(1)}),"Object",r)}},{23:23,33:33,35:35}],84:[function(e,t,n){var u=e(81),c=e(117),l=e(82).f;t.exports=function(s){return function(e){for(var t,n=c(e),r=u(n),i=r.length,o=0,a=[];o<i;)l.call(n,t=r[o++])&&a.push(s?[t,n[t]]:n[t]);return a}}},{117:117,81:81,82:82}],85:[function(e,t,n){var r=e(77),i=e(78),o=e(7),a=e(40).Reflect;t.exports=a&&a.ownKeys||function(e){var t=r.f(o(e)),n=i.f;return n?t.concat(n(e)):t}},{40:40,7:7,77:77,78:78}],86:[function(e,t,n){var r=e(40).parseFloat,i=e(111).trim;t.exports=1/r(e(112)+"-0")!=-1/0?function(e){var t=i(String(e),3),n=r(t);return 0===n&&"-"==t.charAt(0)?-0:n}:r},{111:111,112:112,40:40}],87:[function(e,t,n){var r=e(40).parseInt,i=e(111).trim,o=e(112),a=/^[-+]?0[xX]/;t.exports=8!==r(o+"08")||22!==r(o+"0x16")?function(e,t){var n=i(String(e),3);return r(n,t>>>0||(a.test(n)?16:10))}:r},{111:111,112:112,40:40}],88:[function(e,t,n){"use strict";var r=e(89),c=e(46),l=e(3);t.exports=function(){for(var i=l(this),o=arguments.length,a=Array(o),e=0,s=r._,u=!1;e<o;)(a[e]=arguments[e++])===s&&(u=!0);return function(){var e,t=arguments.length,n=0,r=0;if(!u&&!t)return c(i,a,this);if(e=a.slice(),u)for(;n<o;n++)e[n]===s&&(e[n]=arguments[r++]);for(;r<t;)e.push(arguments[r++]);return c(i,e,this)}}},{3:3,46:46,89:89}],89:[function(e,t,n){t.exports=e(40)},{40:40}],90:[function(e,t,n){t.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},{}],91:[function(e,t,n){var r=e(69);t.exports=function(e,t){var n=r.f(e);return(0,n.resolve)(t),n.promise}},{69:69}],92:[function(e,t,n){t.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},{}],93:[function(e,t,n){var i=e(94);t.exports=function(e,t,n){for(var r in t)i(e,r,t[r],n);return e}},{94:94}],94:[function(e,t,n){var o=e(40),a=e(42),s=e(41),u=e(124)("src"),r=Function.toString,c=(""+r).split("toString");e(23).inspectSource=function(e){return r.call(e)},(t.exports=function(e,t,n,r){var i="function"==typeof n;i&&(s(n,"name")||a(n,"name",t)),e[t]!==n&&(i&&(s(n,u)||a(n,u,e[t]?""+e[t]:c.join(String(t)))),e===o?e[t]=n:r?e[t]?e[t]=n:a(e,t,n):(delete e[t],a(e,t,n)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[u]||r.call(this)})},{124:124,23:23,40:40,41:41,42:42}],95:[function(e,t,n){t.exports=function(t,n){var r=n===Object(n)?function(e){return n[e]}:n;return function(e){return String(e).replace(t,r)}}},{}],96:[function(e,t,n){t.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},{}],97:[function(e,t,n){"use strict";var r=e(33),a=e(3),s=e(25),u=e(39);t.exports=function(e){r(r.S,e,{from:function(e){var t,n,r,i,o=arguments[1];return a(this),(t=void 0!==o)&&a(o),null==e?new this:(n=[],t?(r=0,i=s(o,arguments[2],2),u(e,!1,function(e){n.push(i(e,r++))})):u(e,!1,n.push,n),new this(n))}})}},{25:25,3:3,33:33,39:39}],98:[function(e,t,n){"use strict";var r=e(33);t.exports=function(e){r(r.S,e,{of:function(){for(var e=arguments.length,t=Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},{33:33}],99:[function(t,e,n){var r=t(51),i=t(7),o=function(e,t){if(i(e),!r(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,n,r){try{(r=t(25)(Function.call,t(75).f(Object.prototype,"__proto__").set,2))(e,[]),n=!(e instanceof Array)}catch(e){n=!0}return function(e,t){return o(e,t),n?e.__proto__=t:r(e,t),e}}({},!1):void 0),check:o}},{25:25,51:51,7:7,75:75}],100:[function(e,t,n){"use strict";var r=e(40),i=e(72),o=e(29),a=e(128)("species");t.exports=function(e){var t=r[e];o&&t&&!t[a]&&i.f(t,a,{configurable:!0,get:function(){return this}})}},{128:128,29:29,40:40,72:72}],101:[function(e,t,n){var r=e(72).f,i=e(41),o=e(128)("toStringTag");t.exports=function(e,t,n){e&&!i(e=n?e:e.prototype,o)&&r(e,o,{configurable:!0,value:t})}},{128:128,41:41,72:72}],102:[function(e,t,n){var r=e(103)("keys"),i=e(124);t.exports=function(e){return r[e]||(r[e]=i(e))}},{103:103,124:124}],103:[function(e,t,n){var r=e(40),i=r["__core-js_shared__"]||(r["__core-js_shared__"]={});t.exports=function(e){return i[e]||(i[e]={})}},{40:40}],104:[function(e,t,n){var i=e(7),o=e(3),a=e(128)("species");t.exports=function(e,t){var n,r=i(e).constructor;return void 0===r||null==(n=i(r)[a])?t:o(n)}},{128:128,3:3,7:7}],105:[function(e,t,n){"use strict";var r=e(35);t.exports=function(e,t){return!!e&&r(function(){t?e.call(null,function(){},1):e.call(null)})}},{35:35}],106:[function(e,t,n){var u=e(116),c=e(28);t.exports=function(s){return function(e,t){var n,r,i=String(c(e)),o=u(t),a=i.length;return o<0||a<=o?s?"":void 0:(n=i.charCodeAt(o))<55296||56319<n||o+1===a||(r=i.charCodeAt(o+1))<56320||57343<r?s?i.charAt(o):n:s?i.slice(o,o+2):r-56320+(n-55296<<10)+65536}}},{116:116,28:28}],107:[function(e,t,n){var r=e(52),i=e(28);t.exports=function(e,t,n){if(r(t))throw TypeError("String#"+n+" doesn't accept regex!");return String(i(e))}},{28:28,52:52}],108:[function(e,t,n){var r=e(33),i=e(35),a=e(28),s=/"/g,o=function(e,t,n,r){var i=String(a(e)),o="<"+t;return""!==n&&(o+=" "+n+'="'+String(r).replace(s,"&quot;")+'"'),o+">"+i+"</"+t+">"};t.exports=function(t,e){var n={};n[t]=e(o),r(r.P+r.F*i(function(){var e=""[t]('"');return e!==e.toLowerCase()||3<e.split('"').length}),"String",n)}},{28:28,33:33,35:35}],109:[function(e,t,n){var l=e(118),h=e(110),f=e(28);t.exports=function(e,t,n,r){var i=String(f(e)),o=i.length,a=void 0===n?" ":String(n),s=l(t);if(s<=o||""==a)return i;var u=s-o,c=h.call(a,Math.ceil(u/a.length));return c.length>u&&(c=c.slice(0,u)),r?c+i:i+c}},{110:110,118:118,28:28}],110:[function(e,t,n){"use strict";var i=e(116),o=e(28);t.exports=function(e){var t=String(o(this)),n="",r=i(e);if(r<0||r==1/0)throw RangeError("Count can't be negative");for(;0<r;(r>>>=1)&&(t+=t))1&r&&(n+=t);return n}},{116:116,28:28}],111:[function(e,t,n){var a=e(33),r=e(28),s=e(35),u=e(112),i="["+u+"]",o=RegExp("^"+i+i+"*"),c=RegExp(i+i+"*$"),l=function(e,t,n){var r={},i=s(function(){return!!u[e]()||"​"!="​"[e]()}),o=r[e]=i?t(h):u[e];n&&(r[n]=o),a(a.P+a.F*i,"String",r)},h=l.trim=function(e,t){return e=String(r(e)),1&t&&(e=e.replace(o,"")),2&t&&(e=e.replace(c,"")),e};t.exports=l},{112:112,28:28,33:33,35:35}],112:[function(e,t,n){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},{}],113:[function(e,t,n){var r,i,o,a=e(25),s=e(46),u=e(43),c=e(30),l=e(40),h=l.process,f=l.setImmediate,d=l.clearImmediate,p=l.MessageChannel,v=l.Dispatch,m=0,g={},y=function(){var e=+this;if(g.hasOwnProperty(e)){var t=g[e];delete g[e],t()}},b=function(e){y.call(e.data)};f&&d||(f=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return g[++m]=function(){s("function"==typeof e?e:Function(e),t)},r(m),m},d=function(e){delete g[e]},"process"==e(18)(h)?r=function(e){h.nextTick(a(y,e,1))}:v&&v.now?r=function(e){v.now(a(y,e,1))}:p?(o=(i=new p).port2,i.port1.onmessage=b,r=a(o.postMessage,o,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(r=function(e){l.postMessage(e+"","*")},l.addEventListener("message",b,!1)):r="onreadystatechange"in c("script")?function(e){u.appendChild(c("script")).onreadystatechange=function(){u.removeChild(this),y.call(e)}}:function(e){setTimeout(a(y,e,1),0)}),t.exports={set:f,clear:d}},{18:18,25:25,30:30,40:40,43:43,46:46}],114:[function(e,t,n){var r=e(116),i=Math.max,o=Math.min;t.exports=function(e,t){return(e=r(e))<0?i(e+t,0):o(e,t)}},{116:116}],115:[function(e,t,n){var r=e(116),i=e(118);t.exports=function(e){if(void 0===e)return 0;var t=r(e),n=i(t);if(t!==n)throw RangeError("Wrong length!");return n}},{116:116,118:118}],116:[function(e,t,n){var r=Math.ceil,i=Math.floor;t.exports=function(e){return isNaN(e=+e)?0:(0<e?i:r)(e)}},{}],117:[function(e,t,n){var r=e(47),i=e(28);t.exports=function(e){return r(i(e))}},{28:28,47:47}],118:[function(e,t,n){var r=e(116),i=Math.min;t.exports=function(e){return 0<e?i(r(e),9007199254740991):0}},{116:116}],119:[function(e,t,n){var r=e(28);t.exports=function(e){return Object(r(e))}},{28:28}],120:[function(e,t,n){var i=e(51);t.exports=function(e,t){if(!i(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!i(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!i(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!i(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")}},{51:51}],121:[function(e,t,n){"use strict";if(e(29)){var g=e(60),y=e(40),b=e(35),_=e(33),w=e(123),r=e(122),f=e(25),E=e(6),i=e(92),S=e(42),o=e(93),a=e(116),C=e(118),T=e(115),s=e(114),u=e(120),c=e(41),O=e(17),R=e(51),d=e(119),p=e(48),A=e(71),I=e(79),N=e(77).f,v=e(129),l=e(124),h=e(128),m=e(12),k=e(11),P=e(104),x=e(141),D=e(58),M=e(56),L=e(100),F=e(9),V=e(8),j=e(72),U=e(75),B=j.f,q=U.f,W=y.RangeError,H=y.TypeError,G=y.Uint8Array,K=Array.prototype,$=r.ArrayBuffer,z=r.DataView,Q=m(0),Y=m(2),X=m(3),J=m(4),Z=m(5),ee=m(6),te=k(!0),ne=k(!1),re=x.values,ie=x.keys,oe=x.entries,ae=K.lastIndexOf,se=K.reduce,ue=K.reduceRight,ce=K.join,le=K.sort,he=K.slice,fe=K.toString,de=K.toLocaleString,pe=h("iterator"),ve=h("toStringTag"),me=l("typed_constructor"),ge=l("def_constructor"),ye=w.CONSTR,be=w.TYPED,_e=w.VIEW,we=m(1,function(e,t){return Oe(P(e,e[ge]),t)}),Ee=b(function(){return 1===new G(new Uint16Array([1]).buffer)[0]}),Se=!!G&&!!G.prototype.set&&b(function(){new G(1).set({})}),Ce=function(e,t){var n=a(e);if(n<0||n%t)throw W("Wrong offset!");return n},Te=function(e){if(R(e)&&be in e)return e;throw H(e+" is not a typed array!")},Oe=function(e,t){if(!(R(e)&&me in e))throw H("It is not a typed array constructor!");return new e(t)},Re=function(e,t){return Ae(P(e,e[ge]),t)},Ae=function(e,t){for(var n=0,r=t.length,i=Oe(e,r);n<r;)i[n]=t[n++];return i},Ie=function(e,t,n){B(e,t,{get:function(){return this._d[n]}})},Ne=function(e){var t,n,r,i,o,a,s=d(e),u=arguments.length,c=1<u?arguments[1]:void 0,l=void 0!==c,h=v(s);if(null!=h&&!p(h)){for(a=h.call(s),r=[],t=0;!(o=a.next()).done;t++)r.push(o.value);s=r}for(l&&2<u&&(c=f(c,arguments[2],2)),t=0,n=C(s.length),i=Oe(this,n);t<n;t++)i[t]=l?c(s[t],t):s[t];return i},ke=function(){for(var e=0,t=arguments.length,n=Oe(this,t);e<t;)n[e]=arguments[e++];return n},Pe=!!G&&b(function(){de.call(new G(1))}),xe=function(){return de.apply(Pe?he.call(Te(this)):Te(this),arguments)},De={copyWithin:function(e,t){return V.call(Te(this),e,t,2<arguments.length?arguments[2]:void 0)},every:function(e){return J(Te(this),e,1<arguments.length?arguments[1]:void 0)},fill:function(e){return F.apply(Te(this),arguments)},filter:function(e){return Re(this,Y(Te(this),e,1<arguments.length?arguments[1]:void 0))},find:function(e){return Z(Te(this),e,1<arguments.length?arguments[1]:void 0)},findIndex:function(e){return ee(Te(this),e,1<arguments.length?arguments[1]:void 0)},forEach:function(e){Q(Te(this),e,1<arguments.length?arguments[1]:void 0)},indexOf:function(e){return ne(Te(this),e,1<arguments.length?arguments[1]:void 0)},includes:function(e){return te(Te(this),e,1<arguments.length?arguments[1]:void 0)},join:function(e){return ce.apply(Te(this),arguments)},lastIndexOf:function(e){return ae.apply(Te(this),arguments)},map:function(e){return we(Te(this),e,1<arguments.length?arguments[1]:void 0)},reduce:function(e){return se.apply(Te(this),arguments)},reduceRight:function(e){return ue.apply(Te(this),arguments)},reverse:function(){for(var e,t=this,n=Te(t).length,r=Math.floor(n/2),i=0;i<r;)e=t[i],t[i++]=t[--n],t[n]=e;return t},some:function(e){return X(Te(this),e,1<arguments.length?arguments[1]:void 0)},sort:function(e){return le.call(Te(this),e)},subarray:function(e,t){var n=Te(this),r=n.length,i=s(e,r);return new(P(n,n[ge]))(n.buffer,n.byteOffset+i*n.BYTES_PER_ELEMENT,C((void 0===t?r:s(t,r))-i))}},Me=function(e,t){return Re(this,he.call(Te(this),e,t))},Le=function(e){Te(this);var t=Ce(arguments[1],1),n=this.length,r=d(e),i=C(r.length),o=0;if(n<i+t)throw W("Wrong length!");for(;o<i;)this[t+o]=r[o++]},Fe={entries:function(){return oe.call(Te(this))},keys:function(){return ie.call(Te(this))},values:function(){return re.call(Te(this))}},Ve=function(e,t){return R(e)&&e[be]&&"symbol"!=typeof t&&t in e&&String(+t)==String(t)},je=function(e,t){return Ve(e,t=u(t,!0))?i(2,e[t]):q(e,t)},Ue=function(e,t,n){return!(Ve(e,t=u(t,!0))&&R(n)&&c(n,"value"))||c(n,"get")||c(n,"set")||n.configurable||c(n,"writable")&&!n.writable||c(n,"enumerable")&&!n.enumerable?B(e,t,n):(e[t]=n.value,e)};ye||(U.f=je,j.f=Ue),_(_.S+_.F*!ye,"Object",{getOwnPropertyDescriptor:je,defineProperty:Ue}),b(function(){fe.call({})})&&(fe=de=function(){return ce.call(this)});var Be=o({},De);o(Be,Fe),S(Be,pe,Fe.values),o(Be,{slice:Me,set:Le,constructor:function(){},toString:fe,toLocaleString:xe}),Ie(Be,"buffer","b"),Ie(Be,"byteOffset","o"),Ie(Be,"byteLength","l"),Ie(Be,"length","e"),B(Be,ve,{get:function(){return this[be]}}),t.exports=function(e,h,t,o){var f=e+((o=!!o)?"Clamped":"")+"Array",n="get"+e,a="set"+e,d=y[f],s=d||{},r=d&&I(d),i=!d||!w.ABV,u={},c=d&&d.prototype,p=function(e,i){B(e,i,{get:function(){return e=i,(t=this._d).v[n](e*h+t.o,Ee);var e,t},set:function(e){return t=i,n=e,r=this._d,o&&(n=(n=Math.round(n))<0?0:255<n?255:255&n),void r.v[a](t*h+r.o,n,Ee);var t,n,r},enumerable:!0})};i?(d=t(function(e,t,n,r){E(e,d,f,"_d");var i,o,a,s,u=0,c=0;if(R(t)){if(!(t instanceof $||"ArrayBuffer"==(s=O(t))||"SharedArrayBuffer"==s))return be in t?Ae(d,t):Ne.call(d,t);i=t,c=Ce(n,h);var l=t.byteLength;if(void 0===r){if(l%h)throw W("Wrong length!");if((o=l-c)<0)throw W("Wrong length!")}else if((o=C(r)*h)+c>l)throw W("Wrong length!");a=o/h}else a=T(t),i=new $(o=a*h);for(S(e,"_d",{b:i,o:c,l:o,e:a,v:new z(i)});u<a;)p(e,u++)}),c=d.prototype=A(Be),S(c,"constructor",d)):b(function(){d(1)})&&b(function(){new d(-1)})&&M(function(e){new d,new d(null),new d(1.5),new d(e)},!0)||(d=t(function(e,t,n,r){var i;return E(e,d,f),R(t)?t instanceof $||"ArrayBuffer"==(i=O(t))||"SharedArrayBuffer"==i?void 0!==r?new s(t,Ce(n,h),r):void 0!==n?new s(t,Ce(n,h)):new s(t):be in t?Ae(d,t):Ne.call(d,t):new s(T(t))}),Q(r!==Function.prototype?N(s).concat(N(r)):N(s),function(e){e in d||S(d,e,s[e])}),d.prototype=c,g||(c.constructor=d));var l=c[pe],v=!!l&&("values"==l.name||null==l.name),m=Fe.values;S(d,me,!0),S(c,be,f),S(c,_e,!0),S(c,ge,d),(o?new d(1)[ve]==f:ve in c)||B(c,ve,{get:function(){return f}}),u[f]=d,_(_.G+_.W+_.F*(d!=s),u),_(_.S,f,{BYTES_PER_ELEMENT:h}),_(_.S+_.F*b(function(){s.of.call(d,1)}),f,{from:Ne,of:ke}),"BYTES_PER_ELEMENT"in c||S(c,"BYTES_PER_ELEMENT",h),_(_.P,f,De),L(f),_(_.P+_.F*Se,f,{set:Le}),_(_.P+_.F*!v,f,Fe),g||c.toString==fe||(c.toString=fe),_(_.P+_.F*b(function(){new d(1).slice()}),f,{slice:Me}),_(_.P+_.F*(b(function(){return[1,2].toLocaleString()!=new d([1,2]).toLocaleString()})||!b(function(){c.toLocaleString.call([1,2])})),f,{toLocaleString:xe}),D[f]=v?l:m,g||v||S(c,pe,m)}}else t.exports=function(){}},{100:100,104:104,11:11,114:114,115:115,116:116,118:118,119:119,12:12,120:120,122:122,123:123,124:124,128:128,129:129,141:141,17:17,25:25,29:29,33:33,35:35,40:40,41:41,42:42,48:48,51:51,56:56,58:58,6:6,60:60,71:71,72:72,75:75,77:77,79:79,8:8,9:9,92:92,93:93}],122:[function(e,t,n){"use strict";function r(e,t,n){var r,i,o,a=Array(n),s=8*n-t-1,u=(1<<s)-1,c=u>>1,l=23===t?V(2,-24)-V(2,-77):0,h=0,f=e<0||0===e&&1/e<0?1:0;for((e=F(e))!=e||e===M?(i=e!=e?1:0,r=u):(r=j(U(e)/B),e*(o=V(2,-r))<1&&(r--,o*=2),2<=(e+=1<=r+c?l/o:l*V(2,1-c))*o&&(r++,o/=2),u<=r+c?(i=0,r=u):1<=r+c?(i=(e*o-1)*V(2,t),r+=c):(i=e*V(2,c-1)*V(2,t),r=0));8<=t;a[h++]=255&i,i/=256,t-=8);for(r=r<<t|i,s+=t;0<s;a[h++]=255&r,r/=256,s-=8);return a[--h]|=128*f,a}function i(e,t,n){var r,i=8*n-t-1,o=(1<<i)-1,a=o>>1,s=i-7,u=n-1,c=e[u--],l=127&c;for(c>>=7;0<s;l=256*l+e[u],u--,s-=8);for(r=l&(1<<-s)-1,l>>=-s,s+=t;0<s;r=256*r+e[u],u--,s-=8);if(0===l)l=1-a;else{if(l===o)return r?NaN:c?-M:M;r+=V(2,t),l-=a}return(c?-1:1)*r*V(2,l-t)}function o(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]}function a(e){return[255&e]}function s(e){return[255&e,e>>8&255]}function u(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]}function c(e){return r(e,52,8)}function l(e){return r(e,23,4)}function h(e,t,n){O(e[I],t,{get:function(){return this[n]}})}function f(e,t,n,r){var i=C(+n);if(i+t>e[W])throw D(N);var o=e[q]._b,a=i+e[H],s=o.slice(a,a+t);return r?s:s.reverse()}function d(e,t,n,r,i,o){var a=C(+n);if(a+t>e[W])throw D(N);for(var s=e[q]._b,u=a+e[H],c=r(+i),l=0;l<t;l++)s[u+l]=c[o?l:t-l-1]}var p=e(40),v=e(29),m=e(60),g=e(123),y=e(42),b=e(93),_=e(35),w=e(6),E=e(116),S=e(118),C=e(115),T=e(77).f,O=e(72).f,R=e(9),A=e(101),I="prototype",N="Wrong index!",k=p.ArrayBuffer,P=p.DataView,x=p.Math,D=p.RangeError,M=p.Infinity,L=k,F=x.abs,V=x.pow,j=x.floor,U=x.log,B=x.LN2,q=v?"_b":"buffer",W=v?"_l":"byteLength",H=v?"_o":"byteOffset";if(g.ABV){if(!_(function(){k(1)})||!_(function(){new k(-1)})||_(function(){return new k,new k(1.5),new k(NaN),"ArrayBuffer"!=k.name})){for(var G,K=(k=function(e){return w(this,k),new L(C(e))})[I]=L[I],$=T(L),z=0;$.length>z;)(G=$[z++])in k||y(k,G,L[G]);m||(K.constructor=k)}var Q=new P(new k(2)),Y=P[I].setInt8;Q.setInt8(0,2147483648),Q.setInt8(1,2147483649),!Q.getInt8(0)&&Q.getInt8(1)||b(P[I],{setInt8:function(e,t){Y.call(this,e,t<<24>>24)},setUint8:function(e,t){Y.call(this,e,t<<24>>24)}},!0)}else k=function(e){w(this,k,"ArrayBuffer");var t=C(e);this._b=R.call(Array(t),0),this[W]=t},P=function(e,t,n){w(this,P,"DataView"),w(e,k,"DataView");var r=e[W],i=E(t);if(i<0||r<i)throw D("Wrong offset!");if(r<i+(n=void 0===n?r-i:S(n)))throw D("Wrong length!");this[q]=e,this[H]=i,this[W]=n},v&&(h(k,"byteLength","_l"),h(P,"buffer","_b"),h(P,"byteLength","_l"),h(P,"byteOffset","_o")),b(P[I],{getInt8:function(e){return f(this,1,e)[0]<<24>>24},getUint8:function(e){return f(this,1,e)[0]},getInt16:function(e){var t=f(this,2,e,arguments[1]);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=f(this,2,e,arguments[1]);return t[1]<<8|t[0]},getInt32:function(e){return o(f(this,4,e,arguments[1]))},getUint32:function(e){return o(f(this,4,e,arguments[1]))>>>0},getFloat32:function(e){return i(f(this,4,e,arguments[1]),23,4)},getFloat64:function(e){return i(f(this,8,e,arguments[1]),52,8)},setInt8:function(e,t){d(this,1,e,a,t)},setUint8:function(e,t){d(this,1,e,a,t)},setInt16:function(e,t){d(this,2,e,s,t,arguments[2])},setUint16:function(e,t){d(this,2,e,s,t,arguments[2])},setInt32:function(e,t){d(this,4,e,u,t,arguments[2])},setUint32:function(e,t){d(this,4,e,u,t,arguments[2])},setFloat32:function(e,t){d(this,4,e,l,t,arguments[2])},setFloat64:function(e,t){d(this,8,e,c,t,arguments[2])}});A(k,"ArrayBuffer"),A(P,"DataView"),y(P[I],g.VIEW,!0),n.ArrayBuffer=k,n.DataView=P},{101:101,115:115,116:116,118:118,123:123,29:29,35:35,40:40,42:42,6:6,60:60,72:72,77:77,9:9,93:93}],123:[function(e,t,n){for(var r,i=e(40),o=e(42),a=e(124),s=a("typed_array"),u=a("view"),c=!(!i.ArrayBuffer||!i.DataView),l=c,h=0,f="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");h<9;)(r=i[f[h++]])?(o(r.prototype,s,!0),o(r.prototype,u,!0)):l=!1;t.exports={ABV:c,CONSTR:l,TYPED:s,VIEW:u}},{124:124,40:40,42:42}],124:[function(e,t,n){var r=0,i=Math.random();t.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++r+i).toString(36))}},{}],125:[function(e,t,n){var r=e(51);t.exports=function(e,t){if(!r(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},{51:51}],126:[function(e,t,n){var r=e(40),i=e(23),o=e(60),a=e(127),s=e(72).f;t.exports=function(e){var t=i.Symbol||(i.Symbol=o?{}:r.Symbol||{});"_"==e.charAt(0)||e in t||s(t,e,{value:a.f(e)})}},{127:127,23:23,40:40,60:60,72:72}],127:[function(e,t,n){n.f=e(128)},{128:128}],128:[function(e,t,n){var r=e(103)("wks"),i=e(124),o=e(40).Symbol,a="function"==typeof o;(t.exports=function(e){return r[e]||(r[e]=a&&o[e]||(a?o:i)("Symbol."+e))}).store=r},{103:103,124:124,40:40}],129:[function(e,t,n){var r=e(17),i=e(128)("iterator"),o=e(58);t.exports=e(23).getIteratorMethod=function(e){if(null!=e)return e[i]||e["@@iterator"]||o[r(e)]}},{128:128,17:17,23:23,58:58}],130:[function(e,t,n){var r=e(33),i=e(95)(/[\\^$*+?.()|[\]{}]/g,"\\$&");r(r.S,"RegExp",{escape:function(e){return i(e)}})},{33:33,95:95}],131:[function(e,t,n){var r=e(33);r(r.P,"Array",{copyWithin:e(8)}),e(5)("copyWithin")},{33:33,5:5,8:8}],132:[function(e,t,n){"use strict";var r=e(33),i=e(12)(4);r(r.P+r.F*!e(105)([].every,!0),"Array",{every:function(e){return i(this,e,arguments[1])}})},{105:105,12:12,33:33}],133:[function(e,t,n){var r=e(33);r(r.P,"Array",{fill:e(9)}),e(5)("fill")},{33:33,5:5,9:9}],134:[function(e,t,n){"use strict";var r=e(33),i=e(12)(2);r(r.P+r.F*!e(105)([].filter,!0),"Array",{filter:function(e){return i(this,e,arguments[1])}})},{105:105,12:12,33:33}],135:[function(e,t,n){"use strict";var r=e(33),i=e(12)(6),o="findIndex",a=!0;o in[]&&Array(1)[o](function(){a=!1}),r(r.P+r.F*a,"Array",{findIndex:function(e){return i(this,e,1<arguments.length?arguments[1]:void 0)}}),e(5)(o)},{12:12,33:33,5:5}],136:[function(e,t,n){"use strict";var r=e(33),i=e(12)(5),o=!0;"find"in[]&&Array(1).find(function(){o=!1}),r(r.P+r.F*o,"Array",{find:function(e){return i(this,e,1<arguments.length?arguments[1]:void 0)}}),e(5)("find")},{12:12,33:33,5:5}],137:[function(e,t,n){"use strict";var r=e(33),i=e(12)(0),o=e(105)([].forEach,!0);r(r.P+r.F*!o,"Array",{forEach:function(e){return i(this,e,arguments[1])}})},{105:105,12:12,33:33}],138:[function(e,t,n){"use strict";var f=e(25),r=e(33),d=e(119),p=e(53),v=e(48),m=e(118),g=e(24),y=e(129);r(r.S+r.F*!e(56)(function(e){Array.from(e)}),"Array",{from:function(e){var t,n,r,i,o=d(e),a="function"==typeof this?this:Array,s=arguments.length,u=1<s?arguments[1]:void 0,c=void 0!==u,l=0,h=y(o);if(c&&(u=f(u,2<s?arguments[2]:void 0,2)),null==h||a==Array&&v(h))for(n=new a(t=m(o.length));l<t;l++)g(n,l,c?u(o[l],l):o[l]);else for(i=h.call(o),n=new a;!(r=i.next()).done;l++)g(n,l,c?p(i,u,[r.value,l],!0):r.value);return n.length=l,n}})},{118:118,119:119,129:129,24:24,25:25,33:33,48:48,53:53,56:56}],139:[function(e,t,n){"use strict";var r=e(33),i=e(11)(!1),o=[].indexOf,a=!!o&&1/[1].indexOf(1,-0)<0;r(r.P+r.F*(a||!e(105)(o)),"Array",{indexOf:function(e){return a?o.apply(this,arguments)||0:i(this,e,arguments[1])}})},{105:105,11:11,33:33}],140:[function(e,t,n){var r=e(33);r(r.S,"Array",{isArray:e(49)})},{33:33,49:49}],141:[function(e,t,n){"use strict";var r=e(5),i=e(57),o=e(58),a=e(117);t.exports=e(55)(Array,"Array",function(e,t){this._t=a(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,i(1)):i(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])},"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},{117:117,5:5,55:55,57:57,58:58}],142:[function(e,t,n){"use strict";var r=e(33),i=e(117),o=[].join;r(r.P+r.F*(e(47)!=Object||!e(105)(o)),"Array",{join:function(e){return o.call(i(this),void 0===e?",":e)}})},{105:105,117:117,33:33,47:47}],143:[function(e,t,n){"use strict";var r=e(33),i=e(117),o=e(116),a=e(118),s=[].lastIndexOf,u=!!s&&1/[1].lastIndexOf(1,-0)<0;r(r.P+r.F*(u||!e(105)(s)),"Array",{lastIndexOf:function(e){if(u)return s.apply(this,arguments)||0;var t=i(this),n=a(t.length),r=n-1;for(1<arguments.length&&(r=Math.min(r,o(arguments[1]))),r<0&&(r=n+r);0<=r;r--)if(r in t&&t[r]===e)return r||0;return-1}})},{105:105,116:116,117:117,118:118,33:33}],144:[function(e,t,n){"use strict";var r=e(33),i=e(12)(1);r(r.P+r.F*!e(105)([].map,!0),"Array",{map:function(e){return i(this,e,arguments[1])}})},{105:105,12:12,33:33}],145:[function(e,t,n){"use strict";var r=e(33),i=e(24);r(r.S+r.F*e(35)(function(){function e(){}return!(Array.of.call(e)instanceof e)}),"Array",{of:function(){for(var e=0,t=arguments.length,n=new("function"==typeof this?this:Array)(t);e<t;)i(n,e,arguments[e++]);return n.length=t,n}})},{24:24,33:33,35:35}],146:[function(e,t,n){"use strict";var r=e(33),i=e(13);r(r.P+r.F*!e(105)([].reduceRight,!0),"Array",{reduceRight:function(e){return i(this,e,arguments.length,arguments[1],!0)}})},{105:105,13:13,33:33}],147:[function(e,t,n){"use strict";var r=e(33),i=e(13);r(r.P+r.F*!e(105)([].reduce,!0),"Array",{reduce:function(e){return i(this,e,arguments.length,arguments[1],!1)}})},{105:105,13:13,33:33}],148:[function(e,t,n){"use strict";var r=e(33),i=e(43),c=e(18),l=e(114),h=e(118),f=[].slice;r(r.P+r.F*e(35)(function(){i&&f.call(i)}),"Array",{slice:function(e,t){var n=h(this.length),r=c(this);if(t=void 0===t?n:t,"Array"==r)return f.call(this,e,t);for(var i=l(e,n),o=l(t,n),a=h(o-i),s=Array(a),u=0;u<a;u++)s[u]="String"==r?this.charAt(i+u):this[i+u];return s}})},{114:114,118:118,18:18,33:33,35:35,43:43}],149:[function(e,t,n){"use strict";var r=e(33),i=e(12)(3);r(r.P+r.F*!e(105)([].some,!0),"Array",{some:function(e){return i(this,e,arguments[1])}})},{105:105,12:12,33:33}],150:[function(e,t,n){"use strict";var r=e(33),i=e(3),o=e(119),a=e(35),s=[].sort,u=[1,2,3];r(r.P+r.F*(a(function(){u.sort(void 0)})||!a(function(){u.sort(null)})||!e(105)(s)),"Array",{sort:function(e){return void 0===e?s.call(o(this)):s.call(o(this),i(e))}})},{105:105,119:119,3:3,33:33,35:35}],151:[function(e,t,n){e(100)("Array")},{100:100}],152:[function(e,t,n){var r=e(33);r(r.S,"Date",{now:function(){return(new Date).getTime()}})},{33:33}],153:[function(e,t,n){var r=e(33),i=e(26);r(r.P+r.F*(Date.prototype.toISOString!==i),"Date",{toISOString:i})},{26:26,33:33}],154:[function(e,t,n){"use strict";var r=e(33),i=e(119),o=e(120);r(r.P+r.F*e(35)(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(e){var t=i(this),n=o(t);return"number"!=typeof n||isFinite(n)?t.toISOString():null}})},{119:119,120:120,33:33,35:35}],155:[function(e,t,n){var r=e(128)("toPrimitive"),i=Date.prototype;r in i||e(42)(i,r,e(27))},{128:128,27:27,42:42}],156:[function(e,t,n){var r=Date.prototype,i=r.toString,o=r.getTime;new Date(NaN)+""!="Invalid Date"&&e(94)(r,"toString",function(){var e=o.call(this);return e==e?i.call(this):"Invalid Date"})},{94:94}],157:[function(e,t,n){var r=e(33);r(r.P,"Function",{bind:e(16)})},{16:16,33:33}],158:[function(e,t,n){"use strict";var r=e(51),i=e(79),o=e(128)("hasInstance"),a=Function.prototype;o in a||e(72).f(a,o,{value:function(e){if("function"!=typeof this||!r(e))return!1;if(!r(this.prototype))return e instanceof this;for(;e=i(e);)if(this.prototype===e)return!0;return!1}})},{128:128,51:51,72:72,79:79}],159:[function(e,t,n){var r=e(72).f,i=Function.prototype,o=/^\s*function ([^ (]*)/;"name"in i||e(29)&&r(i,"name",{configurable:!0,get:function(){try{return(""+this).match(o)[1]}catch(e){return""}}})},{29:29,72:72}],160:[function(e,t,n){"use strict";var r=e(19),i=e(125);t.exports=e(22)("Map",function(e){return function(){return e(this,0<arguments.length?arguments[0]:void 0)}},{get:function(e){var t=r.getEntry(i(this,"Map"),e);return t&&t.v},set:function(e,t){return r.def(i(this,"Map"),0===e?0:e,t)}},r,!0)},{125:125,19:19,22:22}],161:[function(e,t,n){var r=e(33),i=e(63),o=Math.sqrt,a=Math.acosh;r(r.S+r.F*!(a&&710==Math.floor(a(Number.MAX_VALUE))&&a(1/0)==1/0),"Math",{acosh:function(e){return(e=+e)<1?NaN:94906265.62425156<e?Math.log(e)+Math.LN2:i(e-1+o(e-1)*o(e+1))}})},{33:33,63:63}],162:[function(e,t,n){var r=e(33),i=Math.asinh;r(r.S+r.F*!(i&&0<1/i(0)),"Math",{asinh:function e(t){return isFinite(t=+t)&&0!=t?t<0?-e(-t):Math.log(t+Math.sqrt(t*t+1)):t}})},{33:33}],163:[function(e,t,n){var r=e(33),i=Math.atanh;r(r.S+r.F*!(i&&1/i(-0)<0),"Math",{atanh:function(e){return 0==(e=+e)?e:Math.log((1+e)/(1-e))/2}})},{33:33}],164:[function(e,t,n){var r=e(33),i=e(65);r(r.S,"Math",{cbrt:function(e){return i(e=+e)*Math.pow(Math.abs(e),1/3)}})},{33:33,65:65}],165:[function(e,t,n){var r=e(33);r(r.S,"Math",{clz32:function(e){return(e>>>=0)?31-Math.floor(Math.log(e+.5)*Math.LOG2E):32}})},{33:33}],166:[function(e,t,n){var r=e(33),i=Math.exp;r(r.S,"Math",{cosh:function(e){return(i(e=+e)+i(-e))/2}})},{33:33}],167:[function(e,t,n){var r=e(33),i=e(61);r(r.S+r.F*(i!=Math.expm1),"Math",{expm1:i})},{33:33,61:61}],168:[function(e,t,n){var r=e(33);r(r.S,"Math",{fround:e(62)})},{33:33,62:62}],169:[function(e,t,n){var r=e(33),u=Math.abs;r(r.S,"Math",{hypot:function(e,t){for(var n,r,i=0,o=0,a=arguments.length,s=0;o<a;)s<(n=u(arguments[o++]))?(i=i*(r=s/n)*r+1,s=n):0<n?i+=(r=n/s)*r:i+=n;return s===1/0?1/0:s*Math.sqrt(i)}})},{33:33}],170:[function(e,t,n){var r=e(33),i=Math.imul;r(r.S+r.F*e(35)(function(){return-5!=i(4294967295,5)||2!=i.length}),"Math",{imul:function(e,t){var n=+e,r=+t,i=65535&n,o=65535&r;return 0|i*o+((65535&n>>>16)*o+i*(65535&r>>>16)<<16>>>0)}})},{33:33,35:35}],171:[function(e,t,n){var r=e(33);r(r.S,"Math",{log10:function(e){return Math.log(e)*Math.LOG10E}})},{33:33}],172:[function(e,t,n){var r=e(33);r(r.S,"Math",{log1p:e(63)})},{33:33,63:63}],173:[function(e,t,n){var r=e(33);r(r.S,"Math",{log2:function(e){return Math.log(e)/Math.LN2}})},{33:33}],174:[function(e,t,n){var r=e(33);r(r.S,"Math",{sign:e(65)})},{33:33,65:65}],175:[function(e,t,n){var r=e(33),i=e(61),o=Math.exp;r(r.S+r.F*e(35)(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(e){return Math.abs(e=+e)<1?(i(e)-i(-e))/2:(o(e-1)-o(-e-1))*(Math.E/2)}})},{33:33,35:35,61:61}],176:[function(e,t,n){var r=e(33),i=e(61),o=Math.exp;r(r.S,"Math",{tanh:function(e){var t=i(e=+e),n=i(-e);return t==1/0?1:n==1/0?-1:(t-n)/(o(e)+o(-e))}})},{33:33,61:61}],177:[function(e,t,n){var r=e(33);r(r.S,"Math",{trunc:function(e){return(0<e?Math.floor:Math.ceil)(e)}})},{33:33}],178:[function(e,t,n){"use strict";var r=e(40),i=e(41),o=e(18),a=e(45),l=e(120),s=e(35),u=e(77).f,c=e(75).f,h=e(72).f,f=e(111).trim,d=r.Number,p=d,v=d.prototype,m="Number"==o(e(71)(v)),g="trim"in String.prototype,y=function(e){var t=l(e,!1);if("string"==typeof t&&2<t.length){var n,r,i,o=(t=g?t.trim():f(t,3)).charCodeAt(0);if(43===o||45===o){if(88===(n=t.charCodeAt(2))||120===n)return NaN}else if(48===o){switch(t.charCodeAt(1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+t}for(var a,s=t.slice(2),u=0,c=s.length;u<c;u++)if((a=s.charCodeAt(u))<48||i<a)return NaN;return parseInt(s,r)}}return+t};if(!d(" 0o1")||!d("0b1")||d("+0x1")){d=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof d&&(m?s(function(){v.valueOf.call(n)}):"Number"!=o(n))?a(new p(y(t)),n,d):y(t)};for(var b,_=e(29)?u(p):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),w=0;_.length>w;w++)i(p,b=_[w])&&!i(d,b)&&h(d,b,c(p,b));(d.prototype=v).constructor=d,e(94)(r,"Number",d)}},{111:111,120:120,18:18,29:29,35:35,40:40,41:41,45:45,71:71,72:72,75:75,77:77,94:94}],179:[function(e,t,n){var r=e(33);r(r.S,"Number",{EPSILON:Math.pow(2,-52)})},{33:33}],180:[function(e,t,n){var r=e(33),i=e(40).isFinite;r(r.S,"Number",{isFinite:function(e){return"number"==typeof e&&i(e)}})},{33:33,40:40}],181:[function(e,t,n){var r=e(33);r(r.S,"Number",{isInteger:e(50)})},{33:33,50:50}],182:[function(e,t,n){var r=e(33);r(r.S,"Number",{isNaN:function(e){return e!=e}})},{33:33}],183:[function(e,t,n){var r=e(33),i=e(50),o=Math.abs;r(r.S,"Number",{isSafeInteger:function(e){return i(e)&&o(e)<=9007199254740991}})},{33:33,50:50}],184:[function(e,t,n){var r=e(33);r(r.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},{33:33}],185:[function(e,t,n){var r=e(33);r(r.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},{33:33}],186:[function(e,t,n){var r=e(33),i=e(86);r(r.S+r.F*(Number.parseFloat!=i),"Number",{parseFloat:i})},{33:33,86:86}],187:[function(e,t,n){var r=e(33),i=e(87);r(r.S+r.F*(Number.parseInt!=i),"Number",{parseInt:i})},{33:33,87:87}],188:[function(e,t,n){"use strict";var r=e(33),c=e(116),l=e(4),h=e(110),i=1..toFixed,o=Math.floor,a=[0,0,0,0,0,0],f="Number.toFixed: incorrect invocation!",d=function(e,t){for(var n=-1,r=t;++n<6;)r+=e*a[n],a[n]=r%1e7,r=o(r/1e7)},p=function(e){for(var t=6,n=0;0<=--t;)n+=a[t],a[t]=o(n/e),n=n%e*1e7},v=function(){for(var e=6,t="";0<=--e;)if(""!==t||0===e||0!==a[e]){var n=String(a[e]);t=""===t?n:t+h.call("0",7-n.length)+n}return t},m=function(e,t,n){return 0===t?n:t%2==1?m(e,t-1,n*e):m(e*e,t/2,n)};r(r.P+r.F*(!!i&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!e(35)(function(){i.call({})})),"Number",{toFixed:function(e){var t,n,r,i,o=l(this,f),a=c(e),s="",u="0";if(a<0||20<a)throw RangeError(f);if(o!=o)return"NaN";if(o<=-1e21||1e21<=o)return String(o);if(o<0&&(s="-",o=-o),1e-21<o)if(n=(t=function(e){for(var t=0,n=e;4096<=n;)t+=12,n/=4096;for(;2<=n;)t+=1,n/=2;return t}(o*m(2,69,1))-69)<0?o*m(2,-t,1):o/m(2,t,1),n*=4503599627370496,0<(t=52-t)){for(d(0,n),r=a;7<=r;)d(1e7,0),r-=7;for(d(m(10,r,1),0),r=t-1;23<=r;)p(1<<23),r-=23;p(1<<r),d(1,1),p(2),u=v()}else d(0,n),d(1<<-t,0),u=v()+h.call("0",a);return 0<a?u=s+((i=u.length)<=a?"0."+h.call("0",a-i)+u:u.slice(0,i-a)+"."+u.slice(i-a)):u=s+u,u}})},{110:110,116:116,33:33,35:35,4:4}],189:[function(e,t,n){"use strict";var r=e(33),i=e(35),o=e(4),a=1..toPrecision;r(r.P+r.F*(i(function(){return"1"!==a.call(1,void 0)})||!i(function(){a.call({})})),"Number",{toPrecision:function(e){var t=o(this,"Number#toPrecision: incorrect invocation!");return void 0===e?a.call(t):a.call(t,e)}})},{33:33,35:35,4:4}],190:[function(e,t,n){var r=e(33);r(r.S+r.F,"Object",{assign:e(70)})},{33:33,70:70}],191:[function(e,t,n){var r=e(33);r(r.S,"Object",{create:e(71)})},{33:33,71:71}],192:[function(e,t,n){var r=e(33);r(r.S+r.F*!e(29),"Object",{defineProperties:e(73)})},{29:29,33:33,73:73}],193:[function(e,t,n){var r=e(33);r(r.S+r.F*!e(29),"Object",{defineProperty:e(72).f})},{29:29,33:33,72:72}],194:[function(e,t,n){var r=e(51),i=e(66).onFreeze;e(83)("freeze",function(t){return function(e){return t&&r(e)?t(i(e)):e}})},{51:51,66:66,83:83}],195:[function(e,t,n){var r=e(117),i=e(75).f;e(83)("getOwnPropertyDescriptor",function(){return function(e,t){return i(r(e),t)}})},{117:117,75:75,83:83}],196:[function(e,t,n){e(83)("getOwnPropertyNames",function(){return e(76).f})},{76:76,83:83}],197:[function(e,t,n){var r=e(119),i=e(79);e(83)("getPrototypeOf",function(){return function(e){return i(r(e))}})},{119:119,79:79,83:83}],198:[function(e,t,n){var r=e(51);e(83)("isExtensible",function(t){return function(e){return!!r(e)&&(!t||t(e))}})},{51:51,83:83}],199:[function(e,t,n){var r=e(51);e(83)("isFrozen",function(t){return function(e){return!r(e)||!!t&&t(e)}})},{51:51,83:83}],200:[function(e,t,n){var r=e(51);e(83)("isSealed",function(t){return function(e){return!r(e)||!!t&&t(e)}})},{51:51,83:83}],201:[function(e,t,n){var r=e(33);r(r.S,"Object",{is:e(96)})},{33:33,96:96}],202:[function(e,t,n){var r=e(119),i=e(81);e(83)("keys",function(){return function(e){return i(r(e))}})},{119:119,81:81,83:83}],203:[function(e,t,n){var r=e(51),i=e(66).onFreeze;e(83)("preventExtensions",function(t){return function(e){return t&&r(e)?t(i(e)):e}})},{51:51,66:66,83:83}],204:[function(e,t,n){var r=e(51),i=e(66).onFreeze;e(83)("seal",function(t){return function(e){return t&&r(e)?t(i(e)):e}})},{51:51,66:66,83:83}],205:[function(e,t,n){var r=e(33);r(r.S,"Object",{setPrototypeOf:e(99).set})},{33:33,99:99}],206:[function(e,t,n){"use strict";var r=e(17),i={};i[e(128)("toStringTag")]="z",i+""!="[object z]"&&e(94)(Object.prototype,"toString",function(){return"[object "+r(this)+"]"},!0)},{128:128,17:17,94:94}],207:[function(e,t,n){var r=e(33),i=e(86);r(r.G+r.F*(parseFloat!=i),{parseFloat:i})},{33:33,86:86}],208:[function(e,t,n){var r=e(33),i=e(87);r(r.G+r.F*(parseInt!=i),{parseInt:i})},{33:33,87:87}],209:[function(n,e,t){"use strict";var r,i,o,a,s=n(60),u=n(40),c=n(25),l=n(17),h=n(33),f=n(51),d=n(3),p=n(6),v=n(39),m=n(104),g=n(113).set,y=n(68)(),b=n(69),_=n(90),w=n(91),E=u.TypeError,S=u.process,C=u.Promise,T="process"==l(S),O=function(){},R=i=b.f,A=!!function(){try{var e=C.resolve(1),t=(e.constructor={})[n(128)("species")]=function(e){e(O,O)};return(T||"function"==typeof PromiseRejectionEvent)&&e.then(O)instanceof t}catch(e){}}(),I=s?function(e,t){return e===t||e===C&&t===a}:function(e,t){return e===t},N=function(e){var t;return!(!f(e)||"function"!=typeof(t=e.then))&&t},k=function(c,t){if(!c._n){c._n=!0;var n=c._c;y(function(){for(var s=c._v,u=1==c._s,e=0;n.length>e;)!function(e){var t,n,r=u?e.ok:e.fail,i=e.resolve,o=e.reject,a=e.domain;try{r?(u||(2==c._h&&D(c),c._h=1),!0===r?t=s:(a&&a.enter(),t=r(s),a&&a.exit()),t===e.promise?o(E("Promise-chain cycle")):(n=N(t))?n.call(t,i,o):i(t)):o(s)}catch(e){o(e)}}(n[e++]);c._c=[],c._n=!1,t&&!c._h&&P(c)})}},P=function(o){g.call(u,function(){var e,t,n,r=o._v,i=x(o);if(i&&(e=_(function(){T?S.emit("unhandledRejection",r,o):(t=u.onunhandledrejection)?t({promise:o,reason:r}):(n=u.console)&&n.error&&n.error("Unhandled promise rejection",r)}),o._h=T||x(o)?2:1),o._a=void 0,i&&e.e)throw e.v})},x=function(e){if(1==e._h)return!1;for(var t,n=e._a||e._c,r=0;n.length>r;)if((t=n[r++]).fail||!x(t.promise))return!1;return!0},D=function(t){g.call(u,function(){var e;T?S.emit("rejectionHandled",t):(e=u.onrejectionhandled)&&e({promise:t,reason:t._v})})},M=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),k(t,!0))},L=function(e){var n,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===e)throw E("Promise can't be resolved itself");(n=N(e))?y(function(){var t={_w:r,_d:!1};try{n.call(e,c(L,t,1),c(M,t,1))}catch(e){M.call(t,e)}}):(r._v=e,r._s=1,k(r,!1))}catch(e){M.call({_w:r,_d:!1},e)}}};A||(C=function(e){p(this,C,"Promise","_h"),d(e),r.call(this);try{e(c(L,this,1),c(M,this,1))}catch(e){M.call(this,e)}},(r=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(93)(C.prototype,{then:function(e,t){var n=R(m(this,C));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=T?S.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&k(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),o=function(){var e=new r;this.promise=e,this.resolve=c(L,e,1),this.reject=c(M,e,1)},b.f=R=function(e){return I(C,e)?new o(e):i(e)}),h(h.G+h.W+h.F*!A,{Promise:C}),n(101)(C,"Promise"),n(100)("Promise"),a=n(23).Promise,h(h.S+h.F*!A,"Promise",{reject:function(e){var t=R(this);return(0,t.reject)(e),t.promise}}),h(h.S+h.F*(s||!A),"Promise",{resolve:function(e){return e instanceof C&&I(e.constructor,this)?e:w(this,e)}}),h(h.S+h.F*!(A&&n(56)(function(e){C.all(e).catch(O)})),"Promise",{all:function(e){var a=this,t=R(a),s=t.resolve,u=t.reject,n=_(function(){var r=[],i=0,o=1;v(e,!1,function(e){var t=i++,n=!1;r.push(void 0),o++,a.resolve(e).then(function(e){n||(n=!0,r[t]=e,--o||s(r))},u)}),--o||s(r)});return n.e&&u(n.v),t.promise},race:function(e){var t=this,n=R(t),r=n.reject,i=_(function(){v(e,!1,function(e){t.resolve(e).then(n.resolve,r)})});return i.e&&r(i.v),n.promise}})},{100:100,101:101,104:104,113:113,128:128,17:17,23:23,25:25,3:3,33:33,39:39,40:40,51:51,56:56,6:6,60:60,68:68,69:69,90:90,91:91,93:93}],210:[function(e,t,n){var r=e(33),o=e(3),a=e(7),s=(e(40).Reflect||{}).apply,u=Function.apply;r(r.S+r.F*!e(35)(function(){s(function(){})}),"Reflect",{apply:function(e,t,n){var r=o(e),i=a(n);return s?s(r,t,i):u.call(r,t,i)}})},{3:3,33:33,35:35,40:40,7:7}],211:[function(e,t,n){var r=e(33),s=e(71),u=e(3),c=e(7),l=e(51),i=e(35),h=e(16),f=(e(40).Reflect||{}).construct,d=i(function(){function e(){}return!(f(function(){},[],e)instanceof e)}),p=!i(function(){f(function(){})});r(r.S+r.F*(d||p),"Reflect",{construct:function(e,t){u(e),c(t);var n=arguments.length<3?e:u(arguments[2]);if(p&&!d)return f(e,t,n);if(e==n){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var r=[null];return r.push.apply(r,t),new(h.apply(e,r))}var i=n.prototype,o=s(l(i)?i:Object.prototype),a=Function.apply.call(e,o,t);return l(a)?a:o}})},{16:16,3:3,33:33,35:35,40:40,51:51,7:7,71:71}],212:[function(e,t,n){var r=e(72),i=e(33),o=e(7),a=e(120);i(i.S+i.F*e(35)(function(){Reflect.defineProperty(r.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(e,t,n){o(e),t=a(t,!0),o(n);try{return r.f(e,t,n),!0}catch(e){return!1}}})},{120:120,33:33,35:35,7:7,72:72}],213:[function(e,t,n){var r=e(33),i=e(75).f,o=e(7);r(r.S,"Reflect",{deleteProperty:function(e,t){var n=i(o(e),t);return!(n&&!n.configurable)&&delete e[t]}})},{33:33,7:7,75:75}],214:[function(e,t,n){"use strict";var r=e(33),i=e(7),o=function(e){this._t=i(e),this._i=0;var t,n=this._k=[];for(t in e)n.push(t)};e(54)(o,"Object",function(){var e,t=this._k;do{if(this._i>=t.length)return{value:void 0,done:!0}}while(!((e=t[this._i++])in this._t));return{value:e,done:!1}}),r(r.S,"Reflect",{enumerate:function(e){return new o(e)}})},{33:33,54:54,7:7}],215:[function(e,t,n){var r=e(75),i=e(33),o=e(7);i(i.S,"Reflect",{getOwnPropertyDescriptor:function(e,t){return r.f(o(e),t)}})},{33:33,7:7,75:75}],216:[function(e,t,n){var r=e(33),i=e(79),o=e(7);r(r.S,"Reflect",{getPrototypeOf:function(e){return i(o(e))}})},{33:33,7:7,79:79}],217:[function(e,t,n){var a=e(75),s=e(79),u=e(41),r=e(33),c=e(51),l=e(7);r(r.S,"Reflect",{get:function e(t,n){var r,i,o=arguments.length<3?t:arguments[2];return l(t)===o?t[n]:(r=a.f(t,n))?u(r,"value")?r.value:void 0!==r.get?r.get.call(o):void 0:c(i=s(t))?e(i,n,o):void 0}})},{33:33,41:41,51:51,7:7,75:75,79:79}],218:[function(e,t,n){var r=e(33);r(r.S,"Reflect",{has:function(e,t){return t in e}})},{33:33}],219:[function(e,t,n){var r=e(33),i=e(7),o=Object.isExtensible;r(r.S,"Reflect",{isExtensible:function(e){return i(e),!o||o(e)}})},{33:33,7:7}],220:[function(e,t,n){var r=e(33);r(r.S,"Reflect",{ownKeys:e(85)})},{33:33,85:85}],221:[function(e,t,n){var r=e(33),i=e(7),o=Object.preventExtensions;r(r.S,"Reflect",{preventExtensions:function(e){i(e);try{return o&&o(e),!0}catch(e){return!1}}})},{33:33,7:7}],222:[function(e,t,n){var r=e(33),i=e(99);i&&r(r.S,"Reflect",{setPrototypeOf:function(e,t){i.check(e,t);try{return i.set(e,t),!0}catch(e){return!1}}})},{33:33,99:99}],223:[function(e,t,n){var u=e(72),c=e(75),l=e(79),h=e(41),r=e(33),f=e(92),d=e(7),p=e(51);r(r.S,"Reflect",{set:function e(t,n,r){var i,o,a=arguments.length<4?t:arguments[3],s=c.f(d(t),n);if(!s){if(p(o=l(t)))return e(o,n,r,a);s=f(0)}return h(s,"value")?!(!1===s.writable||!p(a)||((i=c.f(a,n)||f(0)).value=r,u.f(a,n,i),0)):void 0!==s.set&&(s.set.call(a,r),!0)}})},{33:33,41:41,51:51,7:7,72:72,75:75,79:79,92:92}],224:[function(e,t,n){var r=e(40),o=e(45),i=e(72).f,a=e(77).f,s=e(52),u=e(37),c=r.RegExp,l=c,h=c.prototype,f=/a/g,d=/a/g,p=new c(f)!==f;if(e(29)&&(!p||e(35)(function(){return d[e(128)("match")]=!1,c(f)!=f||c(d)==d||"/a/i"!=c(f,"i")}))){c=function(e,t){var n=this instanceof c,r=s(e),i=void 0===t;return!n&&r&&e.constructor===c&&i?e:o(p?new l(r&&!i?e.source:e,t):l((r=e instanceof c)?e.source:e,r&&i?u.call(e):t),n?this:h,c)};for(var v=a(l),m=0;v.length>m;)!function(t){t in c||i(c,t,{configurable:!0,get:function(){return l[t]},set:function(e){l[t]=e}})}(v[m++]);(h.constructor=c).prototype=h,e(94)(r,"RegExp",c)}e(100)("RegExp")},{100:100,128:128,29:29,35:35,37:37,40:40,45:45,52:52,72:72,77:77,94:94}],225:[function(e,t,n){e(29)&&"g"!=/./g.flags&&e(72).f(RegExp.prototype,"flags",{configurable:!0,get:e(37)})},{29:29,37:37,72:72}],226:[function(e,t,n){e(36)("match",1,function(r,i,e){return[function(e){"use strict";var t=r(this),n=null==e?void 0:e[i];return void 0!==n?n.call(e,t):new RegExp(e)[i](String(t))},e]})},{36:36}],227:[function(e,t,n){e(36)("replace",2,function(i,o,a){return[function(e,t){"use strict";var n=i(this),r=null==e?void 0:e[o];return void 0!==r?r.call(e,n,t):a.call(String(n),e,t)},a]})},{36:36}],228:[function(e,t,n){e(36)("search",1,function(r,i,e){return[function(e){"use strict";var t=r(this),n=null==e?void 0:e[i];return void 0!==n?n.call(e,t):new RegExp(e)[i](String(t))},e]})},{36:36}],229:[function(e,t,n){e(36)("split",2,function(i,o,a){"use strict";var d=e(52),p=a,v=[].push,m="length";if("c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1)[m]||2!="ab".split(/(?:ab)*/)[m]||4!=".".split(/(.?)(.?)/)[m]||1<".".split(/()()/)[m]||"".split(/.?/)[m]){var g=void 0===/()??/.exec("")[1];a=function(e,t){var n=String(this);if(void 0===e&&0===t)return[];if(!d(e))return p.call(n,e,t);var r,i,o,a,s,u=[],c=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),l=0,h=void 0===t?4294967295:t>>>0,f=new RegExp(e.source,c+"g");for(g||(r=new RegExp("^"+f.source+"$(?!\\s)",c));(i=f.exec(n))&&!((o=i.index+i[0][m])>l&&(u.push(n.slice(l,i.index)),!g&&1<i[m]&&i[0].replace(r,function(){for(s=1;s<arguments[m]-2;s++)void 0===arguments[s]&&(i[s]=void 0)}),1<i[m]&&i.index<n[m]&&v.apply(u,i.slice(1)),a=i[0][m],l=o,u[m]>=h));)f.lastIndex===i.index&&f.lastIndex++;return l===n[m]?!a&&f.test("")||u.push(""):u.push(n.slice(l)),u[m]>h?u.slice(0,h):u}}else"0".split(void 0,0)[m]&&(a=function(e,t){return void 0===e&&0===t?[]:p.call(this,e,t)});return[function(e,t){var n=i(this),r=null==e?void 0:e[o];return void 0!==r?r.call(e,n,t):a.call(String(n),e,t)},a]})},{36:36,52:52}],230:[function(t,e,n){"use strict";t(225);var r=t(7),i=t(37),o=t(29),a=/./.toString,s=function(e){t(94)(RegExp.prototype,"toString",e,!0)};t(35)(function(){return"/a/b"!=a.call({source:"a",flags:"b"})})?s(function(){var e=r(this);return"/".concat(e.source,"/","flags"in e?e.flags:!o&&e instanceof RegExp?i.call(e):void 0)}):"toString"!=a.name&&s(function(){return a.call(this)})},{225:225,29:29,35:35,37:37,7:7,94:94}],231:[function(e,t,n){"use strict";var r=e(19),i=e(125);t.exports=e(22)("Set",function(e){return function(){return e(this,0<arguments.length?arguments[0]:void 0)}},{add:function(e){return r.def(i(this,"Set"),e=0===e?0:e,e)}},r)},{125:125,19:19,22:22}],232:[function(e,t,n){"use strict";e(108)("anchor",function(t){return function(e){return t(this,"a","name",e)}})},{108:108}],233:[function(e,t,n){"use strict";e(108)("big",function(e){return function(){return e(this,"big","","")}})},{108:108}],234:[function(e,t,n){"use strict";e(108)("blink",function(e){return function(){return e(this,"blink","","")}})},{108:108}],235:[function(e,t,n){"use strict";e(108)("bold",function(e){return function(){return e(this,"b","","")}})},{108:108}],236:[function(e,t,n){"use strict";var r=e(33),i=e(106)(!1);r(r.P,"String",{codePointAt:function(e){return i(this,e)}})},{106:106,33:33}],237:[function(e,t,n){"use strict";var r=e(33),a=e(118),s=e(107),u="".endsWith;r(r.P+r.F*e(34)("endsWith"),"String",{endsWith:function(e){var t=s(this,e,"endsWith"),n=1<arguments.length?arguments[1]:void 0,r=a(t.length),i=void 0===n?r:Math.min(a(n),r),o=String(e);return u?u.call(t,o,i):t.slice(i-o.length,i)===o}})},{107:107,118:118,33:33,34:34}],238:[function(e,t,n){"use strict";e(108)("fixed",function(e){return function(){return e(this,"tt","","")}})},{108:108}],239:[function(e,t,n){"use strict";e(108)("fontcolor",function(t){return function(e){return t(this,"font","color",e)}})},{108:108}],240:[function(e,t,n){"use strict";e(108)("fontsize",function(t){return function(e){return t(this,"font","size",e)}})},{108:108}],241:[function(e,t,n){var r=e(33),o=e(114),a=String.fromCharCode,i=String.fromCodePoint;r(r.S+r.F*(!!i&&1!=i.length),"String",{fromCodePoint:function(e){for(var t,n=[],r=arguments.length,i=0;i<r;){if(t=+arguments[i++],o(t,1114111)!==t)throw RangeError(t+" is not a valid code point");n.push(t<65536?a(t):a(55296+((t-=65536)>>10),t%1024+56320))}return n.join("")}})},{114:114,33:33}],242:[function(e,t,n){"use strict";var r=e(33),i=e(107);r(r.P+r.F*e(34)("includes"),"String",{includes:function(e){return!!~i(this,e,"includes").indexOf(e,1<arguments.length?arguments[1]:void 0)}})},{107:107,33:33,34:34}],243:[function(e,t,n){"use strict";e(108)("italics",function(e){return function(){return e(this,"i","","")}})},{108:108}],244:[function(e,t,n){"use strict";var r=e(106)(!0);e(55)(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=r(t,n),this._i+=e.length,{value:e,done:!1})})},{106:106,55:55}],245:[function(e,t,n){"use strict";e(108)("link",function(t){return function(e){return t(this,"a","href",e)}})},{108:108}],246:[function(e,t,n){var r=e(33),a=e(117),s=e(118);r(r.S,"String",{raw:function(e){for(var t=a(e.raw),n=s(t.length),r=arguments.length,i=[],o=0;o<n;)i.push(String(t[o++])),o<r&&i.push(String(arguments[o]));return i.join("")}})},{117:117,118:118,33:33}],247:[function(e,t,n){var r=e(33);r(r.P,"String",{repeat:e(110)})},{110:110,33:33}],248:[function(e,t,n){"use strict";e(108)("small",function(e){return function(){return e(this,"small","","")}})},{108:108}],249:[function(e,t,n){"use strict";var r=e(33),i=e(118),o=e(107),a="".startsWith;r(r.P+r.F*e(34)("startsWith"),"String",{startsWith:function(e){var t=o(this,e,"startsWith"),n=i(Math.min(1<arguments.length?arguments[1]:void 0,t.length)),r=String(e);return a?a.call(t,r,n):t.slice(n,n+r.length)===r}})},{107:107,118:118,33:33,34:34}],250:[function(e,t,n){"use strict";e(108)("strike",function(e){return function(){return e(this,"strike","","")}})},{108:108}],251:[function(e,t,n){"use strict";e(108)("sub",function(e){return function(){return e(this,"sub","","")}})},{108:108}],252:[function(e,t,n){"use strict";e(108)("sup",function(e){return function(){return e(this,"sup","","")}})},{108:108}],253:[function(e,t,n){"use strict";e(111)("trim",function(e){return function(){return e(this,3)}})},{111:111}],254:[function(e,t,n){"use strict";var r=e(40),a=e(41),i=e(29),o=e(33),s=e(94),u=e(66).KEY,c=e(35),l=e(103),h=e(101),f=e(124),d=e(128),p=e(127),v=e(126),m=e(59),g=e(32),y=e(49),b=e(7),_=e(117),w=e(120),E=e(92),S=e(71),C=e(76),T=e(75),O=e(72),R=e(81),A=T.f,I=O.f,N=C.f,k=r.Symbol,P=r.JSON,x=P&&P.stringify,D=d("_hidden"),M=d("toPrimitive"),L={}.propertyIsEnumerable,F=l("symbol-registry"),V=l("symbols"),j=l("op-symbols"),U=Object.prototype,B="function"==typeof k,q=r.QObject,W=!q||!q.prototype||!q.prototype.findChild,H=i&&c(function(){return 7!=S(I({},"a",{get:function(){return I(this,"a",{value:7}).a}})).a})?function(e,t,n){var r=A(U,t);r&&delete U[t],I(e,t,n),r&&e!==U&&I(U,t,r)}:I,G=function(e){var t=V[e]=S(k.prototype);return t._k=e,t},K=B&&"symbol"==typeof k.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof k},$=function(e,t,n){return e===U&&$(j,t,n),b(e),t=w(t,!0),b(n),a(V,t)?(n.enumerable?(a(e,D)&&e[D][t]&&(e[D][t]=!1),n=S(n,{enumerable:E(0,!1)})):(a(e,D)||I(e,D,E(1,{})),e[D][t]=!0),H(e,t,n)):I(e,t,n)},z=function(e,t){b(e);for(var n,r=g(t=_(t)),i=0,o=r.length;i<o;)$(e,n=r[i++],t[n]);return e},Q=function(e){var t=L.call(this,e=w(e,!0));return!(this===U&&a(V,e)&&!a(j,e))&&(!(t||!a(this,e)||!a(V,e)||a(this,D)&&this[D][e])||t)},Y=function(e,t){if(e=_(e),t=w(t,!0),e!==U||!a(V,t)||a(j,t)){var n=A(e,t);return!n||!a(V,t)||a(e,D)&&e[D][t]||(n.enumerable=!0),n}},X=function(e){for(var t,n=N(_(e)),r=[],i=0;n.length>i;)a(V,t=n[i++])||t==D||t==u||r.push(t);return r},J=function(e){for(var t,n=e===U,r=N(n?j:_(e)),i=[],o=0;r.length>o;)!a(V,t=r[o++])||n&&!a(U,t)||i.push(V[t]);return i};B||(s((k=function(){if(this instanceof k)throw TypeError("Symbol is not a constructor!");var t=f(0<arguments.length?arguments[0]:void 0),n=function(e){this===U&&n.call(j,e),a(this,D)&&a(this[D],t)&&(this[D][t]=!1),H(this,t,E(1,e))};return i&&W&&H(U,t,{configurable:!0,set:n}),G(t)}).prototype,"toString",function(){return this._k}),T.f=Y,O.f=$,e(77).f=C.f=X,e(82).f=Q,e(78).f=J,i&&!e(60)&&s(U,"propertyIsEnumerable",Q,!0),p.f=function(e){return G(d(e))}),o(o.G+o.W+o.F*!B,{Symbol:k});for(var Z="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ee=0;Z.length>ee;)d(Z[ee++]);for(var te=R(d.store),ne=0;te.length>ne;)v(te[ne++]);o(o.S+o.F*!B,"Symbol",{for:function(e){return a(F,e+="")?F[e]:F[e]=k(e)},keyFor:function(e){if(K(e))return m(F,e);throw TypeError(e+" is not a symbol!")},useSetter:function(){W=!0},useSimple:function(){W=!1}}),o(o.S+o.F*!B,"Object",{create:function(e,t){return void 0===t?S(e):z(S(e),t)},defineProperty:$,defineProperties:z,getOwnPropertyDescriptor:Y,getOwnPropertyNames:X,getOwnPropertySymbols:J}),P&&o(o.S+o.F*(!B||c(function(){var e=k();return"[null]"!=x([e])||"{}"!=x({a:e})||"{}"!=x(Object(e))})),"JSON",{stringify:function(e){if(void 0!==e&&!K(e)){for(var t,n,r=[e],i=1;arguments.length>i;)r.push(arguments[i++]);return"function"==typeof(t=r[1])&&(n=t),!n&&y(t)||(t=function(e,t){if(n&&(t=n.call(this,e,t)),!K(t))return t}),r[1]=t,x.apply(P,r)}}}),k.prototype[M]||e(42)(k.prototype,M,k.prototype.valueOf),h(k,"Symbol"),h(Math,"Math",!0),h(r.JSON,"JSON",!0)},{101:101,103:103,117:117,120:120,124:124,126:126,127:127,128:128,29:29,32:32,33:33,35:35,40:40,41:41,42:42,49:49,59:59,60:60,66:66,7:7,71:71,72:72,75:75,76:76,77:77,78:78,81:81,82:82,92:92,94:94}],255:[function(e,t,n){"use strict";var r=e(33),i=e(123),o=e(122),c=e(7),l=e(114),h=e(118),a=e(51),s=e(40).ArrayBuffer,f=e(104),d=o.ArrayBuffer,p=o.DataView,u=i.ABV&&s.isView,v=d.prototype.slice,m=i.VIEW;r(r.G+r.W+r.F*(s!==d),{ArrayBuffer:d}),r(r.S+r.F*!i.CONSTR,"ArrayBuffer",{isView:function(e){return u&&u(e)||a(e)&&m in e}}),r(r.P+r.U+r.F*e(35)(function(){return!new d(2).slice(1,void 0).byteLength}),"ArrayBuffer",{slice:function(e,t){if(void 0!==v&&void 0===t)return v.call(c(this),e);for(var n=c(this).byteLength,r=l(e,n),i=l(void 0===t?n:t,n),o=new(f(this,d))(h(i-r)),a=new p(this),s=new p(o),u=0;r<i;)s.setUint8(u++,a.getUint8(r++));return o}}),e(100)("ArrayBuffer")},{100:100,104:104,114:114,118:118,122:122,123:123,33:33,35:35,40:40,51:51,7:7}],256:[function(e,t,n){var r=e(33);r(r.G+r.W+r.F*!e(123).ABV,{DataView:e(122).DataView})},{122:122,123:123,33:33}],257:[function(e,t,n){e(121)("Float32",4,function(r){return function(e,t,n){return r(this,e,t,n)}})},{121:121}],258:[function(e,t,n){e(121)("Float64",8,function(r){return function(e,t,n){return r(this,e,t,n)}})},{121:121}],259:[function(e,t,n){e(121)("Int16",2,function(r){return function(e,t,n){return r(this,e,t,n)}})},{121:121}],260:[function(e,t,n){e(121)("Int32",4,function(r){return function(e,t,n){return r(this,e,t,n)}})},{121:121}],261:[function(e,t,n){e(121)("Int8",1,function(r){return function(e,t,n){return r(this,e,t,n)}})},{121:121}],262:[function(e,t,n){e(121)("Uint16",2,function(r){return function(e,t,n){return r(this,e,t,n)}})},{121:121}],263:[function(e,t,n){e(121)("Uint32",4,function(r){return function(e,t,n){return r(this,e,t,n)}})},{121:121}],264:[function(e,t,n){e(121)("Uint8",1,function(r){return function(e,t,n){return r(this,e,t,n)}})},{121:121}],265:[function(e,t,n){e(121)("Uint8",1,function(r){return function(e,t,n){return r(this,e,t,n)}},!0)},{121:121}],266:[function(e,t,n){"use strict";var o,r=e(12)(0),a=e(94),i=e(66),s=e(70),u=e(21),c=e(51),l=e(35),h=e(125),f=i.getWeak,d=Object.isExtensible,p=u.ufstore,v={},m=function(e){return function(){return e(this,0<arguments.length?arguments[0]:void 0)}},g={get:function(e){if(c(e)){var t=f(e);return!0===t?p(h(this,"WeakMap")).get(e):t?t[this._i]:void 0}},set:function(e,t){return u.def(h(this,"WeakMap"),e,t)}},y=t.exports=e(22)("WeakMap",m,g,u,!0,!0);l(function(){return 7!=(new y).set((Object.freeze||Object)(v),7).get(v)})&&(s((o=u.getConstructor(m,"WeakMap")).prototype,g),i.NEED=!0,r(["delete","has","get","set"],function(r){var e=y.prototype,i=e[r];a(e,r,function(e,t){if(c(e)&&!d(e)){this._f||(this._f=new o);var n=this._f[r](e,t);return"set"==r?this:n}return i.call(this,e,t)})}))},{12:12,125:125,21:21,22:22,35:35,51:51,66:66,70:70,94:94}],267:[function(e,t,n){"use strict";var r=e(21),i=e(125);e(22)("WeakSet",function(e){return function(){return e(this,0<arguments.length?arguments[0]:void 0)}},{add:function(e){return r.def(i(this,"WeakSet"),e,!0)}},r,!1,!0)},{125:125,21:21,22:22}],268:[function(e,t,n){"use strict";var r=e(33),i=e(38),o=e(119),a=e(118),s=e(3),u=e(15);r(r.P,"Array",{flatMap:function(e){var t,n,r=o(this);return s(e),t=a(r.length),n=u(r,0),i(n,r,r,t,0,1,e,arguments[1]),n}}),e(5)("flatMap")},{118:118,119:119,15:15,3:3,33:33,38:38,5:5}],269:[function(e,t,n){"use strict";var r=e(33),i=e(38),o=e(119),a=e(118),s=e(116),u=e(15);r(r.P,"Array",{flatten:function(){var e=arguments[0],t=o(this),n=a(t.length),r=u(t,0);return i(r,t,t,n,0,void 0===e?1:s(e)),r}}),e(5)("flatten")},{116:116,118:118,119:119,15:15,33:33,38:38,5:5}],270:[function(e,t,n){"use strict";var r=e(33),i=e(11)(!0);r(r.P,"Array",{includes:function(e){return i(this,e,1<arguments.length?arguments[1]:void 0)}}),e(5)("includes")},{11:11,33:33,5:5}],271:[function(e,t,n){var r=e(33),i=e(68)(),o=e(40).process,a="process"==e(18)(o);r(r.G,{asap:function(e){var t=a&&o.domain;i(t?t.bind(e):e)}})},{18:18,33:33,40:40,68:68}],272:[function(e,t,n){var r=e(33),i=e(18);r(r.S,"Error",{isError:function(e){return"Error"===i(e)}})},{18:18,33:33}],273:[function(e,t,n){var r=e(33);r(r.G,{global:e(40)})},{33:33,40:40}],274:[function(e,t,n){e(97)("Map")},{97:97}],275:[function(e,t,n){e(98)("Map")},{98:98}],276:[function(e,t,n){var r=e(33);r(r.P+r.R,"Map",{toJSON:e(20)("Map")})},{20:20,33:33}],277:[function(e,t,n){var r=e(33);r(r.S,"Math",{clamp:function(e,t,n){return Math.min(n,Math.max(t,e))}})},{33:33}],278:[function(e,t,n){var r=e(33);r(r.S,"Math",{DEG_PER_RAD:Math.PI/180})},{33:33}],279:[function(e,t,n){var r=e(33),i=180/Math.PI;r(r.S,"Math",{degrees:function(e){return e*i}})},{33:33}],280:[function(e,t,n){var r=e(33),o=e(64),a=e(62);r(r.S,"Math",{fscale:function(e,t,n,r,i){return a(o(e,t,n,r,i))}})},{33:33,62:62,64:64}],281:[function(e,t,n){var r=e(33);r(r.S,"Math",{iaddh:function(e,t,n,r){var i=e>>>0,o=n>>>0;return(t>>>0)+(r>>>0)+((i&o|(i|o)&~(i+o>>>0))>>>31)|0}})},{33:33}],282:[function(e,t,n){var r=e(33);r(r.S,"Math",{imulh:function(e,t){var n=+e,r=+t,i=65535&n,o=65535&r,a=n>>16,s=r>>16,u=(a*o>>>0)+(i*o>>>16);return a*s+(u>>16)+((i*s>>>0)+(65535&u)>>16)}})},{33:33}],283:[function(e,t,n){var r=e(33);r(r.S,"Math",{isubh:function(e,t,n,r){var i=e>>>0,o=n>>>0;return(t>>>0)-(r>>>0)-((~i&o|~(i^o)&i-o>>>0)>>>31)|0}})},{33:33}],284:[function(e,t,n){var r=e(33);r(r.S,"Math",{RAD_PER_DEG:180/Math.PI})},{33:33}],285:[function(e,t,n){var r=e(33),i=Math.PI/180;r(r.S,"Math",{radians:function(e){return e*i}})},{33:33}],286:[function(e,t,n){var r=e(33);r(r.S,"Math",{scale:e(64)})},{33:33,64:64}],287:[function(e,t,n){var r=e(33);r(r.S,"Math",{signbit:function(e){return(e=+e)!=e?e:0==e?1/e==1/0:0<e}})},{33:33}],288:[function(e,t,n){var r=e(33);r(r.S,"Math",{umulh:function(e,t){var n=+e,r=+t,i=65535&n,o=65535&r,a=n>>>16,s=r>>>16,u=(a*o>>>0)+(i*o>>>16);return a*s+(u>>>16)+((i*s>>>0)+(65535&u)>>>16)}})},{33:33}],289:[function(e,t,n){"use strict";var r=e(33),i=e(119),o=e(3),a=e(72);e(29)&&r(r.P+e(74),"Object",{__defineGetter__:function(e,t){a.f(i(this),e,{get:o(t),enumerable:!0,configurable:!0})}})},{119:119,29:29,3:3,33:33,72:72,74:74}],290:[function(e,t,n){"use strict";var r=e(33),i=e(119),o=e(3),a=e(72);e(29)&&r(r.P+e(74),"Object",{__defineSetter__:function(e,t){a.f(i(this),e,{set:o(t),enumerable:!0,configurable:!0})}})},{119:119,29:29,3:3,33:33,72:72,74:74}],291:[function(e,t,n){var r=e(33),i=e(84)(!0);r(r.S,"Object",{entries:function(e){return i(e)}})},{33:33,84:84}],292:[function(e,t,n){var r=e(33),u=e(85),c=e(117),l=e(75),h=e(24);r(r.S,"Object",{getOwnPropertyDescriptors:function(e){for(var t,n,r=c(e),i=l.f,o=u(r),a={},s=0;o.length>s;)void 0!==(n=i(r,t=o[s++]))&&h(a,t,n);return a}})},{117:117,24:24,33:33,75:75,85:85}],293:[function(e,t,n){"use strict";var r=e(33),i=e(119),o=e(120),a=e(79),s=e(75).f;e(29)&&r(r.P+e(74),"Object",{__lookupGetter__:function(e){var t,n=i(this),r=o(e,!0);do{if(t=s(n,r))return t.get}while(n=a(n))}})},{119:119,120:120,29:29,33:33,74:74,75:75,79:79}],294:[function(e,t,n){"use strict";var r=e(33),i=e(119),o=e(120),a=e(79),s=e(75).f;e(29)&&r(r.P+e(74),"Object",{__lookupSetter__:function(e){var t,n=i(this),r=o(e,!0);do{if(t=s(n,r))return t.set}while(n=a(n))}})},{119:119,120:120,29:29,33:33,74:74,75:75,79:79}],295:[function(e,t,n){var r=e(33),i=e(84)(!1);r(r.S,"Object",{values:function(e){return i(e)}})},{33:33,84:84}],296:[function(e,t,n){"use strict";var r=e(33),o=e(40),a=e(23),i=e(68)(),s=e(128)("observable"),u=e(3),c=e(7),l=e(6),h=e(93),f=e(42),d=e(39),p=d.RETURN,v=function(e){return null==e?void 0:u(e)},m=function(e){var t=e._c;t&&(e._c=void 0,t())},g=function(e){return void 0===e._o},y=function(e){g(e)||(e._o=void 0,m(e))},b=function(e,t){c(e),this._c=void 0,this._o=e,e=new _(this);try{var n=t(e),r=n;null!=n&&("function"==typeof n.unsubscribe?n=function(){r.unsubscribe()}:u(n),this._c=n)}catch(t){return void e.error(t)}g(this)&&m(this)};b.prototype=h({},{unsubscribe:function(){y(this)}});var _=function(e){this._s=e};_.prototype=h({},{next:function(e){var t=this._s;if(!g(t)){var n=t._o;try{var r=v(n.next);if(r)return r.call(n,e)}catch(e){try{y(t)}finally{throw e}}}},error:function(e){var t=this._s;if(g(t))throw e;var n=t._o;t._o=void 0;try{var r=v(n.error);if(!r)throw e;e=r.call(n,e)}catch(e){try{m(t)}finally{throw e}}return m(t),e},complete:function(e){var t=this._s;if(!g(t)){var n=t._o;t._o=void 0;try{var r=v(n.complete);e=r?r.call(n,e):void 0}catch(e){try{m(t)}finally{throw e}}return m(t),e}}});var w=function(e){l(this,w,"Observable","_f")._f=u(e)};h(w.prototype,{subscribe:function(e){return new b(e,this._f)},forEach:function(r){var i=this;return new(a.Promise||o.Promise)(function(e,t){u(r);var n=i.subscribe({next:function(e){try{return r(e)}catch(e){t(e),n.unsubscribe()}},error:t,complete:e})})}}),h(w,{from:function(e){var t="function"==typeof this?this:w,n=v(c(e)[s]);if(n){var r=c(n.call(e));return r.constructor===t?r:new t(function(e){return r.subscribe(e)})}return new t(function(t){var n=!1;return i(function(){if(!n){try{if(d(e,!1,function(e){if(t.next(e),n)return p})===p)return}catch(e){if(n)throw e;return void t.error(e)}t.complete()}}),function(){n=!0}})},of:function(){for(var e=0,t=arguments.length,r=Array(t);e<t;)r[e]=arguments[e++];return new("function"==typeof this?this:w)(function(t){var n=!1;return i(function(){if(!n){for(var e=0;e<r.length;++e)if(t.next(r[e]),n)return;t.complete()}}),function(){n=!0}})}}),f(w.prototype,s,function(){return this}),r(r.G,{Observable:w}),e(100)("Observable")},{100:100,128:128,23:23,3:3,33:33,39:39,40:40,42:42,6:6,68:68,7:7,93:93}],297:[function(e,t,n){"use strict";var r=e(33),i=e(23),o=e(40),a=e(104),s=e(91);r(r.P+r.R,"Promise",{finally:function(t){var n=a(this,i.Promise||o.Promise),e="function"==typeof t;return this.then(e?function(e){return s(n,t()).then(function(){return e})}:t,e?function(e){return s(n,t()).then(function(){throw e})}:t)}})},{104:104,23:23,33:33,40:40,91:91}],298:[function(e,t,n){"use strict";var r=e(33),i=e(69),o=e(90);r(r.S,"Promise",{try:function(e){var t=i.f(this),n=o(e);return(n.e?t.reject:t.resolve)(n.v),t.promise}})},{33:33,69:69,90:90}],299:[function(e,t,n){var r=e(67),i=e(7),o=r.key,a=r.set;r.exp({defineMetadata:function(e,t,n,r){a(e,t,i(n),o(r))}})},{67:67,7:7}],300:[function(e,t,n){var r=e(67),o=e(7),a=r.key,s=r.map,u=r.store;r.exp({deleteMetadata:function(e,t){var n=arguments.length<3?void 0:a(arguments[2]),r=s(o(t),n,!1);if(void 0===r||!r.delete(e))return!1;if(r.size)return!0;var i=u.get(t);return i.delete(n),!!i.size||u.delete(t)}})},{67:67,7:7}],301:[function(e,t,n){var o=e(231),a=e(10),r=e(67),i=e(7),s=e(79),u=r.keys,c=r.key,l=function(e,t){var n=u(e,t),r=s(e);if(null===r)return n;var i=l(r,t);return i.length?n.length?a(new o(n.concat(i))):i:n};r.exp({getMetadataKeys:function(e){return l(i(e),arguments.length<2?void 0:c(arguments[1]))}})},{10:10,231:231,67:67,7:7,79:79}],302:[function(e,t,n){var r=e(67),i=e(7),o=e(79),a=r.has,s=r.get,u=r.key,c=function(e,t,n){if(a(e,t,n))return s(e,t,n);var r=o(t);return null!==r?c(e,r,n):void 0};r.exp({getMetadata:function(e,t){return c(e,i(t),arguments.length<3?void 0:u(arguments[2]))}})},{67:67,7:7,79:79}],303:[function(e,t,n){var r=e(67),i=e(7),o=r.keys,a=r.key;r.exp({getOwnMetadataKeys:function(e){return o(i(e),arguments.length<2?void 0:a(arguments[1]))}})},{67:67,7:7}],304:[function(e,t,n){var r=e(67),i=e(7),o=r.get,a=r.key;r.exp({getOwnMetadata:function(e,t){return o(e,i(t),arguments.length<3?void 0:a(arguments[2]))}})},{67:67,7:7}],305:[function(e,t,n){var r=e(67),i=e(7),o=e(79),a=r.has,s=r.key,u=function(e,t,n){if(a(e,t,n))return!0;var r=o(t);return null!==r&&u(e,r,n)};r.exp({hasMetadata:function(e,t){return u(e,i(t),arguments.length<3?void 0:s(arguments[2]))}})},{67:67,7:7,79:79}],306:[function(e,t,n){var r=e(67),i=e(7),o=r.has,a=r.key;r.exp({hasOwnMetadata:function(e,t){return o(e,i(t),arguments.length<3?void 0:a(arguments[2]))}})},{67:67,7:7}],307:[function(e,t,n){var r=e(67),i=e(7),o=e(3),a=r.key,s=r.set;r.exp({metadata:function(n,r){return function(e,t){s(n,r,(void 0!==t?i:o)(e),a(t))}}})},{3:3,67:67,7:7}],308:[function(e,t,n){e(97)("Set")},{97:97}],309:[function(e,t,n){e(98)("Set")},{98:98}],310:[function(e,t,n){var r=e(33);r(r.P+r.R,"Set",{toJSON:e(20)("Set")})},{20:20,33:33}],311:[function(e,t,n){"use strict";var r=e(33),i=e(106)(!0);r(r.P,"String",{at:function(e){return i(this,e)}})},{106:106,33:33}],312:[function(e,t,n){"use strict";var r=e(33),i=e(28),o=e(118),a=e(52),s=e(37),u=RegExp.prototype,c=function(e,t){this._r=e,this._s=t};e(54)(c,"RegExp String",function(){var e=this._r.exec(this._s);return{value:e,done:null===e}}),r(r.P,"String",{matchAll:function(e){if(i(this),!a(e))throw TypeError(e+" is not a regexp!");var t=String(this),n="flags"in u?String(e.flags):s.call(e),r=new RegExp(e.source,~n.indexOf("g")?n:"g"+n);return r.lastIndex=o(e.lastIndex),new c(r,t)}})},{118:118,28:28,33:33,37:37,52:52,54:54}],313:[function(e,t,n){"use strict";var r=e(33),i=e(109);r(r.P,"String",{padEnd:function(e){return i(this,e,1<arguments.length?arguments[1]:void 0,!1)}})},{109:109,33:33}],314:[function(e,t,n){"use strict";var r=e(33),i=e(109);r(r.P,"String",{padStart:function(e){return i(this,e,1<arguments.length?arguments[1]:void 0,!0)}})},{109:109,33:33}],315:[function(e,t,n){"use strict";e(111)("trimLeft",function(e){return function(){return e(this,1)}},"trimStart")},{111:111}],316:[function(e,t,n){"use strict";e(111)("trimRight",function(e){return function(){return e(this,2)}},"trimEnd")},{111:111}],317:[function(e,t,n){e(126)("asyncIterator")},{126:126}],318:[function(e,t,n){e(126)("observable")},{126:126}],319:[function(e,t,n){var r=e(33);r(r.S,"System",{global:e(40)})},{33:33,40:40}],320:[function(e,t,n){e(97)("WeakMap")},{97:97}],321:[function(e,t,n){e(98)("WeakMap")},{98:98}],322:[function(e,t,n){e(97)("WeakSet")},{97:97}],323:[function(e,t,n){e(98)("WeakSet")},{98:98}],324:[function(e,t,n){for(var r=e(141),i=e(81),o=e(94),a=e(40),s=e(42),u=e(58),c=e(128),l=c("iterator"),h=c("toStringTag"),f=u.Array,d={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},p=i(d),v=0;v<p.length;v++){var m,g=p[v],y=d[g],b=a[g],_=b&&b.prototype;if(_&&(_[l]||s(_,l,f),_[h]||s(_,h,g),u[g]=f,y))for(m in r)_[m]||o(_,m,r[m],!0)}},{128:128,141:141,40:40,42:42,58:58,81:81,94:94}],325:[function(e,t,n){var r=e(33),i=e(113);r(r.G+r.B,{setImmediate:i.set,clearImmediate:i.clear})},{113:113,33:33}],326:[function(e,t,n){var r=e(40),i=e(33),o=e(46),a=e(88),s=r.navigator,u=!!s&&/MSIE .\./.test(s.userAgent),c=function(n){return u?function(e,t){return n(o(a,[].slice.call(arguments,2),"function"==typeof e?e:Function(e)),t)}:n};i(i.G+i.B+i.F*u,{setTimeout:c(r.setTimeout),setInterval:c(r.setInterval)})},{33:33,40:40,46:46,88:88}],327:[function(e,t,n){e(254),e(191),e(193),e(192),e(195),e(197),e(202),e(196),e(194),e(204),e(203),e(199),e(200),e(198),e(190),e(201),e(205),e(206),e(157),e(159),e(158),e(208),e(207),e(178),e(188),e(189),e(179),e(180),e(181),e(182),e(183),e(184),e(185),e(186),e(187),e(161),e(162),e(163),e(164),e(165),e(166),e(167),e(168),e(169),e(170),e(171),e(172),e(173),e(174),e(175),e(176),e(177),e(241),e(246),e(253),e(244),e(236),e(237),e(242),e(247),e(249),e(232),e(233),e(234),e(235),e(238),e(239),e(240),e(243),e(245),e(248),e(250),e(251),e(252),e(152),e(154),e(153),e(156),e(155),e(140),e(138),e(145),e(142),e(148),e(150),e(137),e(144),e(134),e(149),e(132),e(147),e(146),e(139),e(143),e(131),e(133),e(136),e(135),e(151),e(141),e(224),e(230),e(225),e(226),e(227),e(228),e(229),e(209),e(160),e(231),e(266),e(267),e(255),e(256),e(261),e(264),e(265),e(259),e(262),e(260),e(263),e(257),e(258),e(210),e(211),e(212),e(213),e(214),e(217),e(215),e(216),e(218),e(219),e(220),e(221),e(223),e(222),e(270),e(268),e(269),e(311),e(314),e(313),e(315),e(316),e(312),e(317),e(318),e(292),e(295),e(291),e(289),e(290),e(293),e(294),e(276),e(310),e(275),e(309),e(321),e(323),e(274),e(308),e(320),e(322),e(273),e(319),e(272),e(277),e(278),e(279),e(280),e(281),e(283),e(282),e(284),e(285),e(286),e(288),e(287),e(297),e(298),e(299),e(300),e(302),e(301),e(304),e(303),e(305),e(306),e(307),e(271),e(296),e(326),e(325),e(324),t.exports=e(23)},{131:131,132:132,133:133,134:134,135:135,136:136,137:137,138:138,139:139,140:140,141:141,142:142,143:143,144:144,145:145,146:146,147:147,148:148,149:149,150:150,151:151,152:152,153:153,154:154,155:155,156:156,157:157,158:158,159:159,160:160,161:161,162:162,163:163,164:164,165:165,166:166,167:167,168:168,169:169,170:170,171:171,172:172,173:173,174:174,175:175,176:176,177:177,178:178,179:179,180:180,181:181,182:182,183:183,184:184,185:185,186:186,187:187,188:188,189:189,190:190,191:191,192:192,193:193,194:194,195:195,196:196,197:197,198:198,199:199,200:200,201:201,202:202,203:203,204:204,205:205,206:206,207:207,208:208,209:209,210:210,211:211,212:212,213:213,214:214,215:215,216:216,217:217,218:218,219:219,220:220,221:221,222:222,223:223,224:224,225:225,226:226,227:227,228:228,229:229,23:23,230:230,231:231,232:232,233:233,234:234,235:235,236:236,237:237,238:238,239:239,240:240,241:241,242:242,243:243,244:244,245:245,246:246,247:247,248:248,249:249,250:250,251:251,252:252,253:253,254:254,255:255,256:256,257:257,258:258,259:259,260:260,261:261,262:262,263:263,264:264,265:265,266:266,267:267,268:268,269:269,270:270,271:271,272:272,273:273,274:274,275:275,276:276,277:277,278:278,279:279,280:280,281:281,282:282,283:283,284:284,285:285,286:286,287:287,288:288,289:289,290:290,291:291,292:292,293:293,294:294,295:295,296:296,297:297,298:298,299:299,300:300,301:301,302:302,303:303,304:304,305:305,306:306,307:307,308:308,309:309,310:310,311:311,312:312,313:313,314:314,315:315,316:316,317:317,318:318,319:319,320:320,321:321,322:322,323:323,324:324,325:325,326:326}],328:[function(e,P,t){(function(e){!function(e){"use strict";function o(e,t,n,r){var o,a,s,u,i=t&&t.prototype instanceof f?t:f,c=Object.create(i.prototype),l=new p(r||[]);return c._invoke=(o=e,a=n,s=l,u=S,function(e,t){if(u===T)throw new Error("Generator is already running");if(u===O){if("throw"===e)throw t;return v()}for(s.method=e,s.arg=t;;){var n=s.delegate;if(n){var r=d(n,s);if(r){if(r===R)continue;return r}}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if(u===S)throw u=O,s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);u=T;var i=h(o,a,s);if("normal"===i.type){if(u=s.done?O:C,i.arg===R)continue;return{value:i.arg,done:s.done}}"throw"===i.type&&(u=O,s.method="throw",s.arg=i.arg)}}),c}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}function f(){}function n(){}function t(){}function r(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function a(s){function u(e,t,n,r){var i=h(s[e],s,t);if("throw"!==i.type){var o=i.arg,a=o.value;return a&&"object"==typeof a&&m.call(a,"__await")?Promise.resolve(a.__await).then(function(e){u("next",e,n,r)},function(e){u("throw",e,n,r)}):Promise.resolve(a).then(function(e){o.value=e,n(o)},r)}r(i.arg)}var t;"object"==typeof e.process&&e.process.domain&&(u=e.process.domain.bind(u)),this._invoke=function(n,r){function e(){return new Promise(function(e,t){u(n,r,e,t)})}return t=t?t.then(e,e):e()}}function d(e,t){var n=e.iterator[t.method];if(n===c){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=c,d(e,t),"throw"===t.method))return R;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return R}var r=h(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,R;var i=r.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=c),t.delegate=null,R):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,R)}function i(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function s(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function p(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(i,this),this.reset(!0)}function u(t){if(t){var e=t[y];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,r=function e(){for(;++n<t.length;)if(m.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=c,e.done=!0,e};return r.next=r}}return{next:v}}function v(){return{value:c,done:!0}}var c,l=Object.prototype,m=l.hasOwnProperty,g="function"==typeof Symbol?Symbol:{},y=g.iterator||"@@iterator",b=g.asyncIterator||"@@asyncIterator",_=g.toStringTag||"@@toStringTag",w="object"==typeof P,E=e.regeneratorRuntime;if(E)w&&(P.exports=E);else{(E=e.regeneratorRuntime=w?P.exports:{}).wrap=o;var S="suspendedStart",C="suspendedYield",T="executing",O="completed",R={},A={};A[y]=function(){return this};var I=Object.getPrototypeOf,N=I&&I(I(u([])));N&&N!==l&&m.call(N,y)&&(A=N);var k=t.prototype=f.prototype=Object.create(A);n.prototype=k.constructor=t,t.constructor=n,t[_]=n.displayName="GeneratorFunction",E.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))},E.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,t):(e.__proto__=t,_ in e||(e[_]="GeneratorFunction")),e.prototype=Object.create(k),e},E.awrap=function(e){return{__await:e}},r(a.prototype),a.prototype[b]=function(){return this},E.AsyncIterator=a,E.async=function(e,t,n,r){var i=new a(o(e,t,n,r));return E.isGeneratorFunction(t)?i:i.next().then(function(e){return e.done?e.value:i.next()})},r(k),k[_]="Generator",k[y]=function(){return this},k.toString=function(){return"[object Generator]"},E.keys=function(n){var r=[];for(var e in n)r.push(e);return r.reverse(),function e(){for(;r.length;){var t=r.pop();if(t in n)return e.value=t,e.done=!1,e}return e.done=!0,e}},E.values=u,p.prototype={constructor:p,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=c,this.done=!1,this.delegate=null,this.method="next",this.arg=c,this.tryEntries.forEach(s),!e)for(var t in this)"t"===t.charAt(0)&&m.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=c)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(n){function e(e,t){return o.type="throw",o.arg=n,r.next=e,t&&(r.method="next",r.arg=c),!!t}if(this.done)throw n;for(var r=this,t=this.tryEntries.length-1;0<=t;--t){var i=this.tryEntries[t],o=i.completion;if("root"===i.tryLoc)return e("end");if(i.tryLoc<=this.prev){var a=m.call(i,"catchLoc"),s=m.call(i,"finallyLoc");if(a&&s){if(this.prev<i.catchLoc)return e(i.catchLoc,!0);if(this.prev<i.finallyLoc)return e(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return e(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return e(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;0<=n;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&m.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,R):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),R},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),s(n),R}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;s(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:u(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=c),R}}}}("object"==typeof e?e:"object"==typeof window?window:"object"==typeof self?self:this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1]),function(){"use strict";var y,d="undefined"!=typeof window&&"undefined"!=typeof document,h="undefined"!=typeof process&&process.versions&&process.versions.node,a="undefined"!=typeof process&&"string"==typeof process.platform&&process.platform.match(/^win/),C="undefined"!=typeof self?self:global,t="undefined"!=typeof Symbol;function e(e){return t?Symbol():"@@"+e}if("undefined"!=typeof document&&document.getElementsByTagName){if(!(y=document.baseURI)){var n=document.getElementsByTagName("base");y=n[0]&&n[0].href||window.location.href}}else"undefined"!=typeof location&&(y=location.href);if(y){var r=(y=y.split("#")[0].split("?")[0]).lastIndexOf("/");-1!==r&&(y=y.substr(0,r+1))}else{if("undefined"==typeof process||!process.cwd)throw new TypeError("No environment baseURI");y="file://"+(a?"/":"")+process.cwd(),a&&(y=y.replace(/\\/g,"/"))}"/"!==y[y.length-1]&&(y+="/");var o="_"==new Error(0,"_").fileName;function T(e,t){d||(t=t.replace(a?/file:\/\/\//g:/file:\/\//g,""));var n,r=(e.message||e)+"\n  "+t;n=o&&e.fileName?new Error(r,e.fileName,e.lineNumber):new Error(r);var i=e.originalErr?e.originalErr.stack:e.stack;return n.stack=h?r+"\n  "+i:i,n.originalErr=e.originalErr||e,n}function f(e,t){throw new RangeError('Unable to resolve "'+e+'" to '+t)}function b(e,t){e=e.trim();var n=t&&t.substr(0,t.indexOf(":")+1),r=e[0],i=e[1];if("/"===r&&"/"===i)return n||f(e,t),n+e;if("."===r&&("/"===i||"."===i&&("/"===e[2]||2===e.length&&(e+="/"))||1===e.length&&(e+="/"))||"/"===r){var o,a=!n||"/"!==t[n.length];if(a?(void 0===t&&f(e,t),o=t):o="/"===t[n.length+1]?"file:"!==n?(o=t.substr(n.length+2)).substr(o.indexOf("/")+1):t.substr(8):t.substr(n.length+1),"/"===r){if(!a)return t.substr(0,t.length-o.length-1)+e;f(e,t)}for(var s=o.substr(0,o.lastIndexOf("/")+1)+e,u=[],c=-1,l=0;l<s.length;l++)if(-1===c)if("."!==s[l])c=l;else{if("."!==s[l+1]||"/"!==s[l+2]&&l+2!==s.length){if("/"!==s[l+1]&&l+1!==s.length){c=l;continue}l+=1}else u.pop(),l+=2;a&&0===u.length&&f(e,t)}else"/"===s[l]&&(u.push(s.substring(c,l+1)),c=-1);return-1!==c&&u.push(s.substr(c)),t.substr(0,t.length-o.length)+u.join("")}return-1!==e.indexOf(":")?h&&":"===e[1]&&"\\"===e[2]&&e[0].match(/[a-z]/i)?"file:///"+e.replace(/\\/g,"/"):e:void 0}var i=Promise.resolve();function s(n){if(n.values)return n.values();if("undefined"==typeof Symbol||!Symbol.iterator)throw new Error("Symbol.iterator not supported in this browser");var e={};return e[Symbol.iterator]=function(){var e=Object.keys(n),t=0;return{next:function(){return t<e.length?{value:n[e[t++]],done:!1}:{value:void 0,done:!0}}}},e}function u(){this.registry=new _}function c(e){if(!(e instanceof O))throw new TypeError("Module instantiation did not return a valid namespace object.");return e}(u.prototype.constructor=u).prototype.import=function(t,n){if("string"!=typeof t)throw new TypeError("Loader import method must be passed a module key string");var e=this;return i.then(function(){return e[p](t,n)}).then(c).catch(function(e){throw T(e,"Loading "+t+(n?" from "+n:""))})};var l=u.resolve=e("resolve"),p=u.resolveInstantiate=e("resolveInstantiate");function v(e){if(void 0===e)throw new RangeError("No resolution found.");return e}u.prototype[p]=function(e,t){var n=this;return n.resolve(e,t).then(function(e){return n.registry.get(e)})},u.prototype.resolve=function(t,n){var e=this;return i.then(function(){return e[l](t,n)}).then(v).catch(function(e){throw T(e,"Resolving "+t+(n?" to "+n:""))})};var m="undefined"!=typeof Symbol&&Symbol.iterator,g=e("registry");function _(){this[g]={}}m&&(_.prototype[Symbol.iterator]=function(){return this.entries()[Symbol.iterator]()},_.prototype.entries=function(){var t=this[g];return s(Object.keys(t).map(function(e){return[e,t[e]]}))}),_.prototype.keys=function(){return s(Object.keys(this[g]))},_.prototype.values=function(){var t=this[g];return s(Object.keys(t).map(function(e){return t[e]}))},_.prototype.get=function(e){return this[g][e]},_.prototype.set=function(e,t){if(!(t instanceof O))throw new Error("Registry must be set with an instance of Module Namespace");return this[g][e]=t,this},_.prototype.has=function(e){return Object.hasOwnProperty.call(this[g],e)},_.prototype.delete=function(e){return!!Object.hasOwnProperty.call(this[g],e)&&(delete this[g][e],!0)};var w=e("baseObject");function O(e){Object.defineProperty(this,w,{value:e}),Object.keys(e).forEach(E,this)}function E(e){Object.defineProperty(this,e,{enumerable:!0,get:function(){return this[w][e]}})}O.prototype=Object.create(null),"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(O.prototype,Symbol.toStringTag,{value:"Module"});var S=e("register-internal");function R(){u.call(this);var n=this.registry.delete;this.registry.delete=function(e){var t=n.call(this,e);return r.hasOwnProperty(e)&&!r[e].linkRecord&&(delete r[e],t=!0),t};var r={};this[S]={lastRegister:void 0,records:r},this.trace=!1}var A=((R.prototype=Object.create(u.prototype)).constructor=R).instantiate=e("instantiate");function I(e,t,n){return e.records[t]={key:t,registration:n,module:void 0,importerSetters:void 0,loadError:void 0,evalError:void 0,linkRecord:{instantiatePromise:void 0,dependencies:void 0,execute:void 0,executingRequire:!1,moduleObj:void 0,setters:void 0,depsInstantiatePromise:void 0,dependencyInstantiations:void 0}}}function N(l,h,f,d,p){return f.instantiatePromise||(f.instantiatePromise=(h.registration?Promise.resolve():Promise.resolve().then(function(){return p.lastRegister=void 0,l[A](h.key,1<l[A].length&&(t=h,n=p,function(){var e=n.lastRegister;return e?(n.lastRegister=void 0,t.registration=e,!0):!!t.registration}));var t,n})).then(function(e){if(void 0!==e){if(!(e instanceof O))throw new TypeError("Instantiate did not return a valid Module object.");return delete p.records[h.key],l.trace&&P(l,h,f),d[h.key]=e}var t,n,r,i,o,a,s,u,c=h.registration;if(h.registration=void 0,!c)throw new TypeError("Module instantiation did not call an anonymous or correctly named System.register.");return f.dependencies=c[0],h.importerSetters=[],f.moduleObj={},c[2]?(f.moduleObj.default=f.moduleObj.__useDefault={},f.executingRequire=c[1],f.execute=c[2]):(t=l,n=h,r=f,i=c[1],o=r.moduleObj,a=n.importerSetters,s=!1,u=i.call(C,function(e,t){if("object"==typeof e){var n=!1;for(var r in e)t=e[r],"__useDefault"===r||r in o&&o[r]===t||(n=!0,o[r]=t);if(!1===n)return t}else{if((s||e in o)&&o[e]===t)return t;o[e]=t}for(var i=0;i<a.length;i++)a[i](o);return t},new x(t,n.key)),r.setters=u.setters,r.execute=u.execute,u.exports&&(r.moduleObj=o=u.exports,s=!0)),h}).catch(function(e){throw h.linkRecord=void 0,h.loadError=h.loadError||T(e,"Instantiating "+h.key)}))}function k(i,o,e,a,s,u){return i.resolve(o,e).then(function(e){u&&(u[o]=e);var t=s.records[e],n=a[e];if(n&&(!t||t.module&&n!==t.module))return n;if(t&&t.loadError)throw t.loadError;(!t||!n&&t.module)&&(t=I(s,e,t&&t.registration));var r=t.linkRecord;return r?N(i,t,r,a,s):t})}function P(e,t,n){e.loads=e.loads||{},e.loads[t.key]={key:t.key,deps:n.dependencies,dynamicDeps:[],depMap:n.depMap||{}}}function x(e,t){this.loader=e,this.key=this.id=t,this.meta={url:t}}R.prototype[R.resolve=u.resolve]=function(e,t){return b(e,t||y)},R.prototype[A]=function(e,t){},R.prototype[u.resolveInstantiate]=function(e,t){var r=this,i=this[S],o=this.registry[g];return function(n,e,t,r,i){var o=r[e];if(o)return Promise.resolve(o);var a=i.records[e];return a&&!a.module?a.loadError?Promise.reject(a.loadError):N(n,a,a.linkRecord,r,i):n.resolve(e,t).then(function(e){if(o=r[e])return o;if((a=i.records[e])&&!a.module||(a=I(i,e,a&&a.registration)),a.loadError)return Promise.reject(a.loadError);var t=a.linkRecord;return t?N(n,a,t,r,i):a})}(r,e,t,o,i).then(function(e){if(e instanceof O)return e;var u,t,c,l,n=e.linkRecord;if(!n){if(e.module)return e.module;throw e.evalError}return(u=r,t=e,c=o,l=i,new Promise(function(i,n){var r=[],o=0;function a(e){var t=e.linkRecord;t&&-1===r.indexOf(e)&&(r.push(e),o++,function(e,i,o,t,n){if(o.depsInstantiatePromise)return o.depsInstantiatePromise;for(var r=Array(o.dependencies.length),a=0;a<o.dependencies.length;a++)r[a]=k(e,o.dependencies[a],i.key,t,n,e.trace&&o.depMap||(o.depMap={}));var s=Promise.all(r).then(function(e){if(o.dependencyInstantiations=e,o.setters)for(var t=0;t<e.length;t++){var n=o.setters[t];if(n){var r=e[t];if(r instanceof O)n(r);else{if(r.loadError)throw r.loadError;n(r.module||r.linkRecord.moduleObj),r.importerSetters&&r.importerSetters.push(n)}}}return i});return e.trace&&(s=s.then(function(){return P(e,i,o),i})),(s=s.catch(function(e){throw o.depsInstantiatePromise=void 0,T(e,"Loading "+i.key)})).catch(function(){}),o.depsInstantiatePromise=s}(u,e,t,c,l).then(s,n))}function s(e){o--;var t=e.linkRecord;if(t)for(var n=0;n<t.dependencies.length;n++){var r=t.dependencyInstantiations[n];r instanceof O||a(r)}0===o&&i()}a(t)})).then(function(){return function S(e,t,n,r,i,o){if(t.module)return t.module;if(t.evalError)throw t.evalError;if(o&&-1!==o.indexOf(t))return t.linkRecord.moduleObj;var a=function e(t,n,r,i,o,a){var s,u,c,l,h,f,d,p;if(a.push(n),r.setters)for(var v,m,g=0;g<r.dependencies.length;g++)if(!((v=r.dependencyInstantiations[g])instanceof O)&&((m=v.linkRecord)&&-1===a.indexOf(v)&&(s=v.evalError?v.evalError:e(t,v,m,i,o,m.setters?a:[])),s))return n.linkRecord=void 0,n.evalError=T(s,"Evaluating "+n.key),n.evalError;if(r.execute)if(r.setters)s=function(e){try{e.call(D)}catch(e){return e}}(r.execute);else{var y={id:n.key},b=r.moduleObj;Object.defineProperty(y,"exports",{configurable:!0,set:function(e){b.default=b.__useDefault=e},get:function(){return b.__useDefault}});var _=(u=t,c=n.key,l=r.dependencies,h=r.dependencyInstantiations,f=i,d=o,p=a,function(e){for(var t=0;t<l.length;t++)if(l[t]===e){var n,r=h[t];return"__useDefault"in(n=r instanceof O?r:S(u,r,r.linkRecord,f,d,p))?n.__useDefault:n}throw new Error("Module "+e+" not declared as a System.registerDynamic dependency of "+c)});if(!r.executingRequire)for(g=0;g<r.dependencies.length;g++)_(r.dependencies[g]);s=function(e,t,n,r){try{var i=e.call(C,t,n,r);void 0!==i&&(r.exports=i)}catch(e){return e}}(r.execute,_,b.default,y),y.exports!==b.__useDefault&&(b.default=b.__useDefault=y.exports);var w=b.default;if(w&&w.__esModule)for(var E in w)Object.hasOwnProperty.call(w,E)&&(b[E]=w[E])}if(n.linkRecord=void 0,s)return n.evalError=T(s,"Evaluating "+n.key);if(i[n.key]=n.module=new O(r.moduleObj),!r.setters){if(n.importerSetters)for(g=0;g<n.importerSetters.length;g++)n.importerSetters[g](n.module);n.importerSetters=void 0}}(e,t,n,r,i,n.setters?[]:o||[]);if(a)throw a;return t.module}(r,e,n,o,i,void 0)})})},R.prototype.register=function(e,t,n){var r=this[S];void 0===n?r.lastRegister=[e,t,void 0]:(r.records[e]||I(r,e,void 0)).registration=[t,n,void 0]},R.prototype.registerDynamic=function(e,t,n,r){var i=this[S];"string"!=typeof e?i.lastRegister=[e,t,n]:(i.records[e]||I(i,e,void 0)).registration=[t,n,r]},x.prototype.import=function(e){return this.loader.trace&&this.loader.loads[this.key].dynamicDeps.push(e),this.loader.import(e,this.key)};var D={};Object.freeze&&Object.freeze(D);var M=Promise.resolve();function L(){}var F,V,j=new O({}),U=e("loader-config"),B=e("metadata"),q="undefined"==typeof window&&"undefined"!=typeof self&&"undefined"!=typeof importScripts;function W(e,t){(t||this.warnings&&"undefined"!=typeof console&&console.warn)&&console.warn(e)}function H(e,t){for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}function G(e,t){for(var n in t)Object.hasOwnProperty.call(t,n)&&void 0===e[n]&&(e[n]=t[n]);return e}function K(e,t,n){for(var r in t)if(Object.hasOwnProperty.call(t,r)){var i=t[r];void 0===e[r]?e[r]=i:i instanceof Array&&e[r]instanceof Array?e[r]=[].concat(n?i:e[r]).concat(n?e[r]:i):"object"==typeof i&&null!==i&&"object"==typeof e[r]?e[r]=(n?G:H)(H({},e[r]),i):n||(e[r]=i)}}var $=!1,z=!1;function Q(e){if($||z){var t=document.createElement("link");$?(t.rel="preload",t.as="script"):t.rel="prefetch",t.href=e,document.head.appendChild(t)}else(new Image).src=e}if(d&&function(){var e=document.createElement("link").relList;if(e&&e.supports){z=!0;try{$=e.supports("preload")}catch(e){}}}(),d){var Y=window.onerror;window.onerror=function(e,t){Y&&Y.apply(this,arguments)}}function X(e,t){for(var n=e.split(".");n.length;)t=t[n.shift()];return t}function J(e,t,n){var r=ee(t,n);if(r){var i=t[r]+n.substr(r.length),o=b(i,y);return void 0!==o?o:e+i}return-1!==n.indexOf(":")?n:e+n}function Z(e){var t=this.name;if(t.substr(0,e.length)===e&&(t.length===e.length||"/"===t[e.length]||"/"===e[e.length-1]||":"===e[e.length-1])){var n=e.split("/").length;n>this.len&&(this.match=e,this.len=n)}}function ee(e,t){if(Object.hasOwnProperty.call(e,t))return t;var n={name:t,match:void 0,len:0};return Object.keys(e).forEach(Z,n),n.match}var te,ne=/(?:^\uFEFF?|[^$_a-zA-Z\xA0-\uFFFF."'])require\s*\(\s*("[^"\\]*(?:\\.[^"\\]*)*"|'[^'\\]*(?:\\.[^'\\]*)*'|`[^`\\]*(?:\\.[^`\\]*)*`)\s*\)/g;function re(e,t,n,r){if("file:///"===e.substr(0,8)){if(oe)return ie(e,t,n,r);throw new Error("Unable to fetch file URLs in this environment.")}e=e.replace(/#/g,"%23");var i={headers:{Accept:"application/x-es-module, */*"}};return n&&(i.integrity=n),t&&("string"==typeof t&&(i.headers.Authorization=t),i.credentials="include"),fetch(e,i).then(function(e){if(e.ok)return r?e.arrayBuffer():e.text();throw new Error("Fetch error: "+e.status+" "+e.statusText)})}function ie(o,a,e,s){return new Promise(function(e,t){o=o.replace(/#/g,"%23");var n=new XMLHttpRequest;function r(){e(s?n.response:n.responseText)}function i(){t(new Error("XHR error: "+(n.status?" ("+n.status+(n.statusText?" "+n.statusText:"")+")":"")+" loading "+o))}s&&(n.responseType="arraybuffer"),n.onreadystatechange=function(){4===n.readyState&&(0==n.status?n.response?r():(n.addEventListener("error",i),n.addEventListener("load",r)):200===n.status?r():i())},n.open("GET",o,!0),n.setRequestHeader&&(n.setRequestHeader("Accept","application/x-es-module, */*"),a&&("string"==typeof a&&n.setRequestHeader("Authorization",a),n.withCredentials=!0)),n.send(null)})}var oe="undefined"!=typeof XMLHttpRequest,ae="undefined"!=typeof fetch,se="undefined"!=typeof self&&void 0!==self.fetch?re:oe?ie:"undefined"!=typeof require&&"undefined"!=typeof process?function(e,t,n,o){return"file:///"!=e.substr(0,8)?ae?re(e,t,n,o):Promise.reject(new Error('Unable to fetch "'+e+'". Only file URLs of the form file:/// supported running in Node without fetch.')):(te=te||require("fs"),e=a?e.replace(/\//g,"\\").substr(8):e.substr(7),new Promise(function(r,i){te.readFile(e,function(e,t){if(e)return i(e);if(o)r(t);else{var n=t+"";"\ufeff"===n[0]&&(n=n.substr(1)),r(n)}})}))}:function(){throw new Error("No fetch method is defined for this environment.")};function ue(e,t,n){var r,i={pluginKey:void 0,pluginArgument:void 0,pluginModule:void 0,packageKey:void 0,packageConfig:void 0,load:void 0};return n&&(t.pluginFirst?-1!==(r=n.lastIndexOf("!"))&&(i.pluginArgument=i.pluginKey=n.substr(0,r)):-1!==(r=n.indexOf("!"))&&(i.pluginArgument=i.pluginKey=n.substr(r+1)),i.packageKey=ee(t.packages,n),i.packageKey&&(i.packageConfig=t.packages[i.packageKey])),i}function ce(e,t){var n=de(e.pluginFirst,t);if(n){var r=ce.call(this,e,n.plugin);return pe(e.pluginFirst,le.call(this,e,n.argument,void 0,!1,!1),r)}return le.call(this,e,t,void 0,!1,!1)}function le(e,t,n,r,i){var o=b(t,n||y);if(o)return J(e.baseURL,e.paths,o);if(r){var a=ee(e.map,t);if(a&&(o=b(t=e.map[a]+t.substr(a.length),y)))return J(e.baseURL,e.paths,o)}if(this.registry.has(t))return t;if("@node/"===t.substr(0,6))return t;var s=i&&"/"!==t[t.length-1],u=J(e.baseURL,e.paths,s?t+"/":t);return s?u.substr(0,u.length-1):u}function he(e,t,n,r,i,o){if(i&&i.packageConfig&&"."!==t[0]){var a=i.packageConfig.map,s=a&&ee(a,t);if(s&&"string"==typeof a[s]){var u=ge(this,e,i.packageConfig,i.packageKey,s,t,r,o);if(u)return u}}var c=le.call(this,e,t,n,!0,!0),l=_e(e,c);if(r.packageKey=l&&l.packageKey||ee(e.packages,c),!r.packageKey)return c;if(-1!==e.packageConfigKeys.indexOf(c))return r.packageKey=void 0,c;r.packageConfig=e.packages[r.packageKey]||(e.packages[r.packageKey]={defaultExtension:void 0,main:void 0,format:void 0,meta:void 0,map:void 0,packageConfig:void 0,configured:!1});var h=c.substr(r.packageKey.length+1);return function(e,t,n,r,i,o,a){if(!i){if(!n.main)return r;i="./"===n.main.substr(0,2)?n.main.substr(2):n.main}if(n.map){var s="./"+i,u=ee(n.map,s);if(u||(s="./"+ve(t,n,r,i,a))!="./"+i&&(u=ee(n.map,s)),u){var c=ge(e,t,n,r,u,s,o,a);if(c)return c}}return r+"/"+ve(t,n,r,i,a)}(this,e,r.packageConfig,r.packageKey,h,r,o)}function fe(u,c,l,h,n,f){var d=this;return M.then(function(){if(n&&n.packageConfig&&"./"!==c.substr(0,2)){var e=n.packageConfig.map,t=e&&ee(e,c);if(t)return ye(d,u,n.packageConfig,n.packageKey,t,c,h,f)}return M}).then(function(e){if(e)return e;var t,n,r,i,o,a=le.call(d,u,c,l,!0,!0),s=_e(u,a);return h.packageKey=s&&s.packageKey||ee(u.packages,a),h.packageKey?-1!==u.packageConfigKeys.indexOf(a)?(h.packageKey=void 0,h.load={extension:"",deps:void 0,format:void 0,loader:void 0,scriptLoad:void 0,globals:void 0,nonce:void 0,integrity:void 0,sourceMap:void 0,exports:void 0,encapsulateGlobal:!1,crossOrigin:void 0,cjsRequireDetection:!0,cjsDeferDepsExecute:!1,esModule:!1},h.load.format="json",h.load.loader="",Promise.resolve(a)):(h.packageConfig=u.packages[h.packageKey]||(u.packages[h.packageKey]={defaultExtension:void 0,main:void 0,format:void 0,meta:void 0,map:void 0,packageConfig:void 0,configured:!1}),(s&&!h.packageConfig.configured?(t=d,n=u,r=s.configPath,i=h,o=t.pluginLoader||t,-1===n.packageConfigKeys.indexOf(r)&&n.packageConfigKeys.push(r),o.import(r).then(function(e){Ne(i.packageConfig,e,i.packageKey,!0,n),i.packageConfig.configured=!0}).catch(function(e){throw T(e,"Unable to fetch package configuration file "+r)})):M).then(function(){var e=a.substr(h.packageKey.length+1);return function(e,t,n,r,i,o,a){if(!i){if(!n.main)return Promise.resolve(r);i="./"===n.main.substr(0,2)?n.main.substr(2):n.main}var s,u;return n.map&&(s="./"+i,(u=ee(n.map,s))||(s="./"+ve(t,n,r,i,a))!="./"+i&&(u=ee(n.map,s))),(u?ye(e,t,n,r,u,s,o,a):M).then(function(e){return e?Promise.resolve(e):Promise.resolve(r+"/"+ve(t,n,r,i,a))})}(d,u,h.packageConfig,h.packageKey,e,h,f)})):Promise.resolve(a)})}function de(e,t){var n,r,i=e?t.indexOf("!"):t.lastIndexOf("!");if(-1!==i)return e?(n=t.substr(i+1),r=t.substr(0,i)):(n=t.substr(0,i),r=t.substr(i+1)||n.substr(n.lastIndexOf(".")+1)),{argument:n,plugin:r}}function pe(e,t,n){return e?n+"!"+t:t+"!"+n}function ve(e,t,n,r,i){if(!r||!t.defaultExtension||"/"===r[r.length-1]||i)return r;var o=!1;if(t.meta&&we(t.meta,r,function(e,t,n){if(0===n||e.lastIndexOf("*")!==e.length-1)return o=!0}),!o&&e.meta&&we(e.meta,n+"/"+r,function(e,t,n){if(0===n||e.lastIndexOf("*")!==e.length-1)return o=!0}),o)return r;var a="."+t.defaultExtension;return r.substr(r.length-a.length)!==a?r+a:r}function me(e,t,n){return!(t.substr(0,e.length)===e&&n.length>e.length)}function ge(e,t,n,r,i,o,a,s){"/"===o[o.length-1]&&(o=o.substr(0,o.length-1));var u=n.map[i];if("object"==typeof u)throw new Error("Synchronous conditional normalization not supported sync normalizing "+i+" in "+r);if(me(i,u,o)&&"string"==typeof u)return he.call(e,t,u+o.substr(i.length),r+"/",a,a,s)}function ye(t,n,e,r,i,o,a,s){"/"===o[o.length-1]&&(o=o.substr(0,o.length-1));var u=e.map[i];if("string"==typeof u)return me(i,u,o)?fe.call(t,n,u+o.substr(i.length),r+"/",a,a,s).then(function(e){return Oe.call(t,e,r+"/",a)}):M;var c=[],l=[];for(var h in u){var f=Se(h);l.push({condition:f,map:u[h]}),c.push(R.prototype.import.call(t,f.module,r))}return Promise.all(c).then(function(e){for(var t=0;t<l.length;t++){var n=l[t].condition,r=X(n.prop,"__useDefault"in e[t]?e[t].__useDefault:e[t]);if(!n.negate&&r||n.negate&&!r)return l[t].map}}).then(function(e){if(e)return me(i,e,o)?fe.call(t,n,e+o.substr(i.length),r+"/",a,a,s).then(function(e){return Oe.call(t,e,r+"/",a)}):M})}var be={};function _e(e,t){for(var n,r,i,o,a,s=!1,u=0;u<e.packageConfigPaths.length;u++){var c=e.packageConfigPaths[u],l=be[c]||(be[c]=(o=(i=c).lastIndexOf("*"),{length:a=Math.max(o+1,i.lastIndexOf("/")),regEx:new RegExp("^("+i.substr(0,a).replace(/[.+?^${}()|[\]\\]/g,"\\$&").replace(/\*/g,"[^\\/]+")+")(\\/|$)"),wildcard:-1!==o}));if(!(t.length<l.length)){var h=t.match(l.regEx);!h||n&&(s&&l.wildcard||!(n.length<h[1].length))||(n=h[1],s=!l.wildcard,r=n+c.substr(l.length))}}if(n)return{packageKey:n,configPath:r}}function we(e,t,n){var r;for(var i in e){var o="./"===i.substr(0,2)?"./":"";if(o&&(i=i.substr(2)),-1!==(r=i.indexOf("*"))&&i.substr(0,r)===t.substr(0,r)&&i.substr(r+1)===t.substr(t.length-i.length+r+1)&&n(i,e[o+i],i.split("/").length))return}var a=e[t]&&Object.hasOwnProperty.call(e,t)?e[t]:e["./"+t];a&&n(a,a,0)}var Ee=["browser","node","dev","build","production","default"];function Se(e){var t,n,r,i=e.lastIndexOf("|");return-1!==i?(t=e.substr(i+1),n=e.substr(0,i),"~"===t[0]&&(r=!0,t=t.substr(1))):(r="~"===e[0],t="default",n=e.substr(r),-1!==Ee.indexOf(n)&&(t=n,n=null)),{module:n||"@system-env",prop:t,negate:r}}function Ce(n,e,r){return R.prototype.import.call(this,n.module,e).then(function(e){var t=X(n.prop,e);if(r&&"boolean"!=typeof t)throw new TypeError("Condition did not resolve to a boolean.");return n.negate?!t:t})}var Te=/#\{[^\}]+\}/;function Oe(t,n,e){var r=t.match(Te);if(!r)return Promise.resolve(t);var i=Se.call(this,r[0].substr(2,r[0].length-3));return Ce.call(this,i,n,!1).then(function(e){if("string"!=typeof e)throw new TypeError("The condition value for "+t+" doesn't resolve to a string.");if(-1!==e.indexOf("/"))throw new TypeError("Unabled to interpolate conditional "+t+(n?" in "+n:"")+"\n\tThe condition value "+e+' cannot contain a "/" separator.');return t.replace(Te,e)})}var Re=["browserConfig","nodeConfig","devConfig","buildConfig","productionConfig"];function Ae(e,t,n){for(var r=0;r<Re.length;r++){var i=Re[r];t[i]&&St[i.substr(0,i.length-6)]&&n(t[i])}}function Ie(e,t){var n=e[t];return n instanceof Array?e[t].concat([]):"object"==typeof n?function e(t,n){var r={};for(var i in t){var o=t[i];1<n?o instanceof Array?r[i]=[].concat(o):"object"==typeof o?r[i]=e(o,n-1):"packageConfig"!==i&&(r[i]=o):r[i]=o}return r}(n,3):e[t]}function Ne(e,t,n,r,i){for(var o in t)"main"===o||"format"===o||"defaultExtension"===o||"configured"===o?r&&void 0!==e[o]||(e[o]=t[o]):"map"===o?(r?G:H)(e.map=e.map||{},t.map):"meta"===o?(r?G:H)(e.meta=e.meta||{},t.meta):Object.hasOwnProperty.call(t,o)&&W.call(i,'"'+o+'" is not a valid package configuration option in package '+n);return void 0===e.defaultExtension&&(e.defaultExtension="js"),void 0===e.main&&e.map&&e.map["."]?(e.main=e.map["."],delete e.map["."]):"object"==typeof e.main&&(e.map=e.map||{},e.map["./@main"]=e.main,e.main.default=e.main.default||"./",e.main="@main"),e}var ke="undefined"!=typeof Buffer;try{ke&&"YQ=="!==new Buffer("a").toString("base64")&&(ke=!1)}catch(e){ke=!1}var Pe,xe,De,Me,Le="\n//# sourceMappingURL=data:application/json;base64,";function Fe(e,t,n,r){var i,o=e.lastIndexOf("\n");if(t){if("object"!=typeof t)throw new TypeError("load.metadata.sourceMap must be set to an object.");t=JSON.stringify(t)}return(r?"(function(System, SystemJS) {":"")+e+(r?"\n})(System, System);":"")+("\n//# sourceURL="!=e.substr(o,15)?"\n//# sourceURL="+n+(t?"!transpiled":""):"")+(t&&(i=t,ke?Le+new Buffer(i).toString("base64"):"undefined"!=typeof btoa?Le+btoa(unescape(encodeURIComponent(i))):"")||"")}var Ve=0;function je(e){0==Ve++&&(Me=C.System),C.System=C.SystemJS=e}function Ue(){0==--Ve&&(C.System=C.SystemJS=Me)}var Be,qe=!1;function We(e,t,n,r,i,o,a){if(t){if(o&&qe)return function(e,t,n,r,i){Pe||(Pe=document.head||document.body||document.documentElement);var o=document.createElement("script");o.text=Fe(t,n,r,!1);var a,s=window.onerror;if(window.onerror=function(e){a=addToError(e,"Evaluating "+r),s&&s.apply(this,arguments)},je(e),i&&o.setAttribute("nonce",i),Pe.appendChild(o),Pe.removeChild(o),Ue(),window.onerror=s,a)return a}(e,t,n,r,o);try{je(e),!xe&&e._nodeRequire&&(xe=e._nodeRequire("vm"),De=xe.runInThisContext("typeof System !== 'undefined' && System")===e),De?xe.runInThisContext(Fe(t,n,r,!a),{filename:r+(n?"!transpiled":"")}):(0,eval)(Fe(t,n,r,!a)),Ue()}catch(e){return Ue(),e}}}function He(e){return"file:///"===e.substr(0,8)?e.substr(7+!!a):Be&&e.substr(0,Be.length)===Be?e.substr(Be.length):e}function Ge(e,t){return He(this.normalizeSync(e,t))}function Ke(e){var t,n=e.lastIndexOf("!"),r=(t=-1!==n?e.substr(0,n):e).split("/");return r.pop(),r=r.join("/"),{filename:He(t),dirname:He(r)}}d&&"undefined"!=typeof document&&document.getElementsByTagName&&(window.chrome&&window.chrome.extension||navigator.userAgent.match(/^Node\.js/)||(qe=!0)),"undefined"!=typeof window&&"undefined"!=typeof document&&window.location&&(Be=location.protocol+"//"+location.hostname+(location.port?":"+location.port:""));var $e,ze=/(^|[^\\])(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,Qe=/("[^"\\\n\r]*(\\.[^"\\\n\r]*)*"|'[^'\\\n\r]*(\\.[^'\\\n\r]*)*')/g,Ye=["_g","sessionStorage","localStorage","clipboardData","frames","frameElement","external","mozAnimationStartTime","mozPaintCount","webkitStorageInfo","webkitIndexedDB","mozInnerScreenY","mozInnerScreenX"];function Xe(e){if(-1===Ye.indexOf(e)){try{var t=C[e]}catch(t){Ye.push(e)}this(e,t)}}function Je(e){if("string"==typeof e)return X(e,C);if(!(e instanceof Array))throw new Error("Global exports must be a string or array.");for(var t={},n=0;n<e.length;n++)t[e[n].split(".").pop()]=X(e[n],C);return t}function Ze(e,o,t,a){var s,u=C.define;if(C.define=void 0,t)for(var n in s={},t)s[n]=C[n],C[n]=t[n];return o||($e={},Object.keys(C).forEach(Xe,function(e,t){$e[e]=t})),function(){var n,r=o?Je(o):{},i=!!o;if(o&&!a||Object.keys(C).forEach(Xe,function(e,t){$e[e]!==t&&void 0!==t&&(a&&(C[e]=void 0),o||(r[e]=t,void 0!==n?i||n===t||(i=!0):n=t))}),r=i?r:n,s)for(var e in s)C[e]=s[e];return C.define=u,r}}var et="(?:^|[^$_a-zA-Z\\xA0-\\uFFFF.])",tt="\\s*\\(\\s*(\"([^\"]+)\"|'([^']+)')\\s*\\)",nt=/\(([^\)]*)\)/,rt=/^\s+|\s+$/g,it={};function ot(r){return function(e,t,n){r(e,t,n),"object"!=typeof(t=n.exports)&&"function"!=typeof t||"__esModule"in t||Object.defineProperty(n.exports,"__esModule",{value:!0})}}var at,st,ut,ct=!1,lt=!1,ht=(d||q)&&"undefined"!=typeof navigator&&navigator.userAgent&&!navigator.userAgent.match(/MSIE (9|10).0/);function ft(e,t){!e.load.esModule||"object"!=typeof t&&"function"!=typeof t||"__esModule"in t||Object.defineProperty(t,"__esModule",{value:!0})}function dt(d,p,e,v,m){return Promise.resolve(e).then(function(h){return"detect"===v.load.format&&(v.load.format=void 0),function(e,t){var n=h.match(Ct);if(n)for(var r=n[0].match(Tt),i=0;i<r.length;i++){var o=r[i],a=o.length,s=o.substr(0,1);if(";"==o.substr(a-1,1)&&a--,'"'==s||"'"==s){var u=o.substr(1,o.length-3),c=u.substr(0,u.indexOf(" "));if(c){var l=u.substr(c.length+1,u.length-c.length-1);"deps"===c&&(c="deps[]"),"[]"===c.substr(c.length-2,2)?(c=c.substr(0,c.length-2),t.load[c]=t.load[c]||[],t.load[c].push(l)):"use"!==c&&Ot(t.load,c,l)}else t.load[u]=!0}}}(0,v),v.pluginModule?(v.pluginLoad.source=h,v.pluginModule.translate?Promise.resolve(v.pluginModule.translate.call(d,v.pluginLoad,v.traceOpts)).then(function(e){if(v.load.sourceMap){if("object"!=typeof v.load.sourceMap)throw new Error("metadata.load.sourceMap must be set to an object.");wt(v.pluginLoad.address,v.load.sourceMap)}return"string"==typeof e?e:v.pluginLoad.source}):h):h}).then(function(e){return v.load.format||'"bundle"'!==e.substring(0,8)?"register"===v.load.format||!v.load.format&&gt(e)?(v.load.format="register",e):"esm"===v.load.format||!v.load.format&&e.match(vt)?(v.load.format="esm",function(t,n,r,i,e){if(!t.transpiler)throw new TypeError("Unable to dynamically transpile ES module\n   A loader plugin needs to be configured via `SystemJS.config({ transpiler: 'transpiler-module' })`.");if(i.load.deps){for(var o="",a=0;a<i.load.deps.length;a++)o+='import "'+i.load.deps[a]+'"; ';n=o+n}return t.import.call(t,t.transpiler).then(function(e){if(!(e=e.__useDefault||e).translate)throw new Error(t.transpiler+" is not a valid transpiler plugin.");return e===i.pluginModule?n:("string"==typeof i.load.sourceMap&&(i.load.sourceMap=JSON.parse(i.load.sourceMap)),i.pluginLoad=i.pluginLoad||{name:r,address:r,source:n,metadata:i.load},i.load.deps=i.load.deps||[],Promise.resolve(e.translate.call(t,i.pluginLoad,i.traceOpts)).then(function(e){var t=i.load.sourceMap;return t&&"object"==typeof t&&wt(r,t),"esm"===i.load.format&&gt(e)&&(i.load.format="register"),e}))},function(e){throw T(e,"Unable to load transpiler to transpile "+r)})}(d,e,p,v)):e:(v.load.format="system",e)}).then(function(n){if("string"!=typeof n||!v.pluginModule||!v.pluginModule.instantiate)return n;var r=!1;return v.pluginLoad.source=n,Promise.resolve(v.pluginModule.instantiate.call(d,v.pluginLoad,function(e){if(n=e.source,v.load=e.metadata,r)throw new Error("Instantiate must only be called once.");r=!0})).then(function(e){return r?n:(t=e)instanceof O?t:t&&t.__esModule?new O(t):new O({default:t,__useDefault:t});var t})}).then(function(l){if("string"!=typeof l)return l;var e;v.load.format||(v.load.format=(e=l).match(yt)?"amd":(bt.lastIndex=0,ne.lastIndex=0,ne.exec(e)||bt.exec(e)?"cjs":"global"));var t,n,r,i=!1;switch(v.load.format){case"esm":case"register":case"system":if(s=We(d,l,v.load.sourceMap,p,v.load.integrity,v.load.nonce,!1))throw s;return m()?void 0:j;case"json":var o=JSON.parse(l);return d.newModule({default:o,__useDefault:o});case"amd":var a=C.define;C.define=d.amdDefine,n=v.load.deps,r=v.load.esModule,st=n,lt=r,at=void 0,ct=!1;var s=We(d,l,v.load.sourceMap,p,v.load.integrity,v.load.nonce,!1);if((i=m())||(t=d,at?t.registerDynamic(st?at[0].concat(st):at[0],!1,lt?ot(at[1]):at[1]):ct&&t.registerDynamic([],!1,L),i=m()),C.define=a,s)throw s;break;case"cjs":var h=v.load.deps,u=(v.load.deps||[]).concat(v.load.cjsRequireDetection?function(e){ne.lastIndex=ze.lastIndex=Qe.lastIndex=0;var t,n=[],r=[],i=[];function o(e,t){for(var n=0;n<e.length;n++)if(e[n][0]<t.index&&e[n][1]>t.index)return!0;return!1}if(e.length/e.split("\n").length<200){for(;t=Qe.exec(e);)r.push([t.index,t.index+t[0].length]);for(;t=ze.exec(e);)o(r,t)||i.push([t.index+t[1].length,t.index+t[0].length-1])}for(;t=ne.exec(e);)if(!o(r,t)&&!o(i,t)){var a=t[1].substr(1,t[1].length-2);if(a.match(/"|'/))continue;n.push(a)}return n}(l):[]);for(var c in v.load.globals)v.load.globals[c]&&u.push(v.load.globals[c]);d.registerDynamic(u,!0,function(e,t,n){if(e.resolve=function(e){return Ge.call(d,e,n.id)},n.paths=[],n.require=e,!v.load.cjsDeferDepsExecute&&h)for(var r=0;r<h.length;r++)e(h[r]);var i=Ke(n.id),o={exports:t,args:[e,t,n,i.filename,i.dirname,C,C]},a="(function (require, exports, module, __filename, __dirname, global, GLOBAL";if(v.load.globals)for(var s in v.load.globals)o.args.push(e(v.load.globals[s])),a+=", "+s;var u=C.define;C.define=void 0,C.__cjsWrapper=o,l=a+") {"+l.replace(_t,"")+"\n}).apply(__cjsWrapper.exports, __cjsWrapper.args);";var c=We(d,l,v.load.sourceMap,p,v.load.integrity,v.load.nonce,!1);if(c)throw c;ft(v,t),C.__cjsWrapper=void 0,C.define=u}),i=m();break;case"global":for(var c in u=v.load.deps||[],v.load.globals){var f=v.load.globals[c];f&&u.push(f)}d.registerDynamic(u,!1,function(e,t,n){var r;if(v.load.globals)for(var i in r={},v.load.globals)v.load.globals[i]&&(r[i]=e(v.load.globals[i]));var o=v.load.exports;o&&(l+="\n"+pt+'["'+o+'"] = '+o+";");var a=Ze(n.id,o,r,v.load.encapsulateGlobal),s=We(d,l,v.load.sourceMap,p,v.load.integrity,v.load.nonce,!0);if(s)throw s;var u=a();return ft(v,u),u}),i=m();break;default:throw new TypeError('Unknown module format "'+v.load.format+'" for "'+p+'".'+("es6"===v.load.format?' Use "esm" instead here.':""))}if(!i)throw new Error("Module "+p+" detected as "+v.load.format+" but didn't execute correctly.")})}"undefined"==typeof require||"undefined"==typeof process||process.browser||(ut=require);var pt="undefined"!=typeof self?"self":"global",vt=/(^\s*|[}\);\n]\s*)(import\s*(['"]|(\*\s+as\s+)?(?!type)([^"'\(\)\n; ]+)\s*from\s*['"]|\{)|export\s+\*\s+from\s+["']|export\s*(\{|default|function|class|var|const|let|async\s+function))/,mt=/^(\s*\/\*[^\*]*(\*(?!\/)[^\*]*)*\*\/|\s*\/\/[^\n]*|\s*"[^"]+"\s*;?|\s*'[^']+'\s*;?)*\s*/;function gt(e){var t=e.match(mt);if(!t)return!1;var n=t[0].length;return e.startsWith("System.register",n)||e.startsWith("SystemJS.register",n)}var yt=/(?:^\uFEFF?|[^$_a-zA-Z\xA0-\uFFFF.])define\s*\(\s*("[^"]+"\s*,\s*|'[^']+'\s*,\s*)?\s*(\[(\s*(("[^"]+"|'[^']+')\s*,|\/\/.*\r?\n|\/\*(.|\s)*?\*\/))*(\s*("[^"]+"|'[^']+')\s*,?)?(\s*(\/\/.*\r?\n|\/\*(.|\s)*?\*\/))*\s*\]|function\s*|{|[_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*\))/,bt=/(?:^\uFEFF?|[^$_a-zA-Z\xA0-\uFFFF.])(exports\s*(\[['"]|\.)|module(\.exports|\['exports'\]|\["exports"\])\s*(\[['"]|[=,\.]))/,_t=/^\#\!.*/;function wt(e,t){var n=e.split("!")[0];t.file&&t.file!=e||(t.file=n+"!transpiled"),(!t.sources||t.sources.length<=1&&(!t.sources[0]||t.sources[0]===e))&&(t.sources=[n])}var Et,St,Ct=/^(\s*\/\*[^\*]*(\*(?!\/)[^\*]*)*\*\/|\s*\/\/[^\n]*|\s*"[^"]+"\s*;?|\s*'[^']+'\s*;?)+/,Tt=/\/\*[^\*]*(\*(?!\/)[^\*]*)*\*\/|\/\/[^\n]*|"[^"]+"\s*;?|'[^']+'\s*;?/g;function Ot(e,t,n){for(var r,i=t.split(".");1<i.length;)e=e[r=i.shift()]=e[r]||{};void 0===e[r=i.shift()]&&(e[r]=n)}if("undefined"==typeof Promise)throw new Error("SystemJS needs a Promise polyfill.");if("undefined"!=typeof document){var Rt=document.getElementsByTagName("script"),At=Rt[Rt.length-1];document.currentScript&&(At.defer||At.async)&&(At=document.currentScript),Et=At&&At.src}else if("undefined"!=typeof importScripts)try{throw new Error("_")}catch(e){e.stack.replace(/(?:at|@).*(http.+):[\d]+:[\d]+/,function(e,t){Et=t})}else"undefined"!=typeof __filename&&(Et=__filename);function It(){var e;R.call(this),this._loader={},this[B]={},this[U]={baseURL:y,paths:{},packageConfigPaths:[],packageConfigKeys:[],map:{},packages:{},depCache:{},meta:{},bundles:{},production:!1,transpiler:void 0,loadedBundles:{},warnings:!1,pluginFirst:!1,wasm:!1},this.scriptSrc=Et,this._nodeRequire=ut,this.registry.set("@empty",j),Nt.call(this,!1,!1),(e=this).set("@@cjs-helpers",e.newModule({requireResolve:Ge.bind(e),getPathVars:Ke})),e.set("@@global-helpers",e.newModule({prepareGlobal:Ze})),function(d){function p(e,t,n,r){if("object"==typeof e&&!(e instanceof Array))return p.apply(null,Array.prototype.splice.call(arguments,1,arguments.length-1));if("string"==typeof e&&"function"==typeof t&&(e=[e]),!(e instanceof Array)){if("string"==typeof e){var i=d.decanonicalize(e,r),o=d.get(i);if(!o)throw new Error('Module not already loaded loading "'+e+'" as '+i+(r?' from "'+r+'".':"."));return"__useDefault"in o?o.__useDefault:o}throw new TypeError("Invalid require")}for(var a=[],s=0;s<e.length;s++)a.push(d.import(e[s],r));Promise.all(a).then(function(e){t&&t.apply(null,e)},n)}function e(e,u,c){var t,l,h,f;function n(r,e,i){for(var t=[],n=0;n<u.length;n++)t.push(r(u[n]));if(i.uri=i.id,i.config=L,-1!==f&&t.splice(f,0,i),-1!==h&&t.splice(h,0,e),-1!==l){var o=function(e,t,n){return"string"==typeof e&&"function"!=typeof t?r(e):p.call(d,e,t,n,i.id)};o.toUrl=function(e){return d.normalizeSync(e,i.id)},t.splice(l,0,o)}var a=C.require;C.require=p;var s=c.apply(-1===h?C:e,t);C.require=a,void 0!==s&&(i.exports=s)}"string"!=typeof e&&(c=u,u=e,e=null),u instanceof Array||(u=["require","exports","module"].splice(0,(c=u).length)),"function"!=typeof c&&(t=c,c=function(){return t}),e||st&&(u=u.concat(st),st=void 0),-1!==(l=u.indexOf("require"))&&(u.splice(l,1),e||(u=u.concat(function(e,t){var n=((e=e.replace(ze,"")).match(nt)[1].split(",")[t]||"require").replace(rt,""),r=it[n]||(it[n]=new RegExp(et+n+tt,"g"));r.lastIndex=0;for(var i,o=[];i=r.exec(e);)o.push(i[2]||i[3]);return o}(c.toString(),l)))),-1!==(h=u.indexOf("exports"))&&u.splice(h,1),-1!==(f=u.indexOf("module"))&&u.splice(f,1),e?(d.registerDynamic(e,u,!1,n),at?ct=!(at=void 0):ct||(at=[u,n])):d.registerDynamic(u,!1,lt?ot(n):n)}e.amd={},d.amdDefine=e,d.amdRequire=p}(this)}function Nt(e,t){this[U].production=e,this.registry.set("@system-env",St=this.newModule({browser:d,node:!!this._nodeRequire,production:!t&&e,dev:t||!e,build:t,default:!0}))}((It.prototype=Object.create(R.prototype)).constructor=It).prototype[It.resolve=R.resolve]=It.prototype.normalize=function(n,r){var i=this[U],o={pluginKey:void 0,pluginArgument:void 0,pluginModule:void 0,packageKey:void 0,packageConfig:void 0,load:void 0},a=ue(0,i,r),s=this;return Promise.resolve().then(function(){var t=n.lastIndexOf("#?");if(-1===t)return Promise.resolve(n);var e=Se.call(s,n.substr(t+2));return Ce.call(s,e,r,!0).then(function(e){return e?n.substr(0,t):"@empty"})}).then(function(e){var t=de(i.pluginFirst,e);return t?(o.pluginKey=t.plugin,Promise.all([fe.call(s,i,t.argument,a&&a.pluginArgument||r,o,a,!0),s.resolve(t.plugin,r)]).then(function(e){if(o.pluginArgument=e[0],o.pluginKey=e[1],o.pluginArgument===o.pluginKey)throw new Error("Plugin "+o.pluginArgument+" cannot load itself, make sure it is excluded from any wildcard meta configuration via a custom loader: false rule.");return pe(i.pluginFirst,e[0],e[1])})):fe.call(s,i,e,a&&a.pluginArgument||r,o,a,!1)}).then(function(e){return Oe.call(s,e,r,a)}).then(function(t){return function(e,t,n){n.load=n.load||{extension:"",deps:void 0,format:void 0,loader:void 0,scriptLoad:void 0,globals:void 0,nonce:void 0,integrity:void 0,sourceMap:void 0,exports:void 0,encapsulateGlobal:!1,crossOrigin:void 0,cjsRequireDetection:!0,cjsDeferDepsExecute:!1,esModule:!1};var r,i=0;for(var o in e.meta)if(-1!==(r=o.indexOf("*"))&&o.substr(0,r)===t.substr(0,r)&&o.substr(r+1)===t.substr(t.length-o.length+r+1)){var a=o.split("/").length;i<a&&(i=a),K(n.load,e.meta[o],i!==a)}if(e.meta[t]&&K(n.load,e.meta[t],!1),n.packageKey){var s=t.substr(n.packageKey.length+1),u={};if(n.packageConfig.meta){i=0;we(n.packageConfig.meta,s,function(e,t,n){i<n&&(i=n),K(u,t,n&&n<i)}),K(n.load,u,!1)}!n.packageConfig.format||n.pluginKey||n.load.loader||(n.load.format=n.load.format||n.packageConfig.format)}}.call(s,i,t,o),o.pluginKey||!o.load.loader?t:s.resolve(o.load.loader,t).then(function(e){return o.pluginKey=e,o.pluginArgument=t})}).then(function(e){return s[B][e]=o,e})},It.prototype.load=function(e,t){return W.call(this[U],"System.load is deprecated."),this.import(e,t)},It.prototype.decanonicalize=It.prototype.normalizeSync=It.prototype.resolveSync=function e(t,n){var r=this[U],i={pluginKey:void 0,pluginArgument:void 0,pluginModule:void 0,packageKey:void 0,packageConfig:void 0,load:void 0},o=o||ue(0,r,n),a=de(r.pluginFirst,t);return a?(i.pluginKey=e.call(this,a.plugin,n),pe(r.pluginFirst,he.call(this,r,a.argument,o.pluginArgument||n,i,o,!!i.pluginKey),i.pluginKey)):he.call(this,r,t,o.pluginArgument||n,i,o,!!i.pluginKey)},It.prototype[It.instantiate=R.instantiate]=function(o,l){var h=this,f=this[U];return(function(e,t,n){var r;if(d&&(r=e.depCache[n]))for(var i=0;i<r.length;i++)t.normalize(r[i],n).then(Q);else{var o=!1;for(var a in e.bundles){for(i=0;i<e.bundles[a].length;i++){var s=e.bundles[a][i];if(s===n){o=!0;break}if(-1!==s.indexOf("*")){var u=s.split("*");if(2!==u.length){e.bundles[a].splice(i--,1);continue}if(n.substr(0,u[0].length)===u[0]&&n.substr(n.length-u[1].length,u[1].length)===u[1]){o=!0;break}}}if(o)return t.import(a)}}}(f,this,o)||M).then(function(){if(!l()){var e,t,n,r=h[B][o];if("@node/"===o.substr(0,6)){if(!h._nodeRequire)throw new TypeError("Error loading "+o+". Can only load node core modules in Node.");return h.registerDynamic([],!1,function(){return function(e,t){if("."===e[0])throw new Error("Node module "+e+" can't be loaded as it is not a package require.");if(!V){var n=this._nodeRequire("module"),r=decodeURI(t.substr(a?8:7));(V=new n(r)).paths=n._nodeModulePaths(r)}return V.require(e)}.call(h,o.substr(6),h.baseURL)}),void l()}return r.load.scriptLoad?!r.load.pluginKey&&ht||(r.load.scriptLoad=!1,W.call(f,'scriptLoad not supported for "'+o+'"')):!1!==r.load.scriptLoad&&!r.load.pluginKey&&ht&&(r.load.deps||r.load.globals||!("system"===r.load.format||"register"===r.load.format||"global"===r.load.format&&r.load.exports)||(r.load.scriptLoad=!0)),r.load.scriptLoad?new Promise(function(t,e){if("amd"===r.load.format&&C.define!==h.amdDefine)throw new Error("Loading AMD with scriptLoad requires setting the global `"+pt+".define = SystemJS.amdDefine`");!function(t,e,n,r,i){if(t=t.replace(/#/g,"%23"),q)return function(e,t,n){try{importScripts(e)}catch(e){n(e)}t()}(t,r,i);var o=document.createElement("script");function a(){r(),u()}function s(e){u(),i(new Error("Fetching "+t))}function u(){o.removeEventListener("load",a,!1),o.removeEventListener("error",s,!1),document.head.removeChild(o)}o.type="text/javascript",o.charset="utf-8",o.async=!0,e&&(o.crossOrigin=e),n&&(o.integrity=n),o.addEventListener("load",a,!1),o.addEventListener("error",s,!1),o.src=t,document.head.appendChild(o)}(o,r.load.crossOrigin,r.load.integrity,function(){if(!l()){r.load.format="global";var e=r.load.exports&&Je(r.load.exports);h.registerDynamic([],!1,function(){return ft(r,e),e}),l()}t()},e)}):(e=h,t=o,n=r,n.pluginKey?e.import(n.pluginKey).then(function(e){n.pluginModule=e,n.pluginLoad={name:t,address:n.pluginArgument,source:void 0,metadata:n.load},n.load.deps=n.load.deps||[]}):M).then(function(){return i=h,a=o,s=r,u=l,c=f.wasm,s.load.exports&&!s.load.format&&(s.load.format="global"),M.then(function(){if(s.pluginModule&&s.pluginModule.locate)return Promise.resolve(s.pluginModule.locate.call(i,s.pluginLoad)).then(function(e){e&&(s.pluginLoad.address=e)})}).then(function(){return s.pluginModule?(c=!1,s.pluginModule.fetch?s.pluginModule.fetch.call(i,s.pluginLoad,function(e){return se(e.address,s.load.authorization,s.load.integrity,!1)}):se(s.pluginLoad.address,s.load.authorization,s.load.integrity,!1)):se(a,s.load.authorization,s.load.integrity,c)}).then(function(n){return c&&"string"!=typeof n?(e=i,t=n,o=u,r=new Uint8Array(t),0===r[0]&&97===r[1]&&115===r[2]?WebAssembly.compile(t).then(function(t){var n=[],r=[],i={};return WebAssembly.Module.imports&&WebAssembly.Module.imports(t).forEach(function(e){var t=e.module;r.push(function(e){i[t]=e}),-1===n.indexOf(t)&&n.push(t)}),e.register(n,function(e){return{setters:r,execute:function(){e(new WebAssembly.Instance(t,i).exports)}}}),o(),!0}):Promise.resolve(!1)).then(function(e){if(!e){var t=d?new TextDecoder("utf-8").decode(new Uint8Array(n)):n.toString();return dt(i,a,t,s,u)}}):dt(i,a,n,s,u);var e,t,o,r});var i,a,s,u,c})}}).then(function(e){return delete h[B][o],e})},It.prototype.config=function(e,t){var n,r=this,i=this[U];if("warnings"in e&&(i.warnings=e.warnings),"wasm"in e&&(i.wasm="undefined"!=typeof WebAssembly&&e.wasm),("production"in e||"build"in e)&&Nt.call(r,!!e.production,!!(e.build||St&&St.build)),!t)for(var o in Ae(0,e,function(e){n=n||e.baseURL}),(n=n||e.baseURL)&&(i.baseURL=b(n,y)||b("./"+n,y),"/"!==i.baseURL[i.baseURL.length-1]&&(i.baseURL+="/")),e.paths&&H(i.paths,e.paths),Ae(0,e,function(e){e.paths&&H(i.paths,e.paths)}),i.paths)-1!==i.paths[o].indexOf("*")&&(W.call(i,"Path config "+o+" -> "+i.paths[o]+" is no longer supported as wildcards are deprecated."),delete i.paths[o]);if(e.defaultJSExtensions&&W.call(i,"The defaultJSExtensions configuration option is deprecated.\n  Use packages defaultExtension instead.",!0),"boolean"==typeof e.pluginFirst&&(i.pluginFirst=e.pluginFirst),e.map)for(var o in e.map){var a=e.map[o];if("string"==typeof a){var s=le.call(r,i,a,void 0,!1,!1);"/"===s[s.length-1]&&":"!==o[o.length-1]&&"/"!==o[o.length-1]&&(s=s.substr(0,s.length-1)),i.map[o]=s}else{v=(v=le.call(r,i,"/"!==o[o.length-1]?o+"/":o,void 0,!0,!0)).substr(0,v.length-1);var u=i.packages[v];u||((u=i.packages[v]={defaultExtension:void 0,main:void 0,format:void 0,meta:void 0,map:void 0,packageConfig:void 0,configured:!1}).defaultExtension=""),Ne(u,{map:a},v,!1,i)}}if(e.packageConfigPaths){for(var c=[],l=0;l<e.packageConfigPaths.length;l++){var h=e.packageConfigPaths[l],f=Math.max(h.lastIndexOf("*")+1,h.lastIndexOf("/")),d=le.call(r,i,h.substr(0,f),void 0,!1,!1);c[l]=d+h.substr(f)}i.packageConfigPaths=c}if(e.bundles)for(var o in e.bundles){var p=[];for(l=0;l<e.bundles[o].length;l++)p.push(r.normalizeSync(e.bundles[o][l]));i.bundles[o]=p}if(e.packages)for(var o in e.packages){if(o.match(/^([^\/]+:)?\/\/$/))throw new TypeError('"'+o+'" is not a valid package name.');var v;v=(v=le.call(r,i,"/"!==o[o.length-1]?o+"/":o,void 0,!0,!0)).substr(0,v.length-1),Ne(i.packages[v]=i.packages[v]||{defaultExtension:void 0,main:void 0,format:void 0,meta:void 0,map:void 0,packageConfig:void 0,configured:!1},e.packages[o],v,!1,i)}if(e.depCache)for(var o in e.depCache)i.depCache[r.normalizeSync(o)]=[].concat(e.depCache[o]);if(e.meta)for(var o in e.meta)if("*"===o[0])H(i.meta[o]=i.meta[o]||{},e.meta[o]);else{var m=le.call(r,i,o,void 0,!0,!0);H(i.meta[m]=i.meta[m]||{},e.meta[o])}for(var g in"transpiler"in e&&(i.transpiler=e.transpiler),e)-1===kt.indexOf(g)&&-1===Re.indexOf(g)&&(r[g]=e[g]);Ae(0,e,function(e){r.config(e,!0)})},It.prototype.getConfig=function(e){if(e){if(-1!==kt.indexOf(e))return Ie(this[U],e);throw new Error('"'+e+'" is not a valid configuration name. Must be one of '+kt.join(", ")+".")}for(var t={},n=0;n<kt.length;n++){var r=kt[n],i=Ie(this[U],r);void 0!==i&&(t[r]=i)}return t},It.prototype.global=C,It.prototype.import=function(){return R.prototype.import.apply(this,arguments).then(function(e){return"__useDefault"in e?e.__useDefault:e})};for(var kt=["baseURL","map","paths","packages","packageConfigPaths","depCache","meta","bundles","transpiler","warnings","pluginFirst","production","wasm"],Pt="undefined"!=typeof Proxy,xt=0;xt<kt.length;xt++)!function(n){Object.defineProperty(It.prototype,n,{get:function(){var e=Ie(this[U],n);return Pt&&"object"==typeof e&&(e=new Proxy(e,{set:function(e,t){throw new Error("Cannot set SystemJS."+n+'["'+t+'"] directly. Use SystemJS.config({ '+n+': { "'+t+'": ... } }) rather.')}})),e},set:function(e){throw new Error("Setting `SystemJS."+n+"` directly is no longer supported. Use `SystemJS.config({ "+n+": ... })`.")}})}(kt[xt]);function Dt(e,t){W.call(e[U],"SystemJS."+t+" is deprecated for SystemJS.registry."+t)}It.prototype.delete=function(e){return Dt(this,"delete"),this.registry.delete(e)},It.prototype.get=function(e){return Dt(this,"get"),this.registry.get(e)},It.prototype.has=function(e){return Dt(this,"has"),this.registry.has(e)},It.prototype.set=function(e,t){return Dt(this,"set"),this.registry.set(e,t)},It.prototype.newModule=function(e){return new O(e)},It.prototype.isModule=function(e){return void 0===F&&(F="undefined"!=typeof Symbol&&!!Symbol.toStringTag),e instanceof O||F&&"[object Module]"==Object.prototype.toString.call(e)},It.prototype.register=function(e,t,n){return"string"==typeof e&&(e=ce.call(this,this[U],e)),R.prototype.register.call(this,e,t,n)},It.prototype.registerDynamic=function(e,t,n,r){return"string"==typeof e&&(e=ce.call(this,this[U],e)),R.prototype.registerDynamic.call(this,e,t,n,r)},It.prototype.version="0.21.3 Dev";var Mt=new It;(d||q)&&(C.SystemJS=C.System=Mt),"undefined"!=typeof module&&module.exports&&(module.exports=Mt)}(),_aureliaConfigureModuleLoader(),define("text/text",{}),define("text",["text/text"],function(e){return e}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define("moment",t):e.moment=t()}(this,function(){"use strict";var e,i;function f(){return e.apply(null,arguments)}function s(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function u(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function c(e){return void 0===e}function l(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function h(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function d(e,t){var n,r=[];for(n=0;n<e.length;++n)r.push(t(e[n],n));return r}function p(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function v(e,t){for(var n in t)p(t,n)&&(e[n]=t[n]);return p(t,"toString")&&(e.toString=t.toString),p(t,"valueOf")&&(e.valueOf=t.valueOf),e}function m(e,t,n,r){return Ot(e,t,n,r,!0).utc()}function g(e){return null==e._pf&&(e._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}),e._pf}function y(e){if(null==e._isValid){var t=g(e),n=i.call(t.parsedDateParts,function(e){return null!=e}),r=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&n);if(e._strict&&(r=r&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour),null!=Object.isFrozen&&Object.isFrozen(e))return r;e._isValid=r}return e._isValid}function b(e){var t=m(NaN);return null!=e?v(g(t),e):g(t).userInvalidated=!0,t}i=Array.prototype.some?Array.prototype.some:function(e){for(var t=Object(this),n=t.length>>>0,r=0;r<n;r++)if(r in t&&e.call(this,t[r],r,t))return!0;return!1};var o=f.momentProperties=[];function _(e,t){var n,r,i;if(c(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),c(t._i)||(e._i=t._i),c(t._f)||(e._f=t._f),c(t._l)||(e._l=t._l),c(t._strict)||(e._strict=t._strict),c(t._tzm)||(e._tzm=t._tzm),c(t._isUTC)||(e._isUTC=t._isUTC),c(t._offset)||(e._offset=t._offset),c(t._pf)||(e._pf=g(t)),c(t._locale)||(e._locale=t._locale),0<o.length)for(n=0;n<o.length;n++)c(i=t[r=o[n]])||(e[r]=i);return e}var t=!1;function w(e){_(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===t&&(t=!0,f.updateOffset(this),t=!1)}function E(e){return e instanceof w||null!=e&&null!=e._isAMomentObject}function S(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function C(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=S(t)),n}function a(e,t,n){var r,i=Math.min(e.length,t.length),o=Math.abs(e.length-t.length),a=0;for(r=0;r<i;r++)(n&&e[r]!==t[r]||!n&&C(e[r])!==C(t[r]))&&a++;return a+o}function T(e){!1===f.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function n(i,o){var a=!0;return v(function(){if(null!=f.deprecationHandler&&f.deprecationHandler(null,i),a){for(var e,t=[],n=0;n<arguments.length;n++){if(e="","object"==typeof arguments[n]){for(var r in e+="\n["+n+"] ",arguments[0])e+=r+": "+arguments[0][r]+", ";e=e.slice(0,-2)}else e=arguments[n];t.push(e)}T(i+"\nArguments: "+Array.prototype.slice.call(t).join("")+"\n"+(new Error).stack),a=!1}return o.apply(this,arguments)},o)}var r,O={};function R(e,t){null!=f.deprecationHandler&&f.deprecationHandler(e,t),O[e]||(T(t),O[e]=!0)}function A(e){return e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function I(e,t){var n,r=v({},e);for(n in t)p(t,n)&&(u(e[n])&&u(t[n])?(r[n]={},v(r[n],e[n]),v(r[n],t[n])):null!=t[n]?r[n]=t[n]:delete r[n]);for(n in e)p(e,n)&&!p(t,n)&&u(e[n])&&(r[n]=v({},r[n]));return r}function N(e){null!=e&&this.set(e)}f.suppressDeprecationWarnings=!1,f.deprecationHandler=null,r=Object.keys?Object.keys:function(e){var t,n=[];for(t in e)p(e,t)&&n.push(t);return n};var k={};function P(e,t){var n=e.toLowerCase();k[n]=k[n+"s"]=k[t]=e}function x(e){return"string"==typeof e?k[e]||k[e.toLowerCase()]:void 0}function D(e){var t,n,r={};for(n in e)p(e,n)&&(t=x(n))&&(r[t]=e[n]);return r}var M={};function L(e,t){M[e]=t}function F(e,t,n){var r=""+Math.abs(e),i=t-r.length;return(0<=e?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var V=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,j=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,U={},B={};function q(e,t,n,r){var i=r;"string"==typeof r&&(i=function(){return this[r]()}),e&&(B[e]=i),t&&(B[t[0]]=function(){return F(i.apply(this,arguments),t[1],t[2])}),n&&(B[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),e)})}function W(e,t){return e.isValid()?(t=H(t,e.localeData()),U[t]=U[t]||function(r){var e,i,t,o=r.match(V);for(e=0,i=o.length;e<i;e++)B[o[e]]?o[e]=B[o[e]]:o[e]=(t=o[e]).match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"");return function(e){var t,n="";for(t=0;t<i;t++)n+=A(o[t])?o[t].call(e,r):o[t];return n}}(t),U[t](e)):e.localeData().invalidDate()}function H(e,t){var n=5;function r(e){return t.longDateFormat(e)||e}for(j.lastIndex=0;0<=n&&j.test(e);)e=e.replace(j,r),j.lastIndex=0,n-=1;return e}var G=/\d/,K=/\d\d/,$=/\d{3}/,z=/\d{4}/,Q=/[+-]?\d{6}/,Y=/\d\d?/,X=/\d\d\d\d?/,J=/\d\d\d\d\d\d?/,Z=/\d{1,3}/,ee=/\d{1,4}/,te=/[+-]?\d{1,6}/,ne=/\d+/,re=/[+-]?\d+/,ie=/Z|[+-]\d\d:?\d\d/gi,oe=/Z|[+-]\d\d(?::?\d\d)?/gi,ae=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,se={};function ue(e,n,r){se[e]=A(n)?n:function(e,t){return e&&r?r:n}}function ce(e,t){return p(se,e)?se[e](t._strict,t._locale):new RegExp(le(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,r,i){return t||n||r||i})))}function le(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var he={};function fe(e,n){var t,r=n;for("string"==typeof e&&(e=[e]),l(n)&&(r=function(e,t){t[n]=C(e)}),t=0;t<e.length;t++)he[e[t]]=r}function de(e,i){fe(e,function(e,t,n,r){n._w=n._w||{},i(e,n._w,n,r)})}var pe=0,ve=1,me=2,ge=3,ye=4,be=5,_e=6,we=7,Ee=8;function Se(e){return Ce(e)?366:365}function Ce(e){return e%4==0&&e%100!=0||e%400==0}q("Y",0,0,function(){var e=this.year();return e<=9999?""+e:"+"+e}),q(0,["YY",2],0,function(){return this.year()%100}),q(0,["YYYY",4],0,"year"),q(0,["YYYYY",5],0,"year"),q(0,["YYYYYY",6,!0],0,"year"),P("year","y"),L("year",1),ue("Y",re),ue("YY",Y,K),ue("YYYY",ee,z),ue("YYYYY",te,Q),ue("YYYYYY",te,Q),fe(["YYYYY","YYYYYY"],pe),fe("YYYY",function(e,t){t[pe]=2===e.length?f.parseTwoDigitYear(e):C(e)}),fe("YY",function(e,t){t[pe]=f.parseTwoDigitYear(e)}),fe("Y",function(e,t){t[pe]=parseInt(e,10)}),f.parseTwoDigitYear=function(e){return C(e)+(68<C(e)?1900:2e3)};var Te,Oe=Re("FullYear",!0);function Re(t,n){return function(e){return null!=e?(Ie(this,t,e),f.updateOffset(this,n),this):Ae(this,t)}}function Ae(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function Ie(e,t,n){e.isValid()&&!isNaN(n)&&("FullYear"===t&&Ce(e.year())&&1===e.month()&&29===e.date()?e._d["set"+(e._isUTC?"UTC":"")+t](n,e.month(),Ne(n,e.month())):e._d["set"+(e._isUTC?"UTC":"")+t](n))}function Ne(e,t){if(isNaN(e)||isNaN(t))return NaN;var n,r=(t%(n=12)+n)%n;return e+=(t-r)/12,1===r?Ce(e)?29:28:31-r%7%2}Te=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1},q("M",["MM",2],"Mo",function(){return this.month()+1}),q("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),q("MMMM",0,0,function(e){return this.localeData().months(this,e)}),P("month","M"),L("month",8),ue("M",Y),ue("MM",Y,K),ue("MMM",function(e,t){return t.monthsShortRegex(e)}),ue("MMMM",function(e,t){return t.monthsRegex(e)}),fe(["M","MM"],function(e,t){t[ve]=C(e)-1}),fe(["MMM","MMMM"],function(e,t,n,r){var i=n._locale.monthsParse(e,r,n._strict);null!=i?t[ve]=i:g(n).invalidMonth=e});var ke=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Pe="January_February_March_April_May_June_July_August_September_October_November_December".split("_");var xe="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");function De(e,t){var n;if(!e.isValid())return e;if("string"==typeof t)if(/^\d+$/.test(t))t=C(t);else if(!l(t=e.localeData().monthsParse(t)))return e;return n=Math.min(e.date(),Ne(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e}function Me(e){return null!=e?(De(this,e),f.updateOffset(this,!0),this):Ae(this,"Month")}var Le=ae;var Fe=ae;function Ve(){function e(e,t){return t.length-e.length}var t,n,r=[],i=[],o=[];for(t=0;t<12;t++)n=m([2e3,t]),r.push(this.monthsShort(n,"")),i.push(this.months(n,"")),o.push(this.months(n,"")),o.push(this.monthsShort(n,""));for(r.sort(e),i.sort(e),o.sort(e),t=0;t<12;t++)r[t]=le(r[t]),i[t]=le(i[t]);for(t=0;t<24;t++)o[t]=le(o[t]);this._monthsRegex=new RegExp("^("+o.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+r.join("|")+")","i")}function je(e){var t=new Date(Date.UTC.apply(null,arguments));return e<100&&0<=e&&isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e),t}function Ue(e,t,n){var r=7+t-n;return-((7+je(e,0,r).getUTCDay()-t)%7)+r-1}function Be(e,t,n,r,i){var o,a,s=1+7*(t-1)+(7+n-r)%7+Ue(e,r,i);return s<=0?a=Se(o=e-1)+s:s>Se(e)?(o=e+1,a=s-Se(e)):(o=e,a=s),{year:o,dayOfYear:a}}function qe(e,t,n){var r,i,o=Ue(e.year(),t,n),a=Math.floor((e.dayOfYear()-o-1)/7)+1;return a<1?r=a+We(i=e.year()-1,t,n):a>We(e.year(),t,n)?(r=a-We(e.year(),t,n),i=e.year()+1):(i=e.year(),r=a),{week:r,year:i}}function We(e,t,n){var r=Ue(e,t,n),i=Ue(e+1,t,n);return(Se(e)-r+i)/7}q("w",["ww",2],"wo","week"),q("W",["WW",2],"Wo","isoWeek"),P("week","w"),P("isoWeek","W"),L("week",5),L("isoWeek",5),ue("w",Y),ue("ww",Y,K),ue("W",Y),ue("WW",Y,K),de(["w","ww","W","WW"],function(e,t,n,r){t[r.substr(0,1)]=C(e)});q("d",0,"do","day"),q("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),q("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),q("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),q("e",0,0,"weekday"),q("E",0,0,"isoWeekday"),P("day","d"),P("weekday","e"),P("isoWeekday","E"),L("day",11),L("weekday",11),L("isoWeekday",11),ue("d",Y),ue("e",Y),ue("E",Y),ue("dd",function(e,t){return t.weekdaysMinRegex(e)}),ue("ddd",function(e,t){return t.weekdaysShortRegex(e)}),ue("dddd",function(e,t){return t.weekdaysRegex(e)}),de(["dd","ddd","dddd"],function(e,t,n,r){var i=n._locale.weekdaysParse(e,r,n._strict);null!=i?t.d=i:g(n).invalidWeekday=e}),de(["d","e","E"],function(e,t,n,r){t[r]=C(e)});var He="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_");var Ge="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_");var Ke="Su_Mo_Tu_We_Th_Fr_Sa".split("_");var $e=ae;var ze=ae;var Qe=ae;function Ye(){function e(e,t){return t.length-e.length}var t,n,r,i,o,a=[],s=[],u=[],c=[];for(t=0;t<7;t++)n=m([2e3,1]).day(t),r=this.weekdaysMin(n,""),i=this.weekdaysShort(n,""),o=this.weekdays(n,""),a.push(r),s.push(i),u.push(o),c.push(r),c.push(i),c.push(o);for(a.sort(e),s.sort(e),u.sort(e),c.sort(e),t=0;t<7;t++)s[t]=le(s[t]),u[t]=le(u[t]),c[t]=le(c[t]);this._weekdaysRegex=new RegExp("^("+c.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+u.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+s.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+a.join("|")+")","i")}function Xe(){return this.hours()%12||12}function Je(e,t){q(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function Ze(e,t){return t._meridiemParse}q("H",["HH",2],0,"hour"),q("h",["hh",2],0,Xe),q("k",["kk",2],0,function(){return this.hours()||24}),q("hmm",0,0,function(){return""+Xe.apply(this)+F(this.minutes(),2)}),q("hmmss",0,0,function(){return""+Xe.apply(this)+F(this.minutes(),2)+F(this.seconds(),2)}),q("Hmm",0,0,function(){return""+this.hours()+F(this.minutes(),2)}),q("Hmmss",0,0,function(){return""+this.hours()+F(this.minutes(),2)+F(this.seconds(),2)}),Je("a",!0),Je("A",!1),P("hour","h"),L("hour",13),ue("a",Ze),ue("A",Ze),ue("H",Y),ue("h",Y),ue("k",Y),ue("HH",Y,K),ue("hh",Y,K),ue("kk",Y,K),ue("hmm",X),ue("hmmss",J),ue("Hmm",X),ue("Hmmss",J),fe(["H","HH"],ge),fe(["k","kk"],function(e,t,n){var r=C(e);t[ge]=24===r?0:r}),fe(["a","A"],function(e,t,n){n._isPm=n._locale.isPM(e),n._meridiem=e}),fe(["h","hh"],function(e,t,n){t[ge]=C(e),g(n).bigHour=!0}),fe("hmm",function(e,t,n){var r=e.length-2;t[ge]=C(e.substr(0,r)),t[ye]=C(e.substr(r)),g(n).bigHour=!0}),fe("hmmss",function(e,t,n){var r=e.length-4,i=e.length-2;t[ge]=C(e.substr(0,r)),t[ye]=C(e.substr(r,2)),t[be]=C(e.substr(i)),g(n).bigHour=!0}),fe("Hmm",function(e,t,n){var r=e.length-2;t[ge]=C(e.substr(0,r)),t[ye]=C(e.substr(r))}),fe("Hmmss",function(e,t,n){var r=e.length-4,i=e.length-2;t[ge]=C(e.substr(0,r)),t[ye]=C(e.substr(r,2)),t[be]=C(e.substr(i))});var et,tt=Re("Hours",!0),nt={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:Pe,monthsShort:xe,week:{dow:0,doy:6},weekdays:He,weekdaysMin:Ke,weekdaysShort:Ge,meridiemParse:/[ap]\.?m?\.?/i},rt={},it={};function ot(e){return e?e.toLowerCase().replace("_","-"):e}function at(e){var t=null;if(!rt[e]&&"undefined"!=typeof module&&module&&module.exports)try{t=et._abbr,require("./locale/"+e),st(t)}catch(e){}return rt[e]}function st(e,t){var n;return e&&((n=c(t)?ct(e):ut(e,t))?et=n:"undefined"!=typeof console&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),et._abbr}function ut(e,t){if(null!==t){var n,r=nt;if(t.abbr=e,null!=rt[e])R("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=rt[e]._config;else if(null!=t.parentLocale)if(null!=rt[t.parentLocale])r=rt[t.parentLocale]._config;else{if(null==(n=at(t.parentLocale)))return it[t.parentLocale]||(it[t.parentLocale]=[]),it[t.parentLocale].push({name:e,config:t}),null;r=n._config}return rt[e]=new N(I(r,t)),it[e]&&it[e].forEach(function(e){ut(e.name,e.config)}),st(e),rt[e]}return delete rt[e],null}function ct(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return et;if(!s(e)){if(t=at(e))return t;e=[e]}return function(e){for(var t,n,r,i,o=0;o<e.length;){for(t=(i=ot(e[o]).split("-")).length,n=(n=ot(e[o+1]))?n.split("-"):null;0<t;){if(r=at(i.slice(0,t).join("-")))return r;if(n&&n.length>=t&&a(i,n,!0)>=t-1)break;t--}o++}return et}(e)}function lt(e){var t,n=e._a;return n&&-2===g(e).overflow&&(t=n[ve]<0||11<n[ve]?ve:n[me]<1||n[me]>Ne(n[pe],n[ve])?me:n[ge]<0||24<n[ge]||24===n[ge]&&(0!==n[ye]||0!==n[be]||0!==n[_e])?ge:n[ye]<0||59<n[ye]?ye:n[be]<0||59<n[be]?be:n[_e]<0||999<n[_e]?_e:-1,g(e)._overflowDayOfYear&&(t<pe||me<t)&&(t=me),g(e)._overflowWeeks&&-1===t&&(t=we),g(e)._overflowWeekday&&-1===t&&(t=Ee),g(e).overflow=t),e}function ht(e,t,n){return null!=e?e:null!=t?t:n}function ft(e){var t,n,r,i,o,a=[];if(!e._d){var s,u;for(s=e,u=new Date(f.now()),r=s._useUTC?[u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate()]:[u.getFullYear(),u.getMonth(),u.getDate()],e._w&&null==e._a[me]&&null==e._a[ve]&&function(e){var t,n,r,i,o,a,s,u;if(null!=(t=e._w).GG||null!=t.W||null!=t.E)o=1,a=4,n=ht(t.GG,e._a[pe],qe(Rt(),1,4).year),r=ht(t.W,1),((i=ht(t.E,1))<1||7<i)&&(u=!0);else{o=e._locale._week.dow,a=e._locale._week.doy;var c=qe(Rt(),o,a);n=ht(t.gg,e._a[pe],c.year),r=ht(t.w,c.week),null!=t.d?((i=t.d)<0||6<i)&&(u=!0):null!=t.e?(i=t.e+o,(t.e<0||6<t.e)&&(u=!0)):i=o}r<1||r>We(n,o,a)?g(e)._overflowWeeks=!0:null!=u?g(e)._overflowWeekday=!0:(s=Be(n,r,i,o,a),e._a[pe]=s.year,e._dayOfYear=s.dayOfYear)}(e),null!=e._dayOfYear&&(o=ht(e._a[pe],r[pe]),(e._dayOfYear>Se(o)||0===e._dayOfYear)&&(g(e)._overflowDayOfYear=!0),n=je(o,0,e._dayOfYear),e._a[ve]=n.getUTCMonth(),e._a[me]=n.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=a[t]=r[t];for(;t<7;t++)e._a[t]=a[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[ge]&&0===e._a[ye]&&0===e._a[be]&&0===e._a[_e]&&(e._nextDay=!0,e._a[ge]=0),e._d=(e._useUTC?je:function(e,t,n,r,i,o,a){var s=new Date(e,t,n,r,i,o,a);return e<100&&0<=e&&isFinite(s.getFullYear())&&s.setFullYear(e),s}).apply(null,a),i=e._useUTC?e._d.getUTCDay():e._d.getDay(),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[ge]=24),e._w&&void 0!==e._w.d&&e._w.d!==i&&(g(e).weekdayMismatch=!0)}}var dt=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,pt=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,vt=/Z|[+-]\d\d(?::?\d\d)?/,mt=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],gt=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],yt=/^\/?Date\((\-?\d+)/i;function bt(e){var t,n,r,i,o,a,s=e._i,u=dt.exec(s)||pt.exec(s);if(u){for(g(e).iso=!0,t=0,n=mt.length;t<n;t++)if(mt[t][1].exec(u[1])){i=mt[t][0],r=!1!==mt[t][2];break}if(null==i)return void(e._isValid=!1);if(u[3]){for(t=0,n=gt.length;t<n;t++)if(gt[t][1].exec(u[3])){o=(u[2]||" ")+gt[t][0];break}if(null==o)return void(e._isValid=!1)}if(!r&&null!=o)return void(e._isValid=!1);if(u[4]){if(!vt.exec(u[4]))return void(e._isValid=!1);a="Z"}e._f=i+(o||"")+(a||""),Ct(e)}else e._isValid=!1}var _t=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/;function wt(e,t,n,r,i,o){var a=[function(e){var t=parseInt(e,10);{if(t<=49)return 2e3+t;if(t<=999)return 1900+t}return t}(e),xe.indexOf(t),parseInt(n,10),parseInt(r,10),parseInt(i,10)];return o&&a.push(parseInt(o,10)),a}var Et={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function St(e){var t,n,r,i=_t.exec(e._i.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim());if(i){var o=wt(i[4],i[3],i[2],i[5],i[6],i[7]);if(t=i[1],n=o,r=e,t&&Ge.indexOf(t)!==new Date(n[0],n[1],n[2]).getDay()&&(g(r).weekdayMismatch=!0,!(r._isValid=!1)))return;e._a=o,e._tzm=function(e,t,n){if(e)return Et[e];if(t)return 0;var r=parseInt(n,10),i=r%100;return(r-i)/100*60+i}(i[8],i[9],i[10]),e._d=je.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),g(e).rfc2822=!0}else e._isValid=!1}function Ct(e){if(e._f!==f.ISO_8601)if(e._f!==f.RFC_2822){e._a=[],g(e).empty=!0;var t,n,r,i,o,a,s,u,c=""+e._i,l=c.length,h=0;for(r=H(e._f,e._locale).match(V)||[],t=0;t<r.length;t++)i=r[t],(n=(c.match(ce(i,e))||[])[0])&&(0<(o=c.substr(0,c.indexOf(n))).length&&g(e).unusedInput.push(o),c=c.slice(c.indexOf(n)+n.length),h+=n.length),B[i]?(n?g(e).empty=!1:g(e).unusedTokens.push(i),a=i,u=e,null!=(s=n)&&p(he,a)&&he[a](s,u._a,u,a)):e._strict&&!n&&g(e).unusedTokens.push(i);g(e).charsLeftOver=l-h,0<c.length&&g(e).unusedInput.push(c),e._a[ge]<=12&&!0===g(e).bigHour&&0<e._a[ge]&&(g(e).bigHour=void 0),g(e).parsedDateParts=e._a.slice(0),g(e).meridiem=e._meridiem,e._a[ge]=function(e,t,n){var r;if(null==n)return t;return null!=e.meridiemHour?e.meridiemHour(t,n):(null!=e.isPM&&((r=e.isPM(n))&&t<12&&(t+=12),r||12!==t||(t=0)),t)}(e._locale,e._a[ge],e._meridiem),ft(e),lt(e)}else St(e);else bt(e)}function Tt(e){var t,n,r,i,o=e._i,a=e._f;return e._locale=e._locale||ct(e._l),null===o||void 0===a&&""===o?b({nullInput:!0}):("string"==typeof o&&(e._i=o=e._locale.preparse(o)),E(o)?new w(lt(o)):(h(o)?e._d=o:s(a)?function(e){var t,n,r,i,o;if(0===e._f.length)return g(e).invalidFormat=!0,e._d=new Date(NaN);for(i=0;i<e._f.length;i++)o=0,t=_({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[i],Ct(t),y(t)&&(o+=g(t).charsLeftOver,o+=10*g(t).unusedTokens.length,g(t).score=o,(null==r||o<r)&&(r=o,n=t));v(e,n||t)}(e):a?Ct(e):c(n=(t=e)._i)?t._d=new Date(f.now()):h(n)?t._d=new Date(n.valueOf()):"string"==typeof n?(r=t,null===(i=yt.exec(r._i))?(bt(r),!1===r._isValid&&(delete r._isValid,St(r),!1===r._isValid&&(delete r._isValid,f.createFromInputFallback(r)))):r._d=new Date(+i[1])):s(n)?(t._a=d(n.slice(0),function(e){return parseInt(e,10)}),ft(t)):u(n)?function(e){if(!e._d){var t=D(e._i);e._a=d([t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],function(e){return e&&parseInt(e,10)}),ft(e)}}(t):l(n)?t._d=new Date(n):f.createFromInputFallback(t),y(e)||(e._d=null),e))}function Ot(e,t,n,r,i){var o,a={};return!0!==n&&!1!==n||(r=n,n=void 0),(u(e)&&function(e){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(e).length;var t;for(t in e)if(e.hasOwnProperty(t))return!1;return!0}(e)||s(e)&&0===e.length)&&(e=void 0),a._isAMomentObject=!0,a._useUTC=a._isUTC=i,a._l=n,a._i=e,a._f=t,a._strict=r,(o=new w(lt(Tt(a))))._nextDay&&(o.add(1,"d"),o._nextDay=void 0),o}function Rt(e,t,n,r){return Ot(e,t,n,r,!1)}f.createFromInputFallback=n("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),f.ISO_8601=function(){},f.RFC_2822=function(){};var At=n("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Rt.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:b()}),It=n("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Rt.apply(null,arguments);return this.isValid()&&e.isValid()?this<e?this:e:b()});function Nt(e,t){var n,r;if(1===t.length&&s(t[0])&&(t=t[0]),!t.length)return Rt();for(n=t[0],r=1;r<t.length;++r)t[r].isValid()&&!t[r][e](n)||(n=t[r]);return n}var kt=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Pt(e){var t=D(e),n=t.year||0,r=t.quarter||0,i=t.month||0,o=t.week||0,a=t.day||0,s=t.hour||0,u=t.minute||0,c=t.second||0,l=t.millisecond||0;this._isValid=function(e){for(var t in e)if(-1===Te.call(kt,t)||null!=e[t]&&isNaN(e[t]))return!1;for(var n=!1,r=0;r<kt.length;++r)if(e[kt[r]]){if(n)return!1;parseFloat(e[kt[r]])!==C(e[kt[r]])&&(n=!0)}return!0}(t),this._milliseconds=+l+1e3*c+6e4*u+1e3*s*60*60,this._days=+a+7*o,this._months=+i+3*r+12*n,this._data={},this._locale=ct(),this._bubble()}function xt(e){return e instanceof Pt}function Dt(e){return e<0?-1*Math.round(-1*e):Math.round(e)}function Mt(e,n){q(e,0,0,function(){var e=this.utcOffset(),t="+";return e<0&&(e=-e,t="-"),t+F(~~(e/60),2)+n+F(~~e%60,2)})}Mt("Z",":"),Mt("ZZ",""),ue("Z",oe),ue("ZZ",oe),fe(["Z","ZZ"],function(e,t,n){n._useUTC=!0,n._tzm=Ft(oe,e)});var Lt=/([\+\-]|\d\d)/gi;function Ft(e,t){var n=(t||"").match(e);if(null===n)return null;var r=((n[n.length-1]||[])+"").match(Lt)||["-",0,0],i=60*r[1]+C(r[2]);return 0===i?0:"+"===r[0]?i:-i}function Vt(e,t){var n,r;return t._isUTC?(n=t.clone(),r=(E(e)||h(e)?e.valueOf():Rt(e).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+r),f.updateOffset(n,!1),n):Rt(e).local()}function jt(e){return 15*-Math.round(e._d.getTimezoneOffset()/15)}function Ut(){return!!this.isValid()&&(this._isUTC&&0===this._offset)}f.updateOffset=function(){};var Bt=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,qt=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Wt(e,t){var n,r,i,o=e,a=null;return xt(e)?o={ms:e._milliseconds,d:e._days,M:e._months}:l(e)?(o={},t?o[t]=e:o.milliseconds=e):(a=Bt.exec(e))?(n="-"===a[1]?-1:1,o={y:0,d:C(a[me])*n,h:C(a[ge])*n,m:C(a[ye])*n,s:C(a[be])*n,ms:C(Dt(1e3*a[_e]))*n}):(a=qt.exec(e))?(n="-"===a[1]?-1:(a[1],1),o={y:Ht(a[2],n),M:Ht(a[3],n),w:Ht(a[4],n),d:Ht(a[5],n),h:Ht(a[6],n),m:Ht(a[7],n),s:Ht(a[8],n)}):null==o?o={}:"object"==typeof o&&("from"in o||"to"in o)&&(i=function(e,t){var n;if(!e.isValid()||!t.isValid())return{milliseconds:0,months:0};t=Vt(t,e),e.isBefore(t)?n=Gt(e,t):((n=Gt(t,e)).milliseconds=-n.milliseconds,n.months=-n.months);return n}(Rt(o.from),Rt(o.to)),(o={}).ms=i.milliseconds,o.M=i.months),r=new Pt(o),xt(e)&&p(e,"_locale")&&(r._locale=e._locale),r}function Ht(e,t){var n=e&&parseFloat(e.replace(",","."));return(isNaN(n)?0:n)*t}function Gt(e,t){var n={milliseconds:0,months:0};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t-+e.clone().add(n.months,"M"),n}function Kt(r,i){return function(e,t){var n;return null===t||isNaN(+t)||(R(i,"moment()."+i+"(period, number) is deprecated. Please use moment()."+i+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),n=e,e=t,t=n),$t(this,Wt(e="string"==typeof e?+e:e,t),r),this}}function $t(e,t,n,r){var i=t._milliseconds,o=Dt(t._days),a=Dt(t._months);e.isValid()&&(r=null==r||r,a&&De(e,Ae(e,"Month")+a*n),o&&Ie(e,"Date",Ae(e,"Date")+o*n),i&&e._d.setTime(e._d.valueOf()+i*n),r&&f.updateOffset(e,o||a))}Wt.fn=Pt.prototype,Wt.invalid=function(){return Wt(NaN)};var zt=Kt(1,"add"),Qt=Kt(-1,"subtract");function Yt(e,t){var n=12*(t.year()-e.year())+(t.month()-e.month()),r=e.clone().add(n,"months");return-(n+(t-r<0?(t-r)/(r-e.clone().add(n-1,"months")):(t-r)/(e.clone().add(n+1,"months")-r)))||0}function Xt(e){var t;return void 0===e?this._locale._abbr:(null!=(t=ct(e))&&(this._locale=t),this)}f.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",f.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var Jt=n("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return void 0===e?this.localeData():this.locale(e)});function Zt(){return this._locale}function en(e,t){q(0,[e,e.length],0,t)}function tn(e,t,n,r,i){var o;return null==e?qe(this,r,i).year:((o=We(e,r,i))<t&&(t=o),function(e,t,n,r,i){var o=Be(e,t,n,r,i),a=je(o.year,0,o.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}.call(this,e,t,n,r,i))}q(0,["gg",2],0,function(){return this.weekYear()%100}),q(0,["GG",2],0,function(){return this.isoWeekYear()%100}),en("gggg","weekYear"),en("ggggg","weekYear"),en("GGGG","isoWeekYear"),en("GGGGG","isoWeekYear"),P("weekYear","gg"),P("isoWeekYear","GG"),L("weekYear",1),L("isoWeekYear",1),ue("G",re),ue("g",re),ue("GG",Y,K),ue("gg",Y,K),ue("GGGG",ee,z),ue("gggg",ee,z),ue("GGGGG",te,Q),ue("ggggg",te,Q),de(["gggg","ggggg","GGGG","GGGGG"],function(e,t,n,r){t[r.substr(0,2)]=C(e)}),de(["gg","GG"],function(e,t,n,r){t[r]=f.parseTwoDigitYear(e)}),q("Q",0,"Qo","quarter"),P("quarter","Q"),L("quarter",7),ue("Q",G),fe("Q",function(e,t){t[ve]=3*(C(e)-1)}),q("D",["DD",2],"Do","date"),P("date","D"),L("date",9),ue("D",Y),ue("DD",Y,K),ue("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient}),fe(["D","DD"],me),fe("Do",function(e,t){t[me]=C(e.match(Y)[0])});var nn=Re("Date",!0);q("DDD",["DDDD",3],"DDDo","dayOfYear"),P("dayOfYear","DDD"),L("dayOfYear",4),ue("DDD",Z),ue("DDDD",$),fe(["DDD","DDDD"],function(e,t,n){n._dayOfYear=C(e)}),q("m",["mm",2],0,"minute"),P("minute","m"),L("minute",14),ue("m",Y),ue("mm",Y,K),fe(["m","mm"],ye);var rn=Re("Minutes",!1);q("s",["ss",2],0,"second"),P("second","s"),L("second",15),ue("s",Y),ue("ss",Y,K),fe(["s","ss"],be);var on,an=Re("Seconds",!1);for(q("S",0,0,function(){return~~(this.millisecond()/100)}),q(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),q(0,["SSS",3],0,"millisecond"),q(0,["SSSS",4],0,function(){return 10*this.millisecond()}),q(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),q(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),q(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),q(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),q(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),P("millisecond","ms"),L("millisecond",16),ue("S",Z,G),ue("SS",Z,K),ue("SSS",Z,$),on="SSSS";on.length<=9;on+="S")ue(on,ne);function sn(e,t){t[_e]=C(1e3*("0."+e))}for(on="S";on.length<=9;on+="S")fe(on,sn);var un=Re("Milliseconds",!1);q("z",0,0,"zoneAbbr"),q("zz",0,0,"zoneName");var cn=w.prototype;function ln(e){return e}cn.add=zt,cn.calendar=function(e,t){var n=e||Rt(),r=Vt(n,this).startOf("day"),i=f.calendarFormat(this,r)||"sameElse",o=t&&(A(t[i])?t[i].call(this,n):t[i]);return this.format(o||this.localeData().calendar(i,this,Rt(n)))},cn.clone=function(){return new w(this)},cn.diff=function(e,t,n){var r,i,o;if(!this.isValid())return NaN;if(!(r=Vt(e,this)).isValid())return NaN;switch(i=6e4*(r.utcOffset()-this.utcOffset()),t=x(t)){case"year":o=Yt(this,r)/12;break;case"month":o=Yt(this,r);break;case"quarter":o=Yt(this,r)/3;break;case"second":o=(this-r)/1e3;break;case"minute":o=(this-r)/6e4;break;case"hour":o=(this-r)/36e5;break;case"day":o=(this-r-i)/864e5;break;case"week":o=(this-r-i)/6048e5;break;default:o=this-r}return n?o:S(o)},cn.endOf=function(e){return void 0===(e=x(e))||"millisecond"===e?this:("date"===e&&(e="day"),this.startOf(e).add(1,"isoWeek"===e?"week":e).subtract(1,"ms"))},cn.format=function(e){e||(e=this.isUtc()?f.defaultFormatUtc:f.defaultFormat);var t=W(this,e);return this.localeData().postformat(t)},cn.from=function(e,t){return this.isValid()&&(E(e)&&e.isValid()||Rt(e).isValid())?Wt({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},cn.fromNow=function(e){return this.from(Rt(),e)},cn.to=function(e,t){return this.isValid()&&(E(e)&&e.isValid()||Rt(e).isValid())?Wt({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},cn.toNow=function(e){return this.to(Rt(),e)},cn.get=function(e){return A(this[e=x(e)])?this[e]():this},cn.invalidAt=function(){return g(this).overflow},cn.isAfter=function(e,t){var n=E(e)?e:Rt(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=x(c(t)?"millisecond":t))?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(t).valueOf())},cn.isBefore=function(e,t){var n=E(e)?e:Rt(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=x(c(t)?"millisecond":t))?this.valueOf()<n.valueOf():this.clone().endOf(t).valueOf()<n.valueOf())},cn.isBetween=function(e,t,n,r){return("("===(r=r||"()")[0]?this.isAfter(e,n):!this.isBefore(e,n))&&(")"===r[1]?this.isBefore(t,n):!this.isAfter(t,n))},cn.isSame=function(e,t){var n,r=E(e)?e:Rt(e);return!(!this.isValid()||!r.isValid())&&("millisecond"===(t=x(t||"millisecond"))?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf()))},cn.isSameOrAfter=function(e,t){return this.isSame(e,t)||this.isAfter(e,t)},cn.isSameOrBefore=function(e,t){return this.isSame(e,t)||this.isBefore(e,t)},cn.isValid=function(){return y(this)},cn.lang=Jt,cn.locale=Xt,cn.localeData=Zt,cn.max=It,cn.min=At,cn.parsingFlags=function(){return v({},g(this))},cn.set=function(e,t){if("object"==typeof e)for(var n=function(e){var t=[];for(var n in e)t.push({unit:n,priority:M[n]});return t.sort(function(e,t){return e.priority-t.priority}),t}(e=D(e)),r=0;r<n.length;r++)this[n[r].unit](e[n[r].unit]);else if(A(this[e=x(e)]))return this[e](t);return this},cn.startOf=function(e){switch(e=x(e)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":case"date":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e&&this.weekday(0),"isoWeek"===e&&this.isoWeekday(1),"quarter"===e&&this.month(3*Math.floor(this.month()/3)),this},cn.subtract=Qt,cn.toArray=function(){return[this.year(),this.month(),this.date(),this.hour(),this.minute(),this.second(),this.millisecond()]},cn.toObject=function(){return{years:this.year(),months:this.month(),date:this.date(),hours:this.hours(),minutes:this.minutes(),seconds:this.seconds(),milliseconds:this.milliseconds()}},cn.toDate=function(){return new Date(this.valueOf())},cn.toISOString=function(e){if(!this.isValid())return null;var t=!0!==e,n=t?this.clone().utc():this;return n.year()<0||9999<n.year()?W(n,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):A(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",W(n,"Z")):W(n,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")},cn.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="";this.isLocal()||(e=0===this.utcOffset()?"moment.utc":"moment.parseZone",t="Z");var n="["+e+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i=t+'[")]';return this.format(n+r+"-MM-DD[T]HH:mm:ss.SSS"+i)},cn.toJSON=function(){return this.isValid()?this.toISOString():null},cn.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},cn.unix=function(){return Math.floor(this.valueOf()/1e3)},cn.valueOf=function(){return this._d.valueOf()-6e4*(this._offset||0)},cn.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}},cn.year=Oe,cn.isLeapYear=function(){return Ce(this.year())},cn.weekYear=function(e){return tn.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)},cn.isoWeekYear=function(e){return tn.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)},cn.quarter=cn.quarters=function(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)},cn.month=Me,cn.daysInMonth=function(){return Ne(this.year(),this.month())},cn.week=cn.weeks=function(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")},cn.isoWeek=cn.isoWeeks=function(e){var t=qe(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")},cn.weeksInYear=function(){var e=this.localeData()._week;return We(this.year(),e.dow,e.doy)},cn.isoWeeksInYear=function(){return We(this.year(),1,4)},cn.date=nn,cn.day=cn.days=function(e){if(!this.isValid())return null!=e?this:NaN;var t,n,r=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(t=e,n=this.localeData(),e="string"!=typeof t?t:isNaN(t)?"number"==typeof(t=n.weekdaysParse(t))?t:null:parseInt(t,10),this.add(e-r,"d")):r},cn.weekday=function(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")},cn.isoWeekday=function(e){if(!this.isValid())return null!=e?this:NaN;if(null!=e){var t=(n=e,r=this.localeData(),"string"==typeof n?r.weekdaysParse(n)%7||7:isNaN(n)?null:n);return this.day(this.day()%7?t:t-7)}return this.day()||7;var n,r},cn.dayOfYear=function(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")},cn.hour=cn.hours=tt,cn.minute=cn.minutes=rn,cn.second=cn.seconds=an,cn.millisecond=cn.milliseconds=un,cn.utcOffset=function(e,t,n){var r,i=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null!=e){if("string"==typeof e){if(null===(e=Ft(oe,e)))return this}else Math.abs(e)<16&&!n&&(e*=60);return!this._isUTC&&t&&(r=jt(this)),this._offset=e,this._isUTC=!0,null!=r&&this.add(r,"m"),i!==e&&(!t||this._changeInProgress?$t(this,Wt(e-i,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,f.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?i:jt(this)},cn.utc=function(e){return this.utcOffset(0,e)},cn.local=function(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(jt(this),"m")),this},cn.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var e=Ft(ie,this._i);null!=e?this.utcOffset(e):this.utcOffset(0,!0)}return this},cn.hasAlignedHourOffset=function(e){return!!this.isValid()&&(e=e?Rt(e).utcOffset():0,(this.utcOffset()-e)%60==0)},cn.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},cn.isLocal=function(){return!!this.isValid()&&!this._isUTC},cn.isUtcOffset=function(){return!!this.isValid()&&this._isUTC},cn.isUtc=Ut,cn.isUTC=Ut,cn.zoneAbbr=function(){return this._isUTC?"UTC":""},cn.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""},cn.dates=n("dates accessor is deprecated. Use date instead.",nn),cn.months=n("months accessor is deprecated. Use month instead",Me),cn.years=n("years accessor is deprecated. Use year instead",Oe),cn.zone=n("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",function(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}),cn.isDSTShifted=n("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",function(){if(!c(this._isDSTShifted))return this._isDSTShifted;var e={};if(_(e,this),(e=Tt(e))._a){var t=e._isUTC?m(e._a):Rt(e._a);this._isDSTShifted=this.isValid()&&0<a(e._a,t.toArray())}else this._isDSTShifted=!1;return this._isDSTShifted});var hn=N.prototype;function fn(e,t,n,r){var i=ct(),o=m().set(r,t);return i[n](o,e)}function dn(e,t,n){if(l(e)&&(t=e,e=void 0),e=e||"",null!=t)return fn(e,t,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=fn(e,r,n,"month");return i}function pn(e,t,n,r){"boolean"==typeof e?l(t)&&(n=t,t=void 0):(t=e,e=!1,l(n=t)&&(n=t,t=void 0)),t=t||"";var i,o=ct(),a=e?o._week.dow:0;if(null!=n)return fn(t,(n+a)%7,r,"day");var s=[];for(i=0;i<7;i++)s[i]=fn(t,(i+a)%7,r,"day");return s}hn.calendar=function(e,t,n){var r=this._calendar[e]||this._calendar.sameElse;return A(r)?r.call(t,n):r},hn.longDateFormat=function(e){var t=this._longDateFormat[e],n=this._longDateFormat[e.toUpperCase()];return t||!n?t:(this._longDateFormat[e]=n.replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e])},hn.invalidDate=function(){return this._invalidDate},hn.ordinal=function(e){return this._ordinal.replace("%d",e)},hn.preparse=ln,hn.postformat=ln,hn.relativeTime=function(e,t,n,r){var i=this._relativeTime[n];return A(i)?i(e,t,n,r):i.replace(/%d/i,e)},hn.pastFuture=function(e,t){var n=this._relativeTime[0<e?"future":"past"];return A(n)?n(t):n.replace(/%s/i,t)},hn.set=function(e){var t,n;for(n in e)A(t=e[n])?this[n]=t:this["_"+n]=t;this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)},hn.months=function(e,t){return e?s(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||ke).test(t)?"format":"standalone"][e.month()]:s(this._months)?this._months:this._months.standalone},hn.monthsShort=function(e,t){return e?s(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[ke.test(t)?"format":"standalone"][e.month()]:s(this._monthsShort)?this._monthsShort:this._monthsShort.standalone},hn.monthsParse=function(e,t,n){var r,i,o;if(this._monthsParseExact)return function(e,t,n){var r,i,o,a=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)o=m([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(o,"").toLocaleLowerCase();return n?"MMM"===t?-1!==(i=Te.call(this._shortMonthsParse,a))?i:null:-1!==(i=Te.call(this._longMonthsParse,a))?i:null:"MMM"===t?-1!==(i=Te.call(this._shortMonthsParse,a))?i:-1!==(i=Te.call(this._longMonthsParse,a))?i:null:-1!==(i=Te.call(this._longMonthsParse,a))?i:-1!==(i=Te.call(this._shortMonthsParse,a))?i:null}.call(this,e,t,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=m([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),n||this._monthsParse[r]||(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(o.replace(".",""),"i")),n&&"MMMM"===t&&this._longMonthsParse[r].test(e))return r;if(n&&"MMM"===t&&this._shortMonthsParse[r].test(e))return r;if(!n&&this._monthsParse[r].test(e))return r}},hn.monthsRegex=function(e){return this._monthsParseExact?(p(this,"_monthsRegex")||Ve.call(this),e?this._monthsStrictRegex:this._monthsRegex):(p(this,"_monthsRegex")||(this._monthsRegex=Fe),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)},hn.monthsShortRegex=function(e){return this._monthsParseExact?(p(this,"_monthsRegex")||Ve.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(p(this,"_monthsShortRegex")||(this._monthsShortRegex=Le),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)},hn.week=function(e){return qe(e,this._week.dow,this._week.doy).week},hn.firstDayOfYear=function(){return this._week.doy},hn.firstDayOfWeek=function(){return this._week.dow},hn.weekdays=function(e,t){return e?s(this._weekdays)?this._weekdays[e.day()]:this._weekdays[this._weekdays.isFormat.test(t)?"format":"standalone"][e.day()]:s(this._weekdays)?this._weekdays:this._weekdays.standalone},hn.weekdaysMin=function(e){return e?this._weekdaysMin[e.day()]:this._weekdaysMin},hn.weekdaysShort=function(e){return e?this._weekdaysShort[e.day()]:this._weekdaysShort},hn.weekdaysParse=function(e,t,n){var r,i,o;if(this._weekdaysParseExact)return function(e,t,n){var r,i,o,a=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)o=m([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(o,"").toLocaleLowerCase();return n?"dddd"===t?-1!==(i=Te.call(this._weekdaysParse,a))?i:null:"ddd"===t?-1!==(i=Te.call(this._shortWeekdaysParse,a))?i:null:-1!==(i=Te.call(this._minWeekdaysParse,a))?i:null:"dddd"===t?-1!==(i=Te.call(this._weekdaysParse,a))?i:-1!==(i=Te.call(this._shortWeekdaysParse,a))?i:-1!==(i=Te.call(this._minWeekdaysParse,a))?i:null:"ddd"===t?-1!==(i=Te.call(this._shortWeekdaysParse,a))?i:-1!==(i=Te.call(this._weekdaysParse,a))?i:-1!==(i=Te.call(this._minWeekdaysParse,a))?i:null:-1!==(i=Te.call(this._minWeekdaysParse,a))?i:-1!==(i=Te.call(this._weekdaysParse,a))?i:-1!==(i=Te.call(this._shortWeekdaysParse,a))?i:null}.call(this,e,t,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=m([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".",".?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".",".?")+"$","i")),this._weekdaysParse[r]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(o.replace(".",""),"i")),n&&"dddd"===t&&this._fullWeekdaysParse[r].test(e))return r;if(n&&"ddd"===t&&this._shortWeekdaysParse[r].test(e))return r;if(n&&"dd"===t&&this._minWeekdaysParse[r].test(e))return r;if(!n&&this._weekdaysParse[r].test(e))return r}},hn.weekdaysRegex=function(e){return this._weekdaysParseExact?(p(this,"_weekdaysRegex")||Ye.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(p(this,"_weekdaysRegex")||(this._weekdaysRegex=$e),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)},hn.weekdaysShortRegex=function(e){return this._weekdaysParseExact?(p(this,"_weekdaysRegex")||Ye.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(p(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=ze),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)},hn.weekdaysMinRegex=function(e){return this._weekdaysParseExact?(p(this,"_weekdaysRegex")||Ye.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(p(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Qe),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)},hn.isPM=function(e){return"p"===(e+"").toLowerCase().charAt(0)},hn.meridiem=function(e,t,n){return 11<e?n?"pm":"PM":n?"am":"AM"},st("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1===C(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}}),f.lang=n("moment.lang is deprecated. Use moment.locale instead.",st),f.langData=n("moment.langData is deprecated. Use moment.localeData instead.",ct);var vn=Math.abs;function mn(e,t,n,r){var i=Wt(t,n);return e._milliseconds+=r*i._milliseconds,e._days+=r*i._days,e._months+=r*i._months,e._bubble()}function gn(e){return e<0?Math.floor(e):Math.ceil(e)}function yn(e){return 4800*e/146097}function bn(e){return 146097*e/4800}function _n(e){return function(){return this.as(e)}}var wn=_n("ms"),En=_n("s"),Sn=_n("m"),Cn=_n("h"),Tn=_n("d"),On=_n("w"),Rn=_n("M"),An=_n("y");function In(e){return function(){return this.isValid()?this._data[e]:NaN}}var Nn=In("milliseconds"),kn=In("seconds"),Pn=In("minutes"),xn=In("hours"),Dn=In("days"),Mn=In("months"),Ln=In("years");var Fn=Math.round,Vn={ss:44,s:45,m:45,h:22,d:26,M:11};var jn=Math.abs;function Un(e){return(0<e)-(e<0)||+e}function Bn(){if(!this.isValid())return this.localeData().invalidDate();var e,t,n=jn(this._milliseconds)/1e3,r=jn(this._days),i=jn(this._months);t=S((e=S(n/60))/60),n%=60,e%=60;var o=S(i/12),a=i%=12,s=r,u=t,c=e,l=n?n.toFixed(3).replace(/\.?0+$/,""):"",h=this.asSeconds();if(!h)return"P0D";var f=h<0?"-":"",d=Un(this._months)!==Un(h)?"-":"",p=Un(this._days)!==Un(h)?"-":"",v=Un(this._milliseconds)!==Un(h)?"-":"";return f+"P"+(o?d+o+"Y":"")+(a?d+a+"M":"")+(s?p+s+"D":"")+(u||c||l?"T":"")+(u?v+u+"H":"")+(c?v+c+"M":"")+(l?v+l+"S":"")}var qn=Pt.prototype;return qn.isValid=function(){return this._isValid},qn.abs=function(){var e=this._data;return this._milliseconds=vn(this._milliseconds),this._days=vn(this._days),this._months=vn(this._months),e.milliseconds=vn(e.milliseconds),e.seconds=vn(e.seconds),e.minutes=vn(e.minutes),e.hours=vn(e.hours),e.months=vn(e.months),e.years=vn(e.years),this},qn.add=function(e,t){return mn(this,e,t,1)},qn.subtract=function(e,t){return mn(this,e,t,-1)},qn.as=function(e){if(!this.isValid())return NaN;var t,n,r=this._milliseconds;if("month"===(e=x(e))||"year"===e)return t=this._days+r/864e5,n=this._months+yn(t),"month"===e?n:n/12;switch(t=this._days+Math.round(bn(this._months)),e){case"week":return t/7+r/6048e5;case"day":return t+r/864e5;case"hour":return 24*t+r/36e5;case"minute":return 1440*t+r/6e4;case"second":return 86400*t+r/1e3;case"millisecond":return Math.floor(864e5*t)+r;default:throw new Error("Unknown unit "+e)}},qn.asMilliseconds=wn,qn.asSeconds=En,qn.asMinutes=Sn,qn.asHours=Cn,qn.asDays=Tn,qn.asWeeks=On,qn.asMonths=Rn,qn.asYears=An,qn.valueOf=function(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*C(this._months/12):NaN},qn._bubble=function(){var e,t,n,r,i,o=this._milliseconds,a=this._days,s=this._months,u=this._data;return 0<=o&&0<=a&&0<=s||o<=0&&a<=0&&s<=0||(o+=864e5*gn(bn(s)+a),s=a=0),u.milliseconds=o%1e3,e=S(o/1e3),u.seconds=e%60,t=S(e/60),u.minutes=t%60,n=S(t/60),u.hours=n%24,s+=i=S(yn(a+=S(n/24))),a-=gn(bn(i)),r=S(s/12),s%=12,u.days=a,u.months=s,u.years=r,this},qn.clone=function(){return Wt(this)},qn.get=function(e){return e=x(e),this.isValid()?this[e+"s"]():NaN},qn.milliseconds=Nn,qn.seconds=kn,qn.minutes=Pn,qn.hours=xn,qn.days=Dn,qn.weeks=function(){return S(this.days()/7)},qn.months=Mn,qn.years=Ln,qn.humanize=function(e){if(!this.isValid())return this.localeData().invalidDate();var t,n,r,i,o,a,s,u,c,l,h,f=this.localeData(),d=(n=!e,r=f,i=Wt(t=this).abs(),o=Fn(i.as("s")),a=Fn(i.as("m")),s=Fn(i.as("h")),u=Fn(i.as("d")),c=Fn(i.as("M")),l=Fn(i.as("y")),(h=o<=Vn.ss&&["s",o]||o<Vn.s&&["ss",o]||a<=1&&["m"]||a<Vn.m&&["mm",a]||s<=1&&["h"]||s<Vn.h&&["hh",s]||u<=1&&["d"]||u<Vn.d&&["dd",u]||c<=1&&["M"]||c<Vn.M&&["MM",c]||l<=1&&["y"]||["yy",l])[2]=n,h[3]=0<+t,h[4]=r,function(e,t,n,r,i){return i.relativeTime(t||1,!!n,e,r)}.apply(null,h));return e&&(d=f.pastFuture(+this,d)),f.postformat(d)},qn.toISOString=Bn,qn.toString=Bn,qn.toJSON=Bn,qn.locale=Xt,qn.localeData=Zt,qn.toIsoString=n("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Bn),qn.lang=Jt,q("X",0,0,"unix"),q("x",0,0,"valueOf"),ue("x",re),ue("X",/[+-]?\d+(\.\d{1,3})?/),fe("X",function(e,t,n){n._d=new Date(1e3*parseFloat(e,10))}),fe("x",function(e,t,n){n._d=new Date(C(e))}),f.version="2.22.1",e=Rt,f.fn=cn,f.min=function(){return Nt("isBefore",[].slice.call(arguments,0))},f.max=function(){return Nt("isAfter",[].slice.call(arguments,0))},f.now=function(){return Date.now?Date.now():+new Date},f.utc=m,f.unix=function(e){return Rt(1e3*e)},f.months=function(e,t){return dn(e,t,"months")},f.isDate=h,f.locale=st,f.invalid=b,f.duration=Wt,f.isMoment=E,f.weekdays=function(e,t,n){return pn(e,t,n,"weekdays")},f.parseZone=function(){return Rt.apply(null,arguments).parseZone()},f.localeData=ct,f.isDuration=xt,f.monthsShort=function(e,t){return dn(e,t,"monthsShort")},f.weekdaysMin=function(e,t,n){return pn(e,t,n,"weekdaysMin")},f.defineLocale=ut,f.updateLocale=function(e,t){if(null!=t){var n,r,i=nt;null!=(r=at(e))&&(i=r._config),(n=new N(t=I(i,t))).parentLocale=rt[e],rt[e]=n,st(e)}else null!=rt[e]&&(null!=rt[e].parentLocale?rt[e]=rt[e].parentLocale:null!=rt[e]&&delete rt[e]);return rt[e]},f.locales=function(){return r(rt)},f.weekdaysShort=function(e,t,n){return pn(e,t,n,"weekdaysShort")},f.normalizeUnits=x,f.relativeTimeRounding=function(e){return void 0===e?Fn:"function"==typeof e&&(Fn=e,!0)},f.relativeTimeThreshold=function(e,t){return void 0!==Vn[e]&&(void 0===t?Vn[e]:(Vn[e]=t,"s"===e&&(Vn.ss=t-1),!0))},f.calendarFormat=function(e,t){var n=e.diff(t,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"},f.prototype=cn,f.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"YYYY-[W]WW",MONTH:"YYYY-MM"},f}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define("firebase/firebase",t):e.firebase=t()}(this,function(){"use strict";!function(e){if(!e.fetch){var t="URLSearchParams"in e,n="Symbol"in e&&"iterator"in Symbol,a="FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),r="FormData"in e,i="ArrayBuffer"in e;if(i)var o=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],s=function(e){return e&&DataView.prototype.isPrototypeOf(e)},u=ArrayBuffer.isView||function(e){return e&&-1<o.indexOf(Object.prototype.toString.call(e))};p.prototype.append=function(e,t){e=h(e),t=f(t);var n=this.map[e];this.map[e]=n?n+","+t:t},p.prototype.delete=function(e){delete this.map[h(e)]},p.prototype.get=function(e){return e=h(e),this.has(e)?this.map[e]:null},p.prototype.has=function(e){return this.map.hasOwnProperty(h(e))},p.prototype.set=function(e,t){this.map[h(e)]=f(t)},p.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},p.prototype.keys=function(){var n=[];return this.forEach(function(e,t){n.push(t)}),d(n)},p.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),d(t)},p.prototype.entries=function(){var n=[];return this.forEach(function(e,t){n.push([t,e])}),d(n)},n&&(p.prototype[Symbol.iterator]=p.prototype.entries);var c=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];_.prototype.clone=function(){return new _(this,{body:this._bodyInit})},b.call(_.prototype),b.call(E.prototype),E.prototype.clone=function(){return new E(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new p(this.headers),url:this.url})},E.error=function(){var e=new E(null,{status:0,statusText:""});return e.type="error",e};var l=[301,302,303,307,308];E.redirect=function(e,t){if(-1===l.indexOf(t))throw new RangeError("Invalid status code");return new E(null,{status:t,headers:{location:e}})},e.Headers=p,e.Request=_,e.Response=E,e.fetch=function(n,i){return new Promise(function(r,e){var t=new _(n,i),o=new XMLHttpRequest;o.onload=function(){var e,i,t={status:o.status,statusText:o.statusText,headers:(e=o.getAllResponseHeaders()||"",i=new p,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(e){var t=e.split(":"),n=t.shift().trim();if(n){var r=t.join(":").trim();i.append(n,r)}}),i)};t.url="responseURL"in o?o.responseURL:t.headers.get("X-Request-URL");var n="response"in o?o.response:o.responseText;r(new E(n,t))},o.onerror=function(){e(new TypeError("Network request failed"))},o.ontimeout=function(){e(new TypeError("Network request failed"))},o.open(t.method,t.url,!0),"include"===t.credentials?o.withCredentials=!0:"omit"===t.credentials&&(o.withCredentials=!1),"responseType"in o&&a&&(o.responseType="blob"),t.headers.forEach(function(e,t){o.setRequestHeader(t,e)}),o.send(void 0===t._bodyInit?null:t._bodyInit)})},e.fetch.polyfill=!0}function h(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function f(e){return"string"!=typeof e&&(e=String(e)),e}function d(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return n&&(e[Symbol.iterator]=function(){return e}),e}function p(t){this.map={},t instanceof p?t.forEach(function(e,t){this.append(t,e)},this):Array.isArray(t)?t.forEach(function(e){this.append(e[0],e[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function v(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function m(n){return new Promise(function(e,t){n.onload=function(){e(n.result)},n.onerror=function(){t(n.error)}})}function g(e){var t=new FileReader,n=m(t);return t.readAsArrayBuffer(e),n}function y(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function b(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e)if("string"==typeof e)this._bodyText=e;else if(a&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(r&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(t&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(i&&a&&s(e))this._bodyArrayBuffer=y(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!i||!ArrayBuffer.prototype.isPrototypeOf(e)&&!u(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=y(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},a&&(this.blob=function(){var e=v(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?v(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(g)}),this.text=function(){var e,t,n,r=v(this);if(r)return r;if(this._bodyBlob)return e=this._bodyBlob,n=m(t=new FileReader),t.readAsText(e),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},r&&(this.formData=function(){return this.text().then(w)}),this.json=function(){return this.text().then(JSON.parse)},this}function _(e,t){var n,r,i=(t=t||{}).body;if(e instanceof _){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new p(e.headers)),this.method=e.method,this.mode=e.mode,i||null==e._bodyInit||(i=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new p(t.headers)),this.method=(r=(n=t.method||this.method||"GET").toUpperCase(),-1<c.indexOf(r)?r:n),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function w(e){var i=new FormData;return e.trim().split("&").forEach(function(e){if(e){var t=e.split("="),n=t.shift().replace(/\+/g," "),r=t.join("=").replace(/\+/g," ");i.append(decodeURIComponent(n),decodeURIComponent(r))}}),i}function E(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=200<=this.status&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new p(t.headers),this.url=t.url||"",this._initBody(e)}}("undefined"!=typeof self?self:void 0);var setTimeoutFunc=setTimeout;function noop(){}function bind(e,t){return function(){e.apply(t,arguments)}}function Promise$1(e){if(!(this instanceof Promise$1))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],doResolve(e,this)}function handle(n,r){for(;3===n._state;)n=n._value;0!==n._state?(n._handled=!0,Promise$1._immediateFn(function(){var e=1===n._state?r.onFulfilled:r.onRejected;if(null!==e){var t;try{t=e(n._value)}catch(e){return void reject(r.promise,e)}resolve(r.promise,t)}else(1===n._state?resolve:reject)(r.promise,n._value)})):n._deferreds.push(r)}function resolve(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if(t instanceof Promise$1)return e._state=3,e._value=t,void finale(e);if("function"==typeof n)return void doResolve(bind(n,t),e)}e._state=1,e._value=t,finale(e)}catch(t){reject(e,t)}}function reject(e,t){e._state=2,e._value=t,finale(e)}function finale(e){2===e._state&&0===e._deferreds.length&&Promise$1._immediateFn(function(){e._handled||Promise$1._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)handle(e,e._deferreds[t]);e._deferreds=null}function Handler(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function doResolve(e,t){var n=!1;try{e(function(e){n||(n=!0,resolve(t,e))},function(e){n||(n=!0,reject(t,e))})}catch(e){if(n)return;n=!0,reject(t,e)}}Promise$1.prototype.catch=function(e){return this.then(null,e)},Promise$1.prototype.then=function(e,t){var n=new this.constructor(noop);return handle(this,new Handler(e,t,n)),n},Promise$1.prototype.finally=function(t){var n=this.constructor;return this.then(function(e){return n.resolve(t()).then(function(){return e})},function(e){return n.resolve(t()).then(function(){return n.reject(e)})})},Promise$1.all=function(t){return new Promise$1(function(r,i){if(!t||void 0===t.length)throw new TypeError("Promise.all accepts an array");var o=Array.prototype.slice.call(t);if(0===o.length)return r([]);var a=o.length;function s(t,e){try{if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if("function"==typeof n)return void n.call(e,function(e){s(t,e)},i)}o[t]=e,0==--a&&r(o)}catch(t){i(t)}}for(var e=0;e<o.length;e++)s(e,o[e])})},Promise$1.resolve=function(t){return t&&"object"==typeof t&&t.constructor===Promise$1?t:new Promise$1(function(e){e(t)})},Promise$1.reject=function(n){return new Promise$1(function(e,t){t(n)})},Promise$1.race=function(i){return new Promise$1(function(e,t){for(var n=0,r=i.length;n<r;n++)i[n].then(e,t)})},Promise$1._immediateFn="function"==typeof setImmediate&&function(e){setImmediate(e)}||function(e){setTimeoutFunc(e,0)},Promise$1._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)};var globalNS=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("unable to locate global object")}();function createCommonjsModule(e,t){return e(t={exports:{}},t.exports),t.exports}globalNS.Promise||(globalNS.Promise=Promise$1);var _global=createCommonjsModule(function(e){var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)}),_core=createCommonjsModule(function(e){var t=e.exports={version:"2.5.5"};"number"==typeof __e&&(__e=t)}),_core_1=_core.version,_isObject=function(e){return"object"==typeof e?null!==e:"function"==typeof e},_anObject=function(e){if(!_isObject(e))throw TypeError(e+" is not an object!");return e},_fails=function(e){try{return!!e()}catch(e){return!0}},_descriptors=!_fails(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),document$1=_global.document,is=_isObject(document$1)&&_isObject(document$1.createElement),_domCreate=function(e){return is?document$1.createElement(e):{}},_ie8DomDefine=!_descriptors&&!_fails(function(){return 7!=Object.defineProperty(_domCreate("div"),"a",{get:function(){return 7}}).a}),_toPrimitive=function(e,t){if(!_isObject(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!_isObject(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!_isObject(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!_isObject(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")},dP=Object.defineProperty,f=_descriptors?Object.defineProperty:function(e,t,n){if(_anObject(e),t=_toPrimitive(t,!0),_anObject(n),_ie8DomDefine)try{return dP(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e},_objectDp={f:f},_propertyDesc=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},_hide=_descriptors?function(e,t,n){return _objectDp.f(e,t,_propertyDesc(1,n))}:function(e,t,n){return e[t]=n,e},hasOwnProperty={}.hasOwnProperty,_has=function(e,t){return hasOwnProperty.call(e,t)},id=0,px=Math.random(),_uid=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++id+px).toString(36))},_redefine=createCommonjsModule(function(e){var o=_uid("src"),t=Function.toString,a=(""+t).split("toString");_core.inspectSource=function(e){return t.call(e)},(e.exports=function(e,t,n,r){var i="function"==typeof n;i&&(_has(n,"name")||_hide(n,"name",t)),e[t]!==n&&(i&&(_has(n,o)||_hide(n,o,e[t]?""+e[t]:a.join(String(t)))),e===_global?e[t]=n:r?e[t]?e[t]=n:_hide(e,t,n):(delete e[t],_hide(e,t,n)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[o]||t.call(this)})}),_aFunction=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e},_ctx=function(r,i,e){if(_aFunction(r),void 0===i)return r;switch(e){case 1:return function(e){return r.call(i,e)};case 2:return function(e,t){return r.call(i,e,t)};case 3:return function(e,t,n){return r.call(i,e,t,n)}}return function(){return r.apply(i,arguments)}},PROTOTYPE="prototype",$export=function(e,t,n){var r,i,o,a,s=e&$export.F,u=e&$export.G,c=e&$export.S,l=e&$export.P,h=e&$export.B,f=u?_global:c?_global[t]||(_global[t]={}):(_global[t]||{})[PROTOTYPE],d=u?_core:_core[t]||(_core[t]={}),p=d[PROTOTYPE]||(d[PROTOTYPE]={});for(r in u&&(n=t),n)o=((i=!s&&f&&void 0!==f[r])?f:n)[r],a=h&&i?_ctx(o,_global):l&&"function"==typeof o?_ctx(Function.call,o):o,f&&_redefine(f,r,o,e&$export.U),d[r]!=o&&_hide(d,r,a),l&&p[r]!=o&&(p[r]=o)};_global.core=_core,$export.F=1,$export.G=2,$export.S=4,$export.P=8,$export.B=16,$export.W=32,$export.U=64,$export.R=128;var _export=$export,toString$1={}.toString,_cof=function(e){return toString$1.call(e).slice(8,-1)},_iobject=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==_cof(e)?e.split(""):Object(e)},_defined=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e},_toObject=function(e){return Object(_defined(e))},ceil=Math.ceil,floor=Math.floor,_toInteger=function(e){return isNaN(e=+e)?0:(0<e?floor:ceil)(e)},min=Math.min,_toLength=function(e){return 0<e?min(_toInteger(e),9007199254740991):0},_isArray=Array.isArray||function(e){return"Array"==_cof(e)},SHARED="__core-js_shared__",store=_global[SHARED]||(_global[SHARED]={}),_shared=function(e){return store[e]||(store[e]={})},_wks=createCommonjsModule(function(e){var t=_shared("wks"),n=_global.Symbol,r="function"==typeof n;(e.exports=function(e){return t[e]||(t[e]=r&&n[e]||(r?n:_uid)("Symbol."+e))}).store=t}),SPECIES=_wks("species"),_arraySpeciesConstructor=function(e){var t;return _isArray(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!_isArray(t.prototype)||(t=void 0),_isObject(t)&&null===(t=t[SPECIES])&&(t=void 0)),void 0===t?Array:t},_arraySpeciesCreate=function(e,t){return new(_arraySpeciesConstructor(e))(t)},_arrayMethods=function(h,e){var f=1==h,d=2==h,p=3==h,v=4==h,m=6==h,g=5==h||m,y=e||_arraySpeciesCreate;return function(e,t,n){for(var r,i,o=_toObject(e),a=_iobject(o),s=_ctx(t,n,3),u=_toLength(a.length),c=0,l=f?y(e,u):d?y(e,0):void 0;c<u;c++)if((g||c in a)&&(i=s(r=a[c],c,o),h))if(f)l[c]=i;else if(i)switch(h){case 3:return!0;case 5:return r;case 6:return c;case 2:l.push(r)}else if(v)return!1;return m?-1:p||v?v:l}},UNSCOPABLES=_wks("unscopables"),ArrayProto=Array.prototype;null==ArrayProto[UNSCOPABLES]&&_hide(ArrayProto,UNSCOPABLES,{});var _addToUnscopables=function(e){ArrayProto[UNSCOPABLES][e]=!0},$find=_arrayMethods(5),KEY="find",forced=!0;KEY in[]&&Array(1)[KEY](function(){forced=!1}),_export(_export.P+_export.F*forced,"Array",{find:function(e){return $find(this,e,1<arguments.length?arguments[1]:void 0)}}),_addToUnscopables(KEY);var find=_core.Array.find,$find$1=_arrayMethods(6),KEY$1="findIndex",forced$1=!0;KEY$1 in[]&&Array(1)[KEY$1](function(){forced$1=!1}),_export(_export.P+_export.F*forced$1,"Array",{findIndex:function(e){return $find$1(this,e,1<arguments.length?arguments[1]:void 0)}}),_addToUnscopables(KEY$1);var findIndex=_core.Array.findIndex,MATCH=_wks("match"),_isRegexp=function(e){var t;return _isObject(e)&&(void 0!==(t=e[MATCH])?!!t:"RegExp"==_cof(e))},_stringContext=function(e,t,n){if(_isRegexp(t))throw TypeError("String#"+n+" doesn't accept regex!");return String(_defined(e))},MATCH$1=_wks("match"),_failsIsRegexp=function(t){var n=/./;try{"/./"[t](n)}catch(e){try{return n[MATCH$1]=!1,!"/./"[t](n)}catch(t){}}return!0},STARTS_WITH="startsWith",$startsWith=""[STARTS_WITH];_export(_export.P+_export.F*_failsIsRegexp(STARTS_WITH),"String",{startsWith:function(e){var t=_stringContext(this,e,STARTS_WITH),n=_toLength(Math.min(1<arguments.length?arguments[1]:void 0,t.length)),r=String(e);return $startsWith?$startsWith.call(t,r,n):t.slice(n,n+r.length)===r}});var startsWith=_core.String.startsWith,extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};function __extends(e,t){function n(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var __assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e};function __awaiter(o,a,s,u){return new(s||(s=Promise))(function(e,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function r(e){try{i(u.throw(e))}catch(e){t(e)}}function i(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(n,r)}i((u=u.apply(o,a||[])).next())})}function __generator(n,r){var i,o,a,e,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,o&&(a=o[2&t[0]?"return":t[0]?"throw":"next"])&&!(a=a.call(o,t[1])).done)return a;switch(o=0,a&&(t=[0,a.value]),t[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,o=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=r.call(n,s)}catch(e){t=[6,e],o=0}finally{i=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}}var CONSTANTS={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},assert=function(e,t){if(!e)throw assertionError(t)},assertionError=function(e){return new Error("Firebase Database ("+CONSTANTS.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)},stringToByteArray=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:(i<2048?t[n++]=i>>6|192:(55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128):t[n++]=i>>12|224,t[n++]=i>>6&63|128),t[n++]=63&i|128)}return t},byteArrayToString=function(e){for(var t=[],n=0,r=0;n<e.length;){var i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(191<i&&i<224){var o=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(239<i&&i<365){var a=((7&i)<<18|(63&(o=e[n++]))<<12|(63&(s=e[n++]))<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(a>>10)),t[r++]=String.fromCharCode(56320+(1023&a))}else{o=e[n++];var s=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}}return t.join("")},base64={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<e.length;i+=3){var o=e[i],a=i+1<e.length,s=a?e[i+1]:0,u=i+2<e.length,c=u?e[i+2]:0,l=o>>2,h=(3&o)<<4|s>>4,f=(15&s)<<2|c>>6,d=63&c;u||(d=64,a||(f=64)),r.push(n[l],n[h],n[f],n[d])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(stringToByteArray(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):byteArrayToString(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<e.length;){var o=n[e.charAt(i++)],a=i<e.length?n[e.charAt(i)]:0,s=++i<e.length?n[e.charAt(i)]:64,u=++i<e.length?n[e.charAt(i)]:64;if(++i,null==o||null==a||null==s||null==u)throw Error();var c=o<<2|a>>4;if(r.push(c),64!=s){var l=a<<4&240|s>>2;if(r.push(l),64!=u){var h=s<<6&192|u;r.push(h)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),(this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e)>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},base64Encode=function(e){var t=stringToByteArray(e);return base64.encodeByteArray(t,!0)},base64Decode=function(e){try{return base64.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function deepCopy(e){return deepExtend(void 0,e)}function deepExtend(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var n in t)t.hasOwnProperty(n)&&(e[n]=deepExtend(e[n],t[n]));return e}function patchProperty(e,t,n){e[t]=n}var Deferred=function(){function e(){var n=this;this.promise=new Promise(function(e,t){n.resolve=e,n.reject=t})}return e.prototype.wrapCallback=function(n){var r=this;return function(e,t){e?r.reject(e):r.resolve(t),"function"==typeof n&&(r.promise.catch(function(){}),1===n.length?n(e):n(e,t))}},e}(),getUA=function(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""},isMobileCordova=function(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(getUA())},isReactNative=function(){return"object"==typeof navigator&&"ReactNative"===navigator.product},isNodeSdk=function(){return!0===CONSTANTS.NODE_CLIENT||!0===CONSTANTS.NODE_ADMIN},ERROR_NAME="FirebaseError",captureStackTrace=Error.captureStackTrace,FirebaseError=function(e,t){if(this.code=e,this.message=t,captureStackTrace)captureStackTrace(this,ErrorFactory.prototype.create);else{var n=Error.apply(this,arguments);this.name=ERROR_NAME,Object.defineProperty(this,"stack",{get:function(){return n.stack}})}};FirebaseError.prototype=Object.create(Error.prototype),FirebaseError.prototype.constructor=FirebaseError,FirebaseError.prototype.name=ERROR_NAME;var ErrorFactory=function(){function e(e,t,n){this.service=e,this.serviceName=t,this.errors=n,this.pattern=/\{\$([^}]+)}/g}return e.prototype.create=function(e,r){void 0===r&&(r={});var t,n=this.errors[e],i=this.service+"/"+e;t=void 0===n?"Error":n.replace(this.pattern,function(e,t){var n=r[t];return void 0!==n?n.toString():"<"+t+"?>"}),t=this.serviceName+": "+t+" ("+i+").";var o=new FirebaseError(i,t);for(var a in r)r.hasOwnProperty(a)&&"_"!==a.slice(-1)&&(o[a]=r[a]);return o},e}();function jsonEval(e){return JSON.parse(e)}function stringify(e){return JSON.stringify(e)}var decode=function(e){var t={},n={},r={},i="";try{var o=e.split(".");t=jsonEval(base64Decode(o[0])||""),n=jsonEval(base64Decode(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(e){}return{header:t,claims:n,data:r,signature:i}},isValidFormat=function(e){var t=decode(e),n=t.claims;return!!t.signature&&!!n&&"object"==typeof n&&n.hasOwnProperty("iat")},isAdmin=function(e){var t=decode(e).claims;return"object"==typeof t&&!0===t.admin},contains=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},safeGet=function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]},forEach=function(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])},extend=function(n,e){return forEach(e,function(e,t){n[e]=t}),n},clone=function(e){return extend({},e)},isEmpty=function(e){for(var t in e)return!1;return!0},getCount=function(e){var t=0;for(var n in e)t++;return t},map=function(e,t,n){var r={};for(var i in e)r[i]=t.call(n,e[i],i,e);return r},findKey=function(e,t,n){for(var r in e)if(t.call(n,e[r],r,e))return r},findValue=function(e,t,n){var r=findKey(e,t,n);return r&&e[r]},getAnyKey=function(e){for(var t in e)return t},getValues=function(e){var t=[],n=0;for(var r in e)t[n++]=e[r];return t},every=function(e,t){for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&!t(n,e[n]))return!1;return!0},querystring=function(e){var n=[];return forEach(e,function(t,e){Array.isArray(e)?e.forEach(function(e){n.push(encodeURIComponent(t)+"="+encodeURIComponent(e))}):n.push(encodeURIComponent(t)+"="+encodeURIComponent(e))}),n.length?"&"+n.join("&"):""},Hash=function(){this.blockSize=-1},Sha1=function(n){function e(){var e=n.call(this)||this;e.chain_=[],e.buf_=[],e.W_=[],e.pad_=[],e.inbuf_=0,e.total_=0,e.blockSize=64,e.pad_[0]=128;for(var t=1;t<e.blockSize;++t)e.pad_[t]=0;return e.reset(),e}return __extends(e,n),e.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},e.prototype.compress_=function(e,t){t||(t=0);var n=this.W_;if("string"==typeof e)for(var r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(r=0;r<16;r++)n[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var o,a,s=this.chain_[0],u=this.chain_[1],c=this.chain_[2],l=this.chain_[3],h=this.chain_[4];for(r=0;r<80;r++)r<40?r<20?(o=l^u&(c^l),a=1518500249):(o=u^c^l,a=1859775393):r<60?(o=u&c|l&(u|c),a=2400959708):(o=u^c^l,a=3395469782),i=(s<<5|s>>>27)+o+h+a+n[r]&4294967295,h=l,l=c,c=4294967295&(u<<30|u>>>2),u=s,s=i;this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295},e.prototype.update=function(e,t){if(null!=e){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<t;){if(0==o)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[o]=e.charCodeAt(r),++r,++o==this.blockSize){this.compress_(i),o=0;break}}else for(;r<t;)if(i[o]=e[r],++r,++o==this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=t}},e.prototype.digest=function(){var e=[],t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;56<=n;n--)this.buf_[n]=255&t,t/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;0<=i;i-=8)e[r]=this.chain_[n]>>i&255,++r;return e},e}(Hash);function createSubscribe(e,t){var n=new ObserverProxy(e,t);return n.subscribe.bind(n)}var ObserverProxy=function(){function e(e,t){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(function(){e(n)}).catch(function(e){n.error(e)})}return e.prototype.next=function(t){this.forEachObserver(function(e){e.next(t)})},e.prototype.error=function(t){this.forEachObserver(function(e){e.error(t)}),this.close(t)},e.prototype.complete=function(){this.forEachObserver(function(e){e.complete()}),this.close()},e.prototype.subscribe=function(e,t,n){var r,i=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");void 0===(r=implementsAnyMethods(e,["next","error","complete"])?e:{next:e,error:t,complete:n}).next&&(r.next=noop$1),void 0===r.error&&(r.error=noop$1),void 0===r.complete&&(r.complete=noop$1);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(e){}}),this.observers.push(r),o},e.prototype.unsubscribeOne=function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},e.prototype.forEachObserver=function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)},e.prototype.sendOne=function(e,t){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}})},e.prototype.close=function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(function(){t.observers=void 0,t.onNoObservers=void 0}))},e}();function implementsAnyMethods(e,t){if("object"!=typeof e||null===e)return!1;for(var n=0,r=t;n<r.length;n++){var i=r[n];if(i in e&&"function"==typeof e[i])return!0}return!1}function noop$1(){}var validateArgCount=function(e,t,n,r){var i;if(r<t?i="at least "+t:n<r&&(i=0===n?"none":"no more than "+n),i)throw new Error(e+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")};function errorPrefix(e,t,n){var r="";switch(t){case 1:r=n?"first":"First";break;case 2:r=n?"second":"Second";break;case 3:r=n?"third":"Third";break;case 4:r=n?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}return e+" failed: "+(r+" argument ")}function validateCallback(e,t,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(errorPrefix(e,t,r)+"must be a valid function.")}function validateContextObject(e,t,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(errorPrefix(e,t,r)+"must be a valid context object.")}var stringToByteArray$1=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);if(55296<=i&&i<=56319){var o=i-55296;assert(++r<e.length,"Surrogate pair missing trail surrogate."),i=65536+(o<<10)+(e.charCodeAt(r)-56320)}i<128?t[n++]=i:(i<2048?t[n++]=i>>6|192:(i<65536?t[n++]=i>>12|224:(t[n++]=i>>18|240,t[n++]=i>>12&63|128),t[n++]=i>>6&63|128),t[n++]=63&i|128)}return t},stringLength=function(e){for(var t=0,n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:55296<=r&&r<=56319?(t+=4,n++):t+=3}return t},contains$1=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},DEFAULT_ENTRY_NAME="[DEFAULT]",tokenListeners=[],FirebaseAppImpl=function(){function e(e,t,n){this.firebase_=n,this.isDeleted_=!1,this.services_={},this.name_=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled||!1,this.options_=deepCopy(e),this.INTERNAL={getUid:function(){return null},getToken:function(){return Promise.resolve(null)},addAuthTokenListener:function(e){tokenListeners.push(e),setTimeout(function(){return e(null)},0)},removeAuthTokenListener:function(t){tokenListeners=tokenListeners.filter(function(e){return e!==t})}}}return Object.defineProperty(e.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this._automaticDataCollectionEnabled},set:function(e){this.checkDestroyed_(),this._automaticDataCollectionEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),e.prototype.delete=function(){var r=this;return new Promise(function(e){r.checkDestroyed_(),e()}).then(function(){r.firebase_.INTERNAL.removeApp(r.name_);var n=[];return Object.keys(r.services_).forEach(function(t){Object.keys(r.services_[t]).forEach(function(e){n.push(r.services_[t][e])})}),Promise.all(n.map(function(e){return e.INTERNAL.delete()}))}).then(function(){r.isDeleted_=!0,r.services_={}})},e.prototype._getService=function(e,t){if(void 0===t&&(t=DEFAULT_ENTRY_NAME),this.checkDestroyed_(),this.services_[e]||(this.services_[e]={}),!this.services_[e][t]){var n=t!==DEFAULT_ENTRY_NAME?t:void 0,r=this.firebase_.INTERNAL.factories[e](this,this.extendApp.bind(this),n);this.services_[e][t]=r}return this.services_[e][t]},e.prototype.extendApp=function(e){var t=this;deepExtend(this,e),e.INTERNAL&&e.INTERNAL.addAuthTokenListener&&(tokenListeners.forEach(function(e){t.INTERNAL.addAuthTokenListener(e)}),tokenListeners=[])},e.prototype.checkDestroyed_=function(){this.isDeleted_&&error("app-deleted",{name:this.name_})},e}();function createFirebaseNamespace(){var o={},a={},s={},u={__esModule:!0,initializeApp:function(e,t){(void 0===t&&(t={}),"object"!=typeof t||null===t)&&(t={name:t});var n=t;void 0===n.name&&(n.name=DEFAULT_ENTRY_NAME);var r=n.name;"string"==typeof r&&r||error("bad-app-name",{name:r+""}),contains$1(o,r)&&error("duplicate-app",{name:r});var i=new FirebaseAppImpl(e,n,u);return h(o[r]=i,"create"),i},app:c,apps:null,Promise:Promise,SDK_VERSION:"5.0.2",INTERNAL:{registerService:function(n,e,t,r,i){a[n]&&error("duplicate-service",{name:n}),a[n]=e,r&&(s[n]=r,l().forEach(function(e){r("create",e)}));var o=function(e){return void 0===e&&(e=c()),"function"!=typeof e[n]&&error("invalid-app-argument",{name:n}),e[n]()};return void 0!==t&&deepExtend(o,t),u[n]=o,FirebaseAppImpl.prototype[n]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._getService.bind(this,n).apply(this,i?e:[])},o},createFirebaseNamespace:createFirebaseNamespace,extendNamespace:function(e){deepExtend(u,e)},createSubscribe:createSubscribe,ErrorFactory:ErrorFactory,removeApp:function(e){h(o[e],"delete"),delete o[e]},factories:a,useAsService:i,Promise:Promise,deepExtend:deepExtend}};function c(e){return contains$1(o,e=e||DEFAULT_ENTRY_NAME)||error("no-app",{name:e}),o[e]}function l(){return Object.keys(o).map(function(e){return o[e]})}function h(n,r){Object.keys(a).forEach(function(e){var t=i(n,e);null!==t&&s[t]&&s[t](r,n)})}function i(e,t){if("serverAuth"===t)return null;var n=t;return e.options,n}return patchProperty(u,"default",u),Object.defineProperty(u,"apps",{get:l}),patchProperty(c,"App",FirebaseAppImpl),u}function error(e,t){throw appErrors.create(e,t)}FirebaseAppImpl.prototype.name&&FirebaseAppImpl.prototype.options||FirebaseAppImpl.prototype.delete||console.log("dc");var errors={"no-app":"No Firebase App '{$name}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$name}","duplicate-app":"Firebase App named '{$name}' already exists","app-deleted":"Firebase App named '{$name}' already deleted","duplicate-service":"Firebase service named '{$name}' already registered","sa-not-supported":"Initializing the Firebase SDK with a service account is only allowed in a Node.js environment. On client devices, you should instead initialize the SDK with an api key and auth domain","invalid-app-argument":"firebase.{$name}() takes either no argument or a Firebase App instance."},appErrors=new ErrorFactory("app","Firebase",errors),firebase=createFirebaseNamespace(),index_esm=Object.freeze({default:firebase,firebase:firebase}),commonjsGlobal="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function createCommonjsModule$1(e,t){return e(t={exports:{}},t.exports),t.exports}var require$$0=index_esm&&firebase||index_esm,LogLevel,Bfc;(function(){var e,d=require$$0.default,u=u||{},l=this;function c(e){return"string"==typeof e}function n(e){return"boolean"==typeof e}function o(){}function h(e){var t=typeof e;if("object"==t){if(!e)return"null";if(e instanceof Array)return"array";if(e instanceof Object)return t;var n=Object.prototype.toString.call(e);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof e.length&&void 0!==e.splice&&void 0!==e.propertyIsEnumerable&&!e.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==e.call&&void 0!==e.propertyIsEnumerable&&!e.propertyIsEnumerable("call"))return"function"}else if("function"==t&&void 0===e.call)return"object";return t}function r(e){return null===e}function f(e){return"array"==h(e)}function p(e){var t=h(e);return"array"==t||"object"==t&&"number"==typeof e.length}function a(e){return"function"==h(e)}function v(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var i="closure_uid_"+(1e9*Math.random()>>>0),s=0;function m(e,t,n){return e.call.apply(e.bind,arguments)}function g(t,n,e){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var e=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(e,r),t.apply(n,e)}}return function(){return t.apply(n,arguments)}}function y(e,t,n){return(y=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?m:g).apply(null,arguments)}function b(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var _=Date.now||function(){return+new Date};function t(e,o){function t(){}t.prototype=o.prototype,e.lb=o.prototype,e.prototype=new t,(e.prototype.constructor=e).cd=function(e,t,n){for(var r=Array(arguments.length-2),i=2;i<arguments.length;i++)r[i-2]=arguments[i];return o.prototype[t].apply(e,r)}}function w(e){e.prototype.then=e.prototype.then,e.prototype.$goog_Thenable=!0}function E(e){if(!e)return!1;try{return!!e.$goog_Thenable}catch(e){return!1}}function S(e){if(Error.captureStackTrace)Error.captureStackTrace(this,S);else{var t=Error().stack;t&&(this.stack=t)}e&&(this.message=String(e))}function C(e,t){for(var n="",r=(e=e.split("%s")).length-1,i=0;i<r;i++)n+=e[i]+(i<t.length?t[i]:"%s");S.call(this,n+e[r])}function T(e,t){throw new C("Failure"+(e?": "+e:""),Array.prototype.slice.call(arguments,1))}function O(e,t){this.c=e,this.f=t,this.b=0,this.a=null}function R(e,t){e.f(t),e.b<100&&(e.b++,t.next=e.a,e.a=t)}function A(){this.b=this.a=null}t(S,Error),S.prototype.name="CustomError",t(C,S),C.prototype.name="AssertionError",O.prototype.get=function(){if(0<this.b){this.b--;var e=this.a;this.a=e.next,e.next=null}else e=this.c();return e};var I=new O(function(){return new N},function(e){e.reset()});function N(){this.next=this.b=this.a=null}A.prototype.add=function(e,t){var n=I.get();n.set(e,t),this.b?this.b.next=n:this.a=n,this.b=n},N.prototype.set=function(e,t){this.a=e,this.b=t,this.next=null},N.prototype.reset=function(){this.next=this.b=this.a=null};var k=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if(c(e))return c(t)&&1==t.length?e.indexOf(t,0):-1;for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},P=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){for(var r=e.length,i=c(e)?e.split(""):e,o=0;o<r;o++)o in i&&t.call(n,i[o],o,e)},x=Array.prototype.map?function(e,t){return Array.prototype.map.call(e,t,void 0)}:function(e,t){for(var n=e.length,r=Array(n),i=c(e)?e.split(""):e,o=0;o<n;o++)o in i&&(r[o]=t.call(void 0,i[o],o,e));return r},D=Array.prototype.some?function(e,t){return Array.prototype.some.call(e,t,void 0)}:function(e,t){for(var n=e.length,r=c(e)?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e))return!0;return!1};function M(e,t){return 0<=k(e,t)}function L(e,t){var n;return(n=0<=(t=k(e,t)))&&Array.prototype.splice.call(e,t,1),n}function F(n,r){!function(e,t){var n=e.length,r=c(e)?e.split(""):e;for(--n;0<=n;--n)n in r&&t.call(void 0,r[n],n,e)}(n,function(e,t){r.call(void 0,e,t,n)&&Array.prototype.splice.call(n,t,1).length})}function V(e){return Array.prototype.concat.apply([],arguments)}function j(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function U(e,t){for(var n=e.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")}var B=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function q(e){return Y.test(e)&&(-1!=e.indexOf("&")&&(e=e.replace(H,"&amp;")),-1!=e.indexOf("<")&&(e=e.replace(G,"&lt;")),-1!=e.indexOf(">")&&(e=e.replace(K,"&gt;")),-1!=e.indexOf('"')&&(e=e.replace($,"&quot;")),-1!=e.indexOf("'")&&(e=e.replace(z,"&#39;")),-1!=e.indexOf("\0")&&(e=e.replace(Q,"&#0;"))),e}var W,H=/&/g,G=/</g,K=/>/g,$=/"/g,z=/'/g,Q=/\x00/g,Y=/[\x00&<>"']/;function X(e,t){return-1!=e.indexOf(t)}function J(e,t){return e<t?-1:t<e?1:0}e:{var Z=l.navigator;if(Z){var ee=Z.userAgent;if(ee){W=ee;break e}}W=""}function te(e){return X(W,e)}function ne(e,t){for(var n in e)t.call(void 0,e[n],n,e)}function re(e){for(var t in e)return!1;return!0}function ie(e){var t,n={};for(t in e)n[t]=e[t];return n}var oe,ae,se="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ue(e,t){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(var o=0;o<se.length;o++)n=se[o],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function ce(e){l.setTimeout(function(){throw e},0)}function le(e,t){ae||function(){if(l.Promise&&l.Promise.resolve){var e=l.Promise.resolve(void 0);ae=function(){e.then(de)}}else ae=function(){var e=de;!a(l.setImmediate)||l.Window&&l.Window.prototype&&!te("Edge")&&l.Window.prototype.setImmediate==l.setImmediate?(oe||(oe=function(){var e=l.MessageChannel;if(void 0===e&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!te("Presto")&&(e=function(){var e=document.createElement("IFRAME");e.style.display="none",e.src="",document.documentElement.appendChild(e);var t=e.contentWindow;(e=t.document).open(),e.write(""),e.close();var n="callImmediate"+Math.random(),r="file:"==t.location.protocol?"*":t.location.protocol+"//"+t.location.host;e=y(function(e){"*"!=r&&e.origin!=r||e.data!=n||this.port1.onmessage()},this),t.addEventListener("message",e,!1),this.port1={},this.port2={postMessage:function(){t.postMessage(n,r)}}}),void 0!==e&&!te("Trident")&&!te("MSIE")){var t=new e,n={},r=n;return t.port1.onmessage=function(){if(void 0!==n.next){var e=(n=n.next).tb;n.tb=null,e()}},function(e){r.next={tb:e},r=r.next,t.port2.postMessage(0)}}return"undefined"!=typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(e){var t=document.createElement("SCRIPT");t.onreadystatechange=function(){t.onreadystatechange=null,t.parentNode.removeChild(t),t=null,e(),e=null},document.documentElement.appendChild(t)}:function(e){l.setTimeout(e,0)}}()),oe(e)):l.setImmediate(e)}}(),he||(ae(),he=!0),fe.add(e,t)}var he=!1,fe=new A;function de(){for(var e;n=t=void 0,n=null,(t=fe).a&&(n=t.a,t.a=t.a.next,t.a||(t.b=null),n.next=null),e=n;){try{e.a.call(e.b)}catch(e){ce(e)}R(I,e)}var t,n;he=!1}function pe(e,t){if(this.a=ve,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,e!=o)try{var n=this;e.call(t,function(e){Oe(n,me,e)},function(e){if(!(e instanceof xe))try{if(e instanceof Error)throw e;throw Error("Promise rejected.")}catch(e){}Oe(n,ge,e)})}catch(e){Oe(this,ge,e)}}var ve=0,me=2,ge=3;function ye(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}ye.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var be=new O(function(){return new ye},function(e){e.reset()});function _e(e,t,n){var r=be.get();return r.g=e,r.b=t,r.f=n,r}function we(e){if(e instanceof pe)return e;var t=new pe(o);return Oe(t,me,e),t}function Ee(n){return new pe(function(e,t){t(n)})}function Se(e,t,n){Re(e,t,n,null)||le(b(t,e))}function Ce(e,t){e.b||e.a!=me&&e.a!=ge||Ae(e),e.f?e.f.next=t:e.b=t,e.f=t}function Te(e,i,o,a){var t=_e(null,null,null);return t.a=new pe(function(n,r){t.g=i?function(e){try{var t=i.call(a,e);n(t)}catch(e){r(e)}}:n,t.b=o?function(e){try{var t=o.call(a,e);void 0===t&&e instanceof xe?r(e):n(t)}catch(e){r(e)}}:r}),Ce(t.a.c=e,t),t.a}function Oe(e,t,n){var r,i;e.a==ve&&(e===n&&(t=ge,n=new TypeError("Promise cannot resolve to itself")),e.a=1,Re(n,e.Lc,e.Mc,e)||(e.i=n,e.a=t,e.c=null,Ae(e),t!=ge||n instanceof xe||(i=n,(r=e).g=!0,le(function(){r.g&&Pe.call(null,i)}))))}function Re(e,t,n,r){if(e instanceof pe)return Ce(e,_e(t||o,n||null,r)),!0;if(E(e))return e.then(t,n,r),!0;if(v(e))try{var i=e.then;if(a(i))return function(e,t,n,r,i){function o(e){a||(a=!0,r.call(i,e))}var a=!1;try{t.call(e,function(e){a||(a=!0,n.call(i,e))},o)}catch(e){o(e)}}(e,i,t,n,r),!0}catch(e){return n.call(r,e),!0}return!1}function Ae(e){e.h||(e.h=!0,le(e.Ub,e))}function Ie(e){var t=null;return e.b&&(t=e.b,e.b=t.next,t.next=null),e.b||(e.f=null),t}function Ne(e,t,n,r){if(n==ge&&t.b&&!t.c)for(;e&&e.g;e=e.c)e.g=!1;if(t.a)t.a.c=null,ke(t,n,r);else try{t.c?t.g.call(t.f):ke(t,n,r)}catch(e){Pe.call(null,e)}R(be,t)}function ke(e,t,n){t==me?e.g.call(e.f,n):e.b&&e.b.call(e.f,n)}pe.prototype.then=function(e,t,n){return Te(this,a(e)?e:null,a(t)?t:null,n)},w(pe),(e=pe.prototype).ia=function(e,t){return(e=_e(e,e,t)).c=!0,Ce(this,e),this},e.s=function(e,t){return Te(this,null,e,t)},e.cancel=function(e){this.a==ve&&le(function(){!function e(t,n){if(t.a==ve)if(t.c){var r=t.c;if(r.b){for(var i=0,o=null,a=null,s=r.b;s&&(s.c||(i++,s.a==t&&(o=s),!(o&&1<i)));s=s.next)o||(a=s);o&&(r.a==ve&&1==i?e(r,n):(a?((i=a).next==r.f&&(r.f=i),i.next=i.next.next):Ie(r),Ne(r,o,ge,n)))}t.c=null}else Oe(t,ge,n)}(this,new xe(e))},this)},e.Lc=function(e){this.a=ve,Oe(this,me,e)},e.Mc=function(e){this.a=ve,Oe(this,ge,e)},e.Ub=function(){for(var e;e=Ie(this);)Ne(this,e,this.a,this.i);this.h=!1};var Pe=ce;function xe(e){S.call(this,e)}function De(){0!=Me&&(Le[this[i]||(this[i]=++s)]=this),this.pa=this.pa,this.ja=this.ja}t(xe,S);var Me=0,Le={};function Fe(e){if(!e.pa&&(e.pa=!0,e.ua(),0!=Me)){var t=e[i]||(e[i]=++s);if(0!=Me&&e.ja&&0<e.ja.length)throw Error(e+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete Le[t]}}function Ve(e){return Ve[" "](e),e}De.prototype.pa=!(xe.prototype.name="cancel"),De.prototype.ua=function(){if(this.ja)for(;this.ja.length;)this.ja.shift()()},Ve[" "]=o;var je,Ue,Be=te("Opera"),qe=te("Trident")||te("MSIE"),We=te("Edge"),He=We||qe,Ge=te("Gecko")&&!(X(W.toLowerCase(),"webkit")&&!te("Edge"))&&!(te("Trident")||te("MSIE"))&&!te("Edge"),Ke=X(W.toLowerCase(),"webkit")&&!te("Edge");function $e(){var e=l.document;return e?e.documentMode:void 0}e:{var ze="",Qe=(Ue=W,Ge?/rv:([^\);]+)(\)|;)/.exec(Ue):We?/Edge\/([\d\.]+)/.exec(Ue):qe?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Ue):Ke?/WebKit\/(\S+)/.exec(Ue):Be?/(?:Version)[ \/]?(\S+)/.exec(Ue):void 0);if(Qe&&(ze=Qe?Qe[1]:""),qe){var Ye=$e();if(null!=Ye&&Ye>parseFloat(ze)){je=String(Ye);break e}}je=ze}var Xe,Je={};function Ze(s){return e=s,t=Je,Object.prototype.hasOwnProperty.call(t,e)?t[e]:t[e]=function(){for(var e=0,t=B(String(je)).split("."),n=B(String(s)).split("."),r=Math.max(t.length,n.length),i=0;0==e&&i<r;i++){var o=t[i]||"",a=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==o[0].length&&0==a[0].length)break;e=J(0==o[1].length?0:parseInt(o[1],10),0==a[1].length?0:parseInt(a[1],10))||J(0==o[2].length,0==a[2].length)||J(o[2],a[2]),o=o[3],a=a[3]}while(0==e)}return 0<=e}();var e,t}var et=l.document;Xe=et&&qe?$e()||("CSS1Compat"==et.compatMode?parseInt(je,10):5):void 0;var tt=Object.freeze||function(e){return e},nt=!qe||9<=Number(Xe),rt=qe&&!Ze("9"),it=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});return l.addEventListener("test",o,t),l.removeEventListener("test",o,t),e}();function ot(e,t){this.type=e,this.b=this.target=t,this.Gb=!0}function at(e,t){if(ot.call(this,e?e.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,e){var n=this.type=e.type,r=e.changedTouches?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.b=t,t=e.relatedTarget){if(Ge){e:{try{Ve(t.nodeName);var i=!0;break e}catch(e){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,null===r?(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0):(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=c(e.pointerType)?e.pointerType:st[e.pointerType]||"",(this.a=e).defaultPrevented&&this.preventDefault()}}ot.prototype.preventDefault=function(){this.Gb=!1},t(at,ot);var st=tt({2:"touch",3:"pen",4:"mouse"});at.prototype.preventDefault=function(){at.lb.preventDefault.call(this);var e=this.a;if(e.preventDefault)e.preventDefault();else if(e.returnValue=!1,rt)try{(e.ctrlKey||112<=e.keyCode&&e.keyCode<=123)&&(e.keyCode=-1)}catch(e){}},at.prototype.f=function(){return this.a};var ut="closure_listenable_"+(1e6*Math.random()|0),ct=0;function lt(e){e.na=!0,e.listener=null,e.proxy=null,e.src=null,e.La=null}function ht(e){this.src=e,this.a={},this.b=0}function ft(e,t){var n=t.type;n in e.a&&L(e.a[n],t)&&(lt(t),0==e.a[n].length&&(delete e.a[n],e.b--))}function dt(e,t,n,r){for(var i=0;i<e.length;++i){var o=e[i];if(!o.na&&o.listener==t&&o.capture==!!n&&o.La==r)return i}return-1}ht.prototype.add=function(e,t,n,r,i){var o=e.toString();(e=this.a[o])||(e=this.a[o]=[],this.b++);var a=dt(e,t,r,i);return-1<a?(t=e[a],n||(t.Ia=!1)):((t=new function(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.La=i,this.key=++ct,this.na=this.Ia=!1}(t,this.src,o,!!r,i)).Ia=n,e.push(t)),t};var pt="closure_lm_"+(1e6*Math.random()|0),vt={};function mt(e,t,n,r,i){if(r&&r.once)yt(e,t,n,r,i);else if(f(t))for(var o=0;o<t.length;o++)mt(e,t[o],n,r,i);else n=Rt(n),e&&e[ut]?It(e,t,n,v(r)?!!r.capture:!!r,i):gt(e,t,n,!1,r,i)}function gt(e,t,n,r,i,o){if(!t)throw Error("Invalid event type");var a,s,u=v(i)?!!i.capture:!!i,c=Tt(e);if(c||(e[pt]=c=new ht(e)),!(n=c.add(t,n,r,u,o)).proxy)if(a=Ct,r=s=nt?function(e){return a.call(s.src,s.listener,e)}:function(e){if(!(e=a.call(s.src,s.listener,e)))return e},(n.proxy=r).src=e,r.listener=n,e.addEventListener)it||(i=u),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(wt(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}}function yt(e,t,n,r,i){if(f(t))for(var o=0;o<t.length;o++)yt(e,t[o],n,r,i);else n=Rt(n),e&&e[ut]?Nt(e,t,n,v(r)?!!r.capture:!!r,i):gt(e,t,n,!0,r,i)}function bt(e,t,n,r,i){if(f(t))for(var o=0;o<t.length;o++)bt(e,t[o],n,r,i);else r=v(r)?!!r.capture:!!r,n=Rt(n),e&&e[ut]?(e=e.m,(t=String(t).toString())in e.a&&-1<(n=dt(o=e.a[t],n,r,i))&&(lt(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete e.a[t],e.b--))):e&&(e=Tt(e))&&(t=e.a[t.toString()],e=-1,t&&(e=dt(t,n,r,i)),(n=-1<e?t[e]:null)&&_t(n))}function _t(e){if("number"!=typeof e&&e&&!e.na){var t=e.src;if(t&&t[ut])ft(t.m,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(wt(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Tt(t))?(ft(n,e),0==n.b&&(n.src=null,t[pt]=null)):lt(e)}}}function wt(e){return e in vt?vt[e]:vt[e]="on"+e}function Et(e,t,n,r){var i=!0;if((e=Tt(e))&&(t=e.a[t.toString()]))for(t=t.concat(),e=0;e<t.length;e++){var o=t[e];o&&o.capture==n&&!o.na&&(o=St(o,r),i=i&&!1!==o)}return i}function St(e,t){var n=e.listener,r=e.La||e.src;return e.Ia&&_t(e),n.call(r,t)}function Ct(e,t){if(e.na)return!0;if(!nt){if(!t)e:{t=["window","event"];for(var n=l,r=0;r<t.length;r++)if(null==(n=n[t[r]])){t=null;break e}t=n}if(t=new at(r=t,this),n=!0,!(r.keyCode<0||null!=r.returnValue)){e:{var i=!1;if(0==r.keyCode)try{r.keyCode=-1;break e}catch(e){i=!0}(i||null==r.returnValue)&&(r.returnValue=!0)}for(r=[],i=t.b;i;i=i.parentNode)r.push(i);for(e=e.type,i=r.length-1;0<=i;i--){t.b=r[i];var o=Et(r[i],e,!0,t);n=n&&o}for(i=0;i<r.length;i++)t.b=r[i],o=Et(r[i],e,!1,t),n=n&&o}return n}return St(e,new at(t,this))}function Tt(e){return(e=e[pt])instanceof ht?e:null}var Ot="__closure_events_fn_"+(1e9*Math.random()>>>0);function Rt(t){return a(t)?t:(t[Ot]||(t[Ot]=function(e){return t.handleEvent(e)}),t[Ot])}function At(){De.call(this),this.m=new ht(this),(this.Nb=this).Ua=null}function It(e,t,n,r,i){e.m.add(String(t),n,!1,r,i)}function Nt(e,t,n,r,i){e.m.add(String(t),n,!0,r,i)}function kt(e,t,n,r){if(!(t=e.m.a[String(t)]))return!0;t=t.concat();for(var i=!0,o=0;o<t.length;++o){var a=t[o];if(a&&!a.na&&a.capture==n){var s=a.listener,u=a.La||a.src;a.Ia&&ft(e.m,a),i=!1!==s.call(u,r)&&i}}return i&&0!=r.Gb}function Pt(e,t,n){if(a(e))n&&(e=y(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=y(e.handleEvent,e)}return 2147483647<Number(t)?-1:l.setTimeout(e,t||0)}function xt(n){var r=null;return new pe(function(e,t){-1==(r=Pt(function(){e(void 0)},n))&&t(Error("Failed to schedule timer."))}).s(function(e){throw l.clearTimeout(r),e})}function Dt(e){if(e.S&&"function"==typeof e.S)return e.S();if(c(e))return e.split("");if(p(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}function Mt(e){if(e.U&&"function"==typeof e.U)return e.U();if(!e.S||"function"!=typeof e.S){if(p(e)||c(e)){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}for(var r in t=[],n=0,e)t[n++]=r;return t}}function Lt(e,t){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof Lt)for(n=e.U(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}function Ft(e){if(e.c!=e.a.length){for(var t=0,n=0;t<e.a.length;){var r=e.a[t];Vt(e.b,r)&&(e.a[n++]=r),t++}e.a.length=n}if(e.c!=e.a.length){var i={};for(n=t=0;t<e.a.length;)Vt(i,r=e.a[t])||(i[e.a[n++]=r]=1),t++;e.a.length=n}}function Vt(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t(At,De),At.prototype[ut]=!0,At.prototype.addEventListener=function(e,t,n,r){mt(this,e,t,n,r)},At.prototype.removeEventListener=function(e,t,n,r){bt(this,e,t,n,r)},At.prototype.dispatchEvent=function(e){var t,n=this.Ua;if(n)for(t=[];n;n=n.Ua)t.push(n);n=this.Nb;var r=e.type||e;if(c(e))e=new ot(e,n);else if(e instanceof ot)e.target=e.target||n;else{var i=e;ue(e=new ot(r,n),i)}if(i=!0,t)for(var o=t.length-1;0<=o;o--){var a=e.b=t[o];i=kt(a,r,!0,e)&&i}if(i=kt(a=e.b=n,r,!0,e)&&i,i=kt(a,r,!1,e)&&i,t)for(o=0;o<t.length;o++)i=kt(a=e.b=t[o],r,!1,e)&&i;return i},At.prototype.ua=function(){if(At.lb.ua.call(this),this.m){var e,t=this.m;for(e in t.a){for(var n=t.a[e],r=0;r<n.length;r++)lt(n[r]);delete t.a[e],t.b--}}this.Ua=null},(e=Lt.prototype).S=function(){Ft(this);for(var e=[],t=0;t<this.a.length;t++)e.push(this.b[this.a[t]]);return e},e.U=function(){return Ft(this),this.a.concat()},e.clear=function(){this.b={},this.c=this.a.length=0},e.get=function(e,t){return Vt(this.b,e)?this.b[e]:t},e.set=function(e,t){Vt(this.b,e)||(this.c++,this.a.push(e)),this.b[e]=t},e.forEach=function(e,t){for(var n=this.U(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);e.call(t,o,i,this)}};var jt=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ut(e,t){if(this.b=this.m=this.c="",this.i=null,this.h=this.g="",this.f=!1,e instanceof Ut){this.f=void 0!==t?t:e.f,Bt(this,e.c),this.m=e.m,this.b=e.b,qt(this,e.i),this.g=e.g,t=e.a;var n=new nn;n.c=t.c,t.a&&(n.a=new Lt(t.a),n.b=t.b),Wt(this,n),this.h=e.h}else e&&(n=String(e).match(jt))?(this.f=!!t,Bt(this,n[1]||"",!0),this.m=zt(n[2]||""),this.b=zt(n[3]||"",!0),qt(this,n[4]),this.g=zt(n[5]||"",!0),Wt(this,n[6]||"",!0),this.h=zt(n[7]||"")):(this.f=!!t,this.a=new nn(null,this.f))}function Bt(e,t,n){e.c=n?zt(t,!0):t,e.c&&(e.c=e.c.replace(/:$/,""))}function qt(e,t){if(t){if(t=Number(t),isNaN(t)||t<0)throw Error("Bad port number "+t);e.i=t}else e.i=null}function Wt(e,t,n){var r,i;t instanceof nn?(e.a=t,r=e.a,(i=e.f)&&!r.f&&(rn(r),r.c=null,r.a.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(an(this,t),un(this,n,e))},r)),r.f=i):(n||(t=Qt(t,en)),e.a=new nn(t,e.f))}function Ht(e,t,n){e.a.set(t,n)}function Gt(e,t){return e.a.get(t)}function Kt(e){return e instanceof Ut?new Ut(e):new Ut(e,void 0)}function $t(e,t){var n=new Ut(null,void 0);return Bt(n,"https"),e&&(n.b=e),t&&(n.g=t),n}function zt(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Qt(e,t,n){return c(e)?(e=encodeURI(e).replace(t,Yt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Yt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}Ut.prototype.toString=function(){var e=[],t=this.c;t&&e.push(Qt(t,Xt,!0),":");var n=this.b;return(n||"file"==t)&&(e.push("//"),(t=this.m)&&e.push(Qt(t,Xt,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.i)&&e.push(":",String(n))),(n=this.g)&&(this.b&&"/"!=n.charAt(0)&&e.push("/"),e.push(Qt(n,"/"==n.charAt(0)?Zt:Jt,!0))),(n=this.a.toString())&&e.push("?",n),(n=this.h)&&e.push("#",Qt(n,tn)),e.join("")};var Xt=/[#\/\?@]/g,Jt=/[#\?:]/g,Zt=/[#\?]/g,en=/[#\?@]/g,tn=/#/g;function nn(e,t){this.b=this.a=null,this.c=e||null,this.f=!!t}function rn(u){u.a||(u.a=new Lt,u.b=0,u.c&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var o=e[n].substring(0,r);i=e[n].substring(r+1)}else o=e[n];a=o,s=i?decodeURIComponent(i.replace(/\+/g," ")):"",u.add(decodeURIComponent(a.replace(/\+/g," ")),s)}}var a,s}(u.c))}function on(e){var t=Mt(e);if(void 0===t)throw Error("Keys are undefined");var n=new nn(null,void 0);e=Dt(e);for(var r=0;r<t.length;r++){var i=t[r],o=e[r];f(o)?un(n,i,o):n.add(i,o)}return n}function an(e,t){rn(e),t=cn(e,t),Vt(e.a.b,t)&&(e.c=null,e.b-=e.a.get(t).length,Vt((e=e.a).b,t)&&(delete e.b[t],e.c--,e.a.length>2*e.c&&Ft(e)))}function sn(e,t){return rn(e),t=cn(e,t),Vt(e.a.b,t)}function un(e,t,n){an(e,t),0<n.length&&(e.c=null,e.a.set(cn(e,t),j(n)),e.b+=n.length)}function cn(e,t){return t=String(t),e.f&&(t=t.toLowerCase()),t}(e=nn.prototype).add=function(e,t){rn(this),this.c=null,e=cn(this,e);var n=this.a.get(e);return n||this.a.set(e,n=[]),n.push(t),this.b+=1,this},e.clear=function(){this.a=this.c=null,this.b=0},e.forEach=function(n,r){rn(this),this.a.forEach(function(e,t){P(e,function(e){n.call(r,e,t,this)},this)},this)},e.U=function(){rn(this);for(var e=this.a.S(),t=this.a.U(),n=[],r=0;r<t.length;r++)for(var i=e[r],o=0;o<i.length;o++)n.push(t[r]);return n},e.S=function(e){rn(this);var t=[];if(c(e))sn(this,e)&&(t=V(t,this.a.get(cn(this,e))));else{e=this.a.S();for(var n=0;n<e.length;n++)t=V(t,e[n])}return t},e.set=function(e,t){return rn(this),this.c=null,sn(this,e=cn(this,e))&&(this.b-=this.a.get(e).length),this.a.set(e,[t]),this.b+=1,this},e.get=function(e,t){return 0<(e=e?this.S(e):[]).length?String(e[0]):t},e.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var e=[],t=this.a.U(),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.S(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),e.push(a)}}return this.c=e.join("&")};var ln=!qe||9<=Number(Xe);function hn(){this.a="",this.b=dn}function fn(e){return e instanceof hn&&e.constructor===hn&&e.b===dn?e.a:(T("expected object of type Const, got '"+e+"'"),"type_error:Const")}hn.prototype.ma=!0,hn.prototype.la=function(){return this.a},hn.prototype.toString=function(){return"Const{"+this.a+"}"};var dn={};function pn(e){var t=new hn;return t.a=e,t}function vn(){this.a="",this.b=_n}function mn(e){return e instanceof vn&&e.constructor===vn&&e.b===_n?e.a:(T("expected object of type TrustedResourceUrl, got '"+e+"' of type "+h(e)),"type_error:TrustedResourceUrl")}function gn(e,n){var t,r,i=fn(e);if(!bn.test(i))throw Error("Invalid TrustedResourceUrl format: "+i);return t=e=i.replace(yn,function(e,t){if(!Object.prototype.hasOwnProperty.call(n,t))throw Error('Found marker, "'+t+'", in format string, "'+i+'", but no valid label mapping found in args: '+JSON.stringify(n));return(e=n[t])instanceof hn?fn(e):encodeURIComponent(String(e))}),(r=new vn).a=t,r}pn(""),vn.prototype.ma=!0,vn.prototype.la=function(){return this.a},vn.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var yn=/%{(\w+)}/g,bn=/^(?:https:)?\/\/[0-9a-z.:[\]-]+\/|^\/[^\/\\]|^about:blank#/i,_n={};function wn(){this.a="",this.b=Tn}function En(e){return e instanceof wn&&e.constructor===wn&&e.b===Tn?e.a:(T("expected object of type SafeUrl, got '"+e+"' of type "+h(e)),"type_error:SafeUrl")}wn.prototype.ma=!0,wn.prototype.la=function(){return this.a},wn.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var Sn=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function Cn(e){return e instanceof wn?e:(e=e.ma?e.la():String(e),Sn.test(e)||(e="about:invalid#zClosurez"),On(e))}var Tn={};function On(e){var t=new wn;return t.a=e,t}function Rn(){this.a="",this.b=An}On("about:blank"),Rn.prototype.ma=!0,Rn.prototype.la=function(){return this.a},Rn.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var An={};function In(e){var t=new Rn;return t.a=e,t}function Nn(e){var t=document;return c(e)?t.getElementById(e):e}function kn(n,e){ne(e,function(e,t){e&&e.ma&&(e=e.la()),"style"==t?n.style.cssText=e:"class"==t?n.className=e:"for"==t?n.htmlFor=e:Pn.hasOwnProperty(t)?n.setAttribute(Pn[t],e):0==t.lastIndexOf("aria-",0)||0==t.lastIndexOf("data-",0)?n.setAttribute(t,e):n[t]=e})}In("<!DOCTYPE html>"),In(""),In("<br>");var Pn={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function xn(e){if(e&&"number"==typeof e.length){if(v(e))return"function"==typeof e.item||"string"==typeof e.item;if(a(e))return"function"==typeof e.item}return!1}function Dn(e){var t=[];return function e(t,n,r){if(null==n)r.push("null");else{if("object"==typeof n){if(f(n)){var i=n;n=i.length,r.push("[");for(var o="",a=0;a<n;a++)r.push(o),e(t,i[a],r),o=",";return void r.push("]")}if(!(n instanceof String||n instanceof Number||n instanceof Boolean)){for(i in r.push("{"),o="",n)Object.prototype.hasOwnProperty.call(n,i)&&"function"!=typeof(a=n[i])&&(r.push(o),Fn(i,r),r.push(":"),e(t,a,r),o=",");return void r.push("}")}n=n.valueOf()}switch(typeof n){case"string":Fn(n,r);break;case"number":r.push(isFinite(n)&&!isNaN(n)?String(n):"null");break;case"boolean":r.push(String(n));break;case"function":r.push("null");break;default:throw Error("Unknown type: "+typeof n)}}}(new function(){},e,t),t.join("")}var Mn={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},Ln=/\uffff/.test("￿")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function Fn(e,t){t.push('"',e.replace(Ln,function(e){var t=Mn[e];return t||(t="\\u"+(65536|e.charCodeAt(0)).toString(16).substr(1),Mn[e]=t),t}),'"')}function Vn(){var e=nr();return qe&&!!Xe&&11==Xe||/Edge\/\d+/.test(e)}function jn(){return l.window&&l.window.location.href||self&&self.location&&self.location.href||""}function Un(e,t){t=t||l.window;var n="about:blank";e&&(n=En(Cn(e))),t.location.href=n}function Bn(e){return!!((e=(e||nr()).toLowerCase()).match(/android/)||e.match(/webos/)||e.match(/iphone|ipad|ipod/)||e.match(/blackberry/)||e.match(/windows phone/)||e.match(/iemobile/))}function qn(e){e=e||l.window;try{e.close()}catch(e){}}function Wn(e,t,n){var r=Math.floor(1e9*Math.random()).toString();t=t||500,n=n||600;var i=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-t)/2;for(s in t={width:t,height:n,top:0<i?i:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=nr().toLowerCase(),r&&(t.target=r,X(n,"crios/")&&(t.target="_blank")),Zn(nr())==Xn&&(e=e||"http://localhost",t.scrollbars=!0),n=e||"",(e=t)||(e={}),r=window,t=n instanceof wn?n:Cn(void 0!==n.href?n.href:String(n)),n=e.target||n.target,i=[],e)switch(s){case"width":case"height":case"top":case"left":i.push(s+"="+e[s]);break;case"target":case"noopener":case"noreferrer":break;default:i.push(s+"="+(e[s]?1:0))}var a,s=i.join(",");if((te("iPhone")&&!te("iPod")&&!te("iPad")||te("iPad")||te("iPod"))&&r.navigator&&r.navigator.standalone&&n&&"_self"!=n?(s=r.document.createElement("A"),t instanceof wn||t instanceof wn||(t=t.ma?t.la():String(t),Sn.test(t)||(t="about:invalid#zClosurez"),t=On(t)),s.href=En(t),s.setAttribute("target",n),e.noreferrer&&s.setAttribute("rel","noreferrer"),(e=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,r,1),s.dispatchEvent(e),s={}):e.noreferrer?(s=r.open("",n,s),e=En(t),s&&(He&&X(e,";")&&(e="'"+e.replace(/'/g,"%27")+"'"),s.opener=null,pn("b/12014412, meta tag with sanitized URL"),e=In(e='<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+q(e)+'">'),s.document.write((a=e)instanceof Rn&&a.constructor===Rn&&a.b===An?a.a:(T("expected object of type SafeHtml, got '"+a+"' of type "+h(a)),"type_error:SafeHtml")),s.document.close())):(s=r.open(En(t),n,s))&&e.noopener&&(s.opener=null),s)try{s.focus()}catch(e){}return s}var Hn=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/;function Gn(){var t=null;return new pe(function(e){"complete"==l.document.readyState?e():(t=function(){e()},yt(window,"load",t))}).s(function(e){throw bt(window,"load",t),e})}function Kn(e){return e=e||nr(),!("file:"!==sr()||!e.toLowerCase().match(/iphone|ipad|ipod|android/))}function $n(){var e=l.window;try{return!(!e||e==e.top)}catch(e){return!1}}function zn(){return"object"!=typeof l.window&&"function"==typeof l.importScripts}function Qn(){return d.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":d.INTERNAL.hasOwnProperty("node")?"Node":zn()?"Worker":"Browser"}function Yn(){var e=Qn();return"ReactNative"===e||"Node"===e}var Xn="Firefox",Jn="Chrome";function Zn(e){var t=e.toLowerCase();return X(t,"opera/")||X(t,"opr/")||X(t,"opios/")?"Opera":X(t,"iemobile")?"IEMobile":X(t,"msie")||X(t,"trident/")?"IE":X(t,"edge/")?"Edge":X(t,"firefox/")?Xn:X(t,"silk/")?"Silk":X(t,"blackberry")?"Blackberry":X(t,"webos")?"Webos":!X(t,"safari/")||X(t,"chrome/")||X(t,"crios/")||X(t,"android")?!X(t,"chrome/")&&!X(t,"crios/")||X(t,"edge/")?X(t,"android")?"Android":(e=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==e.length?e[1]:"Other":Jn:"Safari"}var er={Sc:"FirebaseCore-web",Uc:"FirebaseUI-web"};function tr(e,t){t=t||[];var n,r=[],i={};for(n in er)i[er[n]]=!0;for(n=0;n<t.length;n++)void 0!==i[t[n]]&&(delete i[t[n]],r.push(t[n]));return r.sort(),(t=r).length||(t=["FirebaseCore-web"]),"Browser"===(r=Qn())?r=Zn(i=nr()):"Worker"===r&&(r=Zn(i=nr())+"-"+r),r+"/JsCore/"+e+"/"+t.join(",")}function nr(){return l.navigator&&l.navigator.userAgent||""}function rr(e,t){e=e.split("."),t=t||l;for(var n=0;n<e.length&&"object"==typeof t&&null!=t;n++)t=t[e[n]];return n!=e.length&&(t=void 0),t}function ir(){try{var e=l.localStorage,t=fr();if(e)return e.setItem(t,"1"),e.removeItem(t),!Vn()||!!l.indexedDB}catch(e){return zn()&&!!l.indexedDB}return!1}function or(){return(ar()||"chrome-extension:"===sr()||Kn())&&!Yn()&&ir()&&!zn()}function ar(){return"http:"===sr()||"https:"===sr()}function sr(){return l.location&&l.location.protocol||null}function ur(e){return!Bn(e=e||nr())&&Zn(e)!=Xn}function cr(e){return void 0===e?null:Dn(e)}function lr(e){var t,n={};for(t in e)e.hasOwnProperty(t)&&null!==e[t]&&void 0!==e[t]&&(n[t]=e[t]);return n}function hr(e){if(null!==e)return JSON.parse(e)}function fr(e){return e||Math.floor(1e9*Math.random()).toString()}function dr(e){return"Safari"!=Zn(e=e||nr())&&!e.toLowerCase().match(/iphone|ipad|ipod/)}function pr(){var e=l.___jsl;if(e&&e.H)for(var t in e.H)if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=e.H[t].L.concat(),e.CP)for(var n=0;n<e.CP.length;n++)e.CP[n]=null}function vr(e,t){if(t<e)throw Error("Short delay should be less than long delay!");this.a=e,this.c=t,e=nr(),t=Qn(),this.b=Bn(e)||"ReactNative"===t}function mr(){var e=l.document;return!e||void 0===e.visibilityState||"visible"==e.visibilityState}function gr(e){try{var t=new Date(parseInt(e,10));if(!isNaN(t.getTime())&&!/[^0-9]/.test(e))return t.toUTCString()}catch(e){}return null}function yr(){return!(!rr("fireauth.oauthhelper",l)&&!rr("fireauth.iframe",l))}vr.prototype.get=function(){var e=l.navigator;return!e||"boolean"!=typeof e.onLine||!ar()&&"chrome-extension:"!==sr()&&void 0===e.connection||e.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};var br,_r={};function wr(e){_r[e]||(_r[e]=!0,"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(e))}try{var Er={};Object.defineProperty(Er,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(Er,"abcd",{configurable:!0,enumerable:!0,value:2}),br=2==Er.abcd}catch(Ue){br=!1}function Sr(e,t,n){br?Object.defineProperty(e,t,{configurable:!0,enumerable:!0,value:n}):e[t]=n}function Cr(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&Sr(e,n,t[n])}function Tr(e){var t={};return Cr(t,e),t}function Or(e){var t=e;if("object"==typeof e&&null!=e)for(var n in t="length"in e?[]:{},e)Sr(t,n,Or(e[n]));return t}function Rr(e,t){this.code=Ir+e,this.message=t||Nr[e]||""}function Ar(e){var t=e&&e.code;return t?new Rr(t.substring(Ir.length),e.message):null}t(Rr,Error),Rr.prototype.D=function(){return{code:this.code,message:this.message}},Rr.prototype.toJSON=function(){return this.D()};var Ir="auth/",Nr={"argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","user-cancelled":"User did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."};function kr(e){var t=e.url;if(void 0===t)throw new Rr("missing-continue-uri");if("string"!=typeof t||"string"==typeof t&&!t.length)throw new Rr("invalid-continue-uri");this.h=t,this.b=this.a=null,this.g=!1;var n=e.android;if(n&&"object"==typeof n){t=n[Mr];var r=n[xr];if(n=n[Dr],"string"==typeof t&&t.length){if(this.a=t,void 0!==r&&"boolean"!=typeof r)throw new Rr("argument-error",xr+" property must be a boolean when specified.");if(this.g=!!r,void 0!==n&&("string"!=typeof n||"string"==typeof n&&!n.length))throw new Rr("argument-error",Dr+" property must be a non empty string when specified.");this.b=n||null}else{if(void 0!==t)throw new Rr("argument-error",Mr+" property must be a non empty string when specified.");if(void 0!==r||void 0!==n)throw new Rr("missing-android-pkg-name")}}else if(void 0!==n)throw new Rr("argument-error","android property must be a non null object when specified.");if(this.f=null,(t=e.iOS)&&"object"==typeof t){if("string"==typeof(t=t.bundleId)&&t.length)this.f=t;else if(void 0!==t)throw new Rr("argument-error","bundleId property must be a non empty string when specified.")}else if(void 0!==t)throw new Rr("argument-error","iOS property must be a non null object when specified.");if(void 0!==(e=e[Pr])&&"boolean"!=typeof e)throw new Rr("argument-error",Pr+" property must be a boolean when specified.");this.c=!!e}var Pr="handleCodeInApp",xr="installApp",Dr="minimumVersion",Mr="packageName";function Lr(e){var t={};for(var n in t.continueUrl=e.h,t.canHandleCodeInApp=e.c,(t.androidPackageName=e.a)&&(t.androidMinimumVersion=e.b,t.androidInstallApp=e.g),t.iOSBundleId=e.f,t)null===t[n]&&delete t[n];return t}var Fr=null,Vr=null;function jr(e){this.c=e.sub,this.a=e.provider_id||e.firebase&&e.firebase.sign_in_provider||null,this.b=!!e.is_anonymous||"anonymous"==this.a}function Ur(e){return(e=Br(e))&&e.sub&&e.iss&&e.aud&&e.exp?new jr(e):null}function Br(e){if(!e)return null;if(3!=(e=e.split(".")).length)return null;for(var t=(4-(e=e[1]).length%4)%4,n=0;n<t;n++)e+=".";try{return JSON.parse((r="",function(r,e){function t(e){for(;i<r.length;){var t=r.charAt(i++),n=Vr[t];if(null!=n)return n;if(!/^[\s\xa0]*$/.test(t))throw Error("Unknown base64 encoding at char: "+t)}return e}!function(){if(!Fr){Fr={},Vr={};for(var e=0;e<65;e++)Fr[e]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(e),62<=(Vr[Fr[e]]=e)&&(Vr["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(e)]=e)}}();for(var i=0;;){var n=t(-1),o=t(0),a=t(64),s=t(64);if(64===s&&-1===n)break;e(n<<2|o>>4),64!=a&&(e(o<<4&240|a>>2),64!=s&&e(a<<6&192|s))}}(e,function(e){r+=String.fromCharCode(e)}),r))}catch(e){}var r;return null}jr.prototype.f=function(){return this.b};var qr="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),Wr=["client_id","response_type","scope","redirect_uri","state"],Hr={Tc:{Ma:"locale",Ba:500,Aa:600,Na:"facebook.com",eb:Wr},Vc:{Ma:null,Ba:500,Aa:620,Na:"github.com",eb:Wr},Wc:{Ma:"hl",Ba:515,Aa:680,Na:"google.com",eb:Wr},bd:{Ma:"lang",Ba:485,Aa:705,Na:"twitter.com",eb:qr}};function Gr(e){for(var t in Hr)if(Hr[t].Na==e)return Hr[t];return null}function Kr(e){var t={};t["facebook.com"]=Xr,t["google.com"]=Zr,t["github.com"]=Jr,t["twitter.com"]=ei;var n=e&&e[zr];try{if(n)return t[n]?new t[n](e):new Yr(e);if(void 0!==e[$r])return new Qr(e)}catch(e){}return null}var $r="idToken",zr="providerId";function Qr(e){var t=e[zr];if(!t&&e[$r]){var n=Ur(e[$r]);n&&n.a&&(t=n.a)}if(!t)throw Error("Invalid additional user info!");"anonymous"!=t&&"custom"!=t||(t=null),n=!1,void 0!==e.isNewUser?n=!!e.isNewUser:"identitytoolkit#SignupNewUserResponse"===e.kind&&(n=!0),Sr(this,"providerId",t),Sr(this,"isNewUser",n)}function Yr(e){Qr.call(this,e),Sr(this,"profile",Or((e=hr(e.rawUserInfo||"{}"))||{}))}function Xr(e){if(Yr.call(this,e),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function Jr(e){if(Yr.call(this,e),"github.com"!=this.providerId)throw Error("Invalid provider ID!");Sr(this,"username",this.profile&&this.profile.login||null)}function Zr(e){if(Yr.call(this,e),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function ei(e){if(Yr.call(this,e),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");Sr(this,"username",e.screenName||null)}function ti(e){var t=Kt(e),n=Gt(t,"link"),r=Gt(Kt(n),"link");return Gt(Kt(t=Gt(t,"deep_link_id")),"link")||t||r||n||e}function ni(e,n){return e.then(function(e){if(e[Lo]){var t=Ur(e[Lo]);if(!t||n!=t.c)throw new Rr("user-mismatch");return e}throw new Rr("user-mismatch")}).s(function(e){throw e&&e.code&&e.code==Ir+"user-not-found"?new Rr("user-mismatch"):e})}function ri(e,t,n){if(t.idToken||t.accessToken)t.idToken&&Sr(this,"idToken",t.idToken),t.accessToken&&Sr(this,"accessToken",t.accessToken);else{if(!t.oauthToken||!t.oauthTokenSecret)throw new Rr("internal-error","failed to construct a credential");Sr(this,"accessToken",t.oauthToken),Sr(this,"secret",t.oauthTokenSecret)}Sr(this,"providerId",e),Sr(this,"signInMethod",n)}function ii(e){var t={};return e.idToken&&(t.id_token=e.idToken),e.accessToken&&(t.access_token=e.accessToken),e.secret&&(t.oauth_token_secret=e.secret),t.providerId=e.providerId,{postBody:on(t).toString(),requestUri:"http://localhost"}}function oi(e,t){this.Ac=t||[],Cr(this,{providerId:e,isOAuthProvider:!0}),this.vb={},this.$a=(Gr(e)||{}).Ma||null,this.Ya=null}function ai(e){oi.call(this,e,Wr),this.a=[]}function si(){ai.call(this,"facebook.com")}function ui(e){if(!e)throw new Rr("argument-error","credential failed: expected 1 argument (the OAuth access token).");var t=e;return v(e)&&(t=e.accessToken),(new si).credential(null,t)}function ci(){ai.call(this,"github.com")}function li(e){if(!e)throw new Rr("argument-error","credential failed: expected 1 argument (the OAuth access token).");var t=e;return v(e)&&(t=e.accessToken),(new ci).credential(null,t)}function hi(){ai.call(this,"google.com"),this.ta("profile")}function fi(e,t){var n=e;return v(e)&&(n=e.idToken,t=e.accessToken),(new hi).credential(n,t)}function di(){oi.call(this,"twitter.com",qr)}function pi(e,t){var n=e;if(v(n)||(n={oauthToken:e,oauthTokenSecret:t}),!n.oauthToken||!n.oauthTokenSecret)throw new Rr("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new ri("twitter.com",n,"twitter.com")}function vi(e,t,n){this.a=e,this.b=t,Sr(this,"providerId","password"),Sr(this,"signInMethod",n===mi.EMAIL_LINK_SIGN_IN_METHOD?mi.EMAIL_LINK_SIGN_IN_METHOD:mi.EMAIL_PASSWORD_SIGN_IN_METHOD)}function mi(){Cr(this,{providerId:"password",isOAuthProvider:!1})}function gi(e,t){if(!(t=yi(t)))throw new Rr("argument-error","Invalid email link!");return new vi(e,t,mi.EMAIL_LINK_SIGN_IN_METHOD)}function yi(e){var t=Gt((e=new function(e){this.a=Kt(e)}(e=ti(e))).a,"oobCode")||null;return"signIn"===(Gt(e.a,"mode")||null)&&t?t:null}function bi(e){if(!(e.Sa&&e.Ra||e.Fa&&e.$))throw new Rr("internal-error");this.a=e,Sr(this,"providerId","phone"),Sr(this,"signInMethod","phone")}function _i(e){return e.a.Fa&&e.a.$?{temporaryProof:e.a.Fa,phoneNumber:e.a.$}:{sessionInfo:e.a.Sa,code:e.a.Ra}}function wi(e){try{this.a=e||d.auth()}catch(e){throw new Rr("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}Cr(this,{providerId:"phone",isOAuthProvider:!1})}function Ei(e,t){if(!e)throw new Rr("missing-verification-id");if(!t)throw new Rr("missing-verification-code");return new bi({Sa:e,Ra:t})}function Si(e){if(e.temporaryProof&&e.phoneNumber)return new bi({Fa:e.temporaryProof,$:e.phoneNumber});var t=e&&e.providerId;if(!t||"password"===t)return null;var n=e&&e.oauthAccessToken,r=e&&e.oauthTokenSecret;e=e&&e.oauthIdToken;try{switch(t){case"google.com":return fi(e,n);case"facebook.com":return ui(n);case"github.com":return li(n);case"twitter.com":return pi(n,r);default:return new ai(t).credential(e,n)}}catch(e){return null}}function Ci(e){if(!e.isOAuthProvider)throw new Rr("invalid-oauth-provider")}function Ti(e,t,n,r,i){if(this.b=e,this.c=t||null,this.f=n||null,this.g=r||null,this.a=i||null,!this.f&&!this.a)throw new Rr("invalid-auth-event");if(this.f&&this.a)throw new Rr("invalid-auth-event");if(this.f&&!this.g)throw new Rr("invalid-auth-event")}function Oi(e){return(e=e||{}).type?new Ti(e.type,e.eventId,e.urlResponse,e.sessionId,e.error&&Ar(e.error)):null}function Ri(){this.b=null,this.a=[]}t(Yr,Qr),t(Xr,Yr),t(Jr,Yr),t(Zr,Yr),t(ei,Yr),ri.prototype.ya=function(e){return Zo(e,ii(this))},ri.prototype.c=function(e,t){var n=ii(this);return n.idToken=t,ea(e,n)},ri.prototype.f=function(e,t){return ni(ta(e,ii(this)),t)},ri.prototype.D=function(){var e={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(e.oauthIdToken=this.idToken),this.accessToken&&(e.oauthAccessToken=this.accessToken),this.secret&&(e.oauthTokenSecret=this.secret),e},oi.prototype.Da=function(e){return this.vb=ie(e),this},t(ai,oi),ai.prototype.ta=function(e){return M(this.a,e)||this.a.push(e),this},ai.prototype.Ab=function(){return j(this.a)},ai.prototype.credential=function(e,t){if(!e&&!t)throw new Rr("argument-error","credential failed: must provide the ID token and/or the access token.");return new ri(this.providerId,{idToken:e||null,accessToken:t||null},this.providerId)},t(si,ai),Sr(si,"PROVIDER_ID","facebook.com"),Sr(si,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),t(ci,ai),Sr(ci,"PROVIDER_ID","github.com"),Sr(ci,"GITHUB_SIGN_IN_METHOD","github.com"),t(hi,ai),Sr(hi,"PROVIDER_ID","google.com"),Sr(hi,"GOOGLE_SIGN_IN_METHOD","google.com"),t(di,oi),Sr(di,"PROVIDER_ID","twitter.com"),Sr(di,"TWITTER_SIGN_IN_METHOD","twitter.com"),vi.prototype.ya=function(e){return this.signInMethod==mi.EMAIL_LINK_SIGN_IN_METHOD?Na(e,ca,{email:this.a,oobCode:this.b}):Na(e,Oa,{email:this.a,password:this.b})},vi.prototype.c=function(e,t){return this.signInMethod==mi.EMAIL_LINK_SIGN_IN_METHOD?Na(e,la,{idToken:t,email:this.a,oobCode:this.b}):Na(e,_a,{idToken:t,email:this.a,password:this.b})},vi.prototype.f=function(e,t){return ni(this.ya(e),t)},vi.prototype.D=function(){return{email:this.a,password:this.b,signInMethod:this.signInMethod}},Cr(mi,{PROVIDER_ID:"password"}),Cr(mi,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),Cr(mi,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),bi.prototype.ya=function(e){return e.Ta(_i(this))},bi.prototype.c=function(e,t){var n=_i(this);return n.idToken=t,Na(e,Aa,n)},bi.prototype.f=function(e,t){var n=_i(this);return n.operation="REAUTH",ni(e=Na(e,Ia,n),t)},bi.prototype.D=function(){var e={providerId:"phone"};return this.a.Sa&&(e.verificationId=this.a.Sa),this.a.Ra&&(e.verificationCode=this.a.Ra),this.a.Fa&&(e.temporaryProof=this.a.Fa),this.a.$&&(e.phoneNumber=this.a.$),e},wi.prototype.Ta=function(t,n){var r=this.a.b;return we(n.verify()).then(function(e){if(!c(e))throw new Rr("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(n.type){case"recaptcha":return Na(r,ya,{phoneNumber:t,recaptchaToken:e}).then(function(e){return"function"==typeof n.reset&&n.reset(),e},function(e){throw"function"==typeof n.reset&&n.reset(),e});default:throw new Rr("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}})},Cr(wi,{PROVIDER_ID:"phone"}),Cr(wi,{PHONE_SIGN_IN_METHOD:"phone"}),Ti.prototype.D=function(){return{type:this.b,eventId:this.c,urlResponse:this.f,sessionId:this.g,error:this.a&&this.a.D()}};var Ai=null;function Ii(e){var t="unauthorized-domain",n=void 0,r=Kt(e);e=r.b,"chrome-extension"==(r=r.c)?n=U("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",e):"http"==r||"https"==r?n=U("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",e):t="operation-not-supported-in-this-environment",Rr.call(this,t,n)}function Ni(e,t,n){Rr.call(this,e,n),(e=t||{}).wb&&Sr(this,"email",e.wb),e.$&&Sr(this,"phoneNumber",e.$),e.credential&&Sr(this,"credential",e.credential)}function ki(e){if(e.code){var t=e.code||"";0==t.indexOf(Ir)&&(t=t.substring(Ir.length));var n={credential:Si(e)};if(e.email)n.wb=e.email;else{if(!e.phoneNumber)return new Rr(t,e.message||void 0);n.$=e.phoneNumber}return new Ni(t,n,e.message)}return null}Ri.prototype.subscribe=function(e){var n=this;this.a.push(e),this.b||(this.b=function(e){for(var t=0;t<n.a.length;t++)n.a[t](e)},"function"==typeof(e=rr("universalLinks.subscribe",l))&&e(null,this.b))},Ri.prototype.unsubscribe=function(t){F(this.a,function(e){return e==t})},t(Ii,Rr),t(Ni,Rr),Ni.prototype.D=function(){var e={code:this.code,message:this.message};this.email&&(e.email=this.email),this.phoneNumber&&(e.phoneNumber=this.phoneNumber);var t=this.credential&&this.credential.D();return t&&ue(e,t),e},Ni.prototype.toJSON=function(){return this.D()};var Pi,xi=/^[+a-zA-Z0-9_.!#$%&'*\/=?^`{|}~-]+@([a-zA-Z0-9-]+\.)+[a-zA-Z0-9]{2,63}$/;function Di(){}function Mi(e){return e.c||(e.c=e.b())}function Li(){}function Fi(e){if(!e.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var t=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<t.length;n++){var r=t[n];try{return new ActiveXObject(r),e.f=r}catch(e){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return e.f}function Vi(){}function ji(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseText="",this.status=-1,this.statusText="",this.a.onload=y(this.bc,this),this.a.onerror=y(this.Bb,this),this.a.onprogress=y(this.cc,this),this.a.ontimeout=y(this.fc,this)}function Ui(e,t){e.readyState=t,e.onreadystatechange&&e.onreadystatechange()}function Bi(e,t,n){this.reset(e,t,n,void 0,void 0)}function qi(e){this.f=e,this.b=this.c=this.a=null}function Wi(e,t){this.name=e,this.value=t}Di.prototype.c=null,t(Li,Di),Li.prototype.a=function(){var e=Fi(this);return e?new ActiveXObject(e):new XMLHttpRequest},Li.prototype.b=function(){var e={};return Fi(this)&&(e[0]=!0,e[1]=!0),e},Pi=new Li,t(Vi,Di),Vi.prototype.a=function(){var e=new XMLHttpRequest;if("withCredentials"in e)return e;if("undefined"!=typeof XDomainRequest)return new ji;throw Error("Unsupported browser")},Vi.prototype.b=function(){return{}},(e=ji.prototype).open=function(e,t,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(e,t)},e.send=function(e){if(e){if("string"!=typeof e)throw Error("Only string data is supported");this.a.send(e)}else this.a.send()},e.abort=function(){this.a.abort()},e.setRequestHeader=function(){},e.getResponseHeader=function(e){return"content-type"==e.toLowerCase()?this.a.contentType:""},e.bc=function(){this.status=200,this.responseText=this.a.responseText,Ui(this,4)},e.Bb=function(){this.status=500,this.responseText="",Ui(this,4)},e.fc=function(){this.Bb()},e.cc=function(){this.status=200,Ui(this,1)},e.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},Bi.prototype.a=null,Bi.prototype.reset=function(e,t,n,r,i){delete this.a},Wi.prototype.toString=function(){return this.name};var Hi=new Wi("SEVERE",1e3),Gi=new Wi("WARNING",900),Ki=new Wi("CONFIG",700),$i=new Wi("FINE",500);qi.prototype.log=function(e,t,n){if(e.value>=function e(t){return t.c?t.c:t.a?e(t.a):(T("Root logger has no level set."),null)}(this).value)for(a(t)&&(t=t()),e=new Bi(e,String(t),this.f),n&&(e.a=n),n=this;n;)n=n.a};var zi,Qi={},Yi=null;function Xi(e){var t;if(Yi||(Yi=new qi(""),(Qi[""]=Yi).c=Ki),!(t=Qi[e])){t=new qi(e);var n=e.lastIndexOf("."),r=e.substr(n+1);(n=Xi(e.substr(0,n))).b||(n.b={}),(n.b[r]=t).a=n,Qi[e]=t}return t}function Ji(e,t){e&&e.log($i,t,void 0)}function Zi(e){this.f=e}function eo(e){At.call(this),this.i=e,this.readyState=to,this.status=0,this.responseText=this.statusText="",this.onreadystatechange=null,this.g=new Headers,this.b=null,this.h="GET",this.c="",this.a=!1,this.f=Xi("goog.net.FetchXmlHttp")}t(Zi,Di),Zi.prototype.a=function(){return new eo(this.f)},Zi.prototype.b=(zi={},function(){return zi}),t(eo,At);var to=0;function no(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function ro(e){At.call(this),this.headers=new Lt,this.C=e||null,this.c=!1,this.w=this.a=null,this.h=this.N=this.l="",this.f=this.I=this.i=this.G=!1,this.g=0,this.u=null,this.o=io,this.v=this.O=!1}(e=eo.prototype).open=function(e,t){if(this.readyState!=to)throw this.abort(),Error("Error reopening a connection");this.h=e,this.c=t,this.readyState=1,no(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var t={headers:this.g,method:this.h,credentials:void 0,cache:void 0};e&&(t.body=e),this.i.fetch(new Request(this.c,t)).then(this.ec.bind(this),this.Cb.bind(this))},e.abort=function(){this.responseText="",this.g=new Headers,this.status=0,1<=this.readyState&&this.a&&4!=this.readyState&&(this.readyState=4,this.a=!1,no(this)),this.readyState=to},e.ec=function(e){this.a&&(this.b||(this.b=e.headers,this.readyState=2,no(this)),this.a&&(this.readyState=3,no(this),this.a&&e.text().then(this.dc.bind(this,e),this.Cb.bind(this))))},e.dc=function(e,t){this.a&&(this.status=e.status,this.statusText=e.statusText,this.responseText=t,this.readyState=4,no(this))},e.Cb=function(e){var t=this.f;t&&t.log(Gi,"Failed to fetch url "+this.c,e instanceof Error?e:Error(e)),this.a&&(this.readyState=4,no(this))},e.setRequestHeader=function(e,t){this.g.append(e,t)},e.getResponseHeader=function(e){return this.b?this.b.get(e.toLowerCase())||"":((e=this.f)&&e.log(Gi,"Attempting to get response header but no headers have been received for url: "+this.c,void 0),"")},e.getAllResponseHeaders=function(){if(!this.b){var e=this.f;return e&&e.log(Gi,"Attempting to get all response headers but no headers have been received for url: "+this.c,void 0),""}e=[];for(var t=this.b.entries(),n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},t(ro,At);var io="";ro.prototype.b=Xi("goog.net.XhrIo");var oo=/^https?$/i,ao=["POST","PUT"];function so(e){return"content-type"==e.toLowerCase()}function uo(e,t){e.c=!1,e.a&&(e.f=!0,e.a.abort(),e.f=!1),e.h=t,co(e),ho(e)}function co(e){e.G||(e.G=!0,e.dispatchEvent("complete"),e.dispatchEvent("error"))}function lo(e){if(e.c&&void 0!==u)if(e.w[1]&&4==po(e)&&2==vo(e))Ji(e.b,mo(e,"Local request error detected and ignored"));else if(e.i&&4==po(e))Pt(e.Fb,0,e);else if(e.dispatchEvent("readystatechange"),4==po(e)){Ji(e.b,mo(e,"Request complete")),e.c=!1;try{var t,n=vo(e);e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var i;if(i=0===n){var o=String(e.l).match(jt)[1]||null;if(!o&&l.self&&l.self.location){var a=l.self.location.protocol;o=a.substr(0,a.length-1)}i=!oo.test(o?o.toLowerCase():"")}t=i}if(t)e.dispatchEvent("complete"),e.dispatchEvent("success");else{try{var s=2<po(e)?e.a.statusText:""}catch(t){Ji(e.b,"Can not get status: "+t.message),s=""}e.h=s+" ["+vo(e)+"]",co(e)}}finally{ho(e)}}}function ho(e,t){if(e.a){fo(e);var n=e.a,r=e.w[0]?o:null;e.a=null,e.w=null,t||e.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){(e=e.b)&&e.log(Hi,"Problem encountered resetting onreadystatechange: "+t.message,void 0)}}}function fo(e){e.a&&e.v&&(e.a.ontimeout=null),e.u&&(l.clearTimeout(e.u),e.u=null)}function po(e){return e.a?e.a.readyState:0}function vo(e){try{return 2<po(e)?e.a.status:-1}catch(e){return-1}}function mo(e,t){return t+" ["+e.N+" "+e.l+" "+vo(e)+"]"}function go(e,t){this.g=[],this.v=e,this.u=t||null,this.f=this.a=!1,this.c=void 0,this.l=this.w=this.i=!1,this.h=0,this.b=null,this.m=0}function yo(e,t,n){e.a=!0,e.c=n,e.f=!t,Eo(e)}function bo(e){if(e.a){if(!e.l)throw new So(e);e.l=!1}}function _o(e,t,n,r){e.g.push([t,n,r]),e.a&&Eo(e)}function wo(e){return D(e.g,function(e){return a(e[1])})}function Eo(t){if(t.h&&t.a&&wo(t)){var n=t.h,r=Oo[n];r&&(l.clearTimeout(r.a),delete Oo[n]),t.h=0}t.b&&(t.b.m--,delete t.b),n=t.c;for(var e=r=!1;t.g.length&&!t.i;){var i=t.g.shift(),o=i[0],a=i[1];if(i=i[2],o=t.f?a:o)try{var s=o.call(i||t.u,n);void 0!==s&&(t.f=t.f&&(s==n||s instanceof Error),t.c=n=s),(E(n)||"function"==typeof l.Promise&&n instanceof l.Promise)&&(e=!0,t.i=!0)}catch(e){n=e,t.f=!0,wo(t)||(r=!0)}}t.c=n,e&&(s=y(t.o,t,!0),e=y(t.o,t,!1),n instanceof go?(_o(n,s,e),n.w=!0):n.then(s,e)),r&&(n=new To(n),Oo[n.a]=n,t.h=n.a)}function So(){S.call(this)}function Co(){S.call(this)}function To(e){this.a=l.setTimeout(y(this.c,this),0),this.b=e}(e=ro.prototype).Ga=function(){void 0!==u&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",Ji(this.b,mo(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))},e.abort=function(){this.a&&this.c&&(Ji(this.b,mo(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),ho(this))},e.ua=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),ho(this,!0)),ro.lb.ua.call(this)},e.Fb=function(){this.pa||(this.I||this.i||this.f?lo(this):this.tc())},e.tc=function(){lo(this)},e.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.o){case io:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var e=this.b;return e&&e.log(Hi,"Response type "+this.o+" is not supported on this browser",void 0),null}catch(e){return Ji(this.b,"Can not get response: "+e.message),null}},go.prototype.cancel=function(e){if(this.a)this.c instanceof go&&this.c.cancel();else{if(this.b){var t=this.b;delete this.b,e?t.cancel(e):(t.m--,t.m<=0&&t.cancel())}this.v?this.v.call(this.u,this):this.l=!0,this.a||(e=new Co(this),bo(this),yo(this,!1,e))}},go.prototype.o=function(e,t){this.i=!1,yo(this,e,t)},go.prototype.C=function(){bo(this),yo(this,!0,null)},go.prototype.then=function(e,t,n){var r,i,o=new pe(function(e,t){r=e,i=t});return _o(this,r,function(e){e instanceof Co?o.cancel():i(e)}),o.then(e,t,n)},w(go),t(So,S),So.prototype.message="Deferred has already fired",So.prototype.name="AlreadyCalledError",t(Co,S),Co.prototype.message="Deferred was canceled",Co.prototype.name="CanceledError",To.prototype.c=function(){throw delete Oo[this.a],this.b};var Oo={};function Ro(e){var t,n,r={},i=r.document||document,o=mn(e),a=document.createElement("SCRIPT"),s={Hb:a,Ga:void 0},u=new go(Ao,s),c=null,l=null!=r.timeout?r.timeout:5e3;return 0<l&&(c=window.setTimeout(function(){Io(a,!0);var e=new Po(ko,"Timeout reached for loading script "+o);bo(u),yo(u,!1,e)},l),s.Ga=c),a.onload=a.onreadystatechange=function(){a.readyState&&"loaded"!=a.readyState&&"complete"!=a.readyState||(Io(a,r.dd||!1,c),u.C())},a.onerror=function(){Io(a,!0,c);var e=new Po(No,"Error while loading script "+o);bo(u),yo(u,!1,e)},ue(s=r.attributes||{},{type:"text/javascript",charset:"UTF-8"}),kn(a,s),a.src=mn(e),(t=i,(n=(t||document).getElementsByTagName("HEAD"))&&0!=n.length?n[0]:t.documentElement).appendChild(a),u}function Ao(){if(this&&this.Hb){var e=this.Hb;e&&"SCRIPT"==e.tagName&&Io(e,!0,this.Ga)}}function Io(e,t,n){null!=n&&l.clearTimeout(n),e.onload=o,e.onerror=o,e.onreadystatechange=o,t&&window.setTimeout(function(){e&&e.parentNode&&e.parentNode.removeChild(e)},0)}var No=0,ko=1;function Po(e,t){var n="Jsloader error (code #"+e+")";t&&(n+=": "+t),S.call(this,n),this.code=e}function xo(e){this.f=e}function Do(e,t,n){if(this.b=e,e=t||{},this.i=e.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.m=e.secureTokenTimeout||Fo,this.f=ie(e.secureTokenHeaders||Vo),this.g=e.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.h=e.firebaseTimeout||jo,this.a=ie(e.firebaseHeaders||Uo),n&&(this.a["X-Client-Version"]=n,this.f["X-Client-Version"]=n),n="Node"==Qn(),!(n=l.XMLHttpRequest||n&&d.INTERNAL.node&&d.INTERNAL.node.XMLHttpRequest)&&!zn())throw new Rr("internal-error","The XMLHttpRequest compatibility library was not found.");this.c=void 0,zn()?this.c=new Zi(self):Yn()?this.c=new xo(n):this.c=new Vi}t(Po,S),t(xo,Di),xo.prototype.a=function(){return new this.f},xo.prototype.b=function(){return{}};var Mo,Lo="idToken",Fo=new vr(3e4,6e4),Vo={"Content-Type":"application/x-www-form-urlencoded"},jo=new vr(3e4,6e4),Uo={"Content-Type":"application/json"};function Bo(e,t){t?e.a["X-Firebase-Locale"]=t:delete e.a["X-Firebase-Locale"]}function qo(e,t){t?(e.a["X-Client-Version"]=t,e.f["X-Client-Version"]=t):(delete e.a["X-Client-Version"],delete e.f["X-Client-Version"])}function Wo(e,t,n,r,i,o,a){var s;!((s=Zn(s=nr())!=Jn?null:(s=s.match(/\sChrome\/(\d+)/i))&&2==s.length?parseInt(s[1],10):null)&&s<30||qe&&Xe&&!(9<Xe))||zn()?e=y(e.o,e):(Mo||(Mo=new pe(function(e,t){var n,r;n=e,r=t,((window.gapi||{}).client||{}).request?n():(l[Go]=function(){((window.gapi||{}).client||{}).request?n():r(Error("CORS_UNSUPPORTED"))},_o(Ro(gn(Ho,{onload:Go})),null,function(){r(Error("CORS_UNSUPPORTED"))},void 0))})),e=y(e.l,e)),e(t,n,r,i,o,a)}Do.prototype.o=function(e,n,t,r,i,o){if(zn()&&(void 0===l.fetch||void 0===l.Headers||void 0===l.Request))throw new Rr("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var a=new ro(this.c);if(o){a.g=Math.max(0,o);var s=setTimeout(function(){a.dispatchEvent("timeout")},o)}It(a,"complete",function(){s&&clearTimeout(s);var t=null;try{t=JSON.parse(function(t){try{return t.a?t.a.responseText:""}catch(e){return Ji(t.b,"Can not get responseText: "+e.message),""}}(this))||null}catch(e){t=null}n&&n(t)}),Nt(a,"ready",function(){s&&clearTimeout(s),Fe(this)}),Nt(a,"timeout",function(){s&&clearTimeout(s),Fe(this),n&&n(null)}),function(e,t,n,r,i){if(e.a)throw Error("[goog.net.XhrIo] Object is active with another request="+e.l+"; newUri="+t);n=n?n.toUpperCase():"GET",e.l=t,e.h="",e.N=n,e.G=!1,e.c=!0,e.a=e.C?e.C.a():Pi.a(),e.w=e.C?Mi(e.C):Mi(Pi),e.a.onreadystatechange=y(e.Fb,e);try{Ji(e.b,mo(e,"Opening Xhr")),e.I=!0,e.a.open(n,String(t),!0),e.I=!1}catch(t){return Ji(e.b,mo(e,"Error opening Xhr: "+t.message)),uo(e,t)}t=r||"";var o,a=new Lt(e.headers);i&&function(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(p(e)||c(e))P(e,t,void 0);else for(var n=Mt(e),r=Dt(e),i=r.length,o=0;o<i;o++)t.call(void 0,r[o],n&&n[o],e)}(i,function(e,t){a.set(t,e)}),i=function(e){e:{for(var t=so,n=e.length,r=c(e)?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e)){t=i;break e}t=-1}return t<0?null:c(e)?e.charAt(t):e[t]}(a.U()),r=l.FormData&&t instanceof l.FormData,!M(ao,n)||i||r||a.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),a.forEach(function(e,t){this.a.setRequestHeader(t,e)},e),e.o&&(e.a.responseType=e.o),"withCredentials"in e.a&&e.a.withCredentials!==e.O&&(e.a.withCredentials=e.O);try{fo(e),0<e.g&&(e.v=(o=e.a,qe&&Ze(9)&&"number"==typeof o.timeout&&void 0!==o.ontimeout),Ji(e.b,mo(e,"Will abort after "+e.g+"ms if incomplete, xhr2 "+e.v)),e.v?(e.a.timeout=e.g,e.a.ontimeout=y(e.Ga,e)):e.u=Pt(e.Ga,e.g,e)),Ji(e.b,mo(e,"Sending request")),e.i=!0,e.a.send(t),e.i=!1}catch(t){Ji(e.b,mo(e,"Send error: "+t.message)),uo(e,t)}}(a,e,t,r,i)};var Ho=pn("https://apis.google.com/js/client.js?onload=%{onload}"),Go="__fcb"+Math.floor(1e6*Math.random()).toString();function Ko(e){if(!xi.test(e.email))throw new Rr("invalid-email")}function $o(e){"email"in e&&Ko(e)}function zo(e){if(!e[Lo])throw new Rr("internal-error")}function Qo(e){if(e.phoneNumber||e.temporaryProof){if(!e.phoneNumber||!e.temporaryProof)throw new Rr("internal-error")}else{if(!e.sessionInfo)throw new Rr("missing-verification-id");if(!e.code)throw new Rr("missing-verification-code")}}Do.prototype.l=function(e,n,r,i,o){var a=this;Mo.then(function(){window.gapi.client.setApiKey(a.b);var t=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:e,method:r,body:i,headers:o,authType:"none",callback:function(e){window.gapi.auth.setToken(t),n&&n(e)}})}).s(function(e){n&&n({error:{message:e&&e.message||"CORS_UNSUPPORTED"}})})},Do.prototype.Pa=function(){return Na(this,wa,{})},Do.prototype.mb=function(e,t){return Na(this,ba,{idToken:e,email:t})},Do.prototype.nb=function(e,t){return Na(this,_a,{idToken:e,password:t})};var Yo={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};function Xo(e){if(!e.requestUri||!e.sessionId&&!e.postBody)throw new Rr("internal-error")}function Jo(e){var t=null;if(e.needConfirmation?(e.code="account-exists-with-different-credential",t=ki(e)):"FEDERATED_USER_ID_ALREADY_LINKED"==e.errorMessage?(e.code="credential-already-in-use",t=ki(e)):"EMAIL_EXISTS"==e.errorMessage?(e.code="email-already-in-use",t=ki(e)):e.errorMessage&&(t=ka(e.errorMessage)),t)throw t;if(!e[Lo])throw new Rr("internal-error")}function Zo(e,t){return t.returnIdpCredential=!0,Na(e,Ea,t)}function ea(e,t){return t.returnIdpCredential=!0,Na(e,Ca,t)}function ta(e,t){return t.returnIdpCredential=!0,t.autoCreate=!1,Na(e,Sa,t)}function na(e){if(!e.oobCode)throw new Rr("invalid-action-code")}(e=Do.prototype).ob=function(e,r){var i={idToken:e},o=[];return ne(Yo,function(e,t){var n=r[t];null===n?o.push(e):t in r&&(i[t]=n)}),o.length&&(i.deleteAttribute=o),Na(this,ba,i)},e.hb=function(e,t){return ue(e={requestType:"PASSWORD_RESET",email:e},t),Na(this,pa,e)},e.ib=function(e,t){return ue(e={requestType:"EMAIL_SIGNIN",email:e},t),Na(this,fa,e)},e.gb=function(e,t){return ue(e={requestType:"VERIFY_EMAIL",idToken:e},t),Na(this,da,e)},e.Ta=function(e){return Na(this,Ra,e)},e.Xa=function(e,t){return Na(this,ga,{oobCode:e,newPassword:t})},e.Ja=function(e){return Na(this,ia,{oobCode:e})},e.Va=function(e){return Na(this,ra,{oobCode:e})};var ra={endpoint:"setAccountInfo",B:na,da:"email"},ia={endpoint:"resetPassword",B:na,J:function(e){var t=e.requestType;if(!t||!e.email&&"EMAIL_SIGNIN"!=t)throw new Rr("internal-error")}},oa={endpoint:"signupNewUser",B:function(e){if(Ko(e),!e.password)throw new Rr("weak-password")},J:zo,R:!0},aa={endpoint:"createAuthUri"},sa={endpoint:"deleteAccount",T:["idToken"]},ua={endpoint:"setAccountInfo",T:["idToken","deleteProvider"],B:function(e){if(!f(e.deleteProvider))throw new Rr("internal-error")}},ca={endpoint:"emailLinkSignin",T:["email","oobCode"],B:Ko,J:zo,R:!0},la={endpoint:"emailLinkSignin",T:["idToken","email","oobCode"],B:Ko,J:zo,R:!0},ha={endpoint:"getAccountInfo"},fa={endpoint:"getOobConfirmationCode",T:["requestType"],B:function(e){if("EMAIL_SIGNIN"!=e.requestType)throw new Rr("internal-error");Ko(e)},da:"email"},da={endpoint:"getOobConfirmationCode",T:["idToken","requestType"],B:function(e){if("VERIFY_EMAIL"!=e.requestType)throw new Rr("internal-error")},da:"email"},pa={endpoint:"getOobConfirmationCode",T:["requestType"],B:function(e){if("PASSWORD_RESET"!=e.requestType)throw new Rr("internal-error");Ko(e)},da:"email"},va={rb:!0,endpoint:"getProjectConfig",Eb:"GET"},ma={rb:!0,endpoint:"getRecaptchaParam",Eb:"GET",J:function(e){if(!e.recaptchaSiteKey)throw new Rr("internal-error")}},ga={endpoint:"resetPassword",B:na,da:"email"},ya={endpoint:"sendVerificationCode",T:["phoneNumber","recaptchaToken"],da:"sessionInfo"},ba={endpoint:"setAccountInfo",T:["idToken"],B:$o,R:!0},_a={endpoint:"setAccountInfo",T:["idToken"],B:function(e){if($o(e),!e.password)throw new Rr("weak-password")},J:zo,R:!0},wa={endpoint:"signupNewUser",J:zo,R:!0},Ea={endpoint:"verifyAssertion",B:Xo,J:Jo,R:!0},Sa={endpoint:"verifyAssertion",B:Xo,J:function(e){if(e.errorMessage&&"USER_NOT_FOUND"==e.errorMessage)throw new Rr("user-not-found");if(e.errorMessage)throw ka(e.errorMessage);if(!e[Lo])throw new Rr("internal-error")},R:!0},Ca={endpoint:"verifyAssertion",B:function(e){if(Xo(e),!e.idToken)throw new Rr("internal-error")},J:Jo,R:!0},Ta={endpoint:"verifyCustomToken",B:function(e){if(!e.token)throw new Rr("invalid-custom-token")},J:zo,R:!0},Oa={endpoint:"verifyPassword",B:function(e){if(Ko(e),!e.password)throw new Rr("wrong-password")},J:zo,R:!0},Ra={endpoint:"verifyPhoneNumber",B:Qo,J:zo},Aa={endpoint:"verifyPhoneNumber",B:function(e){if(!e.idToken)throw new Rr("internal-error");Qo(e)},J:function(e){if(e.temporaryProof)throw e.code="credential-already-in-use",ki(e);zo(e)}},Ia={Tb:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",B:Qo,J:zo};function Na(e,t,n){if(!function(e,t){if(!t||!t.length)return!0;if(!e)return!1;for(var n=0;n<t.length;n++){var r=e[t[n]];if(null==r||""===r)return!1}return!0}(n,t.T))return Ee(new Rr("internal-error"));var r,i=t.Eb||"POST";return we(n).then(t.B).then(function(){return t.R&&(n.returnSecureToken=!0),function(e,t,r,i,o,n){var a=Kt(e.g+t);Ht(a,"key",e.b),n&&Ht(a,"cb",_().toString());var s="GET"==r;if(s)for(var u in i)i.hasOwnProperty(u)&&Ht(a,u,i[u]);return new pe(function(t,n){Wo(e,a.toString(),function(e){e?e.error?n(Pa(e,o||{})):t(e):n(new Rr("network-request-failed"))},r,s?void 0:Dn(lr(i)),e.a,e.h.get())})}(e,t.endpoint,i,n,t.Tb,t.rb||!1)}).then(function(e){return r=e}).then(t.J).then(function(){if(!t.da)return r;if(!(t.da in r))throw new Rr("internal-error");return r[t.da]})}function ka(e){return Pa({error:{errors:[{message:e}],code:400,message:e}})}function Pa(e,t){var n=(e.error&&e.error.errors&&e.error.errors[0]||{}).reason||"",r={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=r[n]?new Rr(r[n]):null)return n;for(var i in n=e.error&&e.error.message||"",ue(r={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash"},t||{}),t=(t=n.match(/^[^\s]+\s*:\s*(.*)$/))&&1<t.length?t[1]:void 0,r)if(0===n.indexOf(i))return new Rr(r[i],t);return!t&&e&&(t=cr(e)),new Rr("internal-error",t)}var xa,Da={Yc:{Za:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",fb:"https://securetoken.googleapis.com/v1/token",id:"p"},$c:{Za:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",fb:"https://staging-securetoken.sandbox.googleapis.com/v1/token",id:"s"},ad:{Za:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",fb:"https://test-securetoken.sandbox.googleapis.com/v1/token",id:"t"}};function Ma(e){for(var t in Da)if(Da[t].id===e)return{firebaseEndpoint:(e=Da[t]).Za,secureTokenEndpoint:e.fb};return null}function La(e){var o;this.b=e,this.a=null,this.bb=(o=this,(Ba||(Ba=new pe(function(e,t){function n(){pr(),rr("gapi.load")("gapi.iframes",{callback:e,ontimeout:function(){pr(),t(Error("Network Error"))},timeout:ja.get()})}if(rr("gapi.iframes.Iframe"))e();else if(rr("gapi.load"))n();else{var r="__iframefcb"+Math.floor(1e6*Math.random()).toString();l[r]=function(){rr("gapi.load")?n():t(Error("Network Error"))},we(Ro(r=gn(Va,{onload:r}))).s(function(){t(Error("Network Error"))})}}).s(function(e){throw Ba=null,e}))).then(function(){return new pe(function(r,i){rr("gapi.iframes.getContext")().open({where:document.body,url:o.b,messageHandlersFilter:rr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},function(e){function t(){clearTimeout(n),r()}o.a=e,o.a.restyle({setHideOnLeave:!1});var n=setTimeout(function(){i(Error("Network Error"))},Ua.get());e.ping(t).then(t,function(){i(Error("Network Error"))})})})}))}xa=Ma("__EID__")?"__EID__":void 0;var Fa,Va=pn("https://apis.google.com/js/api.js?onload=%{onload}"),ja=new vr(3e4,6e4),Ua=new vr(5e3,15e3),Ba=null;function qa(e,t,n){this.i=e,this.g=t,this.h=n,this.f=null,this.a=$t(this.i,"/__/auth/iframe"),Ht(this.a,"apiKey",this.g),Ht(this.a,"appName",this.h),this.b=null,this.c=[]}function Wa(e,t,n,r,i){this.o=e,this.l=t,this.c=n,this.m=r,this.h=this.g=this.i=null,this.a=i,this.f=null}function Ha(e){try{return d.app(e).auth().xa()}catch(e){return[]}}function Ga(e,t,n,r,i){this.l=e,this.f=t,this.b=n,this.c=r||null,this.h=i||null,this.o=this.u=this.v=null,this.g=[],this.m=this.a=null}function Ka(e){var s=jn();return Na(e,va,{}).then(function(e){return e.authorizedDomains||[]}).then(function(e){e:{var t=Kt(s),n=t.c;t=t.b;for(var r=0;r<e.length;r++){var i=e[r],o=t,a=n;if(0==i.indexOf("chrome-extension://")?o=Kt(i).b==o&&"chrome-extension"==a:"http"!=a&&"https"!=a?o=!1:Hn.test(i)?o=o==i:(i=i.split(".").join("\\."),o=new RegExp("^(.+\\."+i+"|"+i+")$","i").test(o)),o){e=!0;break e}}e=!1}if(!e)throw new Ii(jn())})}function $a(i){return i.m||(i.m=Gn().then(function(){if(!i.u){var e=i.c,t=i.h,n=Ha(i.b),r=new qa(i.l,i.f,i.b);r.f=e,r.b=t,r.c=j(n||[]),i.u=r.toString()}i.i=new La(i.u),function(r){if(!r.i)throw Error("IfcHandler must be initialized!");var e,t;e=r.i,t=function(e){var t={};if(e&&e.authEvent){var n=!1;for(e=Oi(e.authEvent),t=0;t<r.g.length;t++)n=r.g[t](e)||n;return(t={}).status=n?"ACK":"ERROR",we(t)}return t.status="ERROR",we(t)},e.bb.then(function(){e.a.register("authEvent",t,rr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})}(i)})),i.m}function za(e){return e.o||(e.v=e.c?tr(e.c,Ha(e.b)):null,e.o=new Do(e.f,Ma(e.h),e.v)),e.o}function Qa(e,t,n,r,i,o,a,s,u,c){return(e=new Wa(e,t,n,r,i)).i=o,e.g=a,e.h=s,e.b=ie(u||null),e.f=c,e.toString()}function Ya(e){if(this.a=e||d.INTERNAL.reactNative&&d.INTERNAL.reactNative.AsyncStorage,!this.a)throw new Rr("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function Xa(){if(!Za())throw new Rr("web-storage-unsupported");this.f={},this.a=[],this.b=0,this.g=l.indexedDB,this.type="indexedDB"}function Ja(e){return e.h||(e.h=function i(o){return new pe(function(t,n){var e=o.g.open("firebaseLocalStorageDb",1);e.onerror=function(e){try{e.preventDefault()}catch(e){}n(Error(e.target.error))},e.onupgradeneeded=function(e){e=e.target.result;try{e.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(e){n(e)}},e.onsuccess=function(e){var r;(e=e.target.result).objectStoreNames.contains("firebaseLocalStorage")?t(e):(r=o,new pe(function(e,t){var n=r.g.deleteDatabase("firebaseLocalStorageDb");n.onsuccess=function(){e()},n.onerror=function(e){t(Error(e.target.error))}})).then(function(){return i(o)}).then(function(e){t(e)}).s(function(e){n(e)})}})}(e)),e.h}function Za(){try{return!!l.indexedDB}catch(e){return!1}}function es(e){return e.objectStore("firebaseLocalStorage")}function ts(e,t){return e.transaction(["firebaseLocalStorage"],t?"readwrite":"readonly")}function ns(e){return new pe(function(t,n){e.onsuccess=function(e){e&&e.target?t(e.target.result):t()},e.onerror=function(e){n(Error(e.target.errorCode))}})}function rs(e){var n=this,t=null;this.a=[],this.type="indexedDB",this.c=e,this.b=we().then(function(){return Za()?(Fa||(Fa=new Xa),(t=Fa).set("__sak","!").then(function(){return t.get("__sak")}).then(function(e){if("!"!==e)throw Error("indexedDB not supported!");return t.P("__sak")}).then(function(){return t}).s(function(){return n.c})):n.c}).then(function(e){return n.type=e.type,e.Y(function(t){P(n.a,function(e){e(t)})}),e})}function is(){this.a={},this.type="inMemory"}function os(){if(!function(){var e="Node"==Qn();if(!(e=as()||e&&d.INTERNAL.node&&d.INTERNAL.node.localStorage))return!1;try{return e.setItem("__sak","1"),e.removeItem("__sak"),!0}catch(e){return!1}}()){if("Node"==Qn())throw new Rr("internal-error","The LocalStorage compatibility library was not found.");throw new Rr("web-storage-unsupported")}this.a=as()||d.INTERNAL.node.localStorage,this.type="localStorage"}function as(){try{var e=l.localStorage,t=fr();return e&&(e.setItem(t,"1"),e.removeItem(t)),e}catch(e){return null}}function ss(){this.type="nullStorage"}function us(){if(!function(){var e="Node"==Qn();if(!(e=cs()||e&&d.INTERNAL.node&&d.INTERNAL.node.sessionStorage))return!1;try{return e.setItem("__sak","1"),e.removeItem("__sak"),!0}catch(e){return!1}}()){if("Node"==Qn())throw new Rr("internal-error","The SessionStorage compatibility library was not found.");throw new Rr("web-storage-unsupported")}this.a=cs()||d.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function cs(){try{var e=l.sessionStorage,t=fr();return e&&(e.setItem(t,"1"),e.removeItem(t)),e}catch(e){return null}}qa.prototype.toString=function(){return this.f?Ht(this.a,"v",this.f):an(this.a.a,"v"),this.b?Ht(this.a,"eid",this.b):an(this.a.a,"eid"),this.c.length?Ht(this.a,"fw",this.c.join(",")):an(this.a.a,"fw"),this.a.toString()},Wa.prototype.toString=function(){var e=$t(this.o,"/__/auth/handler");if(Ht(e,"apiKey",this.l),Ht(e,"appName",this.c),Ht(e,"authType",this.m),this.a.isOAuthProvider){var t=this.a;try{var n=d.app(this.c).auth().ea()}catch(e){n=null}for(var r in t.Ya=n,Ht(e,"providerId",this.a.providerId),n=lr((t=this.a).vb))n[r]=n[r].toString();r=t.Ac,n=ie(n);for(var i=0;i<r.length;i++){var o=r[i];o in n&&delete n[o]}t.$a&&t.Ya&&!n[t.$a]&&(n[t.$a]=t.Ya),re(n)||Ht(e,"customParameters",cr(n))}if("function"==typeof this.a.Ab&&(t=this.a.Ab()).length&&Ht(e,"scopes",t.join(",")),this.i?Ht(e,"redirectUrl",this.i):an(e.a,"redirectUrl"),this.g?Ht(e,"eventId",this.g):an(e.a,"eventId"),this.h?Ht(e,"v",this.h):an(e.a,"v"),this.b)for(var a in this.b)this.b.hasOwnProperty(a)&&!Gt(e,a)&&Ht(e,a,this.b[a]);return this.f?Ht(e,"eid",this.f):an(e.a,"eid"),(a=Ha(this.c)).length&&Ht(e,"fw",a.join(",")),e.toString()},(e=Ga.prototype).Ea=function(t,n,e){var r=new Rr("popup-closed-by-user"),i=new Rr("web-storage-unsupported"),o=this,a=!1;return this.ga().then(function(){var e,r;(e=o,r={type:"webStorageSupport"},$a(e).then(function(){return t=e.i,n=r,t.bb.then(function(){return new pe(function(e){t.a.send(n.type,n,e,rr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})});var t,n}).then(function(e){if(e&&e.length&&void 0!==e[0].webStorageSupport)return e[0].webStorageSupport;throw Error()})).then(function(e){e||(t&&qn(t),n(i),a=!0)})}).s(function(){}).then(function(){if(!a)return n=t,new pe(function(t){return function e(){xt(2e3).then(function(){if(n&&!n.closed)return e();t()})}()});var n}).then(function(){if(!a)return xt(e).then(function(){n(r)})})},e.Ib=function(){var e=nr();return!ur(e)&&!dr(e)},e.Db=function(){return!1},e.zb=function(t,e,n,r,i,o,a){if(!t)return Ee(new Rr("popup-blocked"));if(a&&!ur())return this.ga().s(function(e){qn(t),i(e)}),r(),we();this.a||(this.a=Ka(za(this)));var s=this;return this.a.then(function(){var e=s.ga().s(function(e){throw qn(t),i(e),e});return r(),e}).then(function(){Ci(n),a||Un(Qa(s.l,s.f,s.b,e,n,null,o,s.c,void 0,s.h),t)}).s(function(e){throw"auth/network-request-failed"==e.code&&(s.a=null),e})},e.Ca=function(e,t,n){this.a||(this.a=Ka(za(this)));var r=this;return this.a.then(function(){Ci(t),Un(Qa(r.l,r.f,r.b,e,t,jn(),n,r.c,void 0,r.h))}).s(function(e){throw"auth/network-request-failed"==e.code&&(r.a=null),e})},e.ga=function(){var e=this;return $a(this).then(function(){return e.i.bb}).s(function(){throw e.a=null,new Rr("network-request-failed")})},e.Mb=function(){return!0},e.va=function(e){this.g.push(e)},e.Ka=function(t){F(this.g,function(e){return e==t})},(e=Ya.prototype).get=function(e){return we(this.a.getItem(e)).then(function(e){return e&&hr(e)})},e.set=function(e,t){return we(this.a.setItem(e,cr(t)))},e.P=function(e){return we(this.a.removeItem(e))},e.Y=function(){},e.ca=function(){},(e=Xa.prototype).set=function(n,r){var i,o=!1,a=this;return Ja(this).then(function(e){return ns((e=es(ts(i=e,!0))).get(n))}).then(function(e){var t=es(ts(i,!0));return e?(e.value=r,ns(t.put(e))):(a.b++,o=!0,(e={}).fbase_key=n,e.value=r,ns(t.add(e)))}).then(function(){a.f[n]=r}).ia(function(){o&&a.b--})},e.get=function(t){return Ja(this).then(function(e){return ns(es(ts(e,!1)).get(t))}).then(function(e){return e&&e.value})},e.P=function(t){var n=!1,r=this;return Ja(this).then(function(e){return n=!0,r.b++,ns(es(ts(e,!0)).delete(t))}).then(function(){delete r.f[t]}).ia(function(){n&&r.b--})},e.Kc=function(){var r=this;return Ja(this).then(function(e){var i=es(ts(e,!1));return i.getAll?ns(i.getAll()):new pe(function(t,n){var r=[],e=i.openCursor();e.onsuccess=function(e){(e=e.target.result)?(r.push(e.value),e.continue()):t(r)},e.onerror=function(e){n(Error(e.target.errorCode))}})}).then(function(e){var t={},n=[];if(0==r.b){for(n=0;n<e.length;n++)t[e[n].fbase_key]=e[n].value;n=function e(t,n){var r,i=[];for(r in t)r in n?typeof t[r]!=typeof n[r]?i.push(r):"object"==typeof t[r]&&null!=t[r]&&null!=n[r]?0<e(t[r],n[r]).length&&i.push(r):t[r]!==n[r]&&i.push(r):i.push(r);for(r in n)r in t||i.push(r);return i}(r.f,t),r.f=t}return n})},e.Y=function(e){var n;0==this.a.length&&((n=this).c&&n.c.cancel("STOP_EVENT"),function t(){return n.c=xt(800).then(y(n.Kc,n)).then(function(t){0<t.length&&P(n.a,function(e){e(t)})}).then(t).s(function(e){"STOP_EVENT"!=e.message&&t()}),n.c}()),this.a.push(e)},e.ca=function(t){F(this.a,function(e){return e==t}),0==this.a.length&&this.c&&this.c.cancel("STOP_EVENT")},(e=rs.prototype).get=function(t){return this.b.then(function(e){return e.get(t)})},e.set=function(t,n){return this.b.then(function(e){return e.set(t,n)})},e.P=function(t){return this.b.then(function(e){return e.P(t)})},e.Y=function(e){this.a.push(e)},e.ca=function(t){F(this.a,function(e){return e==t})},(e=is.prototype).get=function(e){return we(this.a[e])},e.set=function(e,t){return this.a[e]=t,we()},e.P=function(e){return delete this.a[e],we()},e.Y=function(){},e.ca=function(){},(e=os.prototype).get=function(e){var t=this;return we().then(function(){return hr(t.a.getItem(e))})},e.set=function(t,n){var r=this;return we().then(function(){var e=cr(n);null===e?r.P(t):r.a.setItem(t,e)})},e.P=function(e){var t=this;return we().then(function(){t.a.removeItem(e)})},e.Y=function(e){l.window&&mt(l.window,"storage",e)},e.ca=function(e){l.window&&bt(l.window,"storage",e)},(e=ss.prototype).get=function(){return we(null)},e.set=function(){return we()},e.P=function(){return we()},e.Y=function(){},e.ca=function(){},(e=us.prototype).get=function(e){var t=this;return we().then(function(){return hr(t.a.getItem(e))})},e.set=function(t,n){var r=this;return we().then(function(){var e=cr(n);null===e?r.P(t):r.a.setItem(t,e)})},e.P=function(e){var t=this;return we().then(function(){t.a.removeItem(e)})},e.Y=function(){},e.ca=function(){};var ls,hs,fs={A:os,Qa:us},ds={A:os,Qa:us},ps={A:Ya,Qa:ss},vs={A:os,Qa:ss},ms={Xc:"local",NONE:"none",Zc:"session"};function gs(){var e=!(dr(nr())||!$n()),t=ur(),n=ir();this.o=e,this.h=t,this.m=n,this.a={},ls||(ls=new function(){var e={};e.Browser=fs,e.Node=ds,e.ReactNative=ps,e.Worker=vs,this.a=e[Qn()]}),e=ls;try{this.g=!Vn()&&yr()||!l.indexedDB?new e.a.A:new rs(zn()?new is:new e.a.A)}catch(e){this.g=new is,this.h=!0}try{this.i=new e.a.Qa}catch(e){this.i=new is}this.l=new is,this.f=y(this.Lb,this),this.b={}}function ys(){return hs||(hs=new gs),hs}function bs(e,t){switch(t){case"session":return e.i;case"none":return e.l;default:return e.g}}function _s(e,t){return"firebase:"+e.name+(t?":"+t:"")}function ws(e,t,n){return n=_s(t,n),"local"==t.A&&(e.b[n]=null),bs(e,t.A).P(n)}function Es(e){e.c&&(clearInterval(e.c),e.c=null)}(e=gs.prototype).get=function(e,t){return bs(this,e.A).get(_s(e,t))},e.set=function(t,e,n){var r=_s(t,n),i=this,o=bs(this,t.A);return o.set(r,e).then(function(){return o.get(r)}).then(function(e){"local"==t.A&&(i.b[r]=e)})},e.addListener=function(e,t,n){var r;e=_s(e,t),this.m&&(this.b[e]=l.localStorage.getItem(e)),re(this.a)&&(bs(this,"local").Y(this.f),this.h||(Vn()||!yr())&&l.indexedDB||!this.m||(Es(r=this),r.c=setInterval(function(){for(var e in r.a){var t=l.localStorage.getItem(e),n=r.b[e];t!=n&&(r.b[e]=t,t=new at({type:"storage",key:e,target:window,oldValue:n,newValue:t,a:!0}),r.Lb(t))}},1e3))),this.a[e]||(this.a[e]=[]),this.a[e].push(n)},e.removeListener=function(e,t,n){e=_s(e,t),this.a[e]&&(F(this.a[e],function(e){return e==n}),0==this.a[e].length&&delete this.a[e]),re(this.a)&&(bs(this,"local").ca(this.f),Es(this))},e.Lb=function(e){if(e&&e.f){var t=e.a.key;if(null==t)for(var n in this.a){var r=this.b[n];void 0===r&&(r=null);var i=l.localStorage.getItem(n);i!==r&&(this.b[n]=i,this.Wa(n))}else if(0==t.indexOf("firebase:")&&this.a[t]){if(void 0!==e.a.a?bs(this,"local").ca(this.f):Es(this),this.o)if(n=l.localStorage.getItem(t),(r=e.a.newValue)!==n)null!==r?l.localStorage.setItem(t,r):l.localStorage.removeItem(t);else if(this.b[t]===r&&void 0===e.a.a)return;var o=this;n=function(){void 0===e.a.a&&o.b[t]===l.localStorage.getItem(t)||(o.b[t]=l.localStorage.getItem(t),o.Wa(t))},qe&&Xe&&10==Xe&&l.localStorage.getItem(t)!==e.a.newValue&&e.a.newValue!==e.a.oldValue?setTimeout(n,10):n()}}else P(e,y(this.Wa,this))},e.Wa=function(e){this.a[e]&&P(this.a[e],function(e){e()})};var Ss,Cs={name:"authEvent",A:"local"};function Ts(e,t){this.b=-1,this.b=Os,this.f=l.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=e,this.h=t,this.m=l.Int32Array?new Int32Array(64):Array(64),void 0!==Ss||(Ss=l.Int32Array?new Int32Array(xs):xs),this.reset()}t(Ts,function(){this.b=-1});for(var Os=64,Rs=Os-1,As=[],Is=0;Is<Rs;Is++)As[Is]=0;var Ns=V(128,As);function ks(e){for(var t=e.f,n=e.m,r=0,i=0;i<t.length;)n[r++]=t[i]<<24|t[i+1]<<16|t[i+2]<<8|t[i+3],i=4*r;for(t=16;t<64;t++){i=0|n[t-15],r=0|n[t-2];var o=(0|n[t-16])+((i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3)|0,a=(0|n[t-7])+((r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10)|0;n[t]=o+a|0}r=0|e.a[0],i=0|e.a[1];var s=0|e.a[2],u=0|e.a[3],c=0|e.a[4],l=0|e.a[5],h=0|e.a[6];for(o=0|e.a[7],t=0;t<64;t++){var f=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&i^r&s^i&s)|0;a=(o=o+((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))|0)+((a=(a=c&l^~c&h)+(0|Ss[t])|0)+(0|n[t])|0)|0,o=h,h=l,l=c,c=u+a|0,u=s,s=i,i=r,r=a+f|0}e.a[0]=e.a[0]+r|0,e.a[1]=e.a[1]+i|0,e.a[2]=e.a[2]+s|0,e.a[3]=e.a[3]+u|0,e.a[4]=e.a[4]+c|0,e.a[5]=e.a[5]+l|0,e.a[6]=e.a[6]+h|0,e.a[7]=e.a[7]+o|0}function Ps(e,t,n){void 0===n&&(n=t.length);var r=0,i=e.c;if(c(t))for(;r<n;)e.f[i++]=t.charCodeAt(r++),i==e.b&&(ks(e),i=0);else{if(!p(t))throw Error("message must be string or array");for(;r<n;){var o=t[r++];if(!("number"==typeof o&&0<=o&&o<=255&&o==(0|o)))throw Error("message must be a byte array");e.f[i++]=o,i==e.b&&(ks(e),i=0)}}e.c=i,e.g+=n}Ts.prototype.reset=function(){this.g=this.c=0,this.a=l.Int32Array?new Int32Array(this.h):j(this.h)};var xs=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function Ds(){Ts.call(this,8,Ms)}t(Ds,Ts);var Ms=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function Ls(e,t,n,r,i){this.l=e,this.i=t,this.m=n,this.o=r||null,this.u=i||null,this.h=t+":"+n,this.v=new function(){this.a=ys()},this.g=new function(e){this.a=e,this.b=ys()}(this.h),this.f=null,this.b=[],this.a=this.c=null}function Fs(e){return new Rr("invalid-cordova-configuration",e)}function Vs(e,t){for(var n=0;n<e.b.length;n++)try{e.b[n](t)}catch(e){}}function js(r){return r.f||(r.f=r.ga().then(function(){return new pe(function(n){r.va(function e(t){return n(t),r.Ka(e),!1}),function(i){function t(r){e=!0,n&&n.cancel(),Us(i).then(function(e){var t=o;if(e&&r&&r.url){var n=null;-1!=(t=ti(r.url)).indexOf("/__/auth/callback")&&(n=(n="object"==typeof(n=hr(Gt(n=Kt(t),"firebaseError")||null))?Ar(n):null)?new Ti(e.b,e.c,null,null,n):new Ti(e.b,e.c,t,e.g)),t=n||o}Vs(i,t)})}var o=new Ti("unknown",null,null,null,new Rr("no-auth-event")),e=!1,n=xt(500).then(function(){return Us(i).then(function(){e||Vs(i,o)})}),r=l.handleOpenURL;l.handleOpenURL=function(e){if(0==e.toLowerCase().indexOf(rr("BuildInfo.packageName",l).toLowerCase()+"://")&&t({url:e}),"function"==typeof r)try{r(e)}catch(e){console.error(e)}},Ai||(Ai=new Ri),Ai.subscribe(t)}(r)})})),r.f}function Us(t){var e,n=null;return(e=t.g,e.b.get(Cs,e.a).then(function(e){return Oi(e)})).then(function(e){return n=e,ws((e=t.g).b,Cs,e.a)}).then(function(){return n})}(e=Ls.prototype).ga=function(){return this.za?this.za:this.za=(Kn(void 0)?Gn().then(function(){return new pe(function(e,t){var n=l.document,r=setTimeout(function(){t(Error("Cordova framework is not ready."))},1e3);n.addEventListener("deviceready",function(){clearTimeout(r),e()},!1)})}):Ee(Error("Cordova must run in an Android or iOS file scheme."))).then(function(){if("function"!=typeof rr("universalLinks.subscribe",l))throw Fs("cordova-universal-links-plugin is not installed");if(void 0===rr("BuildInfo.packageName",l))throw Fs("cordova-plugin-buildinfo is not installed");if("function"!=typeof rr("cordova.plugins.browsertab.openUrl",l))throw Fs("cordova-plugin-browsertab is not installed");if("function"!=typeof rr("cordova.InAppBrowser.open",l))throw Fs("cordova-plugin-inappbrowser is not installed")},function(){throw new Rr("cordova-not-ready")})},e.Ea=function(e,t){return t(new Rr("operation-not-supported-in-this-environment")),we()},e.zb=function(){return Ee(new Rr("operation-not-supported-in-this-environment"))},e.Mb=function(){return!1},e.Ib=function(){return!0},e.Db=function(){return!0},e.Ca=function(e,t,n){if(this.c)return Ee(new Rr("redirect-operation-pending"));var r=this,i=l.document,o=null,a=null,s=null,u=null;return this.c=we().then(function(){return Ci(t),js(r)}).then(function(){return function(n,e,t,r){var i=function(){for(var e=20,t=[];0<e;)t.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),e--;return t.join("")}(),o=new Ti(e,r,null,i,new Rr("no-auth-event")),a=rr("BuildInfo.packageName",l);if("string"!=typeof a)throw new Rr("invalid-cordova-configuration");var s=rr("BuildInfo.displayName",l),u={};if(nr().toLowerCase().match(/iphone|ipad|ipod/))u.ibi=a;else{if(!nr().toLowerCase().match(/android/))return Ee(new Rr("operation-not-supported-in-this-environment"));u.apn=a}s&&(u.appDisplayName=s),i=function(e){var t=new Ds;Ps(t,e),e=[];var n=8*t.g;t.c<56?Ps(t,Ns,56-t.c):Ps(t,Ns,t.b-(t.c-56));for(var r=63;56<=r;r--)t.f[r]=255&n,n/=256;for(ks(t),r=n=0;r<t.i;r++)for(var i=24;0<=i;i-=8)e[n++]=t.a[r]>>i&255;return x(e,function(e){return 1<(e=e.toString(16)).length?e:"0"+e}).join("")}(i),u.sessionId=i;var c=Qa(n.l,n.i,n.m,e,t,null,r,n.o,u,n.u);return n.ga().then(function(){var e=n.h;return n.v.a.set(Cs,o.D(),e)}).then(function(){var e=rr("cordova.plugins.browsertab.isAvailable",l);if("function"!=typeof e)throw new Rr("invalid-cordova-configuration");var t=null;e(function(e){if(e){if("function"!=typeof(t=rr("cordova.plugins.browsertab.openUrl",l)))throw new Rr("invalid-cordova-configuration");t(c)}else{if("function"!=typeof(t=rr("cordova.InAppBrowser.open",l)))throw new Rr("invalid-cordova-configuration");e=!(!(e=nr()).match(/(iPad|iPhone|iPod).*OS 7_\d/i)&&!e.match(/(iPad|iPhone|iPod).*OS 8_\d/i)),n.a=t(c,e?"_blank":"_system","location=yes")}})})}(r,e,t,n)}).then(function(){return new pe(function(t,e){a=function(){var e=rr("cordova.plugins.browsertab.close",l);return t(),"function"==typeof e&&e(),r.a&&"function"==typeof r.a.close&&(r.a.close(),r.a=null),!1},r.va(a),s=function(){o||(o=xt(2e3).then(function(){e(new Rr("redirect-cancelled-by-user"))}))},u=function(){mr()&&s()},i.addEventListener("resume",s,!1),nr().toLowerCase().match(/android/)||i.addEventListener("visibilitychange",u,!1)}).s(function(e){return Us(r).then(function(){throw e})})}).ia(function(){s&&i.removeEventListener("resume",s,!1),u&&i.removeEventListener("visibilitychange",u,!1),o&&o.cancel(),a&&r.Ka(a),r.c=null})},e.va=function(t){this.b.push(t),js(this).s(function(e){"auth/invalid-cordova-configuration"===e.code&&(e=new Ti("unknown",null,null,null,new Rr("no-auth-event")),t(e))})},e.Ka=function(t){F(this.b,function(e){return e==t})};var Bs={name:"pendingRedirect",A:"session"};function qs(e){return ws(e.b,Bs,e.a)}function Ws(e,t,n){this.v=e,this.m=t,this.l=n,this.h=[],this.f=!1,this.i=y(this.o,this),this.c=new Zs,this.u=new ru,this.g=new function(e){this.a=e,this.b=ys()}(this.m+":"+this.l),this.b={},this.b.unknown=this.c,this.b.signInViaRedirect=this.c,this.b.linkViaRedirect=this.c,this.b.reauthViaRedirect=this.c,this.b.signInViaPopup=this.u,this.b.linkViaPopup=this.u,this.b.reauthViaPopup=this.u,this.a=Hs(this.v,this.m,this.l,xa)}function Hs(e,t,n,r){var i=d.SDK_VERSION||null;return Kn()?new Ls(e,t,n,i,r):new Ga(e,t,n,i,r)}function Gs(t){t.f||(t.f=!0,t.a.va(t.i));var n=t.a;return t.a.ga().s(function(e){throw t.a==n&&t.reset(),e})}function Ks(n){n.a.Ib()&&Gs(n).s(function(e){var t=new Ti("unknown",null,null,null,new Rr("operation-not-supported-in-this-environment"));Ys(e)&&n.o(t)}),n.a.Db()||eu(n.c)}Ws.prototype.reset=function(){this.f=!1,this.a.Ka(this.i),this.a=Hs(this.v,this.m,this.l)},Ws.prototype.subscribe=function(e){if(M(this.h,e)||this.h.push(e),!this.f){var n=this;(t=this.g,t.b.get(Bs,t.a).then(function(e){return"pending"==e})).then(function(e){e?qs(n.g).then(function(){Gs(n).s(function(e){var t=new Ti("unknown",null,null,null,new Rr("operation-not-supported-in-this-environment"));Ys(e)&&n.o(t)})}):Ks(n)}).s(function(){Ks(n)})}var t},Ws.prototype.unsubscribe=function(t){F(this.h,function(e){return e==t})},Ws.prototype.o=function(e){if(!e)throw new Rr("invalid-auth-event");for(var t=!1,n=0;n<this.h.length;n++){var r=this.h[n];if(r.sb(e.b,e.c)){(t=this.b[e.b])&&t.h(e,r),t=!0;break}}return eu(this.c),t};var $s=new vr(2e3,1e4),zs=new vr(3e4,6e4);function Qs(e,t,n,r,i,o){return e.a.zb(t,n,r,function(){e.f||(e.f=!0,e.a.va(e.i))},function(){e.reset()},i,o)}function Ys(e){return!(!e||"auth/cordova-not-ready"!=e.code)}Ws.prototype.fa=function(){return this.c.fa()},Ws.prototype.Ca=function(e,t,n){var r,i,o=this;return(i=this.g,i.b.set(Bs,"pending",i.a)).then(function(){return o.a.Ca(e,t,n).s(function(e){if(Ys(e))throw new Rr("operation-not-supported-in-this-environment");return r=e,qs(o.g).then(function(){throw r})}).then(function(){return o.a.Mb()?new pe(function(){}):qs(o.g).then(function(){return o.fa()}).then(function(){}).s(function(){})})})},Ws.prototype.Ea=function(t,n,e,r){return this.a.Ea(e,function(e){t.ha(n,null,e,r)},$s.get())};var Xs={};function Js(e,t,n){var r=t+":"+n;return Xs[r]||(Xs[r]=new Ws(e,t,n)),Xs[r]}function Zs(){this.b=null,this.f=[],this.c=[],this.a=null,this.g=!1}function eu(e){e.g||(e.g=!0,nu(e,!1,null,null))}function tu(e,t){if(e.b=function(){return we(t)},e.f.length)for(var n=0;n<e.f.length;n++)e.f[n](t)}function nu(e,t,n,r){t?r?function(e,t){if(e.b=function(){return Ee(t)},e.c.length)for(var n=0;n<e.c.length;n++)e.c[n](t)}(e,r):tu(e,n):tu(e,{user:null}),e.f=[],e.c=[]}function ru(){}function iu(){this.pb=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.pb},set:function(e){this.pb=e},enumerable:!1})}function ou(e,t){this.a=t,Sr(this,"verificationId",e)}function au(e,t,n,r){return new wi(e).Ta(t,n).then(function(e){return new ou(e,r)})}function su(e,t,n){if(this.h=e,this.i=t,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function uu(e){this.f=e,this.b=this.a=null,this.c=0}function cu(e,t){var n=t[Lo],r=t.refreshToken;t=lu(t.expiresIn),e.b=n,e.c=t,e.a=r}function lu(e){return _()+1e3*parseInt(e,10)}function hu(e,t){this.a=e||null,this.b=t||null,Cr(this,{lastSignInTime:gr(t||null),creationTime:gr(e||null)})}function fu(e,t){for(var n in ot.call(this,e),t)this[n]=t[n]}function du(e,t,n){var r;this.G=[],this.l=e.apiKey,this.o=e.appName,this.u=e.authDomain||null,e=d.SDK_VERSION?tr(d.SDK_VERSION):null,this.b=new Do(this.l,Ma(xa),e),this.h=new uu(this.b),_u(this,t[Lo]),cu(this.h,t),Sr(this,"refreshToken",this.h.a),Su(this,n||{}),At.call(this),this.I=!1,this.u&&or()&&(this.a=Js(this.u,this.l,this.o)),this.N=[],this.i=null,this.w=(r=this,new su(function(){return r.F(!0)},function(e){return!(!e||"auth/network-request-failed"!=e.code)},function(){var e=r.h.c-_()-3e5;return 0<e?e:0})),this.V=y(this.Ha,this);var i=this;this.ka=null,this.sa=function(e){i.oa(e.g)},this.X=null,this.O=[],this.ra=function(e){vu(i,e.c)},this.W=null}function pu(e,t){e.X&&bt(e.X,"languageCodeChanged",e.sa),(e.X=t)&&mt(t,"languageCodeChanged",e.sa)}function vu(e,t){e.O=t,qo(e.b,d.SDK_VERSION?tr(d.SDK_VERSION,e.O):null)}function mu(e,t){e.W&&bt(e.W,"frameworkChanged",e.ra),(e.W=t)&&mt(t,"frameworkChanged",e.ra)}function gu(t){try{return d.app(t.o).auth()}catch(e){throw new Rr("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+t.o+"'!")}}function yu(e){e.C||e.w.b||(e.w.start(),bt(e,"tokenChanged",e.V),mt(e,"tokenChanged",e.V))}function bu(e){bt(e,"tokenChanged",e.V),e.w.stop()}function _u(e,t){e.qa=t,Sr(e,"_lat",t)}function wu(e){for(var t=[],n=0;n<e.N.length;n++)t.push(e.N[n](e));return(a=t,new pe(function(r){var i=a.length,o=[];if(i)for(var e=function(e,t,n){i--,o[e]=t?{Zb:!0,value:n}:{Zb:!1,reason:n},0==i&&r(o)},t=0;t<a.length;t++)Se(a[t],b(e,t,!0),b(e,t,!1));else r(o)})).then(function(){return e});var a}function Eu(e){e.a&&!e.I&&(e.I=!0,e.a.subscribe(e))}function Su(e,t){Cr(e,{uid:t.uid,displayName:t.displayName||null,photoURL:t.photoURL||null,email:t.email||null,emailVerified:t.emailVerified||!1,phoneNumber:t.phoneNumber||null,isAnonymous:t.isAnonymous||!1,metadata:new hu(t.createdAt,t.lastLoginAt),providerData:[]})}function Cu(){}function Tu(e){return we().then(function(){if(e.C)throw new Rr("app-deleted")})}function Ou(e){return x(e.providerData,function(e){return e.providerId})}function Ru(e,t){t&&(Au(e,t.providerId),e.providerData.push(t))}function Au(e,t){F(e.providerData,function(e){return e.providerId==t})}function Iu(e,t,n){("uid"!=t||n)&&e.hasOwnProperty(t)&&Sr(e,t,n)}function Nu(t,e){var n,r,i;t!=e&&(Cr(t,{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL,email:e.email,emailVerified:e.emailVerified,phoneNumber:e.phoneNumber,isAnonymous:e.isAnonymous,providerData:[]}),e.metadata?Sr(t,"metadata",new hu((i=e.metadata).a,i.b)):Sr(t,"metadata",new hu),P(e.providerData,function(e){Ru(t,e)}),n=t.h,r=e.h,n.b=r.b,n.a=r.a,n.c=r.c,Sr(t,"refreshToken",t.h.a))}function ku(i){return i.F().then(function(e){var t,n,r=i.isAnonymous;return(t=i,n=e,Na(t.b,ha,{idToken:n}).then(y(t.uc,t))).then(function(){return r||Iu(i,"isAnonymous",!1),e})})}function Pu(e,t){t[Lo]&&e.qa!=t[Lo]&&(cu(e.h,t),e.dispatchEvent(new fu("tokenChanged")),_u(e,t[Lo]),Iu(e,"refreshToken",e.h.a))}function xu(e,t){return ku(e).then(function(){if(M(Ou(e),t))return wu(e).then(function(){throw new Rr("provider-already-linked")})})}function Du(e,t,n){return Tr({user:e,credential:Si(t),additionalUserInfo:t=Kr(t),operationType:n})}function Mu(e,t){return Pu(e,t),e.reload().then(function(){return e})}function Lu(n,r,e,t,i){if(!or())return Ee(new Rr("operation-not-supported-in-this-environment"));if(n.i&&!i)return Ee(n.i);var o=Gr(e.providerId),a=fr(n.uid+":::"),s=null;(!ur()||$n())&&n.u&&e.isOAuthProvider&&(s=Qa(n.u,n.l,n.o,r,e,null,a,d.SDK_VERSION||null));var u=Wn(s,o&&o.Ba,o&&o.Aa);return t=t().then(function(){if(Vu(n),!i)return n.F().then(function(){})}).then(function(){return Qs(n.a,u,r,e,a,!!s)}).then(function(){return new pe(function(e,t){n.ha(r,null,new Rr("cancelled-popup-request"),n.g||null),n.f=e,n.v=t,n.g=a,n.c=n.a.Ea(n,r,u,a)})}).then(function(e){return u&&qn(u),e?Tr(e):null}).s(function(e){throw u&&qn(u),e}),ju(n,t,i)}function Fu(t,e,n,r,i){if(!or())return Ee(new Rr("operation-not-supported-in-this-environment"));if(t.i&&!i)return Ee(t.i);var o=null,a=fr(t.uid+":::");return r=r().then(function(){if(Vu(t),!i)return t.F().then(function(){})}).then(function(){return t.aa=a,wu(t)}).then(function(e){return t.ba&&(e=(e=t.ba).b.set(Bu,t.D(),e.a)),e}).then(function(){return t.a.Ca(e,n,a)}).s(function(e){if(o=e,t.ba)return qu(t.ba);throw o}).then(function(){if(o)throw o}),ju(t,r,i)}function Vu(e){if(!e.a||!e.I){if(e.a&&!e.I)throw new Rr("internal-error");throw new Rr("auth-domain-config-required")}}function ju(e,t,n){var r,i,o,a=(i=t,o=n,(r=e).i&&!o?(i.cancel(),Ee(r.i)):i.s(function(e){throw!e||"auth/user-disabled"!=e.code&&"auth/user-token-expired"!=e.code||(r.i||r.dispatchEvent(new fu("userInvalidated")),r.i=e),e}));return e.G.push(a),a.ia(function(){L(e.G,a)}),a}function Uu(e){if(!e.apiKey)return null;var t={apiKey:e.apiKey,authDomain:e.authDomain,appName:e.appName},n={};if(!(e.stsTokenManager&&e.stsTokenManager.accessToken&&e.stsTokenManager.expirationTime))return null;n[Lo]=e.stsTokenManager.accessToken,n.refreshToken=e.stsTokenManager.refreshToken||null,n.expiresIn=(e.stsTokenManager.expirationTime-_())/1e3;var r=new du(t,n,e);return e.providerData&&P(e.providerData,function(e){e&&Ru(r,Tr(e))}),e.redirectEventId&&(r.aa=e.redirectEventId),r}Zs.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},Zs.prototype.h=function(e,t){if(e){this.reset(),this.g=!0;var n=e.b,r=e.c,i=e.a&&"auth/web-storage-unsupported"==e.a.code,o=e.a&&"auth/operation-not-supported-in-this-environment"==e.a.code;"unknown"!=n||i||o?e.a?(nu(this,!0,null,e.a),we()):t.wa(n,r)?function(t,e,n){n=n.wa(e.b,e.c);var r=e.f,i=e.g,o=!!e.b.match(/Redirect$/);n(r,i).then(function(e){nu(t,o,e,null)}).s(function(e){nu(t,o,null,e)})}(this,e,t):Ee(new Rr("invalid-auth-event")):(nu(this,!1,null,null),we())}else Ee(new Rr("invalid-auth-event"))},Zs.prototype.fa=function(){var i=this;return new pe(function(e,t){var n,r;i.b?i.b().then(e,t):(i.f.push(e),i.c.push(t),n=i,r=new Rr("timeout"),n.a&&n.a.cancel(),n.a=xt(zs.get()).then(function(){n.b||nu(n,!0,null,r)}))})},ru.prototype.h=function(e,t){if(e){var n=e.b,r=e.c;e.a?(t.ha(e.b,null,e.a,e.c),we()):t.wa(n,r)?(o=t,a=(i=e).c,s=i.b,o.wa(s,a)(i.f,i.g).then(function(e){o.ha(s,e,null,a)}).s(function(e){o.ha(s,null,e,a)})):Ee(new Rr("invalid-auth-event"))}else Ee(new Rr("invalid-auth-event"));var i,o,a,s},ou.prototype.confirm=function(e){return e=Ei(this.verificationId,e),this.a(e)},su.prototype.start=function(){this.a=this.c,function t(n,e){var r,i;n.stop(),n.b=xt((r=n,i=e,i?(r.a=r.c,r.g()):(i=r.a,r.a*=2,r.a>r.f&&(r.a=r.f),i))).then(function(){return t=l.document,n=null,mr()||!t?we():new pe(function(e){n=function(){mr()&&(t.removeEventListener("visibilitychange",n,!1),e())},t.addEventListener("visibilitychange",n,!1)}).s(function(e){throw t.removeEventListener("visibilitychange",n,!1),e});var t,n}).then(function(){return n.h()}).then(function(){t(n,!0)}).s(function(e){n.i(e)&&t(n,!1)})}(this,!0)},su.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},uu.prototype.D=function(){return{apiKey:this.f.b,refreshToken:this.a,accessToken:this.b,expirationTime:this.c}},uu.prototype.getToken=function(e){return e=!!e,this.b&&!this.a?Ee(new Rr("user-token-expired")):e||!this.b||_()>this.c-3e4?this.a?(n={grant_type:"refresh_token",refresh_token:(t=this).a},(r=t.f,i=n,new pe(function(t,n){"refresh_token"==i.grant_type&&i.refresh_token||"authorization_code"==i.grant_type&&i.code?Wo(r,r.i+"?key="+encodeURIComponent(r.b),function(e){e?e.error?n(Pa(e)):e.access_token&&e.refresh_token?t(e):n(new Rr("internal-error")):n(new Rr("network-request-failed"))},"POST",on(i).toString(),r.f,r.m.get()):n(new Rr("internal-error"))})).then(function(e){return t.b=e.access_token,t.c=lu(e.expires_in),t.a=e.refresh_token,{accessToken:t.b,expirationTime:t.c,refreshToken:t.a}}).s(function(e){throw"auth/user-token-expired"==e.code&&(t.a=null),e})):we(null):we({accessToken:this.b,expirationTime:this.c,refreshToken:this.a});var t,n,r,i},hu.prototype.D=function(){return{lastLoginAt:this.b,createdAt:this.a}},t(fu,ot),t(du,At),du.prototype.oa=function(e){this.ka=e,Bo(this.b,e)},du.prototype.ea=function(){return this.ka},du.prototype.xa=function(){return j(this.O)},du.prototype.Ha=function(){this.w.b&&(this.w.stop(),this.w.start())},Sr(du.prototype,"providerId","firebase"),(e=du.prototype).reload=function(){var e=this;return ju(this,Tu(this).then(function(){return ku(e).then(function(){return wu(e)}).then(Cu)}))},e.ac=function(e){return this.F(e).then(function(e){return new function(e){var t=Br(e);if(!(t&&t.exp&&t.auth_time&&t.iat))throw new Rr("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");Cr(this,{token:e,expirationTime:gr(1e3*t.exp),authTime:gr(1e3*t.auth_time),issuedAtTime:gr(1e3*t.iat),signInProvider:t.firebase&&t.firebase.sign_in_provider?t.firebase.sign_in_provider:null,claims:t})}(e)})},e.F=function(e){var t=this;return ju(this,Tu(this).then(function(){return t.h.getToken(e)}).then(function(e){if(!e)throw new Rr("internal-error");return e.accessToken!=t.qa&&(_u(t,e.accessToken),t.dispatchEvent(new fu("tokenChanged"))),Iu(t,"refreshToken",e.refreshToken),e.accessToken}))},e.uc=function(e){if(!(e=e.users)||!e.length)throw new Rr("internal-error");Su(this,{uid:(e=e[0]).localId,displayName:e.displayName,photoURL:e.photoUrl,email:e.email,emailVerified:!!e.emailVerified,phoneNumber:e.phoneNumber,lastLoginAt:e.lastLoginAt,createdAt:e.createdAt});for(var t=(r=(r=e).providerUserInfo)&&r.length?x(r,function(a){return new function(e,t,n,r,i,o){Cr(this,{uid:e,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:n||null,phoneNumber:a.phoneNumber||null,providerId:t})}(a.rawId,a.providerId,a.email,0,0,0)}):[],n=0;n<t.length;n++)Ru(this,t[n]);var r;Iu(this,"isAnonymous",!(this.email&&e.passwordHash||this.providerData&&this.providerData.length))},e.cb=function(e){var t=this,n=null;return ju(this,e.f(this.b,this.uid).then(function(e){return Pu(t,e),n=Du(t,e,"reauthenticate"),t.i=null,t.reload()}).then(function(){return n}),!0)},e.vc=function(e){return wr("firebase.User.prototype.reauthenticateWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential instead."),this.cb(e).then(function(){})},e.ab=function(t){var n=this,r=null;return ju(this,xu(this,t.providerId).then(function(){return n.F()}).then(function(e){return t.c(n.b,e)}).then(function(e){return r=Du(n,e,"link"),Mu(n,e)}).then(function(){return r}))},e.mc=function(e){return wr("firebase.User.prototype.linkWithCredential is deprecated. Please use firebase.User.prototype.linkAndRetrieveDataWithCredential instead."),this.ab(e).then(function(e){return e.user})},e.nc=function(e,t){var n=this;return ju(this,xu(this,"phone").then(function(){return au(gu(n),e,t,y(n.ab,n))}))},e.wc=function(e,t){var n=this;return ju(this,we().then(function(){return au(gu(n),e,t,y(n.cb,n))}),!0)},e.mb=function(t){var n=this;return ju(this,this.F().then(function(e){return n.b.mb(e,t)}).then(function(e){return Pu(n,e),n.reload()}))},e.Pc=function(t){var n=this;return ju(this,this.F().then(function(e){return t.c(n.b,e)}).then(function(e){return Pu(n,e),n.reload()}))},e.nb=function(t){var n=this;return ju(this,this.F().then(function(e){return n.b.nb(e,t)}).then(function(e){return Pu(n,e),n.reload()}))},e.ob=function(t){if(void 0===t.displayName&&void 0===t.photoURL)return Tu(this);var n=this;return ju(this,this.F().then(function(e){return n.b.ob(e,{displayName:t.displayName,photoUrl:t.photoURL})}).then(function(e){return Pu(n,e),Iu(n,"displayName",e.displayName||null),Iu(n,"photoURL",e.photoUrl||null),P(n.providerData,function(e){"password"===e.providerId&&(Sr(e,"displayName",n.displayName),Sr(e,"photoURL",n.photoURL))}),wu(n)}).then(Cu))},e.Nc=function(t){var n=this;return ju(this,ku(this).then(function(e){return M(Ou(n),t)?Na(n.b,ua,{idToken:e,deleteProvider:[t]}).then(function(e){var t={};return P(e.providerUserInfo||[],function(e){t[e.providerId]=!0}),P(Ou(n),function(e){t[e]||Au(n,e)}),t[wi.PROVIDER_ID]||Sr(n,"phoneNumber",null),wu(n)}):wu(n).then(function(){throw new Rr("no-such-provider")})}))},e.delete=function(){var t=this;return ju(this,this.F().then(function(e){return Na(t.b,sa,{idToken:e})}).then(function(){t.dispatchEvent(new fu("userDeleted"))})).then(function(){for(var e=0;e<t.G.length;e++)t.G[e].cancel("app-deleted");pu(t,null),mu(t,null),t.G=[],t.C=!0,bu(t),Sr(t,"refreshToken",null),t.a&&t.a.unsubscribe(t)})},e.sb=function(e,t){return!!("linkViaPopup"==e&&(this.g||null)==t&&this.f||"reauthViaPopup"==e&&(this.g||null)==t&&this.f||"linkViaRedirect"==e&&(this.aa||null)==t||"reauthViaRedirect"==e&&(this.aa||null)==t)},e.ha=function(e,t,n,r){"linkViaPopup"!=e&&"reauthViaPopup"!=e||r!=(this.g||null)||(n&&this.v?this.v(n):t&&!n&&this.f&&this.f(t),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.v)},e.wa=function(e,t){return"linkViaPopup"==e&&t==(this.g||null)?y(this.xb,this):"reauthViaPopup"==e&&t==(this.g||null)?y(this.yb,this):"linkViaRedirect"==e&&(this.aa||null)==t?y(this.xb,this):"reauthViaRedirect"==e&&(this.aa||null)==t?y(this.yb,this):null},e.oc=function(e){var t=this;return Lu(this,"linkViaPopup",e,function(){return xu(t,e.providerId).then(function(){return wu(t)})},!1)},e.xc=function(e){return Lu(this,"reauthViaPopup",e,function(){return we()},!0)},e.pc=function(e){var t=this;return Fu(this,"linkViaRedirect",e,function(){return xu(t,e.providerId)},!1)},e.yc=function(e){return Fu(this,"reauthViaRedirect",e,function(){return we()},!0)},e.xb=function(t,n){var r=this;this.c&&(this.c.cancel(),this.c=null);var i=null;return ju(this,this.F().then(function(e){return ea(r.b,{requestUri:t,sessionId:n,idToken:e})}).then(function(e){return i=Du(r,e,"link"),Mu(r,e)}).then(function(){return i}))},e.yb=function(e,t){var n=this;this.c&&(this.c.cancel(),this.c=null);var r=null;return ju(this,we().then(function(){return ni(ta(n.b,{requestUri:e,sessionId:t}),n.uid)}).then(function(e){return r=Du(n,e,"reauthenticate"),Pu(n,e),n.i=null,n.reload()}).then(function(){return r}),!0)},e.gb=function(t){var n=this,r=null;return ju(this,this.F().then(function(e){return r=e,void 0===t||re(t)?{}:Lr(new kr(t))}).then(function(e){return n.b.gb(r,e)}).then(function(e){if(n.email!=e)return n.reload()}).then(function(){}))},e.toJSON=function(){return this.D()},e.D=function(){var t={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,providerData:[],apiKey:this.l,appName:this.o,authDomain:this.u,stsTokenManager:this.h.D(),redirectEventId:this.aa||null};return this.metadata&&ue(t,this.metadata.D()),P(this.providerData,function(e){t.providerData.push(function(e){var t,n={};for(t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}(e))}),t};var Bu={name:"redirectUser",A:"session"};function qu(e){return ws(e.b,Bu,e.a)}function Wu(e){var t,n,r,i,o,a,s,u,c;this.a=e,this.b=ys(),this.c=null,this.f=(t=this,s=Ku("local"),u=Ku("session"),c=Ku("none"),(n=t.b,r=s,i=t.a,o=_s(r,i),a=bs(n,r.A),n.get(r,i).then(function(e){var t=null;try{t=hr(l.localStorage.getItem(o))}catch(e){}if(t&&!e)return l.localStorage.removeItem(o),n.set(r,t,i);t&&e&&"localStorage"!=a.type&&l.localStorage.removeItem(o)})).then(function(){return t.b.get(u,t.a)}).then(function(e){return e?u:t.b.get(c,t.a).then(function(e){return e?c:t.b.get(s,t.a).then(function(e){return e?s:t.b.get(Gu,t.a).then(function(e){return e?Ku(e):s})})})}).then(function(e){return t.c=e,Hu(t,e.A)}).s(function(){t.c||(t.c=s)})),this.b.addListener(Ku("local"),this.a,y(this.g,this))}function Hu(e,t){var n,s,r=[];for(n in ms)ms[n]!==t&&r.push(ws(e.b,Ku(ms[n]),e.a));return r.push(ws(e.b,Gu,e.a)),s=r,new pe(function(n,t){var r=s.length,i=[];if(r)for(var e=function(e,t){r--,i[e]=t,0==r&&n(i)},o=function(e){t(e)},a=0;a<s.length;a++)Se(s[a],b(e,a),o);else n(i)})}Wu.prototype.g=function(){var t=this,n=Ku("local");Yu(this,function(){return we().then(function(){return t.c&&"local"!=t.c.A?t.b.get(n,t.a):null}).then(function(e){if(e)return Hu(t,"local").then(function(){t.c=n})})})};var Gu={name:"persistence",A:"session"};function Ku(e){return{name:"authUser",A:e}}function $u(e,t){return Yu(e,function(){return e.b.set(e.c,t.D(),e.a)})}function zu(e){return Yu(e,function(){return ws(e.b,e.c,e.a)})}function Qu(e,t){return Yu(e,function(){return e.b.get(e.c,e.a).then(function(e){return e&&t&&(e.authDomain=t),Uu(e||{})})})}function Yu(e,t){return e.f=e.f.then(t,t),e.f}function Xu(e){if(this.l=!1,Sr(this,"settings",new iu),Sr(this,"app",e),!ic(this).options||!ic(this).options.apiKey)throw new Rr("invalid-api-key");var t,n,r,i,o,a,s,u,c,l,h,f;e=d.SDK_VERSION?tr(d.SDK_VERSION):null,this.b=new Do(ic(this).options&&ic(this).options.apiKey,Ma(xa),e),this.N=[],this.o=[],this.I=[],this.Pb=d.INTERNAL.createSubscribe(y(this.ic,this)),this.O=void 0,this.Qb=d.INTERNAL.createSubscribe(y(this.jc,this)),nc(this,null),this.h=new Wu(ic(this).options.apiKey+":"+ic(this).name),this.w=new function(e){this.a=e,this.b=ys()}(ic(this).options.apiKey+":"+ic(this).name),this.V=uc(this,(h=ic(a=this).options.authDomain,f=(s=a,l=(u=s.w,c=ic(s).options.authDomain,u.b.get(Bu,u.a).then(function(e){return e&&c&&(e.authDomain=c),Uu(e||{})})).then(function(e){return(s.C=e)&&(e.ba=s.w),qu(s.w)}),uc(s,l)).then(function(){return Qu(a.h,h)}).then(function(t){return t?(t.ba=a.w,a.C&&(a.C.aa||null)==(t.aa||null)?t:t.reload().then(function(){return $u(a.h,t).then(function(){return t})}).s(function(e){return"auth/network-request-failed"==e.code?t:zu(a.h)})):null}).then(function(e){nc(a,e||null)}),uc(a,f))),this.i=uc(this,(o=this).V.then(function(){return o.fa()}).s(function(){}).then(function(){if(!o.l)return o.ka()}).s(function(){}).then(function(){if(!o.l){o.X=!0;var e=o.h;e.b.addListener(Ku("local"),e.a,o.ka)}})),this.X=!1,this.ka=y(this.Jc,this),this.Ha=y(this.Z,this),this.qa=y(this.Yb,this),this.ra=y(this.gc,this),this.sa=y(this.hc,this),r=ic(n=this).options.authDomain,i=ic(n).options.apiKey,r&&or()&&(n.Ob=n.V.then(function(){if(!n.l){if(n.a=Js(r,i,ic(n).name),n.a.subscribe(n),oc(n)&&Eu(oc(n)),n.C){Eu(n.C);var e=n.C;e.oa(n.ea()),pu(e,n),vu(e=n.C,n.G),mu(e,n),n.C=null}return n.a}})),this.INTERNAL={},this.INTERNAL.delete=y(this.delete,this),this.INTERNAL.logFramework=y(this.qc,this),this.u=0,At.call(this),t=this,Object.defineProperty(t,"lc",{get:function(){return this.ea()},set:function(e){this.oa(e)},enumerable:!1}),t.W=null,this.G=[]}function Ju(e){ot.call(this,"languageCodeChanged"),this.g=e}function Zu(e){ot.call(this,"frameworkChanged"),this.c=e}function ec(e){return e.Ob||Ee(new Rr("auth-domain-config-required"))}function tc(o,a){var s={};return s.apiKey=ic(o).options.apiKey,s.authDomain=ic(o).options.authDomain,s.appName=ic(o).name,o.V.then(function(){return e=s,t=a,n=o.w,r=o.xa(),i=new du(e,t),n&&(i.ba=n),r&&vu(i,r),i.reload().then(function(){return i});var e,t,n,r,i}).then(function(e){return oc(o)&&e.uid==oc(o).uid?Nu(oc(o),e):(nc(o,e),Eu(e)),o.Z(e)}).then(function(){sc(o)})}function nc(e,t){var n,r;oc(e)&&(n=oc(e),r=e.Ha,F(n.N,function(e){return e==r}),bt(oc(e),"tokenChanged",e.qa),bt(oc(e),"userDeleted",e.ra),bt(oc(e),"userInvalidated",e.sa),bu(oc(e))),t&&(t.N.push(e.Ha),mt(t,"tokenChanged",e.qa),mt(t,"userDeleted",e.ra),mt(t,"userInvalidated",e.sa),0<e.u&&yu(t)),Sr(e,"currentUser",t),t&&(t.oa(e.ea()),pu(t,e),vu(t,e.G),mu(t,e))}function rc(t,e){var n=null,r=null;return uc(t,e.then(function(e){return n=Si(e),r=Kr(e),tc(t,e)}).then(function(){return Tr({user:oc(t),credential:n,additionalUserInfo:r,operationType:"signIn"})}))}function ic(e){return e.app}function oc(e){return e.currentUser}function ac(e){return oc(e)&&oc(e)._lat||null}function sc(e){if(e.X){for(var t=0;t<e.o.length;t++)e.o[t]&&e.o[t](ac(e));if(e.O!==e.getUid()&&e.I.length)for(e.O=e.getUid(),t=0;t<e.I.length;t++)e.I[t]&&e.I[t](ac(e))}}function uc(e,t){return e.N.push(t),t.ia(function(){L(e.N,t)}),t}function cc(){}function lc(){this.a={},this.b=1e12}Wu.prototype.jb=function(t){var n=null,r=this;return function(e){var t=new Rr("invalid-persistence-type"),n=new Rr("unsupported-persistence-type");e:{for(r in ms)if(ms[r]==e){var r=!0;break e}r=!1}if(!r||"string"!=typeof e)throw t;switch(Qn()){case"ReactNative":if("session"===e)throw n;break;case"Node":if("none"!==e)throw n;break;default:if(!ir()&&"none"!==e)throw n}}(t),Yu(this,function(){return t!=r.c.A?r.b.get(r.c,r.a).then(function(e){return n=e,Hu(r,t)}).then(function(){if(r.c=Ku(t),n)return r.b.set(r.c,n,r.a)}):we()})},t(Xu,At),t(Ju,ot),t(Zu,ot),(e=Xu.prototype).jb=function(e){return uc(this,e=this.h.jb(e))},e.oa=function(e){this.W===e||this.l||(this.W=e,Bo(this.b,this.W),this.dispatchEvent(new Ju(this.ea())))},e.ea=function(){return this.W},e.Qc=function(){var e=l.navigator;this.oa(e&&(e.languages&&e.languages[0]||e.language||e.userLanguage)||null)},e.qc=function(e){this.G.push(e),qo(this.b,d.SDK_VERSION?tr(d.SDK_VERSION,this.G):null),this.dispatchEvent(new Zu(this.G))},e.xa=function(){return j(this.G)},e.toJSON=function(){return{apiKey:ic(this).options.apiKey,authDomain:ic(this).options.authDomain,appName:ic(this).name,currentUser:oc(this)&&oc(this).D()}},e.sb=function(e,t){switch(e){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.g==t&&!!this.f;default:return!1}},e.ha=function(e,t,n,r){"signInViaPopup"==e&&this.g==r&&(n&&this.v?this.v(n):t&&!n&&this.f&&this.f(t),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.v)},e.wa=function(e,t){return"signInViaRedirect"==e||"signInViaPopup"==e&&this.g==t&&this.f?y(this.Xb,this):null},e.Xb=function(e,t){var n=this;e={requestUri:e,sessionId:t},this.c&&(this.c.cancel(),this.c=null);var r=null,i=null,o=Zo(n.b,e).then(function(e){return r=Si(e),i=Kr(e),e});return uc(this,e=n.V.then(function(){return o}).then(function(e){return tc(n,e)}).then(function(){return Tr({user:oc(n),credential:r,additionalUserInfo:i,operationType:"signIn"})}))},e.Hc=function(t){if(!or())return Ee(new Rr("operation-not-supported-in-this-environment"));var n=this,e=Gr(t.providerId),r=fr(),i=null;(!ur()||$n())&&ic(this).options.authDomain&&t.isOAuthProvider&&(i=Qa(ic(this).options.authDomain,ic(this).options.apiKey,ic(this).name,"signInViaPopup",t,null,r,d.SDK_VERSION||null));var o=Wn(i,e&&e.Ba,e&&e.Aa);return uc(this,e=ec(this).then(function(e){return Qs(e,o,"signInViaPopup",t,r,!!i)}).then(function(){return new pe(function(e,t){n.ha("signInViaPopup",null,new Rr("cancelled-popup-request"),n.g),n.f=e,n.v=t,n.g=r,n.c=n.a.Ea(n,"signInViaPopup",o,r)})}).then(function(e){return o&&qn(o),e?Tr(e):null}).s(function(e){throw o&&qn(o),e}))},e.Ic=function(e){if(!or())return Ee(new Rr("operation-not-supported-in-this-environment"));var t=this;return uc(this,ec(this).then(function(){return Yu(e=t.h,function(){return e.b.set(Gu,e.c.A,e.a)});var e}).then(function(){return t.a.Ca("signInViaRedirect",e)}))},e.fa=function(){if(!or())return Ee(new Rr("operation-not-supported-in-this-environment"));var e=this;return uc(this,ec(this).then(function(){return e.a.fa()}).then(function(e){return e?Tr(e):null}))},e.Oc=function(e){if(!e)return Ee(new Rr("null-user"));var t=this,n={};n.apiKey=ic(this).options.apiKey,n.authDomain=ic(this).options.authDomain,n.appName=ic(this).name;var r=function(e,t,n,r){t=t||{apiKey:e.l,authDomain:e.u,appName:e.o};var i=e.h,o={};return o[Lo]=i.b,o.refreshToken=i.a,o.expiresIn=(i.c-_())/1e3,t=new du(t,o),n&&(t.ba=n),r&&vu(t,r),Nu(t,e),t}(e,n,t.w,t.xa());return uc(this,this.i.then(function(){if(ic(t).options.apiKey!=e.l)return r.reload()}).then(function(){return oc(t)&&e.uid==oc(t).uid?(Nu(oc(t),e),t.Z(e)):(nc(t,r),Eu(r),t.Z(r))}).then(function(){sc(t)}))},e.kb=function(){var e=this;return uc(this,this.i.then(function(){return oc(e)?(nc(e,null),zu(e.h).then(function(){sc(e)})):we()}))},e.Jc=function(){var r=this;return Qu(this.h,ic(this).options.authDomain).then(function(e){if(!r.l){var t;if(t=oc(r)&&e){t=oc(r).uid;var n=e.uid;t=null!=t&&""!==t&&null!=n&&""!==n&&t==n}if(t)return Nu(oc(r),e),oc(r).F();(oc(r)||e)&&(nc(r,e),e&&(Eu(e),e.ba=r.w),r.a&&r.a.subscribe(r),sc(r))}})},e.Z=function(e){return $u(this.h,e)},e.Yb=function(){sc(this),this.Z(oc(this))},e.gc=function(){this.kb()},e.hc=function(){this.kb()},e.ic=function(e){var t=this;this.addAuthTokenListener(function(){e.next(oc(t))})},e.jc=function(e){var t,n,r=this;n=function(){e.next(oc(r))},(t=this).I.push(n),uc(t,t.i.then(function(){!t.l&&M(t.I,n)&&t.O!==t.getUid()&&(t.O=t.getUid(),n(ac(t)))}))},e.sc=function(e,t,n){var r=this;return this.X&&d.Promise.resolve().then(function(){a(e)?e(oc(r)):a(e.next)&&e.next(oc(r))}),this.Pb(e,t,n)},e.rc=function(e,t,n){var r=this;return this.X&&d.Promise.resolve().then(function(){r.O=r.getUid(),a(e)?e(oc(r)):a(e.next)&&e.next(oc(r))}),this.Qb(e,t,n)},e.$b=function(e){var t=this;return uc(this,this.i.then(function(){return oc(t)?oc(t).F(e).then(function(e){return{accessToken:e}}):null}))},e.Jb=function(e){var n=this;return this.i.then(function(){return rc(n,Na(n.b,Ta,{token:e}))}).then(function(e){var t=e.user;return Iu(t,"isAnonymous",!1),n.Z(t),e})},e.Bc=function(e){return wr("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCustomToken is deprecated. Please use firebase.auth.Auth.prototype.signInWithCustomToken instead."),this.Jb(e)},e.Cc=function(e,t){return wr("firebase.auth.Auth.prototype.signInAndRetrieveDataWithEmailAndPassword is deprecated. Please use firebase.auth.Auth.prototype.signInWithEmailAndPassword instead."),this.Kb(e,t)},e.Kb=function(e,t){var n=this;return this.i.then(function(){return rc(n,Na(n.b,Oa,{email:e,password:t}))})},e.ub=function(e,t){var n=this;return this.i.then(function(){return rc(n,Na(n.b,oa,{email:e,password:t}))})},e.Sb=function(e,t){return wr("firebase.auth.Auth.prototype.createUserAndRetrieveDataWithEmailAndPassword is deprecated. Please use firebase.auth.Auth.prototype.createUserWithEmailAndPassword instead."),this.ub(e,t)},e.Ec=function(e){return wr("firebase.auth.Auth.prototype.signInWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential instead."),this.Oa(e).then(function(e){return e.user})},e.Oa=function(e){var t=this;return this.i.then(function(){return rc(t,e.ya(t.b))})},e.Pa=function(){var n=this;return this.i.then(function(){var e=oc(n);return e&&e.isAnonymous?Tr({user:e,credential:null,additionalUserInfo:Tr({providerId:null,isNewUser:!1}),operationType:"signIn"}):rc(n,n.b.Pa()).then(function(e){var t=e.user;return Iu(t,"isAnonymous",!0),n.Z(t),e})})},e.Dc=function(){return wr("firebase.auth.Auth.prototype.signInAnonymouslyAndRetrieveData is deprecated. Please use firebase.auth.Auth.prototype.signInAnonymously instead."),this.Pa()},e.getUid=function(){return oc(this)&&oc(this).uid||null},e.Rb=function(e){this.addAuthTokenListener(e),this.u++,0<this.u&&oc(this)&&yu(oc(this))},e.zc=function(t){var n=this;P(this.o,function(e){e==t&&n.u--}),this.u<0&&(this.u=0),0==this.u&&oc(this)&&bu(oc(this)),this.removeAuthTokenListener(t)},e.addAuthTokenListener=function(e){var t=this;this.o.push(e),uc(this,this.i.then(function(){t.l||M(t.o,e)&&e(ac(t))}))},e.removeAuthTokenListener=function(t){F(this.o,function(e){return e==t})},e.delete=function(){this.l=!0;for(var e=0;e<this.N.length;e++)this.N[e].cancel("app-deleted");return this.N=[],this.h&&(e=this.h).b.removeListener(Ku("local"),e.a,this.ka),this.a&&this.a.unsubscribe(this),d.Promise.resolve()},e.Vb=function(e){return wr("firebase.auth.Auth.prototype.fetchProvidersForEmail is deprecated. Please use firebase.auth.Auth.prototype.fetchSignInMethodsForEmail instead."),uc(this,Na(this.b,aa,{identifier:e,continueUri:ar()?jn():"http://localhost"}).then(function(e){return e.allProviders||[]}))},e.Wb=function(e){return uc(this,Na(this.b,aa,{identifier:e,continueUri:ar()?jn():"http://localhost"}).then(function(e){return e.signinMethods||[]}))},e.kc=function(e){return!!yi(e)},e.ib=function(t,n){var r=this;return uc(this,we().then(function(){var e=new kr(n);if(!e.c)throw new Rr("argument-error",Pr+" must be true when sending sign in link to email");return Lr(e)}).then(function(e){return r.b.ib(t,e)}).then(function(){}))},e.Rc=function(e){return this.Ja(e).then(function(e){return e.data.email})},e.Xa=function(e,t){return uc(this,this.b.Xa(e,t).then(function(){}))},e.Ja=function(e){return uc(this,this.b.Ja(e).then(function(e){return new function(e){var t={},n=e.email,r=e.newEmail;if(!(e=e.requestType)||"EMAIL_SIGNIN"!=e&&!n)throw Error("Invalid provider user info!");t.fromEmail=r||null,t.email=n||null,Sr(this,"operation",e),Sr(this,"data",Or(t))}(e)}))},e.Va=function(e){return uc(this,this.b.Va(e).then(function(){}))},e.hb=function(t,e){var n=this;return uc(this,we().then(function(){return void 0===e||re(e)?{}:Lr(new kr(e))}).then(function(e){return n.b.hb(t,e)}).then(function(){}))},e.Gc=function(e,t){return uc(this,au(this,e,t,y(this.Oa,this)))},e.Fc=function(t,n){var r=this;return uc(this,we().then(function(){var e=gi(t,n||jn());return r.Oa(e)}))},cc.prototype.render=function(){},cc.prototype.reset=function(){},cc.prototype.getResponse=function(){},cc.prototype.execute=function(){};var hc=null;function fc(e,t){return(t=dc(t))&&e.a[t]||null}function dc(e){return(e=void 0===e?1e12:e)?e.toString():null}function pc(e,t){this.g=!1,this.c=t,this.a=this.b=null,this.h="invisible"!==this.c.size,this.f=Nn(e);var n=this;this.i=function(){n.execute()},this.h?this.execute():mt(this.f,"click",this.i)}function vc(e){if(e.g)throw Error("reCAPTCHA mock was already deleted!")}function mc(){}lc.prototype.render=function(e,t){return this.a[this.b.toString()]=new pc(e,t),this.b++},lc.prototype.reset=function(e){var t=fc(this,e);e=dc(e),t&&e&&(t.delete(),delete this.a[e])},lc.prototype.getResponse=function(e){return(e=fc(this,e))?e.getResponse():null},lc.prototype.execute=function(e){(e=fc(this,e))&&e.execute()},pc.prototype.getResponse=function(){return vc(this),this.b},pc.prototype.execute=function(){vc(this);var n=this;this.a||(this.a=setTimeout(function(){n.b=function(){for(var e=50,t=[];0<e;)t.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),e--;return t.join("")}();var e=n.c.callback,t=n.c["expired-callback"];if(e)try{e(n.b)}catch(e){}n.a=setTimeout(function(){if(n.a=null,n.b=null,t)try{t()}catch(e){}n.h&&n.execute()},6e4)},500))},pc.prototype.delete=function(){vc(this),this.g=!0,clearTimeout(this.a),this.a=null,bt(this.f,"click",this.i)},mc.prototype.g=function(){return hc||(hc=new lc),we(hc)},mc.prototype.c=function(){};var gc=null;function yc(){this.b=l.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var bc=pn("https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),_c=new vr(3e4,6e4);yc.prototype.g=function(i){var o=this;return new pe(function(e,t){var r=setTimeout(function(){t(new Rr("network-request-failed"))},_c.get());!l.grecaptcha||i!==o.f&&!o.b?(l[o.a]=function(){if(l.grecaptcha){o.f=i;var n=l.grecaptcha.render;l.grecaptcha.render=function(e,t){return e=n(e,t),o.b++,e},clearTimeout(r),e(l.grecaptcha)}else clearTimeout(r),t(new Rr("internal-error"));delete l[o.a]},we(Ro(gn(bc,{onload:o.a,hl:i||""}))).s(function(){clearTimeout(r),t(new Rr("internal-error","Unable to load external reCAPTCHA dependencies!"))})):(clearTimeout(r),e(l.grecaptcha))})},yc.prototype.c=function(){this.b--};var wc=null;function Ec(e,t,n,r,i,o,a){if(Sr(this,"type","recaptcha"),this.c=this.f=null,this.C=!1,this.l=t,this.g=null,a?(gc||(gc=new mc),a=gc):(wc||(wc=new yc),a=wc),this.o=a,this.a=n||{theme:"light",type:"image"},this.h=[],this.a[Tc])throw new Rr("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i="invisible"===this.a[Oc],!l.document)throw new Rr("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!Nn(t)||!this.i&&Nn(t).hasChildNodes())throw new Rr("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.u=new Do(e,o||null,i||null),this.v=r||function(){return null};var s=this;this.m=[];var u=this.a[Sc];this.a[Sc]=function(e){if(Rc(s,e),"function"==typeof u)u(e);else if("string"==typeof u){var t=rr(u,l);"function"==typeof t&&t(e)}};var c=this.a[Cc];this.a[Cc]=function(){if(Rc(s,null),"function"==typeof c)c();else if("string"==typeof c){var e=rr(c,l);"function"==typeof e&&e()}}}var Sc="callback",Cc="expired-callback",Tc="sitekey",Oc="size";function Rc(e,t){for(var n=0;n<e.m.length;n++)try{e.m[n](t)}catch(e){}}function Ac(e,t){return e.h.push(t),t.ia(function(){L(e.h,t)}),t}function Ic(e){if(e.C)throw new Rr("internal-error","RecaptchaVerifier instance has been destroyed.")}function Nc(e,t,n){var r=!1;try{this.b=n||d.app()}catch(e){throw new Rr("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.b.options||!this.b.options.apiKey)throw new Rr("invalid-api-key");n=this.b.options.apiKey;var i=this,o=null;try{o=this.b.auth().xa()}catch(e){}try{r=this.b.auth().settings.appVerificationDisabledForTesting}catch(e){}o=d.SDK_VERSION?tr(d.SDK_VERSION,o):null,Ec.call(this,n,e,t,function(){try{var t=i.b.auth().ea()}catch(e){t=null}return t},o,Ma(xa),r)}function kc(e,t,n,r){e:{n=Array.prototype.slice.call(n);for(var i=0,o=!1,a=0;a<t.length;a++)if(t[a].optional)o=!0;else{if(o)throw new Rr("internal-error","Argument validator encountered a required argument after an optional argument.");i++}if(o=t.length,n.length<i||o<n.length)r="Expected "+(i==o?1==i?"1 argument":i+" arguments":i+"-"+o+" arguments")+" but got "+n.length+".";else{for(i=0;i<n.length;i++)if(o=t[i].optional&&void 0===n[i],!t[i].M(n[i])&&!o){if(t=t[i],i<0||i>=Pc.length)throw new Rr("internal-error","Argument validator received an unsupported number of arguments.");n=Pc[i],r=(r?"":n+" argument ")+(t.name?'"'+t.name+'" ':"")+"must be "+t.K+".";break e}r=null}}if(r)throw new Rr("argument-error",e+" failed: "+r)}(e=Ec.prototype).za=function(){var t=this;return this.f?this.f:this.f=Ac(this,we().then(function(){if(ar()&&!zn())return Gn();throw new Rr("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")}).then(function(){return t.o.g(t.v())}).then(function(e){return t.g=e,Na(t.u,ma,{})}).then(function(e){t.a[Tc]=e.recaptchaSiteKey}).s(function(e){throw t.f=null,e}))},e.render=function(){Ic(this);var n=this;return Ac(this,this.za().then(function(){if(null===n.c){var e=n.l;if(!n.i){var t=Nn(e);e=function(e,t,n){var r=arguments,i=document,o=String(r[0]),a=r[1];if(!ln&&a&&(a.name||a.type)){if(o=["<",o],a.name&&o.push(' name="',q(a.name),'"'),a.type){o.push(' type="',q(a.type),'"');var s={};ue(s,a),delete s.type,a=s}o.push(">"),o=o.join("")}return o=i.createElement(o),a&&(c(a)?o.className=a:f(a)?o.className=a.join(" "):kn(o,a)),2<r.length&&function(t,n,e){function r(e){e&&n.appendChild(c(e)?t.createTextNode(e):e)}for(var i=2;i<e.length;i++){var o=e[i];!p(o)||v(o)&&0<o.nodeType?r(o):P(xn(o)?j(o):o,r)}}(i,o,r),o}("DIV"),t.appendChild(e)}n.c=n.g.render(e,n.a)}return n.c}))},e.verify=function(){Ic(this);var i=this;return Ac(this,this.render().then(function(t){return new pe(function(n){var e=i.g.getResponse(t);if(e)n(e);else{var r=function(e){var t;e&&(t=r,F(i.m,function(e){return e==t}),n(e))};i.m.push(r),i.i&&i.g.execute(i.c)}})}))},e.reset=function(){Ic(this),null!==this.c&&this.g.reset(this.c)},e.clear=function(){Ic(this),this.C=!0,this.o.c();for(var e=0;e<this.h.length;e++)this.h[e].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i)for(var t;t=(e=Nn(this.l)).firstChild;)e.removeChild(t)},t(Nc,Ec);var Pc="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function xc(e,t){return{name:e||"",K:"a valid string",optional:!!t,M:c}}function Dc(e,t){return{name:e||"",K:"a boolean",optional:!!t,M:n}}function Mc(e,t){return{name:e||"",K:"a valid object",optional:!!t,M:v}}function Lc(e,t){return{name:e||"",K:"a function",optional:!!t,M:a}}function Fc(e,t){return{name:e||"",K:"null",optional:!!t,M:r}}function Vc(n){return{name:n?n+"Credential":"credential",K:n?"a valid "+n+" credential":"a valid credential",optional:!1,M:function(e){if(!e)return!1;var t=!n||e.providerId===n;return!(!e.ya||!t)}}}function jc(){return{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(e){return!!(e&&c(e.type)&&a(e.verify))}}}function Uc(t,n,e,r){return{name:e||"",K:t.K+" or "+n.K,optional:!!r,M:function(e){return t.M(e)||n.M(e)}}}function Bc(e,t){for(var n in t){var r=t[n].name;e[r]=Hc(r,e[n],t[n].j)}}function qc(e,t){for(var n in t){var r=t[n].name;if(r!==n){var i=t[n].qb;Object.defineProperty(e,r,{get:function(){return this[n]},set:function(e){kc(r,[i],[e],!0),this[n]=e},enumerable:!0})}}}function Wc(e,t,n,r){e[t]=Hc(t,n,r)}function Hc(e,t,n){function r(){var e=Array.prototype.slice.call(arguments);return kc(a,n,e),t.apply(this,e)}if(!n)return t;var i,o,a=(o=(o=e).split("."))[o.length-1];for(i in t)r[i]=t[i];for(i in t.prototype)r.prototype[i]=t.prototype[i];return r}Bc(Xu.prototype,{Va:{name:"applyActionCode",j:[xc("code")]},Ja:{name:"checkActionCode",j:[xc("code")]},Xa:{name:"confirmPasswordReset",j:[xc("code"),xc("newPassword")]},ub:{name:"createUserWithEmailAndPassword",j:[xc("email"),xc("password")]},Sb:{name:"createUserAndRetrieveDataWithEmailAndPassword",j:[xc("email"),xc("password")]},Vb:{name:"fetchProvidersForEmail",j:[xc("email")]},Wb:{name:"fetchSignInMethodsForEmail",j:[xc("email")]},fa:{name:"getRedirectResult",j:[]},kc:{name:"isSignInWithEmailLink",j:[xc("emailLink")]},rc:{name:"onAuthStateChanged",j:[Uc(Mc(),Lc(),"nextOrObserver"),Lc("opt_error",!0),Lc("opt_completed",!0)]},sc:{name:"onIdTokenChanged",j:[Uc(Mc(),Lc(),"nextOrObserver"),Lc("opt_error",!0),Lc("opt_completed",!0)]},hb:{name:"sendPasswordResetEmail",j:[xc("email"),Uc(Mc("opt_actionCodeSettings",!0),Fc(null,!0),"opt_actionCodeSettings",!0)]},ib:{name:"sendSignInLinkToEmail",j:[xc("email"),Mc("actionCodeSettings")]},jb:{name:"setPersistence",j:[xc("persistence")]},Oa:{name:"signInAndRetrieveDataWithCredential",j:[Vc()]},Pa:{name:"signInAnonymously",j:[]},Dc:{name:"signInAnonymouslyAndRetrieveData",j:[]},Ec:{name:"signInWithCredential",j:[Vc()]},Jb:{name:"signInWithCustomToken",j:[xc("token")]},Bc:{name:"signInAndRetrieveDataWithCustomToken",j:[xc("token")]},Kb:{name:"signInWithEmailAndPassword",j:[xc("email"),xc("password")]},Fc:{name:"signInWithEmailLink",j:[xc("email"),xc("emailLink",!0)]},Cc:{name:"signInAndRetrieveDataWithEmailAndPassword",j:[xc("email"),xc("password")]},Gc:{name:"signInWithPhoneNumber",j:[xc("phoneNumber"),jc()]},Hc:{name:"signInWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(e){return!!(e&&e.providerId&&e.hasOwnProperty&&e.hasOwnProperty("isOAuthProvider"))}}]},Ic:{name:"signInWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(e){return!!(e&&e.providerId&&e.hasOwnProperty&&e.hasOwnProperty("isOAuthProvider"))}}]},Oc:{name:"updateCurrentUser",j:[Uc({name:"user",K:"an instance of Firebase User",optional:!1,M:function(e){return!!(e&&e instanceof du)}},Fc(),"user")]},kb:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[xc(null,!0)]},Qc:{name:"useDeviceLanguage",j:[]},Rc:{name:"verifyPasswordResetCode",j:[xc("code")]}}),qc(Xu.prototype,{lc:{name:"languageCode",qb:Uc(xc(),Fc(),"languageCode")}}),(Xu.Persistence=ms).LOCAL="local",Xu.Persistence.SESSION="session",Xu.Persistence.NONE="none",Bc(du.prototype,{delete:{name:"delete",j:[]},ac:{name:"getIdTokenResult",j:[Dc("opt_forceRefresh",!0)]},F:{name:"getIdToken",j:[Dc("opt_forceRefresh",!0)]},ab:{name:"linkAndRetrieveDataWithCredential",j:[Vc()]},mc:{name:"linkWithCredential",j:[Vc()]},nc:{name:"linkWithPhoneNumber",j:[xc("phoneNumber"),jc()]},oc:{name:"linkWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(e){return!!(e&&e.providerId&&e.hasOwnProperty&&e.hasOwnProperty("isOAuthProvider"))}}]},pc:{name:"linkWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(e){return!!(e&&e.providerId&&e.hasOwnProperty&&e.hasOwnProperty("isOAuthProvider"))}}]},cb:{name:"reauthenticateAndRetrieveDataWithCredential",j:[Vc()]},vc:{name:"reauthenticateWithCredential",j:[Vc()]},wc:{name:"reauthenticateWithPhoneNumber",j:[xc("phoneNumber"),jc()]},xc:{name:"reauthenticateWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(e){return!!(e&&e.providerId&&e.hasOwnProperty&&e.hasOwnProperty("isOAuthProvider"))}}]},yc:{name:"reauthenticateWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(e){return!!(e&&e.providerId&&e.hasOwnProperty&&e.hasOwnProperty("isOAuthProvider"))}}]},reload:{name:"reload",j:[]},gb:{name:"sendEmailVerification",j:[Uc(Mc("opt_actionCodeSettings",!0),Fc(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[xc(null,!0)]},Nc:{name:"unlink",j:[xc("provider")]},mb:{name:"updateEmail",j:[xc("email")]},nb:{name:"updatePassword",j:[xc("password")]},Pc:{name:"updatePhoneNumber",j:[Vc("phone")]},ob:{name:"updateProfile",j:[Mc("profile")]}}),Bc(lc.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Bc(cc.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Bc(pe.prototype,{ia:{name:"finally"},s:{name:"catch"},then:{name:"then"}}),qc(iu.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",qb:Dc("appVerificationDisabledForTesting")}}),Bc(ou.prototype,{confirm:{name:"confirm",j:[xc("verificationCode")]}}),Wc(mi,"credential",function(e,t){return new vi(e,t)},[xc("email"),xc("password")]),Bc(si.prototype,{ta:{name:"addScope",j:[xc("scope")]},Da:{name:"setCustomParameters",j:[Mc("customOAuthParameters")]}}),Wc(si,"credential",ui,[Uc(xc(),Mc(),"token")]),Wc(mi,"credentialWithLink",gi,[xc("email"),xc("emailLink")]),Bc(ci.prototype,{ta:{name:"addScope",j:[xc("scope")]},Da:{name:"setCustomParameters",j:[Mc("customOAuthParameters")]}}),Wc(ci,"credential",li,[Uc(xc(),Mc(),"token")]),Bc(hi.prototype,{ta:{name:"addScope",j:[xc("scope")]},Da:{name:"setCustomParameters",j:[Mc("customOAuthParameters")]}}),Wc(hi,"credential",fi,[Uc(xc(),Uc(Mc(),Fc()),"idToken"),Uc(xc(),Fc(),"accessToken",!0)]),Bc(di.prototype,{Da:{name:"setCustomParameters",j:[Mc("customOAuthParameters")]}}),Wc(di,"credential",pi,[Uc(xc(),Mc(),"token"),xc("secret",!0)]),Bc(ai.prototype,{ta:{name:"addScope",j:[xc("scope")]},credential:{name:"credential",j:[Uc(xc(),Fc(),"idToken",!0),Uc(xc(),Fc(),"accessToken",!0)]},Da:{name:"setCustomParameters",j:[Mc("customOAuthParameters")]}}),Wc(wi,"credential",Ei,[xc("verificationId"),xc("verificationCode")]),Bc(wi.prototype,{Ta:{name:"verifyPhoneNumber",j:[xc("phoneNumber"),jc()]}}),Bc(Rr.prototype,{toJSON:{name:"toJSON",j:[xc(null,!0)]}}),Bc(Ni.prototype,{toJSON:{name:"toJSON",j:[xc(null,!0)]}}),Bc(Ii.prototype,{toJSON:{name:"toJSON",j:[xc(null,!0)]}}),Bc(Nc.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),function(){if(void 0===d||!d.INTERNAL||!d.INTERNAL.registerService)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var e={Auth:Xu,Error:Rr};Wc(e,"EmailAuthProvider",mi,[]),Wc(e,"FacebookAuthProvider",si,[]),Wc(e,"GithubAuthProvider",ci,[]),Wc(e,"GoogleAuthProvider",hi,[]),Wc(e,"TwitterAuthProvider",di,[]),Wc(e,"OAuthProvider",ai,[xc("providerId")]),Wc(e,"PhoneAuthProvider",wi,[{name:"auth",K:"an instance of Firebase Auth",optional:!0,M:function(e){return!!(e&&e instanceof Xu)}}]),Wc(e,"RecaptchaVerifier",Nc,[Uc(xc(),{name:"",K:"an HTML element",optional:!1,M:function(e){return!!(e&&e instanceof Element)}},"recaptchaContainer"),Mc("recaptchaParameters",!0),{name:"app",K:"an instance of Firebase App",optional:!0,M:function(e){return!!(e&&e instanceof d.app.App)}}]),d.INTERNAL.registerService("auth",function(e,t){return t({INTERNAL:{getUid:y((e=new Xu(e)).getUid,e),getToken:y(e.$b,e),addAuthTokenListener:y(e.Rb,e),removeAuthTokenListener:y(e.zc,e)}}),e},e,function(e,t){if("create"===e)try{t.auth()}catch(e){}}),d.INTERNAL.extendNamespace({User:du})}()}).call(void 0!==commonjsGlobal?commonjsGlobal:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{}),Bfc=LogLevel||(LogLevel={}),Bfc[Bfc.DEBUG=0]="DEBUG",Bfc[Bfc.VERBOSE=1]="VERBOSE",Bfc[Bfc.INFO=2]="INFO",Bfc[Bfc.WARN=3]="WARN",Bfc[Bfc.ERROR=4]="ERROR",Bfc[Bfc.SILENT=5]="SILENT";var defaultLogLevel=LogLevel.INFO,defaultLogHandler=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(t<e.logLevel)){var i=(new Date).toISOString();switch(t){case LogLevel.DEBUG:case LogLevel.VERBOSE:console.log.apply(console,["["+i+"]  "+e.name+":"].concat(n));break;case LogLevel.INFO:console.info.apply(console,["["+i+"]  "+e.name+":"].concat(n));break;case LogLevel.WARN:console.warn.apply(console,["["+i+"]  "+e.name+":"].concat(n));break;case LogLevel.ERROR:console.error.apply(console,["["+i+"]  "+e.name+":"].concat(n));break;default:throw new Error("Attempted to log a message with an invalid logType (value: "+t+")")}}},Logger=function(){function e(e){this.name=e,this._logLevel=defaultLogLevel,this._logHandler=defaultLogHandler}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in LogLevel))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!0,configurable:!0}),e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,[this,LogLevel.DEBUG].concat(e))},e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,[this,LogLevel.VERBOSE].concat(e))},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,[this,LogLevel.INFO].concat(e))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,[this,LogLevel.WARN].concat(e))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,[this,LogLevel.ERROR].concat(e))},e}(),DOMStorageWrapper=function(){function e(e){this.domStorage_=e,this.prefix_="firebase:"}return e.prototype.set=function(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),stringify(t))},e.prototype.get=function(e){var t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:jsonEval(t)},e.prototype.remove=function(e){this.domStorage_.removeItem(this.prefixedName_(e))},e.prototype.prefixedName_=function(e){return this.prefix_+e},e.prototype.toString=function(){return this.domStorage_.toString()},e}(),MemoryStorage=function(){function e(){this.cache_={},this.isInMemoryStorage=!0}return e.prototype.set=function(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t},e.prototype.get=function(e){return contains(this.cache_,e)?this.cache_[e]:null},e.prototype.remove=function(e){delete this.cache_[e]},e}(),createStoragefor=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){var t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new DOMStorageWrapper(t)}}catch(e){}return new MemoryStorage},PersistentStorage=createStoragefor("localStorage"),SessionStorage=createStoragefor("sessionStorage"),logClient=new Logger("@firebase/database"),LUIDGenerator=(igc=1,function(){return igc++}),sha1=function(e){var t=stringToByteArray$1(e),n=new Sha1;n.update(t);var r=n.digest();return base64.encodeByteArray(r)},buildLogMessage_=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n="",r=0;r<e.length;r++)Array.isArray(e[r])||e[r]&&"object"==typeof e[r]&&"number"==typeof e[r].length?n+=buildLogMessage_.apply(null,e[r]):"object"==typeof e[r]?n+=stringify(e[r]):n+=e[r],n+=" ";return n},logger=null,firstLog_=!0,enableLogging=function(e,t){assert(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(logClient.logLevel=LogLevel.VERBOSE,logger=logClient.log.bind(logClient),t&&SessionStorage.set("logging_enabled",!0)):"function"==typeof e?logger=e:(logger=null,SessionStorage.remove("logging_enabled"))},log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!0===firstLog_&&(firstLog_=!1,null===logger&&!0===SessionStorage.get("logging_enabled")&&enableLogging(!0)),logger){var n=buildLogMessage_.apply(null,e);logger(n)}},logWrapper=function(n){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];log.apply(void 0,[n].concat(e))}},error$1=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="FIREBASE INTERNAL ERROR: "+buildLogMessage_.apply(void 0,e);logClient.error(n)},fatal=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="FIREBASE FATAL ERROR: "+buildLogMessage_.apply(void 0,e);throw logClient.error(n),new Error(n)},warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="FIREBASE WARNING: "+buildLogMessage_.apply(void 0,e);logClient.warn(n)},warnIfPageIsSecure=function(){"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&warn("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},isInvalidJSONNumber=function(e){return"number"==typeof e&&(e!=e||e==Number.POSITIVE_INFINITY||e==Number.NEGATIVE_INFINITY)},executeWhenDOMReady=function(e){if(isNodeSdk()||"complete"===document.readyState)e();else{var t=!1,n=function(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&n()}),window.attachEvent("onload",n))}},MIN_NAME="[MIN_NAME]",MAX_NAME="[MAX_NAME]",nameCompare=function(e,t){if(e===t)return 0;if(e===MIN_NAME||t===MAX_NAME)return-1;if(t===MIN_NAME||e===MAX_NAME)return 1;var n=tryParseInt(e),r=tryParseInt(t);return null!==n?null!==r?n-r==0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1},stringCompare=function(e,t){return e===t?0:e<t?-1:1},requireKey=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+stringify(t))},ObjectToUniqueKey=function(e){if("object"!=typeof e||null===e)return stringify(e);var t=[];for(var n in e)t.push(n);t.sort();for(var r="{",i=0;i<t.length;i++)0!==i&&(r+=","),r+=stringify(t[i]),r+=":",r+=ObjectToUniqueKey(e[t[i]]);return r+"}"},splitStringBySize=function(e,t){var n=e.length;if(n<=t)return[e];for(var r=[],i=0;i<n;i+=t)n<i+t?r.push(e.substring(i,n)):r.push(e.substring(i,i+t));return r},each=function(e,n){if(Array.isArray(e))for(var t=0;t<e.length;++t)n(t,e[t]);else forEach(e,function(e,t){return n(t,e)})},doubleToIEEE754String=function(e){var t,n,r,i,o,a,s;for(assert(!isInvalidJSONNumber(e),"Invalid JSON number"),0===e?t=1/e==-1/(r=n=0)?1:0:(t=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(n=(i=Math.min(Math.floor(Math.log(e)/Math.LN2),1023))+1023,r=Math.round(e*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,r=Math.round(e/Math.pow(2,-1074)))),a=[],o=52;o;o-=1)a.push(r%2?1:0),r=Math.floor(r/2);for(o=11;o;o-=1)a.push(n%2?1:0),n=Math.floor(n/2);a.push(t?1:0),a.reverse(),s=a.join("");var u="";for(o=0;o<64;o+=8){var c=parseInt(s.substr(o,8),2).toString(16);1===c.length&&(c="0"+c),u+=c}return u.toLowerCase()},isChromeExtensionContentScript=function(){return!("object"!=typeof window||!window.chrome||!window.chrome.extension||/^chrome/.test(window.location.href))},isWindowsStoreApp=function(){return"object"==typeof Windows&&"object"==typeof Windows.UI},errorForServerCode=function(e,t){var n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"==e?n="Client doesn't have permission to access the desired data.":"unavailable"==e&&(n="The service is unavailable");var r=new Error(e+" at "+t.path.toString()+": "+n);return r.code=e.toUpperCase(),r},INTEGER_REGEXP_=new RegExp("^-?\\d{1,10}$"),tryParseInt=function(e){if(INTEGER_REGEXP_.test(e)){var t=Number(e);if(-2147483648<=t&&t<=2147483647)return t}return null},exceptionGuard=function(t){try{t()}catch(t){setTimeout(function(){var e=t.stack||"";throw warn("Exception was thrown by user callback.",e),t},Math.floor(0))}},beingCrawled=function(){return 0<=("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)},setTimeoutNonBlocking=function(e,t){var n=setTimeout(e,t);return"object"==typeof n&&n.unref&&n.unref(),n},Path=function(){function i(e,t){if(void 0===t){this.pieces_=e.split("/");for(var n=0,r=0;r<this.pieces_.length;r++)0<this.pieces_[r].length&&(this.pieces_[n]=this.pieces_[r],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}return Object.defineProperty(i,"Empty",{get:function(){return new i("")},enumerable:!0,configurable:!0}),i.prototype.getFront=function(){return this.pieceNum_>=this.pieces_.length?null:this.pieces_[this.pieceNum_]},i.prototype.getLength=function(){return this.pieces_.length-this.pieceNum_},i.prototype.popFront=function(){var e=this.pieceNum_;return e<this.pieces_.length&&e++,new i(this.pieces_,e)},i.prototype.getBack=function(){return this.pieceNum_<this.pieces_.length?this.pieces_[this.pieces_.length-1]:null},i.prototype.toString=function(){for(var e="",t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"},i.prototype.toUrlEncodedString=function(){for(var e="",t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+encodeURIComponent(String(this.pieces_[t])));return e||"/"},i.prototype.slice=function(e){return void 0===e&&(e=0),this.pieces_.slice(this.pieceNum_+e)},i.prototype.parent=function(){if(this.pieceNum_>=this.pieces_.length)return null;for(var e=[],t=this.pieceNum_;t<this.pieces_.length-1;t++)e.push(this.pieces_[t]);return new i(e,0)},i.prototype.child=function(e){for(var t=[],n=this.pieceNum_;n<this.pieces_.length;n++)t.push(this.pieces_[n]);if(e instanceof i)for(n=e.pieceNum_;n<e.pieces_.length;n++)t.push(e.pieces_[n]);else{var r=e.split("/");for(n=0;n<r.length;n++)0<r[n].length&&t.push(r[n])}return new i(t,0)},i.prototype.isEmpty=function(){return this.pieceNum_>=this.pieces_.length},i.relativePath=function(e,t){var n=e.getFront(),r=t.getFront();if(null===n)return t;if(n===r)return i.relativePath(e.popFront(),t.popFront());throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")},i.comparePaths=function(e,t){for(var n=e.slice(),r=t.slice(),i=0;i<n.length&&i<r.length;i++){var o=nameCompare(n[i],r[i]);if(0!==o)return o}return n.length===r.length?0:n.length<r.length?-1:1},i.prototype.equals=function(e){if(this.getLength()!==e.getLength())return!1;for(var t=this.pieceNum_,n=e.pieceNum_;t<=this.pieces_.length;t++,n++)if(this.pieces_[t]!==e.pieces_[n])return!1;return!0},i.prototype.contains=function(e){var t=this.pieceNum_,n=e.pieceNum_;if(this.getLength()>e.getLength())return!1;for(;t<this.pieces_.length;){if(this.pieces_[t]!==e.pieces_[n])return!1;++t,++n}return!0},i}(),ValidationPath=function(){function e(e,t){this.errorPrefix_=t,this.parts_=e.slice(),this.byteLength_=Math.max(1,this.parts_.length);for(var n=0;n<this.parts_.length;n++)this.byteLength_+=stringLength(this.parts_[n]);this.checkValid_()}return Object.defineProperty(e,"MAX_PATH_DEPTH",{get:function(){return 32},enumerable:!0,configurable:!0}),Object.defineProperty(e,"MAX_PATH_LENGTH_BYTES",{get:function(){return 768},enumerable:!0,configurable:!0}),e.prototype.push=function(e){0<this.parts_.length&&(this.byteLength_+=1),this.parts_.push(e),this.byteLength_+=stringLength(e),this.checkValid_()},e.prototype.pop=function(){var e=this.parts_.pop();this.byteLength_-=stringLength(e),0<this.parts_.length&&(this.byteLength_-=1)},e.prototype.checkValid_=function(){if(this.byteLength_>e.MAX_PATH_LENGTH_BYTES)throw new Error(this.errorPrefix_+"has a key path longer than "+e.MAX_PATH_LENGTH_BYTES+" bytes ("+this.byteLength_+").");if(this.parts_.length>e.MAX_PATH_DEPTH)throw new Error(this.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+e.MAX_PATH_DEPTH+") or object contains a cycle "+this.toErrorString())},e.prototype.toErrorString=function(){return 0==this.parts_.length?"":"in property '"+this.parts_.join(".")+"'"},e}(),PROTOCOL_VERSION="5",VERSION_PARAM="v",TRANSPORT_SESSION_PARAM="s",REFERER_PARAM="r",FORGE_REF="f",FORGE_DOMAIN="firebaseio.com",LAST_SESSION_PARAM="ls",WEBSOCKET="websocket",LONG_POLLING="long_polling",RepoInfo=function(){function e(e,t,n,r,i){void 0===i&&(i=""),this.secure=t,this.namespace=n,this.webSocketOnly=r,this.persistenceKey=i,this.host=e.toLowerCase(),this.domain=this.host.substr(this.host.indexOf(".")+1),this.internalHost=PersistentStorage.get("host:"+e)||this.host}return e.prototype.needsQueryParam=function(){return this.host!==this.internalHost||this.isCustomHost()},e.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},e.prototype.isDemoHost=function(){return"firebaseio-demo.com"===this.domain},e.prototype.isCustomHost=function(){return"firebaseio.com"!==this.domain&&"firebaseio-demo.com"!==this.domain},e.prototype.updateHost=function(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&PersistentStorage.set("host:"+this.host,this.internalHost))},e.prototype.connectionURL=function(e,t){var n;if(assert("string"==typeof e,"typeof type must == string"),assert("object"==typeof t,"typeof params must == object"),e===WEBSOCKET)n=(this.secure?"wss://":"ws://")+this.internalHost+"/.ws?";else{if(e!==LONG_POLLING)throw new Error("Unknown connection type: "+e);n=(this.secure?"https://":"http://")+this.internalHost+"/.lp?"}this.needsQueryParam()&&(t.ns=this.namespace);var r=[];return forEach(t,function(e,t){r.push(e+"="+t)}),n+r.join("&")},e.prototype.toString=function(){var e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e},e.prototype.toURLString=function(){return(this.secure?"https://":"http://")+this.host},e}(),igc;function decodePath(e){for(var t="",n=e.split("/"),r=0;r<n.length;r++)if(0<n[r].length){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(e){}t+="/"+i}return t}function decodeQuery(e){var t={};e.startsWith("?")&&(e=e.substring(1));for(var n=0,r=e.split("&");n<r.length;n++){var i=r[n];if(0!==i.length){var o=i.split("=");2===o.length?t[decodeURIComponent(o[0])]=decodeURIComponent(o[1]):warn("Invalid query segment '"+i+"' in query '"+e+"'")}}return t}var parseRepoInfo=function(e){var t=parseURL(e),n=t.subdomain;"firebase"===t.domain&&fatal(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),n&&"undefined"!=n||"localhost"===t.domain||fatal("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||warnIfPageIsSecure();var r="ws"===t.scheme||"wss"===t.scheme;return{repoInfo:new RepoInfo(t.host,t.secure,n,r),path:new Path(t.pathString)}},parseURL=function(e){var t="",n="",r="",i="",o=!0,a="https",s=443;if("string"==typeof e){var u=e.indexOf("//");0<=u&&(a=e.substring(0,u-1),e=e.substring(u+2));var c=e.indexOf("/");-1===c&&(c=e.length);var l=e.indexOf("?");-1===l&&(l=e.length),t=e.substring(0,Math.min(c,l)),c<l&&(i=decodePath(e.substring(c,l)));var h=decodeQuery(e.substring(Math.min(e.length,l)));0<=(u=t.indexOf(":"))?(o="https"===a||"wss"===a,s=parseInt(t.substring(u+1),10)):u=e.length;var f=t.split(".");3===f.length?(n=f[1],r=f[0].toLowerCase()):2===f.length?n=f[0]:"localhost"===f[0].slice(0,u).toLowerCase()&&(n="localhost"),""===r&&"ns"in h&&(r=h.ns)}return{host:t,port:s,domain:n,subdomain:r,secure:o,scheme:a,pathString:i}},INVALID_KEY_REGEX_=/[\[\].#$\/\u0000-\u001F\u007F]/,INVALID_PATH_REGEX_=/[\[\].#$\u0000-\u001F\u007F]/,MAX_LEAF_SIZE_=10485760,isValidKey=function(e){return"string"==typeof e&&0!==e.length&&!INVALID_KEY_REGEX_.test(e)},isValidPathString=function(e){return"string"==typeof e&&0!==e.length&&!INVALID_PATH_REGEX_.test(e)},isValidRootPathString=function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),isValidPathString(e)},isValidPriority=function(e){return null===e||"string"==typeof e||"number"==typeof e&&!isInvalidJSONNumber(e)||e&&"object"==typeof e&&contains(e,".sv")},validateFirebaseDataArg=function(e,t,n,r,i){i&&void 0===n||validateFirebaseData(errorPrefix(e,t,i),n,r)},validateFirebaseData=function(n,e,t){var r=t instanceof Path?new ValidationPath(t,n):t;if(void 0===e)throw new Error(n+"contains undefined "+r.toErrorString());if("function"==typeof e)throw new Error(n+"contains a function "+r.toErrorString()+" with contents = "+e.toString());if(isInvalidJSONNumber(e))throw new Error(n+"contains "+e.toString()+" "+r.toErrorString());if("string"==typeof e&&e.length>MAX_LEAF_SIZE_/3&&stringLength(e)>MAX_LEAF_SIZE_)throw new Error(n+"contains a string greater than "+MAX_LEAF_SIZE_+" utf8 bytes "+r.toErrorString()+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){var i=!1,o=!1;if(forEach(e,function(e,t){if(".value"===e)i=!0;else if(".priority"!==e&&".sv"!==e&&(o=!0,!isValidKey(e)))throw new Error(n+" contains an invalid key ("+e+") "+r.toErrorString()+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');r.push(e),validateFirebaseData(n,t,r),r.pop()}),i&&o)throw new Error(n+' contains ".value" child '+r.toErrorString()+" in addition to actual children.")}},validateFirebaseMergePaths=function(e,t){var n,r;for(n=0;n<t.length;n++)for(var i=(r=t[n]).slice(),o=0;o<i.length;o++)if(".priority"===i[o]&&o===i.length-1);else if(!isValidKey(i[o]))throw new Error(e+"contains an invalid key ("+i[o]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');t.sort(Path.comparePaths);var a=null;for(n=0;n<t.length;n++){if(r=t[n],null!==a&&a.contains(r))throw new Error(e+"contains a path "+a.toString()+" that is ancestor of another path "+r.toString());a=r}},validateFirebaseMergeDataArg=function(e,t,n,r,i){if(!i||void 0!==n){var o=errorPrefix(e,t,i);if(!n||"object"!=typeof n||Array.isArray(n))throw new Error(o+" must be an object containing the children to replace.");var a=[];forEach(n,function(e,t){var n=new Path(e);if(validateFirebaseData(o,t,r.child(n)),".priority"===n.getBack()&&!isValidPriority(t))throw new Error(o+"contains an invalid value for '"+n.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(n)}),validateFirebaseMergePaths(o,a)}},validatePriority=function(e,t,n,r){if(!r||void 0!==n){if(isInvalidJSONNumber(n))throw new Error(errorPrefix(e,t,r)+"is "+n.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!isValidPriority(n))throw new Error(errorPrefix(e,t,r)+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},validateEventType=function(e,t,n,r){if(!r||void 0!==n)switch(n){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(errorPrefix(e,t,r)+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},validateKey=function(e,t,n,r){if(!(r&&void 0===n||isValidKey(n)))throw new Error(errorPrefix(e,t,r)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},validatePathString=function(e,t,n,r){if(!(r&&void 0===n||isValidPathString(n)))throw new Error(errorPrefix(e,t,r)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},validateRootPathString=function(e,t,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),validatePathString(e,t,n,r)},validateWritablePath=function(e,t){if(".info"===t.getFront())throw new Error(e+" failed = Can't modify data under /.info/")},validateUrl=function(e,t,n){var r=n.path.toString();if("string"!=typeof n.repoInfo.host||0===n.repoInfo.host.length||!isValidKey(n.repoInfo.namespace)&&"localhost"!==n.repoInfo.host.split(":")[0]||0!==r.length&&!isValidRootPathString(r))throw new Error(errorPrefix(e,t,!1)+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},validateBoolean=function(e,t,n,r){if((!r||void 0!==n)&&"boolean"!=typeof n)throw new Error(errorPrefix(e,t,r)+"must be a boolean.")},OnDisconnect=function(){function e(e,t){this.repo_=e,this.path_=t}return e.prototype.cancel=function(e){validateArgCount("OnDisconnect.cancel",0,1,arguments.length),validateCallback("OnDisconnect.cancel",1,e,!0);var t=new Deferred;return this.repo_.onDisconnectCancel(this.path_,t.wrapCallback(e)),t.promise},e.prototype.remove=function(e){validateArgCount("OnDisconnect.remove",0,1,arguments.length),validateWritablePath("OnDisconnect.remove",this.path_),validateCallback("OnDisconnect.remove",1,e,!0);var t=new Deferred;return this.repo_.onDisconnectSet(this.path_,null,t.wrapCallback(e)),t.promise},e.prototype.set=function(e,t){validateArgCount("OnDisconnect.set",1,2,arguments.length),validateWritablePath("OnDisconnect.set",this.path_),validateFirebaseDataArg("OnDisconnect.set",1,e,this.path_,!1),validateCallback("OnDisconnect.set",2,t,!0);var n=new Deferred;return this.repo_.onDisconnectSet(this.path_,e,n.wrapCallback(t)),n.promise},e.prototype.setWithPriority=function(e,t,n){validateArgCount("OnDisconnect.setWithPriority",2,3,arguments.length),validateWritablePath("OnDisconnect.setWithPriority",this.path_),validateFirebaseDataArg("OnDisconnect.setWithPriority",1,e,this.path_,!1),validatePriority("OnDisconnect.setWithPriority",2,t,!1),validateCallback("OnDisconnect.setWithPriority",3,n,!0);var r=new Deferred;return this.repo_.onDisconnectSetWithPriority(this.path_,e,t,r.wrapCallback(n)),r.promise},e.prototype.update=function(e,t){if(validateArgCount("OnDisconnect.update",1,2,arguments.length),validateWritablePath("OnDisconnect.update",this.path_),Array.isArray(e)){for(var n={},r=0;r<e.length;++r)n[""+r]=e[r];e=n,warn("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}validateFirebaseMergeDataArg("OnDisconnect.update",1,e,this.path_,!1),validateCallback("OnDisconnect.update",2,t,!0);var i=new Deferred;return this.repo_.onDisconnectUpdate(this.path_,e,i.wrapCallback(t)),i.promise},e}(),TransactionResult=function(){function e(e,t){this.committed=e,this.snapshot=t}return e.prototype.toJSON=function(){return validateArgCount("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},e}(),nextPushId=(PUSH_CHARS="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",lastPushTime=0,lastRandChars=[],function(e){var t,n=e===lastPushTime;lastPushTime=e;var r=new Array(8);for(t=7;0<=t;t--)r[t]=PUSH_CHARS.charAt(e%64),e=Math.floor(e/64);assert(0===e,"Cannot push at time == 0");var i=r.join("");if(n){for(t=11;0<=t&&63===lastRandChars[t];t--)lastRandChars[t]=0;lastRandChars[t]++}else for(t=0;t<12;t++)lastRandChars[t]=Math.floor(64*Math.random());for(t=0;t<12;t++)i+=PUSH_CHARS.charAt(lastRandChars[t]);return assert(20===i.length,"nextPushId: Length should be 20."),i}),PUSH_CHARS,lastPushTime,lastRandChars,NamedNode=function(){function n(e,t){this.name=e,this.node=t}return n.Wrap=function(e,t){return new n(e,t)},n}(),Index=function(){function e(){}return e.prototype.getCompare=function(){return this.compare.bind(this)},e.prototype.indexedValueChanged=function(e,t){var n=new NamedNode(MIN_NAME,e),r=new NamedNode(MIN_NAME,t);return 0!==this.compare(n,r)},e.prototype.minPost=function(){return NamedNode.MIN},e}(),__EMPTY_NODE,KeyIndex=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t,"__EMPTY_NODE",{get:function(){return __EMPTY_NODE},set:function(e){__EMPTY_NODE=e},enumerable:!0,configurable:!0}),t.prototype.compare=function(e,t){return nameCompare(e.name,t.name)},t.prototype.isDefinedOn=function(e){throw assertionError("KeyIndex.isDefinedOn not expected to be called.")},t.prototype.indexedValueChanged=function(e,t){return!1},t.prototype.minPost=function(){return NamedNode.MIN},t.prototype.maxPost=function(){return new NamedNode(MAX_NAME,__EMPTY_NODE)},t.prototype.makePost=function(e,t){return assert("string"==typeof e,"KeyIndex indexValue must always be a string."),new NamedNode(e,__EMPTY_NODE)},t.prototype.toString=function(){return".key"},t}(Index),KEY_INDEX=new KeyIndex,MAX_NODE;function setMaxNode(e){MAX_NODE=e}var priorityHashText=function(e){return"number"==typeof e?"number:"+doubleToIEEE754String(e):"string:"+e},validatePriorityNode=function(e){if(e.isLeafNode()){var t=e.val();assert("string"==typeof t||"number"==typeof t||"object"==typeof t&&contains(t,".sv"),"Priority must be a string or number.")}else assert(e===MAX_NODE||e.isEmpty(),"priority of unexpected type.");assert(e===MAX_NODE||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},__childrenNodeConstructor,LeafNode=function(){function o(e,t){void 0===t&&(t=o.__childrenNodeConstructor.EMPTY_NODE),this.value_=e,this.priorityNode_=t,this.lazyHash_=null,assert(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),validatePriorityNode(this.priorityNode_)}return Object.defineProperty(o,"__childrenNodeConstructor",{get:function(){return __childrenNodeConstructor},set:function(e){__childrenNodeConstructor=e},enumerable:!0,configurable:!0}),o.prototype.isLeafNode=function(){return!0},o.prototype.getPriority=function(){return this.priorityNode_},o.prototype.updatePriority=function(e){return new o(this.value_,e)},o.prototype.getImmediateChild=function(e){return".priority"===e?this.priorityNode_:o.__childrenNodeConstructor.EMPTY_NODE},o.prototype.getChild=function(e){return e.isEmpty()?this:".priority"===e.getFront()?this.priorityNode_:o.__childrenNodeConstructor.EMPTY_NODE},o.prototype.hasChild=function(){return!1},o.prototype.getPredecessorChildName=function(e,t){return null},o.prototype.updateImmediateChild=function(e,t){return".priority"===e?this.updatePriority(t):t.isEmpty()&&".priority"!==e?this:o.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)},o.prototype.updateChild=function(e,t){var n=e.getFront();return null===n?t:t.isEmpty()&&".priority"!==n?this:(assert(".priority"!==n||1===e.getLength(),".priority must be the last token in a path"),this.updateImmediateChild(n,o.__childrenNodeConstructor.EMPTY_NODE.updateChild(e.popFront(),t)))},o.prototype.isEmpty=function(){return!1},o.prototype.numChildren=function(){return 0},o.prototype.forEachChild=function(e,t){return!1},o.prototype.val=function(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},o.prototype.hash=function(){if(null===this.lazyHash_){var e="";this.priorityNode_.isEmpty()||(e+="priority:"+priorityHashText(this.priorityNode_.val())+":");var t=typeof this.value_;e+=t+":",e+="number"===t?doubleToIEEE754String(this.value_):this.value_,this.lazyHash_=sha1(e)}return this.lazyHash_},o.prototype.getValue=function(){return this.value_},o.prototype.compareTo=function(e){return e===o.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof o.__childrenNodeConstructor?-1:(assert(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))},o.prototype.compareToLeafNode_=function(e){var t=typeof e.value_,n=typeof this.value_,r=o.VALUE_TYPE_ORDER.indexOf(t),i=o.VALUE_TYPE_ORDER.indexOf(n);return assert(0<=r,"Unknown leaf type: "+t),assert(0<=i,"Unknown leaf type: "+n),r===i?"object"===n?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-r},o.prototype.withIndex=function(){return this},o.prototype.isIndexed=function(){return!0},o.prototype.equals=function(e){if(e===this)return!0;if(e.isLeafNode()){var t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1},o.VALUE_TYPE_ORDER=["object","boolean","number","string"],o}(),nodeFromJSON,MAX_NODE$1;function setNodeFromJSON(e){nodeFromJSON=e}function setMaxNode$1(e){MAX_NODE$1=e}var PriorityIndex=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.compare=function(e,t){var n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?nameCompare(e.name,t.name):i},t.prototype.isDefinedOn=function(e){return!e.getPriority().isEmpty()},t.prototype.indexedValueChanged=function(e,t){return!e.getPriority().equals(t.getPriority())},t.prototype.minPost=function(){return NamedNode.MIN},t.prototype.maxPost=function(){return new NamedNode(MAX_NAME,new LeafNode("[PRIORITY-POST]",MAX_NODE$1))},t.prototype.makePost=function(e,t){var n=nodeFromJSON(e);return new NamedNode(t,new LeafNode("[PRIORITY-POST]",n))},t.prototype.toString=function(){return".priority"},t}(Index),PRIORITY_INDEX=new PriorityIndex,SortedMapIterator=function(){function e(e,t,n,r,i){void 0===i&&(i=null),this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];for(var o=1;!e.isEmpty();)if(e=e,o=t?n(e.key,t):1,r&&(o*=-1),o<0)e=this.isReverse_?e.left:e.right;else{if(0===o){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}return e.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e},e.prototype.hasNext=function(){return 0<this.nodeStack_.length},e.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}},e}(),LLRBNode=function(){function o(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:o.RED,this.left=null!=r?r:SortedMap.EMPTY_NODE,this.right=null!=i?i:SortedMap.EMPTY_NODE}return o.prototype.copy=function(e,t,n,r,i){return new o(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},o.prototype.count=function(){return this.left.count()+1+this.right.count()},o.prototype.isEmpty=function(){return!1},o.prototype.inorderTraversal=function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)},o.prototype.reverseTraversal=function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)},o.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},o.prototype.minKey=function(){return this.min_().key},o.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},o.prototype.insert=function(e,t,n){var r,i;return(i=(r=n(e,(i=this).key))<0?i.copy(null,null,null,i.left.insert(e,t,n),null):0===r?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n))).fixUp_()},o.prototype.removeMin_=function(){if(this.left.isEmpty())return SortedMap.EMPTY_NODE;var e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),(e=e.copy(null,null,null,e.left.removeMin_(),null)).fixUp_()},o.prototype.remove=function(e,t){var n,r;if(t(e,(n=this).key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return SortedMap.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()},o.prototype.isRed_=function(){return this.color},o.prototype.fixUp_=function(){var e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e},o.prototype.moveRedLeft_=function(){var e=this.colorFlip_();return e.right.left.isRed_()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight_())).rotateLeft_()).colorFlip_()),e},o.prototype.moveRedRight_=function(){var e=this.colorFlip_();return e.left.left.isRed_()&&(e=(e=e.rotateRight_()).colorFlip_()),e},o.prototype.rotateLeft_=function(){var e=this.copy(null,null,o.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},o.prototype.rotateRight_=function(){var e=this.copy(null,null,o.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},o.prototype.colorFlip_=function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)},o.prototype.checkMaxDepth_=function(){var e=this.check_();return Math.pow(2,e)<=this.count()+1},o.prototype.check_=function(){var e;if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");if((e=this.left.check_())!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)},o.RED=!0,o.BLACK=!1,o}(),LLRBEmptyNode=function(){function e(){}return e.prototype.copy=function(e,t,n,r,i){return this},e.prototype.insert=function(e,t,n){return new LLRBNode(e,t,null)},e.prototype.remove=function(e,t){return this},e.prototype.count=function(){return 0},e.prototype.isEmpty=function(){return!0},e.prototype.inorderTraversal=function(e){return!1},e.prototype.reverseTraversal=function(e){return!1},e.prototype.minKey=function(){return null},e.prototype.maxKey=function(){return null},e.prototype.check_=function(){return 0},e.prototype.isRed_=function(){return!1},e}(),SortedMap=function(){function n(e,t){void 0===t&&(t=n.EMPTY_NODE),this.comparator_=e,this.root_=t}return n.prototype.insert=function(e,t){return new n(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,LLRBNode.BLACK,null,null))},n.prototype.remove=function(e){return new n(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,LLRBNode.BLACK,null,null))},n.prototype.get=function(e){for(var t,n=this.root_;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key)))return n.value;t<0?n=n.left:0<t&&(n=n.right)}return null},n.prototype.getPredecessorKey=function(e){for(var t,n=this.root_,r=null;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:0<t&&(n=(r=n).right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},n.prototype.isEmpty=function(){return this.root_.isEmpty()},n.prototype.count=function(){return this.root_.count()},n.prototype.minKey=function(){return this.root_.minKey()},n.prototype.maxKey=function(){return this.root_.maxKey()},n.prototype.inorderTraversal=function(e){return this.root_.inorderTraversal(e)},n.prototype.reverseTraversal=function(e){return this.root_.reverseTraversal(e)},n.prototype.getIterator=function(e){return new SortedMapIterator(this.root_,null,this.comparator_,!1,e)},n.prototype.getIteratorFrom=function(e,t){return new SortedMapIterator(this.root_,e,this.comparator_,!1,t)},n.prototype.getReverseIteratorFrom=function(e,t){return new SortedMapIterator(this.root_,e,this.comparator_,!0,t)},n.prototype.getReverseIterator=function(e){return new SortedMapIterator(this.root_,null,this.comparator_,!0,e)},n.EMPTY_NODE=new LLRBEmptyNode,n}(),LOG_2=Math.log(2),Base12Num=function(){function e(e){var t;this.count=(t=e+1,parseInt(Math.log(t)/LOG_2,10)),this.current_=this.count-1;var n,r=(n=this.count,parseInt(Array(n+1).join("1"),2));this.bits_=e+1&r}return e.prototype.nextBitIsOne=function(){var e=!(this.bits_&1<<this.current_);return this.current_--,e},e}(),buildChildSet=function(c,e,l,t){c.sort(e);var h=function(e,t){var n,r,i=t-e;if(0==i)return null;if(1==i)return n=c[e],r=l?l(n):n,new LLRBNode(r,n.node,LLRBNode.BLACK,null,null);var o=parseInt(i/2,10)+e,a=h(e,o),s=h(o+1,t);return n=c[o],r=l?l(n):n,new LLRBNode(r,n.node,LLRBNode.BLACK,a,s)},n=function(e){for(var t=null,n=null,s=c.length,r=function(e,t){var n=s-e,r=s;s-=e;var i=h(n+1,r),o=c[n],a=l?l(o):o;u(new LLRBNode(a,o.node,t,null,i))},u=function(e){t?t.left=e:n=e,t=e},i=0;i<e.count;++i){var o=e.nextBitIsOne(),a=Math.pow(2,e.count-(i+1));o?r(a,LLRBNode.BLACK):(r(a,LLRBNode.BLACK),r(a,LLRBNode.RED))}return n}(new Base12Num(c.length));return new SortedMap(t||e,n)},_defaultIndexMap,fallbackObject={},IndexMap=function(){function h(e,t){this.indexes_=e,this.indexSet_=t}return Object.defineProperty(h,"Default",{get:function(){return assert(fallbackObject&&PRIORITY_INDEX,"ChildrenNode.ts has not been loaded"),_defaultIndexMap=_defaultIndexMap||new h({".priority":fallbackObject},{".priority":PRIORITY_INDEX})},enumerable:!0,configurable:!0}),h.prototype.get=function(e){var t=safeGet(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t===fallbackObject?null:t},h.prototype.hasIndex=function(e){return contains(this.indexSet_,e.toString())},h.prototype.addIndex=function(e,t){assert(e!==KEY_INDEX,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var n,r=[],i=!1,o=t.getIterator(NamedNode.Wrap),a=o.getNext();a;)i=i||e.isDefinedOn(a.node),r.push(a),a=o.getNext();n=i?buildChildSet(r,e.getCompare()):fallbackObject;var s=e.toString(),u=clone(this.indexSet_);u[s]=e;var c=clone(this.indexes_);return c[s]=n,new h(c,u)},h.prototype.addToIndexes=function(u,c){var l=this;return new h(map(this.indexes_,function(e,t){var n=safeGet(l.indexSet_,t);if(assert(n,"Missing index implementation for "+t),e===fallbackObject){if(n.isDefinedOn(u.node)){for(var r=[],i=c.getIterator(NamedNode.Wrap),o=i.getNext();o;)o.name!=u.name&&r.push(o),o=i.getNext();return r.push(u),buildChildSet(r,n.getCompare())}return fallbackObject}var a=c.get(u.name),s=e;return a&&(s=s.remove(new NamedNode(u.name,a))),s.insert(u,u.node)}),this.indexSet_)},h.prototype.removeFromIndexes=function(n,r){return new h(map(this.indexes_,function(e){if(e===fallbackObject)return e;var t=r.get(n.name);return t?e.remove(new NamedNode(n.name,t)):e}),this.indexSet_)},h}(),EMPTY_NODE;function NAME_ONLY_COMPARATOR(e,t){return nameCompare(e.name,t.name)}function NAME_COMPARATOR(e,t){return nameCompare(e,t)}var ChildrenNode=function(){function s(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&validatePriorityNode(this.priorityNode_),this.children_.isEmpty()&&assert(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(s,"EMPTY_NODE",{get:function(){return EMPTY_NODE||(EMPTY_NODE=new s(new SortedMap(NAME_COMPARATOR),null,IndexMap.Default))},enumerable:!0,configurable:!0}),s.prototype.isLeafNode=function(){return!1},s.prototype.getPriority=function(){return this.priorityNode_||EMPTY_NODE},s.prototype.updatePriority=function(e){return this.children_.isEmpty()?this:new s(this.children_,e,this.indexMap_)},s.prototype.getImmediateChild=function(e){if(".priority"===e)return this.getPriority();var t=this.children_.get(e);return null===t?EMPTY_NODE:t},s.prototype.getChild=function(e){var t=e.getFront();return null===t?this:this.getImmediateChild(t).getChild(e.popFront())},s.prototype.hasChild=function(e){return null!==this.children_.get(e)},s.prototype.updateImmediateChild=function(e,t){if(assert(t,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(t);var n=new NamedNode(e,t),r=void 0,i=void 0;return t.isEmpty()?(r=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(n,this.children_)):(r=this.children_.insert(e,t),i=this.indexMap_.addToIndexes(n,this.children_)),new s(r,r.isEmpty()?EMPTY_NODE:this.priorityNode_,i)},s.prototype.updateChild=function(e,t){var n=e.getFront();if(null===n)return t;assert(".priority"!==e.getFront()||1===e.getLength(),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(e.popFront(),t);return this.updateImmediateChild(n,r)},s.prototype.isEmpty=function(){return this.children_.isEmpty()},s.prototype.numChildren=function(){return this.children_.count()},s.prototype.val=function(n){if(this.isEmpty())return null;var r={},i=0,o=0,a=!0;if(this.forEachChild(PRIORITY_INDEX,function(e,t){r[e]=t.val(n),i++,a&&s.INTEGER_REGEXP_.test(e)?o=Math.max(o,Number(e)):a=!1}),!n&&a&&o<2*i){var e=[];for(var t in r)e[t]=r[t];return e}return n&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r},s.prototype.hash=function(){if(null===this.lazyHash_){var r="";this.getPriority().isEmpty()||(r+="priority:"+priorityHashText(this.getPriority().val())+":"),this.forEachChild(PRIORITY_INDEX,function(e,t){var n=t.hash();""!==n&&(r+=":"+e+":"+n)}),this.lazyHash_=""===r?"":sha1(r)}return this.lazyHash_},s.prototype.getPredecessorChildName=function(e,t,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new NamedNode(e,t));return i?i.name:null}return this.children_.getPredecessorKey(e)},s.prototype.getFirstChildName=function(e){var t=this.resolveIndex_(e);if(t){var n=t.minKey();return n&&n.name}return this.children_.minKey()},s.prototype.getFirstChild=function(e){var t=this.getFirstChildName(e);return t?new NamedNode(t,this.children_.get(t)):null},s.prototype.getLastChildName=function(e){var t=this.resolveIndex_(e);if(t){var n=t.maxKey();return n&&n.name}return this.children_.maxKey()},s.prototype.getLastChild=function(e){var t=this.getLastChildName(e);return t?new NamedNode(t,this.children_.get(t)):null},s.prototype.forEachChild=function(e,t){var n=this.resolveIndex_(e);return n?n.inorderTraversal(function(e){return t(e.name,e.node)}):this.children_.inorderTraversal(t)},s.prototype.getIterator=function(e){return this.getIteratorFrom(e.minPost(),e)},s.prototype.getIteratorFrom=function(e,t){var n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,function(e){return e});for(var r=this.children_.getIteratorFrom(e.name,NamedNode.Wrap),i=r.peek();null!=i&&t.compare(i,e)<0;)r.getNext(),i=r.peek();return r},s.prototype.getReverseIterator=function(e){return this.getReverseIteratorFrom(e.maxPost(),e)},s.prototype.getReverseIteratorFrom=function(e,t){var n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,function(e){return e});for(var r=this.children_.getReverseIteratorFrom(e.name,NamedNode.Wrap),i=r.peek();null!=i&&0<t.compare(i,e);)r.getNext(),i=r.peek();return r},s.prototype.compareTo=function(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===MAX_NODE$2?-1:0},s.prototype.withIndex=function(e){if(e===KEY_INDEX||this.indexMap_.hasIndex(e))return this;var t=this.indexMap_.addIndex(e,this.children_);return new s(this.children_,this.priorityNode_,t)},s.prototype.isIndexed=function(e){return e===KEY_INDEX||this.indexMap_.hasIndex(e)},s.prototype.equals=function(e){if(e===this)return!0;if(e.isLeafNode())return!1;var t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){for(var n=this.getIterator(PRIORITY_INDEX),r=t.getIterator(PRIORITY_INDEX),i=n.getNext(),o=r.getNext();i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=n.getNext(),o=r.getNext()}return null===i&&null===o}return!1}return!1},s.prototype.resolveIndex_=function(e){return e===KEY_INDEX?null:this.indexMap_.get(e.toString())},s.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,s}(),MaxNode=function(e){function t(){return e.call(this,new SortedMap(NAME_COMPARATOR),ChildrenNode.EMPTY_NODE,IndexMap.Default)||this}return __extends(t,e),t.prototype.compareTo=function(e){return e===this?0:1},t.prototype.equals=function(e){return e===this},t.prototype.getPriority=function(){return this},t.prototype.getImmediateChild=function(e){return ChildrenNode.EMPTY_NODE},t.prototype.isEmpty=function(){return!1},t}(ChildrenNode),MAX_NODE$2=new MaxNode;Object.defineProperties(NamedNode,{MIN:{value:new NamedNode(MIN_NAME,ChildrenNode.EMPTY_NODE)},MAX:{value:new NamedNode(MAX_NAME,MAX_NODE$2)}}),KeyIndex.__EMPTY_NODE=ChildrenNode.EMPTY_NODE,LeafNode.__childrenNodeConstructor=ChildrenNode,setMaxNode(MAX_NODE$2),setMaxNode$1(MAX_NODE$2);var USE_HINZE=!0;function nodeFromJSON$1(e,t){if(void 0===t&&(t=null),null===e)return ChildrenNode.EMPTY_NODE;if("object"==typeof e&&".priority"in e&&(t=e[".priority"]),assert(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!=typeof e||".sv"in e)return new LeafNode(e,nodeFromJSON$1(t));if(e instanceof Array||!USE_HINZE){var r=ChildrenNode.EMPTY_NODE,i=e;return forEach(i,function(e,t){if(contains(i,e)&&"."!==e.substring(0,1)){var n=nodeFromJSON$1(t);!n.isLeafNode()&&n.isEmpty()||(r=r.updateImmediateChild(e,n))}}),r.updatePriority(nodeFromJSON$1(t))}var o=[],a=!1,s=e;if(forEach(s,function(e,t){if("string"!=typeof e||"."!==e.substring(0,1)){var n=nodeFromJSON$1(s[e]);n.isEmpty()||(a=a||!n.getPriority().isEmpty(),o.push(new NamedNode(e,n)))}}),0==o.length)return ChildrenNode.EMPTY_NODE;var n=buildChildSet(o,NAME_ONLY_COMPARATOR,function(e){return e.name},NAME_COMPARATOR);if(a){var u=buildChildSet(o,PRIORITY_INDEX.getCompare());return new ChildrenNode(n,nodeFromJSON$1(t),new IndexMap({".priority":u},{".priority":PRIORITY_INDEX}))}return new ChildrenNode(n,nodeFromJSON$1(t),IndexMap.Default)}setNodeFromJSON(nodeFromJSON$1);var ValueIndex=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.compare=function(e,t){var n=e.node.compareTo(t.node);return 0===n?nameCompare(e.name,t.name):n},t.prototype.isDefinedOn=function(e){return!0},t.prototype.indexedValueChanged=function(e,t){return!e.equals(t)},t.prototype.minPost=function(){return NamedNode.MIN},t.prototype.maxPost=function(){return NamedNode.MAX},t.prototype.makePost=function(e,t){var n=nodeFromJSON$1(e);return new NamedNode(t,n)},t.prototype.toString=function(){return".value"},t}(Index),VALUE_INDEX=new ValueIndex,PathIndex=function(n){function e(e){var t=n.call(this)||this;return t.indexPath_=e,assert(!e.isEmpty()&&".priority"!==e.getFront(),"Can't create PathIndex with empty path or .priority key"),t}return __extends(e,n),e.prototype.extractChild=function(e){return e.getChild(this.indexPath_)},e.prototype.isDefinedOn=function(e){return!e.getChild(this.indexPath_).isEmpty()},e.prototype.compare=function(e,t){var n=this.extractChild(e.node),r=this.extractChild(t.node),i=n.compareTo(r);return 0===i?nameCompare(e.name,t.name):i},e.prototype.makePost=function(e,t){var n=nodeFromJSON$1(e),r=ChildrenNode.EMPTY_NODE.updateChild(this.indexPath_,n);return new NamedNode(t,r)},e.prototype.maxPost=function(){var e=ChildrenNode.EMPTY_NODE.updateChild(this.indexPath_,MAX_NODE$2);return new NamedNode(MAX_NAME,e)},e.prototype.toString=function(){return this.indexPath_.slice().join("/")},e}(Index),DataSnapshot=function(){function i(e,t,n){this.node_=e,this.ref_=t,this.index_=n}return i.prototype.val=function(){return validateArgCount("DataSnapshot.val",0,0,arguments.length),this.node_.val()},i.prototype.exportVal=function(){return validateArgCount("DataSnapshot.exportVal",0,0,arguments.length),this.node_.val(!0)},i.prototype.toJSON=function(){return validateArgCount("DataSnapshot.toJSON",0,1,arguments.length),this.exportVal()},i.prototype.exists=function(){return validateArgCount("DataSnapshot.exists",0,0,arguments.length),!this.node_.isEmpty()},i.prototype.child=function(e){validateArgCount("DataSnapshot.child",0,1,arguments.length),e=String(e),validatePathString("DataSnapshot.child",1,e,!1);var t=new Path(e),n=this.ref_.child(t);return new i(this.node_.getChild(t),n,PRIORITY_INDEX)},i.prototype.hasChild=function(e){validateArgCount("DataSnapshot.hasChild",1,1,arguments.length),validatePathString("DataSnapshot.hasChild",1,e,!1);var t=new Path(e);return!this.node_.getChild(t).isEmpty()},i.prototype.getPriority=function(){return validateArgCount("DataSnapshot.getPriority",0,0,arguments.length),this.node_.getPriority().val()},i.prototype.forEach=function(n){var r=this;return validateArgCount("DataSnapshot.forEach",1,1,arguments.length),validateCallback("DataSnapshot.forEach",1,n,!1),!this.node_.isLeafNode()&&!!this.node_.forEachChild(this.index_,function(e,t){return n(new i(t,r.ref_.child(e),PRIORITY_INDEX))})},i.prototype.hasChildren=function(){return validateArgCount("DataSnapshot.hasChildren",0,0,arguments.length),!this.node_.isLeafNode()&&!this.node_.isEmpty()},Object.defineProperty(i.prototype,"key",{get:function(){return this.ref_.getKey()},enumerable:!0,configurable:!0}),i.prototype.numChildren=function(){return validateArgCount("DataSnapshot.numChildren",0,0,arguments.length),this.node_.numChildren()},i.prototype.getRef=function(){return validateArgCount("DataSnapshot.ref",0,0,arguments.length),this.ref_},Object.defineProperty(i.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),i}(),DataEvent=function(){function e(e,t,n,r){this.eventType=e,this.eventRegistration=t,this.snapshot=n,this.prevName=r}return e.prototype.getPath=function(){var e=this.snapshot.getRef();return"value"===this.eventType?e.path:e.getParent().path},e.prototype.getEventType=function(){return this.eventType},e.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},e.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+stringify(this.snapshot.exportVal())},e}(),CancelEvent=function(){function e(e,t,n){this.eventRegistration=e,this.error=t,this.path=n}return e.prototype.getPath=function(){return this.path},e.prototype.getEventType=function(){return"cancel"},e.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},e.prototype.toString=function(){return this.path.toString()+":cancel"},e}(),ValueEventRegistration=function(){function t(e,t,n){this.callback_=e,this.cancelCallback_=t,this.context_=n}return t.prototype.respondsTo=function(e){return"value"===e},t.prototype.createEvent=function(e,t){var n=t.getQueryParams().getIndex();return new DataEvent("value",this,new DataSnapshot(e.snapshotNode,t.getRef(),n))},t.prototype.getEventRunner=function(e){var t=this.context_;if("cancel"===e.getEventType()){assert(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(t,e.error)}}var r=this.callback_;return function(){r.call(t,e.snapshot)}},t.prototype.createCancelEvent=function(e,t){return this.cancelCallback_?new CancelEvent(this,e,t):null},t.prototype.matches=function(e){return e instanceof t&&(!e.callback_||!this.callback_||e.callback_===this.callback_&&e.context_===this.context_)},t.prototype.hasAnyCallback=function(){return null!==this.callback_},t}(),ChildEventRegistration=function(){function i(e,t,n){this.callbacks_=e,this.cancelCallback_=t,this.context_=n}return i.prototype.respondsTo=function(e){var t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,contains(this.callbacks_,t)},i.prototype.createCancelEvent=function(e,t){return this.cancelCallback_?new CancelEvent(this,e,t):null},i.prototype.createEvent=function(e,t){assert(null!=e.childName,"Child events should have a childName.");var n=t.getRef().child(e.childName),r=t.getQueryParams().getIndex();return new DataEvent(e.type,this,new DataSnapshot(e.snapshotNode,n,r),e.prevName)},i.prototype.getEventRunner=function(e){var t=this.context_;if("cancel"===e.getEventType()){assert(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(t,e.error)}}var r=this.callbacks_[e.eventType];return function(){r.call(t,e.snapshot,e.prevName)}},i.prototype.matches=function(n){if(n instanceof i){if(!this.callbacks_||!n.callbacks_)return!0;if(this.context_===n.context_){var e=getCount(n.callbacks_);if(e===getCount(this.callbacks_)){if(1===e){var t=getAnyKey(n.callbacks_),r=getAnyKey(this.callbacks_);return!(r!==t||n.callbacks_[t]&&this.callbacks_[r]&&n.callbacks_[t]!==this.callbacks_[r])}return every(this.callbacks_,function(e,t){return n.callbacks_[e]===t})}}}return!1},i.prototype.hasAnyCallback=function(){return null!==this.callbacks_},i}(),__referenceConstructor,Query=function(){function c(e,t,n,r){this.repo=e,this.path=t,this.queryParams_=n,this.orderByCalled_=r}return Object.defineProperty(c,"__referenceConstructor",{get:function(){return assert(__referenceConstructor,"Reference.ts has not been loaded"),__referenceConstructor},set:function(e){__referenceConstructor=e},enumerable:!0,configurable:!0}),c.validateQueryEndpoints_=function(e){var t=null,n=null;if(e.hasStart()&&(t=e.getIndexStartValue()),e.hasEnd()&&(n=e.getIndexEndValue()),e.getIndex()===KEY_INDEX){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), endAt(),or equalTo() must be a string.";if(e.hasStart()){if(e.getIndexStartName()!=MIN_NAME)throw new Error(r);if("string"!=typeof t)throw new Error(i)}if(e.hasEnd()){if(e.getIndexEndName()!=MAX_NAME)throw new Error(r);if("string"!=typeof n)throw new Error(i)}}else if(e.getIndex()===PRIORITY_INDEX){if(null!=t&&!isValidPriority(t)||null!=n&&!isValidPriority(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), endAt(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(assert(e.getIndex()instanceof PathIndex||e.getIndex()===VALUE_INDEX,"unknown index type."),null!=t&&"object"==typeof t||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), endAt(), or equalTo() cannot be an object.")},c.validateLimit_=function(e){if(e.hasStart()&&e.hasEnd()&&e.hasLimit()&&!e.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), endAt(), and limit(). Use limitToFirst() or limitToLast() instead.")},c.prototype.validateNoPreviousOrderByCall_=function(e){if(!0===this.orderByCalled_)throw new Error(e+": You can't combine multiple orderBy calls.")},c.prototype.getQueryParams=function(){return this.queryParams_},c.prototype.getRef=function(){return validateArgCount("Query.ref",0,0,arguments.length),new c.__referenceConstructor(this.repo,this.path)},c.prototype.on=function(e,t,n,r){validateArgCount("Query.on",2,4,arguments.length),validateEventType("Query.on",1,e,!1),validateCallback("Query.on",2,t,!1);var i=c.getCancelAndContextArgs_("Query.on",n,r);if("value"===e)this.onValueEvent(t,i.cancel,i.context);else{var o={};o[e]=t,this.onChildEvent(o,i.cancel,i.context)}return t},c.prototype.onValueEvent=function(e,t,n){var r=new ValueEventRegistration(e,t||null,n||null);this.repo.addEventCallbackForQuery(this,r)},c.prototype.onChildEvent=function(e,t,n){var r=new ChildEventRegistration(e,t,n);this.repo.addEventCallbackForQuery(this,r)},c.prototype.off=function(e,t,n){validateArgCount("Query.off",0,3,arguments.length),validateEventType("Query.off",1,e,!0),validateCallback("Query.off",2,t,!0),validateContextObject("Query.off",3,n,!0);var r=null,i=null;"value"===e?r=new ValueEventRegistration(t||null,null,n||null):e&&(t&&((i={})[e]=t),r=new ChildEventRegistration(i,null,n||null)),this.repo.removeEventCallbackForQuery(this,r)},c.prototype.once=function(t,n,e,r){var i=this;validateArgCount("Query.once",1,4,arguments.length),validateEventType("Query.once",1,t,!1),validateCallback("Query.once",2,n,!0);var o=c.getCancelAndContextArgs_("Query.once",e,r),a=!0,s=new Deferred;s.promise.catch(function(){});var u=function(e){a&&(a=!1,i.off(t,u),n&&n.bind(o.context)(e),s.resolve(e))};return this.on(t,u,function(e){i.off(t,u),o.cancel&&o.cancel.bind(o.context)(e),s.reject(e)}),s.promise},c.prototype.limitToFirst=function(e){if(validateArgCount("Query.limitToFirst",1,1,arguments.length),"number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("Query.limitToFirst: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToFirst: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new c(this.repo,this.path,this.queryParams_.limitToFirst(e),this.orderByCalled_)},c.prototype.limitToLast=function(e){if(validateArgCount("Query.limitToLast",1,1,arguments.length),"number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("Query.limitToLast: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToLast: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new c(this.repo,this.path,this.queryParams_.limitToLast(e),this.orderByCalled_)},c.prototype.orderByChild=function(e){if(validateArgCount("Query.orderByChild",1,1,arguments.length),"$key"===e)throw new Error('Query.orderByChild: "$key" is invalid.  Use Query.orderByKey() instead.');if("$priority"===e)throw new Error('Query.orderByChild: "$priority" is invalid.  Use Query.orderByPriority() instead.');if("$value"===e)throw new Error('Query.orderByChild: "$value" is invalid.  Use Query.orderByValue() instead.');validatePathString("Query.orderByChild",1,e,!1),this.validateNoPreviousOrderByCall_("Query.orderByChild");var t=new Path(e);if(t.isEmpty())throw new Error("Query.orderByChild: cannot pass in empty path.  Use Query.orderByValue() instead.");var n=new PathIndex(t),r=this.queryParams_.orderBy(n);return c.validateQueryEndpoints_(r),new c(this.repo,this.path,r,!0)},c.prototype.orderByKey=function(){validateArgCount("Query.orderByKey",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByKey");var e=this.queryParams_.orderBy(KEY_INDEX);return c.validateQueryEndpoints_(e),new c(this.repo,this.path,e,!0)},c.prototype.orderByPriority=function(){validateArgCount("Query.orderByPriority",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByPriority");var e=this.queryParams_.orderBy(PRIORITY_INDEX);return c.validateQueryEndpoints_(e),new c(this.repo,this.path,e,!0)},c.prototype.orderByValue=function(){validateArgCount("Query.orderByValue",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByValue");var e=this.queryParams_.orderBy(VALUE_INDEX);return c.validateQueryEndpoints_(e),new c(this.repo,this.path,e,!0)},c.prototype.startAt=function(e,t){void 0===e&&(e=null),validateArgCount("Query.startAt",0,2,arguments.length),validateFirebaseDataArg("Query.startAt",1,e,this.path,!0),validateKey("Query.startAt",2,t,!0);var n=this.queryParams_.startAt(e,t);if(c.validateLimit_(n),c.validateQueryEndpoints_(n),this.queryParams_.hasStart())throw new Error("Query.startAt: Starting point was already set (by another call to startAt or equalTo).");return void 0===e&&(t=e=null),new c(this.repo,this.path,n,this.orderByCalled_)},c.prototype.endAt=function(e,t){void 0===e&&(e=null),validateArgCount("Query.endAt",0,2,arguments.length),validateFirebaseDataArg("Query.endAt",1,e,this.path,!0),validateKey("Query.endAt",2,t,!0);var n=this.queryParams_.endAt(e,t);if(c.validateLimit_(n),c.validateQueryEndpoints_(n),this.queryParams_.hasEnd())throw new Error("Query.endAt: Ending point was already set (by another call to endAt or equalTo).");return new c(this.repo,this.path,n,this.orderByCalled_)},c.prototype.equalTo=function(e,t){if(validateArgCount("Query.equalTo",1,2,arguments.length),validateFirebaseDataArg("Query.equalTo",1,e,this.path,!1),validateKey("Query.equalTo",2,t,!0),this.queryParams_.hasStart())throw new Error("Query.equalTo: Starting point was already set (by another call to startAt or equalTo).");if(this.queryParams_.hasEnd())throw new Error("Query.equalTo: Ending point was already set (by another call to endAt or equalTo).");return this.startAt(e,t).endAt(e,t)},c.prototype.toString=function(){return validateArgCount("Query.toString",0,0,arguments.length),this.repo.toString()+this.path.toUrlEncodedString()},c.prototype.toJSON=function(){return validateArgCount("Query.toJSON",0,1,arguments.length),this.toString()},c.prototype.queryObject=function(){return this.queryParams_.getQueryObject()},c.prototype.queryIdentifier=function(){var e=this.queryObject(),t=ObjectToUniqueKey(e);return"{}"===t?"default":t},c.prototype.isEqual=function(e){if(validateArgCount("Query.isEqual",1,1,arguments.length),!(e instanceof c))throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.");var t=this.repo===e.repo,n=this.path.equals(e.path),r=this.queryIdentifier()===e.queryIdentifier();return t&&n&&r},c.getCancelAndContextArgs_=function(e,t,n){var r={cancel:null,context:null};if(t&&n)r.cancel=t,validateCallback(e,3,r.cancel,!0),r.context=n,validateContextObject(e,4,r.context,!0);else if(t)if("object"==typeof t&&null!==t)r.context=t;else{if("function"!=typeof t)throw new Error(errorPrefix(e,3,!0)+" must either be a cancel callback or a context object.");r.cancel=t}return r},Object.defineProperty(c.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),c}(),CountedSet=function(){function e(){this.set={}}return e.prototype.add=function(e,t){this.set[e]=null===t||t},e.prototype.contains=function(e){return contains(this.set,e)},e.prototype.get=function(e){return this.contains(e)?this.set[e]:void 0},e.prototype.remove=function(e){delete this.set[e]},e.prototype.clear=function(){this.set={}},e.prototype.isEmpty=function(){return isEmpty(this.set)},e.prototype.count=function(){return getCount(this.set)},e.prototype.each=function(n){forEach(this.set,function(e,t){return n(e,t)})},e.prototype.keys=function(){var t=[];return forEach(this.set,function(e){t.push(e)}),t},e}(),SparseSnapshotTree=function(){function i(){this.value_=null,this.children_=null}return i.prototype.find=function(e){if(null!=this.value_)return this.value_.getChild(e);if(e.isEmpty()||null==this.children_)return null;var t=e.getFront();return e=e.popFront(),this.children_.contains(t)?this.children_.get(t).find(e):null},i.prototype.remember=function(e,t){if(e.isEmpty())this.value_=t,this.children_=null;else if(null!==this.value_)this.value_=this.value_.updateChild(e,t);else{null==this.children_&&(this.children_=new CountedSet);var n=e.getFront();this.children_.contains(n)||this.children_.add(n,new i);var r=this.children_.get(n);e=e.popFront(),r.remember(e,t)}},i.prototype.forget=function(e){if(e.isEmpty())return this.value_=null,!(this.children_=null);if(null!==this.value_){if(this.value_.isLeafNode())return!1;var t=this.value_;this.value_=null;var n=this;return t.forEachChild(PRIORITY_INDEX,function(e,t){n.remember(new Path(e),t)}),this.forget(e)}if(null!==this.children_){var r=e.getFront();return e=e.popFront(),this.children_.contains(r)&&this.children_.get(r).forget(e)&&this.children_.remove(r),!!this.children_.isEmpty()&&!(this.children_=null)}return!0},i.prototype.forEachTree=function(r,i){null!==this.value_?i(r,this.value_):this.forEachChild(function(e,t){var n=new Path(r.toString()+"/"+e);t.forEachTree(n,i)})},i.prototype.forEachChild=function(n){null!==this.children_&&this.children_.each(function(e,t){n(e,t)})},i}(),generateWithValues=function(e){return(e=e||{}).timestamp=e.timestamp||(new Date).getTime(),e},resolveDeferredValue=function(e,t){return e&&"object"==typeof e?(assert(".sv"in e,"Unexpected leaf node or priority contents"),t[e[".sv"]]):e},resolveDeferredValueTree=function(e,n){var r=new SparseSnapshotTree;return e.forEachTree(new Path(""),function(e,t){r.remember(e,resolveDeferredValueSnapshot(t,n))}),r},resolveDeferredValueSnapshot=function(e,r){var i,t=e.getPriority().val(),n=resolveDeferredValue(t,r);if(e.isLeafNode()){var o=e,a=resolveDeferredValue(o.getValue(),r);return a!==o.getValue()||n!==o.getPriority().val()?new LeafNode(a,nodeFromJSON$1(n)):e}var s=e;return n!==(i=s).getPriority().val()&&(i=i.updatePriority(new LeafNode(n))),s.forEachChild(PRIORITY_INDEX,function(e,t){var n=resolveDeferredValueSnapshot(t,r);n!==t&&(i=i.updateImmediateChild(e,n))}),i},OperationType,ruc;ruc=OperationType||(OperationType={}),ruc[ruc.OVERWRITE=0]="OVERWRITE",ruc[ruc.MERGE=1]="MERGE",ruc[ruc.ACK_USER_WRITE=2]="ACK_USER_WRITE",ruc[ruc.LISTEN_COMPLETE=3]="LISTEN_COMPLETE";var OperationSource=function(){function t(e,t,n,r){this.fromUser=e,this.fromServer=t,this.queryId=n,this.tagged=r,assert(!r||t,"Tagged queries must be from server.")}return t.User=new t(!0,!1,null,!1),t.Server=new t(!1,!0,null,!1),t.forServerTaggedQuery=function(e){return new t(!1,!0,e,!0)},t}(),AckUserWrite=function(){function n(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=OperationType.ACK_USER_WRITE,this.source=OperationSource.User}return n.prototype.operationForChild=function(e){if(this.path.isEmpty()){if(null!=this.affectedTree.value)return assert(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var t=this.affectedTree.subtree(new Path(e));return new n(Path.Empty,t,this.revert)}return assert(this.path.getFront()===e,"operationForChild called for unrelated child."),new n(this.path.popFront(),this.affectedTree,this.revert)},n}(),emptyChildrenSingleton,EmptyChildren=function(){return emptyChildrenSingleton||(emptyChildrenSingleton=new SortedMap(stringCompare)),emptyChildrenSingleton},ImmutableTree=function(){function o(e,t){void 0===t&&(t=EmptyChildren()),this.value=e,this.children=t}return o.fromObject=function(e){var n=o.Empty;return forEach(e,function(e,t){n=n.set(new Path(e),t)}),n},o.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},o.prototype.findRootMostMatchingPathAndValue=function(e,t){if(null!=this.value&&t(this.value))return{path:Path.Empty,value:this.value};if(e.isEmpty())return null;var n=e.getFront(),r=this.children.get(n);if(null!==r){var i=r.findRootMostMatchingPathAndValue(e.popFront(),t);return null!=i?{path:new Path(n).child(i.path),value:i.value}:null}return null},o.prototype.findRootMostValueAndPath=function(e){return this.findRootMostMatchingPathAndValue(e,function(){return!0})},o.prototype.subtree=function(e){if(e.isEmpty())return this;var t=e.getFront(),n=this.children.get(t);return null!==n?n.subtree(e.popFront()):o.Empty},o.prototype.set=function(e,t){if(e.isEmpty())return new o(t,this.children);var n=e.getFront(),r=(this.children.get(n)||o.Empty).set(e.popFront(),t),i=this.children.insert(n,r);return new o(this.value,i)},o.prototype.remove=function(e){if(e.isEmpty())return this.children.isEmpty()?o.Empty:new o(null,this.children);var t=e.getFront(),n=this.children.get(t);if(n){var r=n.remove(e.popFront()),i=void 0;return i=r.isEmpty()?this.children.remove(t):this.children.insert(t,r),null===this.value&&i.isEmpty()?o.Empty:new o(this.value,i)}return this},o.prototype.get=function(e){if(e.isEmpty())return this.value;var t=e.getFront(),n=this.children.get(t);return n?n.get(e.popFront()):null},o.prototype.setTree=function(e,t){if(e.isEmpty())return t;var n,r=e.getFront(),i=(this.children.get(r)||o.Empty).setTree(e.popFront(),t);return n=i.isEmpty()?this.children.remove(r):this.children.insert(r,i),new o(this.value,n)},o.prototype.fold=function(e){return this.fold_(Path.Empty,e)},o.prototype.fold_=function(n,r){var i={};return this.children.inorderTraversal(function(e,t){i[e]=t.fold_(n.child(e),r)}),r(n,this.value,i)},o.prototype.findOnPath=function(e,t){return this.findOnPath_(e,Path.Empty,t)},o.prototype.findOnPath_=function(e,t,n){var r=!!this.value&&n(t,this.value);if(r)return r;if(e.isEmpty())return null;var i=e.getFront(),o=this.children.get(i);return o?o.findOnPath_(e.popFront(),t.child(i),n):null},o.prototype.foreachOnPath=function(e,t){return this.foreachOnPath_(e,Path.Empty,t)},o.prototype.foreachOnPath_=function(e,t,n){if(e.isEmpty())return this;this.value&&n(t,this.value);var r=e.getFront(),i=this.children.get(r);return i?i.foreachOnPath_(e.popFront(),t.child(r),n):o.Empty},o.prototype.foreach=function(e){this.foreach_(Path.Empty,e)},o.prototype.foreach_=function(n,r){this.children.inorderTraversal(function(e,t){t.foreach_(n.child(e),r)}),this.value&&r(n,this.value)},o.prototype.foreachChild=function(n){this.children.inorderTraversal(function(e,t){t.value&&n(e,t.value)})},o.Empty=new o(null),o}(),ListenComplete=function(){function t(e,t){this.source=e,this.path=t,this.type=OperationType.LISTEN_COMPLETE}return t.prototype.operationForChild=function(e){return this.path.isEmpty()?new t(this.source,Path.Empty):new t(this.source,this.path.popFront())},t}(),Overwrite=function(){function t(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=OperationType.OVERWRITE}return t.prototype.operationForChild=function(e){return this.path.isEmpty()?new t(this.source,Path.Empty,this.snap.getImmediateChild(e)):new t(this.source,this.path.popFront(),this.snap)},t}(),Merge=function(){function n(e,t,n){this.source=e,this.path=t,this.children=n,this.type=OperationType.MERGE}return n.prototype.operationForChild=function(e){if(this.path.isEmpty()){var t=this.children.subtree(new Path(e));return t.isEmpty()?null:t.value?new Overwrite(this.source,Path.Empty,t.value):new n(this.source,Path.Empty,t)}return assert(this.path.getFront()===e,"Can't get a merge for a child not on the path of the operation"),new n(this.source,this.path.popFront(),this.children)},n.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},n}(),CacheNode=function(){function e(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}return e.prototype.isFullyInitialized=function(){return this.fullyInitialized_},e.prototype.isFiltered=function(){return this.filtered_},e.prototype.isCompleteForPath=function(e){if(e.isEmpty())return this.isFullyInitialized()&&!this.filtered_;var t=e.getFront();return this.isCompleteForChild(t)},e.prototype.isCompleteForChild=function(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)},e.prototype.getNode=function(){return this.node_},e}(),ViewCache=function(){function r(e,t){this.eventCache_=e,this.serverCache_=t}return r.prototype.updateEventSnap=function(e,t,n){return new r(new CacheNode(e,t,n),this.serverCache_)},r.prototype.updateServerSnap=function(e,t,n){return new r(this.eventCache_,new CacheNode(e,t,n))},r.prototype.getEventCache=function(){return this.eventCache_},r.prototype.getCompleteEventSnap=function(){return this.eventCache_.isFullyInitialized()?this.eventCache_.getNode():null},r.prototype.getServerCache=function(){return this.serverCache_},r.prototype.getCompleteServerSnap=function(){return this.serverCache_.isFullyInitialized()?this.serverCache_.getNode():null},r.Empty=new r(new CacheNode(ChildrenNode.EMPTY_NODE,!1,!1),new CacheNode(ChildrenNode.EMPTY_NODE,!1,!1)),r}(),Change=function(){function r(e,t,n,r,i){this.type=e,this.snapshotNode=t,this.childName=n,this.oldSnap=r,this.prevName=i}return r.valueChange=function(e){return new r(r.VALUE,e)},r.childAddedChange=function(e,t){return new r(r.CHILD_ADDED,t,e)},r.childRemovedChange=function(e,t){return new r(r.CHILD_REMOVED,t,e)},r.childChangedChange=function(e,t,n){return new r(r.CHILD_CHANGED,t,e,n)},r.childMovedChange=function(e,t){return new r(r.CHILD_MOVED,t,e)},r.CHILD_ADDED="child_added",r.CHILD_REMOVED="child_removed",r.CHILD_CHANGED="child_changed",r.CHILD_MOVED="child_moved",r.VALUE="value",r}(),IndexedFilter=function(){function e(e){this.index_=e}return e.prototype.updateChild=function(e,t,n,r,i,o){assert(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");var a=e.getImmediateChild(t);return a.getChild(r).equals(n.getChild(r))&&a.isEmpty()==n.isEmpty()?e:(null!=o&&(n.isEmpty()?e.hasChild(t)?o.trackChildChange(Change.childRemovedChange(t,a)):assert(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Change.childAddedChange(t,n)):o.trackChildChange(Change.childChangedChange(t,n,a))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))},e.prototype.updateFullNode=function(r,n,i){return null!=i&&(r.isLeafNode()||r.forEachChild(PRIORITY_INDEX,function(e,t){n.hasChild(e)||i.trackChildChange(Change.childRemovedChange(e,t))}),n.isLeafNode()||n.forEachChild(PRIORITY_INDEX,function(e,t){if(r.hasChild(e)){var n=r.getImmediateChild(e);n.equals(t)||i.trackChildChange(Change.childChangedChange(e,t,n))}else i.trackChildChange(Change.childAddedChange(e,t))})),n.withIndex(this.index_)},e.prototype.updatePriority=function(e,t){return e.isEmpty()?ChildrenNode.EMPTY_NODE:e.updatePriority(t)},e.prototype.filtersNodes=function(){return!1},e.prototype.getIndexedFilter=function(){return this},e.prototype.getIndex=function(){return this.index_},e}(),ChildChangeAccumulator=function(){function e(){this.changeMap_={}}return e.prototype.trackChildChange=function(e){var t=e.type,n=e.childName;assert(t==Change.CHILD_ADDED||t==Change.CHILD_CHANGED||t==Change.CHILD_REMOVED,"Only child changes supported for tracking"),assert(".priority"!==n,"Only non-priority child changes can be tracked.");var r=safeGet(this.changeMap_,n);if(r){var i=r.type;if(t==Change.CHILD_ADDED&&i==Change.CHILD_REMOVED)this.changeMap_[n]=Change.childChangedChange(n,e.snapshotNode,r.snapshotNode);else if(t==Change.CHILD_REMOVED&&i==Change.CHILD_ADDED)delete this.changeMap_[n];else if(t==Change.CHILD_REMOVED&&i==Change.CHILD_CHANGED)this.changeMap_[n]=Change.childRemovedChange(n,r.oldSnap);else if(t==Change.CHILD_CHANGED&&i==Change.CHILD_ADDED)this.changeMap_[n]=Change.childAddedChange(n,e.snapshotNode);else{if(t!=Change.CHILD_CHANGED||i!=Change.CHILD_CHANGED)throw assertionError("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap_[n]=Change.childChangedChange(n,e.snapshotNode,r.oldSnap)}}else this.changeMap_[n]=e},e.prototype.getChanges=function(){return getValues(this.changeMap_)},e}(),NoCompleteChildSource_=function(){function e(){}return e.prototype.getCompleteChild=function(e){return null},e.prototype.getChildAfterChild=function(e,t,n){return null},e}(),NO_COMPLETE_CHILD_SOURCE=new NoCompleteChildSource_,WriteTreeCompleteChildSource=function(){function e(e,t,n){void 0===n&&(n=null),this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}return e.prototype.getCompleteChild=function(e){var t=this.viewCache_.getEventCache();if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);var n=null!=this.optCompleteServerCache_?new CacheNode(this.optCompleteServerCache_,!0,!1):this.viewCache_.getServerCache();return this.writes_.calcCompleteChild(e,n)},e.prototype.getChildAfterChild=function(e,t,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:this.viewCache_.getCompleteServerSnap(),i=this.writes_.calcIndexedSlice(r,t,1,n,e);return 0===i.length?null:i[0]},e}(),ProcessorResult=function(e,t){this.viewCache=e,this.changes=t},ViewProcessor=function(){function h(e){this.filter_=e}return h.prototype.assertIndexed=function(e){assert(e.getEventCache().getNode().isIndexed(this.filter_.getIndex()),"Event snap not indexed"),assert(e.getServerCache().getNode().isIndexed(this.filter_.getIndex()),"Server snap not indexed")},h.prototype.applyOperation=function(e,t,n,r){var i,o,a=new ChildChangeAccumulator;if(t.type===OperationType.OVERWRITE){var s=t;s.source.fromUser?i=this.applyUserOverwrite_(e,s.path,s.snap,n,r,a):(assert(s.source.fromServer,"Unknown source."),o=s.source.tagged||e.getServerCache().isFiltered()&&!s.path.isEmpty(),i=this.applyServerOverwrite_(e,s.path,s.snap,n,r,o,a))}else if(t.type===OperationType.MERGE){var u=t;u.source.fromUser?i=this.applyUserMerge_(e,u.path,u.children,n,r,a):(assert(u.source.fromServer,"Unknown source."),o=u.source.tagged||e.getServerCache().isFiltered(),i=this.applyServerMerge_(e,u.path,u.children,n,r,o,a))}else if(t.type===OperationType.ACK_USER_WRITE){var c=t;i=c.revert?this.revertUserWrite_(e,c.path,n,r,a):this.ackUserWrite_(e,c.path,c.affectedTree,n,r,a)}else{if(t.type!==OperationType.LISTEN_COMPLETE)throw assertionError("Unknown operation type: "+t.type);i=this.listenComplete_(e,t.path,n,a)}var l=a.getChanges();return h.maybeAddValueEvent_(e,i,l),new ProcessorResult(i,l)},h.maybeAddValueEvent_=function(e,t,n){var r=t.getEventCache();if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=e.getCompleteEventSnap();(0<n.length||!e.getEventCache().isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(Change.valueChange(t.getCompleteEventSnap()))}},h.prototype.generateEventCacheAfterServerEvent_=function(e,t,n,r,i){var o=e.getEventCache();if(null!=n.shadowingWrite(t))return e;var a=void 0,s=void 0;if(t.isEmpty())if(assert(e.getServerCache().isFullyInitialized(),"If change path is empty, we must have complete server data"),e.getServerCache().isFiltered()){var u=e.getCompleteServerSnap(),c=u instanceof ChildrenNode?u:ChildrenNode.EMPTY_NODE,l=n.calcCompleteEventChildren(c);a=this.filter_.updateFullNode(e.getEventCache().getNode(),l,i)}else{var h=n.calcCompleteEventCache(e.getCompleteServerSnap());a=this.filter_.updateFullNode(e.getEventCache().getNode(),h,i)}else{var f=t.getFront();if(".priority"==f){assert(1==t.getLength(),"Can't have a priority with additional path components");var d=o.getNode();s=e.getServerCache().getNode();var p=n.calcEventCacheAfterServerOverwrite(t,d,s);a=null!=p?this.filter_.updatePriority(d,p):o.getNode()}else{var v=t.popFront(),m=void 0;if(o.isCompleteForChild(f)){s=e.getServerCache().getNode();var g=n.calcEventCacheAfterServerOverwrite(t,o.getNode(),s);m=null!=g?o.getNode().getImmediateChild(f).updateChild(v,g):o.getNode().getImmediateChild(f)}else m=n.calcCompleteChild(f,e.getServerCache());a=null!=m?this.filter_.updateChild(o.getNode(),f,m,v,r,i):o.getNode()}}return e.updateEventSnap(a,o.isFullyInitialized()||t.isEmpty(),this.filter_.filtersNodes())},h.prototype.applyServerOverwrite_=function(e,t,n,r,i,o,a){var s,u=e.getServerCache(),c=o?this.filter_:this.filter_.getIndexedFilter();if(t.isEmpty())s=c.updateFullNode(u.getNode(),n,null);else if(c.filtersNodes()&&!u.isFiltered()){var l=u.getNode().updateChild(t,n);s=c.updateFullNode(u.getNode(),l,null)}else{var h=t.getFront();if(!u.isCompleteForPath(t)&&1<t.getLength())return e;var f=t.popFront(),d=u.getNode().getImmediateChild(h).updateChild(f,n);s=".priority"==h?c.updatePriority(u.getNode(),d):c.updateChild(u.getNode(),h,d,f,NO_COMPLETE_CHILD_SOURCE,null)}var p=e.updateServerSnap(s,u.isFullyInitialized()||t.isEmpty(),c.filtersNodes()),v=new WriteTreeCompleteChildSource(r,p,i);return this.generateEventCacheAfterServerEvent_(p,t,r,v,a)},h.prototype.applyUserOverwrite_=function(e,t,n,r,i,o){var a,s,u=e.getEventCache(),c=new WriteTreeCompleteChildSource(r,e,i);if(t.isEmpty())s=this.filter_.updateFullNode(e.getEventCache().getNode(),n,o),a=e.updateEventSnap(s,!0,this.filter_.filtersNodes());else{var l=t.getFront();if(".priority"===l)s=this.filter_.updatePriority(e.getEventCache().getNode(),n),a=e.updateEventSnap(s,u.isFullyInitialized(),u.isFiltered());else{var h=t.popFront(),f=u.getNode().getImmediateChild(l),d=void 0;if(h.isEmpty())d=n;else{var p=c.getCompleteChild(l);d=null!=p?".priority"===h.getBack()&&p.getChild(h.parent()).isEmpty()?p:p.updateChild(h,n):ChildrenNode.EMPTY_NODE}if(f.equals(d))a=e;else{var v=this.filter_.updateChild(u.getNode(),l,d,h,c,o);a=e.updateEventSnap(v,u.isFullyInitialized(),this.filter_.filtersNodes())}}}return a},h.cacheHasChild_=function(e,t){return e.getEventCache().isCompleteForChild(t)},h.prototype.applyUserMerge_=function(r,i,e,o,a,s){var u=this,c=r;return e.foreach(function(e,t){var n=i.child(e);h.cacheHasChild_(r,n.getFront())&&(c=u.applyUserOverwrite_(c,n,t,o,a,s))}),e.foreach(function(e,t){var n=i.child(e);h.cacheHasChild_(r,n.getFront())||(c=u.applyUserOverwrite_(c,n,t,o,a,s))}),c},h.prototype.applyMerge_=function(n,e){return e.foreach(function(e,t){n=n.updateChild(e,t)}),n},h.prototype.applyServerMerge_=function(o,e,t,a,s,u,c){var l=this;if(o.getServerCache().getNode().isEmpty()&&!o.getServerCache().isFullyInitialized())return o;var n,h=o;n=e.isEmpty()?t:ImmutableTree.Empty.setTree(e,t);var f=o.getServerCache().getNode();return n.children.inorderTraversal(function(e,t){if(f.hasChild(e)){var n=o.getServerCache().getNode().getImmediateChild(e),r=l.applyMerge_(n,t);h=l.applyServerOverwrite_(h,new Path(e),r,a,s,u,c)}}),n.children.inorderTraversal(function(e,t){var n=!o.getServerCache().isCompleteForChild(e)&&null==t.value;if(!f.hasChild(e)&&!n){var r=o.getServerCache().getNode().getImmediateChild(e),i=l.applyMerge_(r,t);h=l.applyServerOverwrite_(h,new Path(e),i,a,s,u,c)}}),h},h.prototype.ackUserWrite_=function(e,r,t,n,i,o){if(null!=n.shadowingWrite(r))return e;var a=e.getServerCache().isFiltered(),s=e.getServerCache();if(null!=t.value){if(r.isEmpty()&&s.isFullyInitialized()||s.isCompleteForPath(r))return this.applyServerOverwrite_(e,r,s.getNode().getChild(r),n,i,a,o);if(r.isEmpty()){var u=ImmutableTree.Empty;return s.getNode().forEachChild(KEY_INDEX,function(e,t){u=u.set(new Path(e),t)}),this.applyServerMerge_(e,r,u,n,i,a,o)}return e}var c=ImmutableTree.Empty;return t.foreach(function(e,t){var n=r.child(e);s.isCompleteForPath(n)&&(c=c.set(e,s.getNode().getChild(n)))}),this.applyServerMerge_(e,r,c,n,i,a,o)},h.prototype.listenComplete_=function(e,t,n,r){var i=e.getServerCache(),o=e.updateServerSnap(i.getNode(),i.isFullyInitialized()||t.isEmpty(),i.isFiltered());return this.generateEventCacheAfterServerEvent_(o,t,n,NO_COMPLETE_CHILD_SOURCE,r)},h.prototype.revertUserWrite_=function(e,t,n,r,i){var o;if(null!=n.shadowingWrite(t))return e;var a=new WriteTreeCompleteChildSource(n,e,r),s=e.getEventCache().getNode(),u=void 0;if(t.isEmpty()||".priority"===t.getFront()){var c=void 0;if(e.getServerCache().isFullyInitialized())c=n.calcCompleteEventCache(e.getCompleteServerSnap());else{var l=e.getServerCache().getNode();assert(l instanceof ChildrenNode,"serverChildren would be complete if leaf node"),c=n.calcCompleteEventChildren(l)}c=c,u=this.filter_.updateFullNode(s,c,i)}else{var h=t.getFront(),f=n.calcCompleteChild(h,e.getServerCache());null==f&&e.getServerCache().isCompleteForChild(h)&&(f=s.getImmediateChild(h)),(u=null!=f?this.filter_.updateChild(s,h,f,t.popFront(),a,i):e.getEventCache().getNode().hasChild(h)?this.filter_.updateChild(s,h,ChildrenNode.EMPTY_NODE,t.popFront(),a,i):s).isEmpty()&&e.getServerCache().isFullyInitialized()&&(o=n.calcCompleteEventCache(e.getCompleteServerSnap())).isLeafNode()&&(u=this.filter_.updateFullNode(u,o,i))}return o=e.getServerCache().isFullyInitialized()||null!=n.shadowingWrite(Path.Empty),e.updateEventSnap(u,o,this.filter_.filtersNodes())},h}(),EventGenerator=function(){function e(e){this.query_=e,this.index_=this.query_.getQueryParams().getIndex()}return e.prototype.generateEventsForChanges=function(e,t,n){var r=this,i=[],o=[];return e.forEach(function(e){e.type===Change.CHILD_CHANGED&&r.index_.indexedValueChanged(e.oldSnap,e.snapshotNode)&&o.push(Change.childMovedChange(e.childName,e.snapshotNode))}),this.generateEventsForType_(i,Change.CHILD_REMOVED,e,n,t),this.generateEventsForType_(i,Change.CHILD_ADDED,e,n,t),this.generateEventsForType_(i,Change.CHILD_MOVED,o,n,t),this.generateEventsForType_(i,Change.CHILD_CHANGED,e,n,t),this.generateEventsForType_(i,Change.VALUE,e,n,t),i},e.prototype.generateEventsForType_=function(r,t,e,i,o){var a=this,n=e.filter(function(e){return e.type===t});n.sort(this.compareChanges_.bind(this)),n.forEach(function(t){var n=a.materializeSingleChange_(t,o);i.forEach(function(e){e.respondsTo(t.type)&&r.push(e.createEvent(n,a.query_))})})},e.prototype.materializeSingleChange_=function(e,t){return"value"===e.type||"child_removed"===e.type||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,this.index_)),e},e.prototype.compareChanges_=function(e,t){if(null==e.childName||null==t.childName)throw assertionError("Should only compare child_ events.");var n=new NamedNode(e.childName,e.snapshotNode),r=new NamedNode(t.childName,t.snapshotNode);return this.index_.compare(n,r)},e}(),View=function(){function e(e,t){this.query_=e,this.eventRegistrations_=[];var n=this.query_.getQueryParams(),r=new IndexedFilter(n.getIndex()),i=n.getNodeFilter();this.processor_=new ViewProcessor(i);var o=t.getServerCache(),a=t.getEventCache(),s=r.updateFullNode(ChildrenNode.EMPTY_NODE,o.getNode(),null),u=i.updateFullNode(ChildrenNode.EMPTY_NODE,a.getNode(),null),c=new CacheNode(s,o.isFullyInitialized(),r.filtersNodes()),l=new CacheNode(u,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=new ViewCache(l,c),this.eventGenerator_=new EventGenerator(this.query_)}return e.prototype.getQuery=function(){return this.query_},e.prototype.getServerCache=function(){return this.viewCache_.getServerCache().getNode()},e.prototype.getCompleteServerCache=function(e){var t=this.viewCache_.getCompleteServerSnap();return t&&(this.query_.getQueryParams().loadsAllData()||!e.isEmpty()&&!t.getImmediateChild(e.getFront()).isEmpty())?t.getChild(e):null},e.prototype.isEmpty=function(){return 0===this.eventRegistrations_.length},e.prototype.addEventRegistration=function(e){this.eventRegistrations_.push(e)},e.prototype.removeEventRegistration=function(e,n){var r=[];if(n){assert(null==e,"A cancel should cancel all event registrations.");var i=this.query_.path;this.eventRegistrations_.forEach(function(e){n=n;var t=e.createCancelEvent(n,i);t&&r.push(t)})}if(e){for(var t=[],o=0;o<this.eventRegistrations_.length;++o){var a=this.eventRegistrations_[o];if(a.matches(e)){if(e.hasAnyCallback()){t=t.concat(this.eventRegistrations_.slice(o+1));break}}else t.push(a)}this.eventRegistrations_=t}else this.eventRegistrations_=[];return r},e.prototype.applyOperation=function(e,t,n){e.type===OperationType.MERGE&&null!==e.source.queryId&&(assert(this.viewCache_.getCompleteServerSnap(),"We should always have a full cache before handling merges"),assert(this.viewCache_.getCompleteEventSnap(),"Missing event cache, even though we have a server cache"));var r=this.viewCache_,i=this.processor_.applyOperation(r,e,t,n);return this.processor_.assertIndexed(i.viewCache),assert(i.viewCache.getServerCache().isFullyInitialized()||!r.getServerCache().isFullyInitialized(),"Once a server snap is complete, it should never go back"),this.viewCache_=i.viewCache,this.generateEventsForChanges_(i.changes,i.viewCache.getEventCache().getNode(),null)},e.prototype.getInitialEvents=function(e){var t=this.viewCache_.getEventCache(),n=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(PRIORITY_INDEX,function(e,t){n.push(Change.childAddedChange(e,t))}),t.isFullyInitialized()&&n.push(Change.valueChange(t.getNode())),this.generateEventsForChanges_(n,t.getNode(),e)},e.prototype.generateEventsForChanges_=function(e,t,n){var r=n?[n]:this.eventRegistrations_;return this.eventGenerator_.generateEventsForChanges(e,t,r)},e}(),__referenceConstructor$1,SyncPoint=function(){function c(){this.views_={}}return Object.defineProperty(c,"__referenceConstructor",{get:function(){return assert(__referenceConstructor$1,"Reference.ts has not been loaded"),__referenceConstructor$1},set:function(e){assert(!__referenceConstructor$1,"__referenceConstructor has already been defined"),__referenceConstructor$1=e},enumerable:!0,configurable:!0}),c.prototype.isEmpty=function(){return isEmpty(this.views_)},c.prototype.applyOperation=function(n,r,i){var e=n.source.queryId;if(null!==e){var t=safeGet(this.views_,e);return assert(null!=t,"SyncTree gave us an op for an invalid query."),t.applyOperation(n,r,i)}var o=[];return forEach(this.views_,function(e,t){o=o.concat(t.applyOperation(n,r,i))}),o},c.prototype.addEventRegistration=function(e,t,n,r,i){var o=e.queryIdentifier(),a=safeGet(this.views_,o);if(!a){var s=n.calcCompleteEventCache(i?r:null),u=!1;s?u=!0:(s=r instanceof ChildrenNode?n.calcCompleteEventChildren(r):ChildrenNode.EMPTY_NODE,u=!1);var c=new ViewCache(new CacheNode(s,u,!1),new CacheNode(r,i,!1));a=new View(e,c),this.views_[o]=a}return a.addEventRegistration(t),a.getInitialEvents(t)},c.prototype.removeEventRegistration=function(e,n,r){var t=e.queryIdentifier(),i=[],o=[],a=this.hasCompleteView();if("default"===t){var s=this;forEach(this.views_,function(e,t){o=o.concat(t.removeEventRegistration(n,r)),t.isEmpty()&&(delete s.views_[e],t.getQuery().getQueryParams().loadsAllData()||i.push(t.getQuery()))})}else{var u=safeGet(this.views_,t);u&&(o=o.concat(u.removeEventRegistration(n,r)),u.isEmpty()&&(delete this.views_[t],u.getQuery().getQueryParams().loadsAllData()||i.push(u.getQuery())))}return a&&!this.hasCompleteView()&&i.push(new c.__referenceConstructor(e.repo,e.path)),{removed:i,events:o}},c.prototype.getQueryViews=function(){var t=this;return Object.keys(this.views_).map(function(e){return t.views_[e]}).filter(function(e){return!e.getQuery().getQueryParams().loadsAllData()})},c.prototype.getCompleteServerCache=function(n){var r=null;return forEach(this.views_,function(e,t){r=r||t.getCompleteServerCache(n)}),r},c.prototype.viewForQuery=function(e){if(e.getQueryParams().loadsAllData())return this.getCompleteView();var t=e.queryIdentifier();return safeGet(this.views_,t)},c.prototype.viewExistsForQuery=function(e){return null!=this.viewForQuery(e)},c.prototype.hasCompleteView=function(){return null!=this.getCompleteView()},c.prototype.getCompleteView=function(){return findValue(this.views_,function(e){return e.getQuery().getQueryParams().loadsAllData()})||null},c}(),CompoundWrite=function(){function s(e){this.writeTree_=e}return s.prototype.addWrite=function(e,t){if(e.isEmpty())return new s(new ImmutableTree(t));var n=this.writeTree_.findRootMostValueAndPath(e);if(null!=n){var r=n.path,i=n.value,o=Path.relativePath(r,e);return i=i.updateChild(o,t),new s(this.writeTree_.set(r,i))}var a=new ImmutableTree(t);return new s(this.writeTree_.setTree(e,a))},s.prototype.addWrites=function(n,e){var r=this;return forEach(e,function(e,t){r=r.addWrite(n.child(e),t)}),r},s.prototype.removeWrite=function(e){return e.isEmpty()?s.Empty:new s(this.writeTree_.setTree(e,ImmutableTree.Empty))},s.prototype.hasCompleteWrite=function(e){return null!=this.getCompleteNode(e)},s.prototype.getCompleteNode=function(e){var t=this.writeTree_.findRootMostValueAndPath(e);return null!=t?this.writeTree_.get(t.path).getChild(Path.relativePath(t.path,e)):null},s.prototype.getCompleteChildren=function(){var n=[],e=this.writeTree_.value;return null!=e?e.isLeafNode()||e.forEachChild(PRIORITY_INDEX,function(e,t){n.push(new NamedNode(e,t))}):this.writeTree_.children.inorderTraversal(function(e,t){null!=t.value&&n.push(new NamedNode(e,t.value))}),n},s.prototype.childCompoundWrite=function(e){if(e.isEmpty())return this;var t=this.getCompleteNode(e);return new s(null!=t?new ImmutableTree(t):this.writeTree_.subtree(e))},s.prototype.isEmpty=function(){return this.writeTree_.isEmpty()},s.prototype.apply=function(e){return s.applySubtreeWrite_(Path.Empty,this.writeTree_,e)},s.Empty=new s(new ImmutableTree(null)),s.applySubtreeWrite_=function(n,e,r){if(null!=e.value)return r.updateChild(n,e.value);var i=null;return e.children.inorderTraversal(function(e,t){".priority"===e?(assert(null!==t.value,"Priority writes must always be leaf nodes"),i=t.value):r=s.applySubtreeWrite_(n.child(e),t,r)}),r.getChild(n).isEmpty()||null===i||(r=r.updateChild(n.child(".priority"),i)),r},s}(),WriteTree=function(){function c(){this.visibleWrites_=CompoundWrite.Empty,this.allWrites_=[],this.lastWriteId_=-1}return c.prototype.childWrites=function(e){return new WriteTreeRef(e,this)},c.prototype.addOverwrite=function(e,t,n,r){assert(n>this.lastWriteId_,"Stacking an older write on top of newer ones"),void 0===r&&(r=!0),this.allWrites_.push({path:e,snap:t,writeId:n,visible:r}),r&&(this.visibleWrites_=this.visibleWrites_.addWrite(e,t)),this.lastWriteId_=n},c.prototype.addMerge=function(e,t,n){assert(n>this.lastWriteId_,"Stacking an older merge on top of newer ones"),this.allWrites_.push({path:e,children:t,writeId:n,visible:!0}),this.visibleWrites_=this.visibleWrites_.addWrites(e,t),this.lastWriteId_=n},c.prototype.getWrite=function(e){for(var t=0;t<this.allWrites_.length;t++){var n=this.allWrites_[t];if(n.writeId===e)return n}return null},c.prototype.removeWrite=function(t){var n=this,e=this.allWrites_.findIndex(function(e){return e.writeId===t});assert(0<=e,"removeWrite called with nonexistent writeId.");var r=this.allWrites_[e];this.allWrites_.splice(e,1);for(var i=r.visible,o=!1,a=this.allWrites_.length-1;i&&0<=a;){var s=this.allWrites_[a];s.visible&&(e<=a&&this.recordContainsPath_(s,r.path)?i=!1:r.path.contains(s.path)&&(o=!0)),a--}if(i){if(o)return this.resetTree_(),!0;if(r.snap)this.visibleWrites_=this.visibleWrites_.removeWrite(r.path);else{var u=r.children;forEach(u,function(e){n.visibleWrites_=n.visibleWrites_.removeWrite(r.path.child(e))})}return!0}return!1},c.prototype.getCompleteWriteData=function(e){return this.visibleWrites_.getCompleteNode(e)},c.prototype.calcCompleteEventCache=function(t,e,n,r){if(n||r){var i=this.visibleWrites_.childCompoundWrite(t);if(!r&&i.isEmpty())return e;if(r||null!=e||i.hasCompleteWrite(Path.Empty)){var o=c.layerTree_(this.allWrites_,function(e){return(e.visible||r)&&(!n||!~n.indexOf(e.writeId))&&(e.path.contains(t)||t.contains(e.path))},t);return u=e||ChildrenNode.EMPTY_NODE,o.apply(u)}return null}var a=this.visibleWrites_.getCompleteNode(t);if(null!=a)return a;var s=this.visibleWrites_.childCompoundWrite(t);if(s.isEmpty())return e;if(null!=e||s.hasCompleteWrite(Path.Empty)){var u=e||ChildrenNode.EMPTY_NODE;return s.apply(u)}return null},c.prototype.calcCompleteEventChildren=function(e,t){var r=ChildrenNode.EMPTY_NODE,n=this.visibleWrites_.getCompleteNode(e);if(n)return n.isLeafNode()||n.forEachChild(PRIORITY_INDEX,function(e,t){r=r.updateImmediateChild(e,t)}),r;if(t){var i=this.visibleWrites_.childCompoundWrite(e);return t.forEachChild(PRIORITY_INDEX,function(e,t){var n=i.childCompoundWrite(new Path(e)).apply(t);r=r.updateImmediateChild(e,n)}),i.getCompleteChildren().forEach(function(e){r=r.updateImmediateChild(e.name,e.node)}),r}return this.visibleWrites_.childCompoundWrite(e).getCompleteChildren().forEach(function(e){r=r.updateImmediateChild(e.name,e.node)}),r},c.prototype.calcEventCacheAfterServerOverwrite=function(e,t,n,r){assert(n||r,"Either existingEventSnap or existingServerSnap must exist");var i=e.child(t);if(this.visibleWrites_.hasCompleteWrite(i))return null;var o=this.visibleWrites_.childCompoundWrite(i);return o.isEmpty()?r.getChild(t):o.apply(r.getChild(t))},c.prototype.calcCompleteChild=function(e,t,n){var r=e.child(t),i=this.visibleWrites_.getCompleteNode(r);return null!=i?i:n.isCompleteForChild(t)?this.visibleWrites_.childCompoundWrite(r).apply(n.getNode().getImmediateChild(t)):null},c.prototype.shadowingWrite=function(e){return this.visibleWrites_.getCompleteNode(e)},c.prototype.calcIndexedSlice=function(e,t,n,r,i,o){var a,s=this.visibleWrites_.childCompoundWrite(e),u=s.getCompleteNode(Path.Empty);if(null!=u)a=u;else{if(null==t)return[];a=s.apply(t)}if((a=a.withIndex(o)).isEmpty()||a.isLeafNode())return[];for(var c=[],l=o.getCompare(),h=i?a.getReverseIteratorFrom(n,o):a.getIteratorFrom(n,o),f=h.getNext();f&&c.length<r;)0!==l(f,n)&&c.push(f),f=h.getNext();return c},c.prototype.recordContainsPath_=function(n,r){return n.snap?n.path.contains(r):!!findKey(n.children,function(e,t){return n.path.child(t).contains(r)})},c.prototype.resetTree_=function(){this.visibleWrites_=c.layerTree_(this.allWrites_,c.DefaultFilter_,Path.Empty),0<this.allWrites_.length?this.lastWriteId_=this.allWrites_[this.allWrites_.length-1].writeId:this.lastWriteId_=-1},c.DefaultFilter_=function(e){return e.visible},c.layerTree_=function(e,t,n){for(var r=CompoundWrite.Empty,i=0;i<e.length;++i){var o=e[i];if(t(o)){var a=o.path,s=void 0;if(o.snap)n.contains(a)?(s=Path.relativePath(n,a),r=r.addWrite(s,o.snap)):a.contains(n)&&(s=Path.relativePath(a,n),r=r.addWrite(Path.Empty,o.snap.getChild(s)));else{if(!o.children)throw assertionError("WriteRecord should have .snap or .children");if(n.contains(a))s=Path.relativePath(n,a),r=r.addWrites(s,o.children);else if(a.contains(n))if((s=Path.relativePath(a,n)).isEmpty())r=r.addWrites(Path.Empty,o.children);else{var u=safeGet(o.children,s.getFront());if(u){var c=u.getChild(s.popFront());r=r.addWrite(Path.Empty,c)}}}}}return r},c}(),WriteTreeRef=function(){function t(e,t){this.treePath_=e,this.writeTree_=t}return t.prototype.calcCompleteEventCache=function(e,t,n){return this.writeTree_.calcCompleteEventCache(this.treePath_,e,t,n)},t.prototype.calcCompleteEventChildren=function(e){return this.writeTree_.calcCompleteEventChildren(this.treePath_,e)},t.prototype.calcEventCacheAfterServerOverwrite=function(e,t,n){return this.writeTree_.calcEventCacheAfterServerOverwrite(this.treePath_,e,t,n)},t.prototype.shadowingWrite=function(e){return this.writeTree_.shadowingWrite(this.treePath_.child(e))},t.prototype.calcIndexedSlice=function(e,t,n,r,i){return this.writeTree_.calcIndexedSlice(this.treePath_,e,t,n,r,i)},t.prototype.calcCompleteChild=function(e,t){return this.writeTree_.calcCompleteChild(this.treePath_,e,t)},t.prototype.child=function(e){return new t(this.treePath_.child(e),this.writeTree_)},t}(),SyncTree=function(){function g(e){this.listenProvider_=e,this.syncPointTree_=ImmutableTree.Empty,this.pendingWriteTree_=new WriteTree,this.tagToQueryMap_={},this.queryToTagMap_={}}return g.prototype.applyUserOverwrite=function(e,t,n,r){return this.pendingWriteTree_.addOverwrite(e,t,n,r),r?this.applyOperationToSyncPoints_(new Overwrite(OperationSource.User,e,t)):[]},g.prototype.applyUserMerge=function(e,t,n){this.pendingWriteTree_.addMerge(e,t,n);var r=ImmutableTree.fromObject(t);return this.applyOperationToSyncPoints_(new Merge(OperationSource.User,e,r))},g.prototype.ackUserWrite=function(e,t){void 0===t&&(t=!1);var n=this.pendingWriteTree_.getWrite(e);if(this.pendingWriteTree_.removeWrite(e)){var r=ImmutableTree.Empty;return null!=n.snap?r=r.set(Path.Empty,!0):forEach(n.children,function(e,t){r=r.set(new Path(e),t)}),this.applyOperationToSyncPoints_(new AckUserWrite(n.path,r,t))}return[]},g.prototype.applyServerOverwrite=function(e,t){return this.applyOperationToSyncPoints_(new Overwrite(OperationSource.Server,e,t))},g.prototype.applyServerMerge=function(e,t){var n=ImmutableTree.fromObject(t);return this.applyOperationToSyncPoints_(new Merge(OperationSource.Server,e,n))},g.prototype.applyListenComplete=function(e){return this.applyOperationToSyncPoints_(new ListenComplete(OperationSource.Server,e))},g.prototype.applyTaggedQueryOverwrite=function(e,t,n){var r=this.queryKeyForTag_(n);if(null!=r){var i=g.parseQueryKey_(r),o=i.path,a=i.queryId,s=Path.relativePath(o,e),u=new Overwrite(OperationSource.forServerTaggedQuery(a),s,t);return this.applyTaggedOperation_(o,u)}return[]},g.prototype.applyTaggedQueryMerge=function(e,t,n){var r=this.queryKeyForTag_(n);if(r){var i=g.parseQueryKey_(r),o=i.path,a=i.queryId,s=Path.relativePath(o,e),u=ImmutableTree.fromObject(t),c=new Merge(OperationSource.forServerTaggedQuery(a),s,u);return this.applyTaggedOperation_(o,c)}return[]},g.prototype.applyTaggedListenComplete=function(e,t){var n=this.queryKeyForTag_(t);if(n){var r=g.parseQueryKey_(n),i=r.path,o=r.queryId,a=Path.relativePath(i,e),s=new ListenComplete(OperationSource.forServerTaggedQuery(o),a);return this.applyTaggedOperation_(i,s)}return[]},g.prototype.addEventRegistration=function(e,t){var r=e.path,i=null,o=!1;this.syncPointTree_.foreachOnPath(r,function(e,t){var n=Path.relativePath(e,r);i=i||t.getCompleteServerCache(n),o=o||t.hasCompleteView()});var n,a=this.syncPointTree_.get(r);a?(o=o||a.hasCompleteView(),i=i||a.getCompleteServerCache(Path.Empty)):(a=new SyncPoint,this.syncPointTree_=this.syncPointTree_.set(r,a)),null!=i?n=!0:(n=!1,i=ChildrenNode.EMPTY_NODE,this.syncPointTree_.subtree(r).foreachChild(function(e,t){var n=t.getCompleteServerCache(Path.Empty);n&&(i=i.updateImmediateChild(e,n))}));var s=a.viewExistsForQuery(e);if(!s&&!e.getQueryParams().loadsAllData()){var u=g.makeQueryKey_(e);assert(!(u in this.queryToTagMap_),"View does not exist, but we have a tag");var c=g.getNextQueryTag_();this.queryToTagMap_[u]=c,this.tagToQueryMap_["_"+c]=u}var l=this.pendingWriteTree_.childWrites(r),h=a.addEventRegistration(e,t,l,i,n);if(!s&&!o){var f=a.viewForQuery(e);h=h.concat(this.setupListener_(e,f))}return h},g.prototype.removeEventRegistration=function(e,t,n){var r=this,i=e.path,o=this.syncPointTree_.get(i),a=[];if(o&&("default"===e.queryIdentifier()||o.viewExistsForQuery(e))){var s=o.removeEventRegistration(e,t,n);o.isEmpty()&&(this.syncPointTree_=this.syncPointTree_.remove(i));var u=s.removed;a=s.events;var c=-1!==u.findIndex(function(e){return e.getQueryParams().loadsAllData()}),l=this.syncPointTree_.findOnPath(i,function(e,t){return t.hasCompleteView()});if(c&&!l){var h=this.syncPointTree_.subtree(i);if(!h.isEmpty())for(var f=this.collectDistinctViewsForSubTree_(h),d=0;d<f.length;++d){var p=f[d],v=p.getQuery(),m=this.createListenerForView_(p);this.listenProvider_.startListening(g.queryForListening_(v),this.tagForQuery_(v),m.hashFn,m.onComplete)}}!l&&0<u.length&&!n&&(c?this.listenProvider_.stopListening(g.queryForListening_(e),null):u.forEach(function(e){var t=r.queryToTagMap_[g.makeQueryKey_(e)];r.listenProvider_.stopListening(g.queryForListening_(e),t)})),this.removeTags_(u)}return a},g.prototype.calcCompleteEventCache=function(i,e){var t=this.pendingWriteTree_,n=this.syncPointTree_.findOnPath(i,function(e,t){var n=Path.relativePath(e,i),r=t.getCompleteServerCache(n);if(r)return r});return t.calcCompleteEventCache(i,n,e,!0)},g.prototype.collectDistinctViewsForSubTree_=function(e){return e.fold(function(e,t,n){if(t&&t.hasCompleteView())return[t.getCompleteView()];var r=[];return t&&(r=t.getQueryViews()),forEach(n,function(e,t){r=r.concat(t)}),r})},g.prototype.removeTags_=function(e){for(var t=0;t<e.length;++t){var n=e[t];if(!n.getQueryParams().loadsAllData()){var r=g.makeQueryKey_(n),i=this.queryToTagMap_[r];delete this.queryToTagMap_[r],delete this.tagToQueryMap_["_"+i]}}},g.queryForListening_=function(e){return e.getQueryParams().loadsAllData()&&!e.getQueryParams().isDefault()?e.getRef():e},g.prototype.setupListener_=function(e,t){var n=e.path,r=this.tagForQuery_(e),i=this.createListenerForView_(t),o=this.listenProvider_.startListening(g.queryForListening_(e),r,i.hashFn,i.onComplete),a=this.syncPointTree_.subtree(n);if(r)assert(!a.value.hasCompleteView(),"If we're adding a query, it shouldn't be shadowed");else for(var s=a.fold(function(e,t,n){if(!e.isEmpty()&&t&&t.hasCompleteView())return[t.getCompleteView().getQuery()];var r=[];return t&&(r=r.concat(t.getQueryViews().map(function(e){return e.getQuery()}))),forEach(n,function(e,t){r=r.concat(t)}),r}),u=0;u<s.length;++u){var c=s[u];this.listenProvider_.stopListening(g.queryForListening_(c),this.tagForQuery_(c))}return o},g.prototype.createListenerForView_=function(e){var n=this,r=e.getQuery(),i=this.tagForQuery_(r);return{hashFn:function(){return(e.getServerCache()||ChildrenNode.EMPTY_NODE).hash()},onComplete:function(e){if("ok"===e)return i?n.applyTaggedListenComplete(r.path,i):n.applyListenComplete(r.path);var t=errorForServerCode(e,r);return n.removeEventRegistration(r,null,t)}}},g.makeQueryKey_=function(e){return e.path.toString()+"$"+e.queryIdentifier()},g.parseQueryKey_=function(e){var t=e.indexOf("$");return assert(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new Path(e.substr(0,t))}},g.prototype.queryKeyForTag_=function(e){return this.tagToQueryMap_["_"+e]},g.prototype.tagForQuery_=function(e){var t=g.makeQueryKey_(e);return safeGet(this.queryToTagMap_,t)},g.getNextQueryTag_=function(){return g.nextQueryTag_++},g.prototype.applyTaggedOperation_=function(e,t){var n=this.syncPointTree_.get(e);assert(n,"Missing sync point for query tag that we're tracking");var r=this.pendingWriteTree_.childWrites(e);return n.applyOperation(t,r,null)},g.prototype.applyOperationToSyncPoints_=function(e){return this.applyOperationHelper_(e,this.syncPointTree_,null,this.pendingWriteTree_.childWrites(Path.Empty))},g.prototype.applyOperationHelper_=function(e,t,n,r){if(e.path.isEmpty())return this.applyOperationDescendantsHelper_(e,t,n,r);var i=t.get(Path.Empty);null==n&&null!=i&&(n=i.getCompleteServerCache(Path.Empty));var o=[],a=e.path.getFront(),s=e.operationForChild(a),u=t.children.get(a);if(u&&s){var c=n?n.getImmediateChild(a):null,l=r.child(a);o=o.concat(this.applyOperationHelper_(s,u,c,l))}return i&&(o=o.concat(i.applyOperation(e,r,n))),o},g.prototype.applyOperationDescendantsHelper_=function(o,e,a,s){var u=this,t=e.get(Path.Empty);null==a&&null!=t&&(a=t.getCompleteServerCache(Path.Empty));var c=[];return e.children.inorderTraversal(function(e,t){var n=a?a.getImmediateChild(e):null,r=s.child(e),i=o.operationForChild(e);i&&(c=c.concat(u.applyOperationDescendantsHelper_(i,t,n,r)))}),t&&(c=c.concat(t.applyOperation(o,s,a))),c},g.nextQueryTag_=1,g}(),SnapshotHolder=function(){function e(){this.rootNode_=ChildrenNode.EMPTY_NODE}return e.prototype.getNode=function(e){return this.rootNode_.getChild(e)},e.prototype.updateSnapshot=function(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)},e}(),AuthTokenProvider=function(){function e(e){this.app_=e}return e.prototype.getToken=function(e){return this.app_.INTERNAL.getToken(e).then(null,function(e){return e&&"auth/token-not-initialized"===e.code?(log("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)})},e.prototype.addTokenChangeListener=function(e){this.app_.INTERNAL.addAuthTokenListener(e)},e.prototype.removeTokenChangeListener=function(e){this.app_.INTERNAL.removeAuthTokenListener(e)},e.prototype.notifyForInvalidToken=function(){var e='Provided authentication credentials for the app named "'+this.app_.name+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.app_.options?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.app_.options?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',warn(e)},e}(),StatsCollection=function(){function e(){this.counters_={}}return e.prototype.incrementCounter=function(e,t){void 0===t&&(t=1),contains(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t},e.prototype.get=function(){return deepCopy(this.counters_)},e}(),StatsManager=function(){function e(){}return e.getCollection=function(e){var t=e.toString();return this.collections_[t]||(this.collections_[t]=new StatsCollection),this.collections_[t]},e.getOrCreateReporter=function(e,t){var n=e.toString();return this.reporters_[n]||(this.reporters_[n]=t()),this.reporters_[n]},e.collections_={},e.reporters_={},e}(),StatsListener=function(){function e(e){this.collection_=e,this.last_=null}return e.prototype.get=function(){var e=this.collection_.get(),n=clone(e);return this.last_&&forEach(this.last_,function(e,t){n[e]=n[e]-t}),this.last_=e,n},e}(),FIRST_STATS_MIN_TIME=1e4,FIRST_STATS_MAX_TIME=3e4,REPORT_STATS_INTERVAL=3e5,StatsReporter=function(){function e(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new StatsListener(e);var n=FIRST_STATS_MIN_TIME+(FIRST_STATS_MAX_TIME-FIRST_STATS_MIN_TIME)*Math.random();setTimeoutNonBlocking(this.reportStats_.bind(this),Math.floor(n))}return e.prototype.includeStat=function(e){this.statsToReport_[e]=!0},e.prototype.reportStats_=function(){var n=this,e=this.statsListener_.get(),r={},i=!1;forEach(e,function(e,t){0<t&&contains(n.statsToReport_,e)&&(r[e]=t,i=!0)}),i&&this.server_.reportStats(r),setTimeoutNonBlocking(this.reportStats_.bind(this),Math.floor(2*Math.random()*REPORT_STATS_INTERVAL))},e}(),EventQueue=function(){function e(){this.eventLists_=[],this.recursionDepth_=0}return e.prototype.queueEvents=function(e){for(var t=null,n=0;n<e.length;n++){var r=e[n],i=r.getPath();null===t||i.equals(t.getPath())||(this.eventLists_.push(t),t=null),null===t&&(t=new EventList(i)),t.add(r)}t&&this.eventLists_.push(t)},e.prototype.raiseEventsAtPath=function(t,e){this.queueEvents(e),this.raiseQueuedEventsMatchingPredicate_(function(e){return e.equals(t)})},e.prototype.raiseEventsForChangedPath=function(t,e){this.queueEvents(e),this.raiseQueuedEventsMatchingPredicate_(function(e){return e.contains(t)||t.contains(e)})},e.prototype.raiseQueuedEventsMatchingPredicate_=function(e){this.recursionDepth_++;for(var t=!0,n=0;n<this.eventLists_.length;n++){var r=this.eventLists_[n];r&&(e(r.getPath())?(this.eventLists_[n].raise(),this.eventLists_[n]=null):t=!1)}t&&(this.eventLists_=[]),this.recursionDepth_--},e}(),EventList=function(){function e(e){this.path_=e,this.events_=[]}return e.prototype.add=function(e){this.events_.push(e)},e.prototype.raise=function(){for(var e=0;e<this.events_.length;e++){var t=this.events_[e];if(null!==t){this.events_[e]=null;var n=t.getEventRunner();logger&&log("event: "+t.toString()),exceptionGuard(n)}}},e.prototype.getPath=function(){return this.path_},e}(),EventEmitter=function(){function e(e){this.allowedEvents_=e,this.listeners_={},assert(Array.isArray(e)&&0<e.length,"Requires a non-empty array")}return e.prototype.trigger=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(Array.isArray(this.listeners_[e]))for(var r=this.listeners_[e].slice(),i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)},e.prototype.on=function(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});var r=this.getInitialEvent(e);r&&t.apply(n,r)},e.prototype.off=function(e,t,n){this.validateEventType_(e);for(var r=this.listeners_[e]||[],i=0;i<r.length;i++)if(r[i].callback===t&&(!n||n===r[i].context))return void r.splice(i,1)},e.prototype.validateEventType_=function(t){assert(this.allowedEvents_.find(function(e){return e===t}),"Unknown event: "+t)},e}(),VisibilityMonitor=function(r){function e(){var t,e,n=r.call(this,["visible"])||this;return"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(e="visibilitychange",t="hidden"):void 0!==document.mozHidden?(e="mozvisibilitychange",t="mozHidden"):void 0!==document.msHidden?(e="msvisibilitychange",t="msHidden"):void 0!==document.webkitHidden&&(e="webkitvisibilitychange",t="webkitHidden")),n.visible_=!0,e&&document.addEventListener(e,function(){var e=!document[t];e!==n.visible_&&(n.visible_=e,n.trigger("visible",e))},!1),n}return __extends(e,r),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(e){return assert("visible"===e,"Unknown event type: "+e),[this.visible_]},e}(EventEmitter),OnlineMonitor=function(t){function e(){var e=t.call(this,["online"])||this;return e.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||isMobileCordova()||(window.addEventListener("online",function(){e.online_||(e.online_=!0,e.trigger("online",!0))},!1),window.addEventListener("offline",function(){e.online_&&(e.online_=!1,e.trigger("online",!1))},!1)),e}return __extends(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(e){return assert("online"===e,"Unknown event type: "+e),[this.online_]},e.prototype.currentlyOnline=function(){return this.online_},e}(EventEmitter),PacketReceiver=function(){function e(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return e.prototype.closeAfter=function(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},e.prototype.handleResponse=function(e,t){var r=this;this.pendingResponses[e]=t;for(var n=function(){var t=i.pendingResponses[i.currentResponseNum];delete i.pendingResponses[i.currentResponseNum];for(var e=function(e){t[e]&&exceptionGuard(function(){r.onMessage_(t[e])})},n=0;n<t.length;++n)e(n);if(i.currentResponseNum===i.closeAfterResponse)return i.onClose&&(i.onClose(),i.onClose=null),"break";i.currentResponseNum++},i=this;this.pendingResponses[this.currentResponseNum]&&"break"!==n(););},e}(),FIREBASE_LONGPOLL_START_PARAM="start",FIREBASE_LONGPOLL_CLOSE_COMMAND="close",FIREBASE_LONGPOLL_COMMAND_CB_NAME="pLPCommand",FIREBASE_LONGPOLL_DATA_CB_NAME="pRTLPCB",FIREBASE_LONGPOLL_ID_PARAM="id",FIREBASE_LONGPOLL_PW_PARAM="pw",FIREBASE_LONGPOLL_SERIAL_PARAM="ser",FIREBASE_LONGPOLL_CALLBACK_ID_PARAM="cb",FIREBASE_LONGPOLL_SEGMENT_NUM_PARAM="seg",FIREBASE_LONGPOLL_SEGMENTS_IN_PACKET="ts",FIREBASE_LONGPOLL_DATA_PARAM="d",FIREBASE_LONGPOLL_DISCONN_FRAME_PARAM="disconn",FIREBASE_LONGPOLL_DISCONN_FRAME_REQUEST_PARAM="dframe",MAX_URL_DATA_SIZE=1870,SEG_HEADER_SIZE=30,MAX_PAYLOAD_SIZE=MAX_URL_DATA_SIZE-SEG_HEADER_SIZE,KEEPALIVE_REQUEST_INTERVAL=25e3,LP_CONNECT_TIMEOUT=3e4,BrowserPollConnection=function(){function e(e,t,n,r){this.connId=e,this.repoInfo=t,this.transportSessionId=n,this.lastSessionId=r,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=logWrapper(e),this.stats_=StatsManager.getCollection(t),this.urlFn=function(e){return t.connectionURL(LONG_POLLING,e)}}return e.prototype.open=function(e,t){var o=this;this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new PacketReceiver(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(function(){o.log_("Timed out trying to connect."),o.onClosed_(),o.connectTimeoutTimer_=null},Math.floor(LP_CONNECT_TIMEOUT)),executeWhenDOMReady(function(){if(!o.isClosed_){o.scriptTagHolder=new FirebaseIFrameScriptHolder(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e[0],r=e[1],i=e[2];if(o.incrementIncomingBytes_(e),o.scriptTagHolder)if(o.connectTimeoutTimer_&&(clearTimeout(o.connectTimeoutTimer_),o.connectTimeoutTimer_=null),o.everConnected_=!0,n==FIREBASE_LONGPOLL_START_PARAM)o.id=r,o.password=i;else{if(n!==FIREBASE_LONGPOLL_CLOSE_COMMAND)throw new Error("Unrecognized command received: "+n);r?(o.scriptTagHolder.sendNewPolls=!1,o.myPacketOrderer.closeAfter(r,function(){o.onClosed_()})):o.onClosed_()}},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e[0],r=e[1];o.incrementIncomingBytes_(e),o.myPacketOrderer.handleResponse(n,r)},function(){o.onClosed_()},o.urlFn);var e={};e[FIREBASE_LONGPOLL_START_PARAM]="t",e[FIREBASE_LONGPOLL_SERIAL_PARAM]=Math.floor(1e8*Math.random()),o.scriptTagHolder.uniqueCallbackIdentifier&&(e[FIREBASE_LONGPOLL_CALLBACK_ID_PARAM]=o.scriptTagHolder.uniqueCallbackIdentifier),e[VERSION_PARAM]=PROTOCOL_VERSION,o.transportSessionId&&(e[TRANSPORT_SESSION_PARAM]=o.transportSessionId),o.lastSessionId&&(e[LAST_SESSION_PARAM]=o.lastSessionId),!isNodeSdk()&&"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf(FORGE_DOMAIN)&&(e[REFERER_PARAM]=FORGE_REF);var t=o.urlFn(e);o.log_("Connecting via long-poll to "+t),o.scriptTagHolder.addTag(t,function(){})}})},e.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},e.forceAllow=function(){e.forceAllow_=!0},e.forceDisallow=function(){e.forceDisallow_=!0},e.isAvailable=function(){return e.forceAllow_||!e.forceDisallow_&&"undefined"!=typeof document&&null!=document.createElement&&!isChromeExtensionContentScript()&&!isWindowsStoreApp()&&!isNodeSdk()},e.prototype.markConnectionHealthy=function(){},e.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},e.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},e.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},e.prototype.send=function(e){var t=stringify(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);for(var n=base64Encode(t),r=splitStringBySize(n,MAX_PAYLOAD_SIZE),i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++},e.prototype.addDisconnectPingFrame=function(e,t){if(!isNodeSdk()){this.myDisconnFrame=document.createElement("iframe");var n={};n[FIREBASE_LONGPOLL_DISCONN_FRAME_REQUEST_PARAM]="t",n[FIREBASE_LONGPOLL_ID_PARAM]=e,n[FIREBASE_LONGPOLL_PW_PARAM]=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},e.prototype.incrementIncomingBytes_=function(e){var t=stringify(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)},e}(),FirebaseIFrameScriptHolder=function(){function a(e,t,n,r){if(this.onDisconnect=n,this.urlFn=r,this.outstandingRequests=new CountedSet,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,isNodeSdk())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=LUIDGenerator(),window[FIREBASE_LONGPOLL_COMMAND_CB_NAME+this.uniqueCallbackIdentifier]=e,window[FIREBASE_LONGPOLL_DATA_CB_NAME+this.uniqueCallbackIdentifier]=t,this.myIFrame=a.createIFrame_();var i="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)&&(i='<script>document.domain="'+document.domain+'";<\/script>');var o="<html><body>"+i+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(e){log("frame writing exception"),e.stack&&log(e.stack),log(e)}}}return a.createIFrame_=function(){var t=document.createElement("iframe");if(t.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(t);try{t.contentWindow.document||log("No IE domain setting required")}catch(e){var n=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t},a.prototype.close=function(){var e=this;if(this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(function(){null!==e.myIFrame&&(document.body.removeChild(e.myIFrame),e.myIFrame=null)},Math.floor(0))),isNodeSdk()&&this.myID){var t={};t[FIREBASE_LONGPOLL_DISCONN_FRAME_PARAM]="t",t[FIREBASE_LONGPOLL_ID_PARAM]=this.myID,t[FIREBASE_LONGPOLL_PW_PARAM]=this.myPW;var n=this.urlFn(t);a.nodeRestRequest(n)}var r=this.onDisconnect;r&&(this.onDisconnect=null,r())},a.prototype.startLongPoll=function(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););},a.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.count()<(0<this.pendingSegs.length?2:1)){this.currentSerial++;var e={};e[FIREBASE_LONGPOLL_ID_PARAM]=this.myID,e[FIREBASE_LONGPOLL_PW_PARAM]=this.myPW,e[FIREBASE_LONGPOLL_SERIAL_PARAM]=this.currentSerial;for(var t=this.urlFn(e),n="",r=0;0<this.pendingSegs.length&&this.pendingSegs[0].d.length+SEG_HEADER_SIZE+n.length<=MAX_URL_DATA_SIZE;){var i=this.pendingSegs.shift();n=n+"&"+FIREBASE_LONGPOLL_SEGMENT_NUM_PARAM+r+"="+i.seg+"&"+FIREBASE_LONGPOLL_SEGMENTS_IN_PACKET+r+"="+i.ts+"&"+FIREBASE_LONGPOLL_DATA_PARAM+r+"="+i.d,r++}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1},a.prototype.enqueueSegment=function(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()},a.prototype.addLongPollTag_=function(e,t){var n=this;this.outstandingRequests.add(t,1);var r=function(){n.outstandingRequests.remove(t),n.newRequest_()},i=setTimeout(r,Math.floor(KEEPALIVE_REQUEST_INTERVAL));this.addTag(e,function(){clearTimeout(i),r()})},a.prototype.addTag=function(e,n){var r=this;isNodeSdk()?this.doNodeLongPoll(e,n):setTimeout(function(){try{if(!r.sendNewPolls)return;var t=r.myIFrame.doc.createElement("script");t.type="text/javascript",t.async=!0,t.src=e,t.onload=t.onreadystatechange=function(){var e=t.readyState;e&&"loaded"!==e&&"complete"!==e||(t.onload=t.onreadystatechange=null,t.parentNode&&t.parentNode.removeChild(t),n())},t.onerror=function(){log("Long-poll script failed to load: "+e),r.sendNewPolls=!1,r.close()},r.myIFrame.doc.body.appendChild(t)}catch(e){}},Math.floor(1))},a}(),WEBSOCKET_MAX_FRAME_SIZE=16384,WEBSOCKET_KEEPALIVE_INTERVAL=45e3,WebSocketImpl=null;"undefined"!=typeof MozWebSocket?WebSocketImpl=MozWebSocket:"undefined"!=typeof WebSocket&&(WebSocketImpl=WebSocket);var WebSocketConnection=function(){function i(e,t,n,r){this.connId=e,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=logWrapper(this.connId),this.stats_=StatsManager.getCollection(t),this.connURL=i.connectionURL_(t,n,r)}return i.connectionURL_=function(e,t,n){var r={};return r[VERSION_PARAM]=PROTOCOL_VERSION,!isNodeSdk()&&"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf(FORGE_DOMAIN)&&(r[REFERER_PARAM]=FORGE_REF),t&&(r[TRANSPORT_SESSION_PARAM]=t),n&&(r[LAST_SESSION_PARAM]=n),e.connectionURL(WEBSOCKET,r)},i.prototype.open=function(e,t){var n=this;this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,PersistentStorage.set("previous_websocket_failure",!0);try{if(isNodeSdk()){var r=CONSTANTS.NODE_ADMIN?"AdminNode":"Node",i={headers:{"User-Agent":"Firebase/"+PROTOCOL_VERSION+"/"+firebase.SDK_VERSION+"/"+process.platform+"/"+r}},o=process.env,a=0==this.connURL.indexOf("wss://")?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a}),this.mySock=new WebSocketImpl(this.connURL,[],i)}else this.mySock=new WebSocketImpl(this.connURL)}catch(e){this.log_("Error instantiating WebSocket.");var s=e.message||e.data;return s&&this.log_(s),void this.onClosed_()}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(e){n.handleIncomingFrame(e)},this.mySock.onerror=function(e){n.log_("WebSocket error.  Closing connection.");var t=e.message||e.data;t&&n.log_(t),n.onClosed_()}},i.prototype.start=function(){},i.forceDisallow=function(){i.forceDisallow_=!0},i.isAvailable=function(){var e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var t=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);t&&1<t.length&&parseFloat(t[1])<4.4&&(e=!0)}return!e&&null!==WebSocketImpl&&!i.forceDisallow_},i.previouslyFailed=function(){return PersistentStorage.isInMemoryStorage||!0===PersistentStorage.get("previous_websocket_failure")},i.prototype.markConnectionHealthy=function(){PersistentStorage.remove("previous_websocket_failure")},i.prototype.appendFrame_=function(e){if(this.frames.push(e),this.frames.length==this.totalFrames){var t=this.frames.join("");this.frames=null;var n=jsonEval(t);this.onMessage(n)}},i.prototype.handleNewFrameCount_=function(e){this.totalFrames=e,this.frames=[]},i.prototype.extractFrameCount_=function(e){if(assert(null===this.frames,"We already have a frame buffer"),e.length<=6){var t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e},i.prototype.handleIncomingFrame=function(e){if(null!==this.mySock){var t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{var n=this.extractFrameCount_(t);null!==n&&this.appendFrame_(n)}}},i.prototype.send=function(e){this.resetKeepAlive();var t=stringify(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);var n=splitStringBySize(t,WEBSOCKET_MAX_FRAME_SIZE);1<n.length&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])},i.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},i.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},i.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},i.prototype.resetKeepAlive=function(){var e=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(function(){e.mySock&&e.sendString_("0"),e.resetKeepAlive()},Math.floor(WEBSOCKET_KEEPALIVE_INTERVAL))},i.prototype.sendString_=function(e){try{this.mySock.send(e)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},i.responsesRequiredToBeHealthy=2,i.healthyTimeout=3e4,i}(),TransportManager=function(){function i(e){this.initTransports_(e)}return Object.defineProperty(i,"ALL_TRANSPORTS",{get:function(){return[BrowserPollConnection,WebSocketConnection]},enumerable:!0,configurable:!0}),i.prototype.initTransports_=function(e){var t=WebSocketConnection&&WebSocketConnection.isAvailable(),n=t&&!WebSocketConnection.previouslyFailed();if(e.webSocketOnly&&(t||warn("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[WebSocketConnection];else{var r=this.transports_=[];each(i.ALL_TRANSPORTS,function(e,t){t&&t.isAvailable()&&r.push(t)})}},i.prototype.initialTransport=function(){if(0<this.transports_.length)return this.transports_[0];throw new Error("No transports available")},i.prototype.upgradeTransport=function(){return 1<this.transports_.length?this.transports_[1]:null},i}(),UPGRADE_TIMEOUT=6e4,DELAY_BEFORE_SENDING_EXTRA_REQUESTS=5e3,BYTES_SENT_HEALTHY_OVERRIDE=10240,BYTES_RECEIVED_HEALTHY_OVERRIDE=102400,MESSAGE_TYPE="t",MESSAGE_DATA="d",CONTROL_SHUTDOWN="s",CONTROL_RESET="r",CONTROL_ERROR="e",CONTROL_PONG="o",SWITCH_ACK="a",END_TRANSMISSION="n",PING="p",SERVER_HELLO="h",Connection=function(){function e(e,t,n,r,i,o,a){this.id=e,this.repoInfo_=t,this.onMessage_=n,this.onReady_=r,this.onDisconnect_=i,this.onKill_=o,this.lastSessionId=a,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=logWrapper("c:"+this.id+":"),this.transportManager_=new TransportManager(t),this.log_("Connection created"),this.start_()}return e.prototype.start_=function(){var e=this,t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,void 0,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(function(){e.conn_&&e.conn_.open(n,r)},Math.floor(0));var i=t.healthyTimeout||0;0<i&&(this.healthyTimeout_=setTimeoutNonBlocking(function(){e.healthyTimeout_=null,e.isHealthy_||(e.conn_&&e.conn_.bytesReceived>BYTES_RECEIVED_HEALTHY_OVERRIDE?(e.log_("Connection exceeded healthy timeout but has received "+e.conn_.bytesReceived+" bytes.  Marking connection healthy."),e.isHealthy_=!0,e.conn_.markConnectionHealthy()):e.conn_&&e.conn_.bytesSent>BYTES_SENT_HEALTHY_OVERRIDE?e.log_("Connection exceeded healthy timeout but has sent "+e.conn_.bytesSent+" bytes.  Leaving connection alive."):(e.log_("Closing unhealthy connection after timeout."),e.close()))},Math.floor(i)))},e.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},e.prototype.disconnReceiver_=function(t){var n=this;return function(e){t===n.conn_?n.onConnectionLost_(e):t===n.secondaryConn_?(n.log_("Secondary connection lost."),n.onSecondaryConnectionLost_()):n.log_("closing an old connection")}},e.prototype.connReceiver_=function(t){var n=this;return function(e){2!=n.state_&&(t===n.rx_?n.onPrimaryMessageReceived_(e):t===n.secondaryConn_?n.onSecondaryMessageReceived_(e):n.log_("message on old connection"))}},e.prototype.sendRequest=function(e){var t={t:"d",d:e};this.sendData_(t)},e.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},e.prototype.onSecondaryControl_=function(e){if(MESSAGE_TYPE in e){var t=e[MESSAGE_TYPE];t===SWITCH_ACK?this.upgradeIfSecondaryHealthy_():t===CONTROL_RESET?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):t===CONTROL_PONG&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},e.prototype.onSecondaryMessageReceived_=function(e){var t=requireKey("t",e),n=requireKey("d",e);if("c"==t)this.onSecondaryControl_(n);else{if("d"!=t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}},e.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:PING,d:{}}}))},e.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:SWITCH_ACK,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:END_TRANSMISSION,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},e.prototype.onPrimaryMessageReceived_=function(e){var t=requireKey("t",e),n=requireKey("d",e);"c"==t?this.onControl_(n):"d"==t&&this.onDataMessage_(n)},e.prototype.onDataMessage_=function(e){this.onPrimaryResponse_(),this.onMessage_(e)},e.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},e.prototype.onControl_=function(e){var t=requireKey(MESSAGE_TYPE,e);if(MESSAGE_DATA in e){var n=e[MESSAGE_DATA];if(t===SERVER_HELLO)this.onHandshake_(n);else if(t===END_TRANSMISSION){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===CONTROL_SHUTDOWN?this.onConnectionShutdown_(n):t===CONTROL_RESET?this.onReset_(n):t===CONTROL_ERROR?error$1("Server Error: "+n):t===CONTROL_PONG?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):error$1("Unknown control packet command: "+t)}},e.prototype.onHandshake_=function(e){var t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.updateHost(r),0==this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),PROTOCOL_VERSION!==n&&warn("Protocol version mismatch detected"),this.tryStartUpgrade_())},e.prototype.tryStartUpgrade_=function(){var e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)},e.prototype.startUpgrade_=function(e){var t=this;this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),setTimeoutNonBlocking(function(){t.secondaryConn_&&(t.log_("Timed out trying to upgrade."),t.secondaryConn_.close())},Math.floor(UPGRADE_TIMEOUT))},e.prototype.onReset_=function(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.updateHost(e),1===this.state_?this.close():(this.closeConnections_(),this.start_())},e.prototype.onConnectionEstablished_=function(e,t){var n=this;this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):setTimeoutNonBlocking(function(){n.sendPingOnPrimaryIfNecessary_()},Math.floor(DELAY_BEFORE_SENDING_EXTRA_REQUESTS))},e.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:PING,d:{}}}))},e.prototype.onSecondaryConnectionLost_=function(){var e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()},e.prototype.onConnectionLost_=function(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(PersistentStorage.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},e.prototype.onConnectionShutdown_=function(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()},e.prototype.sendData_=function(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)},e.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},e.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},e}(),ServerActions=function(){function e(){}return e.prototype.put=function(e,t,n,r){},e.prototype.merge=function(e,t,n,r){},e.prototype.refreshAuthToken=function(e){},e.prototype.onDisconnectPut=function(e,t,n){},e.prototype.onDisconnectMerge=function(e,t,n){},e.prototype.onDisconnectCancel=function(e,t){},e.prototype.reportStats=function(e){},e}(),RECONNECT_MIN_DELAY=1e3,RECONNECT_MAX_DELAY_DEFAULT=3e5,RECONNECT_MAX_DELAY_FOR_ADMINS=3e4,RECONNECT_DELAY_MULTIPLIER=1.3,RECONNECT_DELAY_RESET_TIMEOUT=3e4,SERVER_KILL_INTERRUPT_REASON="server_kill",INVALID_AUTH_TOKEN_THRESHOLD=3,PersistentConnection=function(s){function l(e,t,n,r,i,o){var a=s.call(this)||this;if(a.repoInfo_=e,a.onDataUpdate_=t,a.onConnectStatus_=n,a.onServerInfoUpdate_=r,a.authTokenProvider_=i,a.authOverride_=o,a.id=l.nextPersistentConnectionId_++,a.log_=logWrapper("p:"+a.id+":"),a.interruptReasons_={},a.listens_={},a.outstandingPuts_=[],a.outstandingPutCount_=0,a.onDisconnectRequestQueue_=[],a.connected_=!1,a.reconnectDelay_=RECONNECT_MIN_DELAY,a.maxReconnectDelay_=RECONNECT_MAX_DELAY_DEFAULT,a.securityDebugCallback_=null,a.lastSessionId=null,a.establishConnectionTimer_=null,a.visible_=!1,a.requestCBHash_={},a.requestNumber_=0,a.realtime_=null,a.authToken_=null,a.forceTokenRefresh_=!1,a.invalidAuthTokenCount_=0,a.firstConnection_=!0,a.lastConnectionAttemptTime_=null,a.lastConnectionEstablishedTime_=null,o&&!isNodeSdk())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return a.scheduleConnect_(0),VisibilityMonitor.getInstance().on("visible",a.onVisible_,a),-1===e.host.indexOf("fblocal")&&OnlineMonitor.getInstance().on("online",a.onOnline_,a),a}return __extends(l,s),l.prototype.sendRequest=function(e,t,n){var r=++this.requestNumber_,i={r:r,a:e,b:t};this.log_(stringify(i)),assert(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)},l.prototype.listen=function(e,t,n,r){var i=e.queryIdentifier(),o=e.path.toString();this.log_("Listen called for "+o+" "+i),this.listens_[o]=this.listens_[o]||{},assert(e.getQueryParams().isDefault()||!e.getQueryParams().loadsAllData(),"listen() called for non-default but complete query"),assert(!this.listens_[o][i],"listen() called twice for same path/queryId.");var a={onComplete:r,hashFn:t,query:e,tag:n};this.listens_[o][i]=a,this.connected_&&this.sendListen_(a)},l.prototype.sendListen_=function(r){var i=this,o=r.query,a=o.path.toString(),s=o.queryIdentifier();this.log_("Listen on "+a+" for "+s);var e={p:a};r.tag&&(e.q=o.queryObject(),e.t=r.tag),e.h=r.hashFn(),this.sendRequest("q",e,function(e){var t=e.d,n=e.s;l.warnOnListenWarnings_(t,o),(i.listens_[a]&&i.listens_[a][s])===r&&(i.log_("listen response",e),"ok"!==n&&i.removeListen_(a,s),r.onComplete&&r.onComplete(n,t))})},l.warnOnListenWarnings_=function(e,t){if(e&&"object"==typeof e&&contains(e,"w")){var n=safeGet(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+t.getQueryParams().getIndex().toString()+'"',i=t.path.toString();warn("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+r+" at "+i+" to your security rules for better performance.")}}},l.prototype.refreshAuthToken=function(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},function(){}),this.reduceReconnectDelayIfAdminCredential_(e)},l.prototype.reduceReconnectDelayIfAdminCredential_=function(e){(e&&40===e.length||isAdmin(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=RECONNECT_MAX_DELAY_FOR_ADMINS)},l.prototype.tryAuth=function(){var r=this;if(this.connected_&&this.authToken_){var i=this.authToken_,e=isValidFormat(i)?"auth":"gauth",t={cred:i};null===this.authOverride_?t.noauth=!0:"object"==typeof this.authOverride_&&(t.authvar=this.authOverride_),this.sendRequest(e,t,function(e){var t=e.s,n=e.d||"error";r.authToken_===i&&("ok"===t?r.invalidAuthTokenCount_=0:r.onAuthRevoked_(t,n))})}},l.prototype.unlisten=function(e,t){var n=e.path.toString(),r=e.queryIdentifier();this.log_("Unlisten called for "+n+" "+r),assert(e.getQueryParams().isDefault()||!e.getQueryParams().loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e.queryObject(),t)},l.prototype.sendUnlisten_=function(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);var i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)},l.prototype.onDisconnectPut=function(e,t,n){this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})},l.prototype.onDisconnectMerge=function(e,t,n){this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})},l.prototype.onDisconnectCancel=function(e,t){this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})},l.prototype.sendOnDisconnect_=function(e,t,n,r){var i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,function(e){r&&setTimeout(function(){r(e.s,e.d)},Math.floor(0))})},l.prototype.put=function(e,t,n,r){this.putInternal("p",e,t,n,r)},l.prototype.merge=function(e,t,n,r){this.putInternal("m",e,t,n,r)},l.prototype.putInternal=function(e,t,n,r,i){var o={p:t,d:n};void 0!==i&&(o.h=i),this.outstandingPuts_.push({action:e,request:o,onComplete:r}),this.outstandingPutCount_++;var a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+t)},l.prototype.sendPut_=function(t){var n=this,r=this.outstandingPuts_[t].action,e=this.outstandingPuts_[t].request,i=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,e,function(e){n.log_(r+" response",e),delete n.outstandingPuts_[t],n.outstandingPutCount_--,0===n.outstandingPutCount_&&(n.outstandingPuts_=[]),i&&i(e.s,e.d)})},l.prototype.reportStats=function(e){var n=this;if(this.connected_){var t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,function(e){if("ok"!==e.s){var t=e.d;n.log_("reportStats","Error sending stats: "+t)}})}},l.prototype.onDataMessage_=function(e){if("r"in e){this.log_("from server: "+stringify(e));var t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}},l.prototype.onDataPush_=function(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):error$1("Unrecognized action received from server: "+stringify(e)+"\nAre you using the latest client?")},l.prototype.onReady_=function(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},l.prototype.scheduleConnect_=function(e){var t=this;assert(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(function(){t.establishConnectionTimer_=null,t.establishConnection_()},Math.floor(e))},l.prototype.onVisible_=function(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=RECONNECT_MIN_DELAY,this.realtime_||this.scheduleConnect_(0)),this.visible_=e},l.prototype.onOnline_=function(e){e?(this.log_("Browser went online."),this.reconnectDelay_=RECONNECT_MIN_DELAY,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},l.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>RECONNECT_DELAY_RESET_TIMEOUT&&(this.reconnectDelay_=RECONNECT_MIN_DELAY),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());var e=(new Date).getTime()-this.lastConnectionAttemptTime_,t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*RECONNECT_DELAY_MULTIPLIER)}this.onConnectStatus_(!1)},l.prototype.establishConnection_=function(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;var t=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+l.nextConnectionId_++,o=this,a=this.lastSessionId,s=!1,u=null,c=function(){u?u.close():(s=!0,r())};this.realtime_={close:c,sendRequest:function(e){assert(u,"sendRequest call when we're not connected not allowed."),u.sendRequest(e)}};var e=this.forceTokenRefresh_;this.forceTokenRefresh_=!1,this.authTokenProvider_.getToken(e).then(function(e){s?log("getToken() completed but was canceled"):(log("getToken() completed. Creating connection."),o.authToken_=e&&e.accessToken,u=new Connection(i,o.repoInfo_,t,n,r,function(e){warn(e+" ("+o.repoInfo_.toString()+")"),o.interrupt(SERVER_KILL_INTERRUPT_REASON)},a))}).then(null,function(e){o.log_("Failed to get token: "+e),s||(CONSTANTS.NODE_ADMIN&&warn(e),c())})}},l.prototype.interrupt=function(e){log("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},l.prototype.resume=function(e){log("Resuming connection for reason: "+e),delete this.interruptReasons_[e],isEmpty(this.interruptReasons_)&&(this.reconnectDelay_=RECONNECT_MIN_DELAY,this.realtime_||this.scheduleConnect_(0))},l.prototype.handleTimestamp_=function(e){var t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})},l.prototype.cancelSentTransactions_=function(){for(var e=0;e<this.outstandingPuts_.length;e++){var t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},l.prototype.onListenRevoked_=function(e,t){var n;n=t?t.map(function(e){return ObjectToUniqueKey(e)}).join("$"):"default";var r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")},l.prototype.removeListen_=function(e,t){var n,r=new Path(e).toString();return void 0!==this.listens_[r]?(n=this.listens_[r][t],delete this.listens_[r][t],0===getCount(this.listens_[r])&&delete this.listens_[r]):n=void 0,n},l.prototype.onAuthRevoked_=function(e,t){log("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=INVALID_AUTH_TOKEN_THRESHOLD&&(this.reconnectDelay_=RECONNECT_MAX_DELAY_FOR_ADMINS,this.authTokenProvider_.notifyForInvalidToken()))},l.prototype.onSecurityDebugPacket_=function(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))},l.prototype.restoreState_=function(){var n=this;this.tryAuth(),forEach(this.listens_,function(e,t){forEach(t,function(e,t){n.sendListen_(t)})});for(var e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){var t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}},l.prototype.sendConnectStats_=function(){var e={},t="js";CONSTANTS.NODE_ADMIN?t="admin_node":CONSTANTS.NODE_CLIENT&&(t="node"),e["sdk."+t+"."+firebase.SDK_VERSION.replace(/\./g,"-")]=1,isMobileCordova()?e["framework.cordova"]=1:isReactNative()&&(e["framework.reactnative"]=1),this.reportStats(e)},l.prototype.shouldReconnect_=function(){var e=OnlineMonitor.getInstance().currentlyOnline();return isEmpty(this.interruptReasons_)&&e},l.nextPersistentConnectionId_=0,l.nextConnectionId_=0,l}(ServerActions),ReadonlyRestClient=function(i){function c(e,t,n){var r=i.call(this)||this;return r.repoInfo_=e,r.onDataUpdate_=t,r.authTokenProvider_=n,r.log_=logWrapper("p:rest:"),r.listens_={},r}return __extends(c,i),c.prototype.reportStats=function(e){throw new Error("Method not implemented.")},c.getListenId_=function(e,t){return void 0!==t?"tag$"+t:(assert(e.getQueryParams().isDefault(),"should have a tag if it's not a default query."),e.path.toString())},c.prototype.listen=function(e,t,r,i){var o=this,a=e.path.toString();this.log_("Listen called for "+a+" "+e.queryIdentifier());var s=c.getListenId_(e,r),u={};this.listens_[s]=u;var n=e.getQueryParams().toRestQueryStringParameters();this.restRequest_(a+".json",n,function(e,t){var n=t;404===e&&(e=n=null),null===e&&o.onDataUpdate_(a,n,!1,r),safeGet(o.listens_,s)===u&&i(e?401==e?"permission_denied":"rest_error:"+e:"ok",null)})},c.prototype.unlisten=function(e,t){var n=c.getListenId_(e,t);delete this.listens_[n]},c.prototype.refreshAuthToken=function(e){},c.prototype.restRequest_=function(i,o,a){var s=this;void 0===o&&(o={}),o.format="export",this.authTokenProvider_.getToken(!1).then(function(e){var t=e&&e.accessToken;t&&(o.auth=t);var n=(s.repoInfo_.secure?"https://":"http://")+s.repoInfo_.host+i+"?"+querystring(o);s.log_("Sending REST request for "+n);var r=new XMLHttpRequest;r.onreadystatechange=function(){if(a&&4===r.readyState){s.log_("REST Response for "+n+" received. status:",r.status,"response:",r.responseText);var e=null;if(200<=r.status&&r.status<300){try{e=jsonEval(r.responseText)}catch(e){warn("Failed to parse JSON response for "+n+": "+r.responseText)}a(null,e)}else 401!==r.status&&404!==r.status&&warn("Got unsuccessful REST response for "+n+" Status: "+r.status),a(r.status);a=null}},r.open("GET",n,!0),r.send()})},c}(ServerActions),INTERRUPT_REASON="repo_interrupt",Repo=function(){function e(e,t,n){var a=this;this.repoInfo_=e,this.app=n,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new EventQueue,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=new SparseSnapshotTree,this.persistentConnection_=null;var r=new AuthTokenProvider(n);if(this.stats_=StatsManager.getCollection(e),t||beingCrawled())this.server_=new ReadonlyRestClient(this.repoInfo_,this.onDataUpdate_.bind(this),r),setTimeout(this.onConnectStatus_.bind(this,!0),0);else{var i=n.options.databaseAuthVariableOverride;if(null!=i){if("object"!=typeof i)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{stringify(i)}catch(e){throw new Error("Invalid authOverride provided: "+e)}}this.persistentConnection_=new PersistentConnection(this.repoInfo_,this.onDataUpdate_.bind(this),this.onConnectStatus_.bind(this),this.onServerInfoUpdate_.bind(this),r,i),this.server_=this.persistentConnection_}r.addTokenChangeListener(function(e){a.server_.refreshAuthToken(e)}),this.statsReporter_=StatsManager.getOrCreateReporter(e,function(){return new StatsReporter(a.stats_,a.server_)}),this.transactions_init_(),this.infoData_=new SnapshotHolder,this.infoSyncTree_=new SyncTree({startListening:function(e,t,n,r){var i=[],o=a.infoData_.getNode(e.path);return o.isEmpty()||(i=a.infoSyncTree_.applyServerOverwrite(e.path,o),setTimeout(function(){r("ok")},0)),i},stopListening:function(){}}),this.updateInfo_("connected",!1),this.serverSyncTree_=new SyncTree({startListening:function(r,e,t,i){return a.server_.listen(r,t,e,function(e,t){var n=i(e,t);a.eventQueue_.raiseEventsForChangedPath(r.path,n)}),[]},stopListening:function(e,t){a.server_.unlisten(e,t)}})}return e.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},e.prototype.name=function(){return this.repoInfo_.namespace},e.prototype.serverTime=function(){var e=this.infoData_.getNode(new Path(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+e},e.prototype.generateServerValues=function(){return generateWithValues({timestamp:this.serverTime()})},e.prototype.onDataUpdate_=function(e,t,n,r){this.dataUpdateCount++;var i=new Path(e);t=this.interceptServerDataCallback_?this.interceptServerDataCallback_(e,t):t;var o=[];if(r)if(n){var a=map(t,function(e){return nodeFromJSON$1(e)});o=this.serverSyncTree_.applyTaggedQueryMerge(i,a,r)}else{var s=nodeFromJSON$1(t);o=this.serverSyncTree_.applyTaggedQueryOverwrite(i,s,r)}else if(n){var u=map(t,function(e){return nodeFromJSON$1(e)});o=this.serverSyncTree_.applyServerMerge(i,u)}else{var c=nodeFromJSON$1(t);o=this.serverSyncTree_.applyServerOverwrite(i,c)}var l=i;0<o.length&&(l=this.rerunTransactions_(i)),this.eventQueue_.raiseEventsForChangedPath(l,o)},e.prototype.interceptServerData_=function(e){this.interceptServerDataCallback_=e},e.prototype.onConnectStatus_=function(e){this.updateInfo_("connected",e),!1===e&&this.runOnDisconnectEvents_()},e.prototype.onServerInfoUpdate_=function(e){var n=this;each(e,function(e,t){n.updateInfo_(t,e)})},e.prototype.updateInfo_=function(e,t){var n=new Path("/.info/"+e),r=nodeFromJSON$1(t);this.infoData_.updateSnapshot(n,r);var i=this.infoSyncTree_.applyServerOverwrite(n,r);this.eventQueue_.raiseEventsForChangedPath(n,i)},e.prototype.getNextWriteId_=function(){return this.nextWriteId_++},e.prototype.setWithPriority=function(i,e,t,o){var a=this;this.log_("set",{path:i.toString(),value:e,priority:t});var n=this.generateServerValues(),r=nodeFromJSON$1(e,t),s=resolveDeferredValueSnapshot(r,n),u=this.getNextWriteId_(),c=this.serverSyncTree_.applyUserOverwrite(i,s,u,!0);this.eventQueue_.queueEvents(c),this.server_.put(i.toString(),r.val(!0),function(e,t){var n="ok"===e;n||warn("set at "+i+" failed: "+e);var r=a.serverSyncTree_.ackUserWrite(u,!n);a.eventQueue_.raiseEventsForChangedPath(i,r),a.callOnCompleteCallback(o,e,t)});var l=this.abortTransactions_(i);this.rerunTransactions_(l),this.eventQueue_.raiseEventsForChangedPath(l,[])},e.prototype.update=function(o,e,a){var s=this;this.log_("update",{path:o.toString(),value:e});var r=!0,i=this.generateServerValues(),u={};if(forEach(e,function(e,t){r=!1;var n=nodeFromJSON$1(t);u[e]=resolveDeferredValueSnapshot(n,i)}),r)log("update() called with empty data.  Don't do anything."),this.callOnCompleteCallback(a,"ok");else{var c=this.getNextWriteId_(),t=this.serverSyncTree_.applyUserMerge(o,u,c);this.eventQueue_.queueEvents(t),this.server_.merge(o.toString(),e,function(e,t){var n="ok"===e;n||warn("update at "+o+" failed: "+e);var r=s.serverSyncTree_.ackUserWrite(c,!n),i=0<r.length?s.rerunTransactions_(o):o;s.eventQueue_.raiseEventsForChangedPath(i,r),s.callOnCompleteCallback(a,e,t)}),forEach(e,function(e){var t=s.abortTransactions_(o.child(e));s.rerunTransactions_(t)}),this.eventQueue_.raiseEventsForChangedPath(o,[])}},e.prototype.runOnDisconnectEvents_=function(){var r=this;this.log_("onDisconnectEvents");var e=this.generateServerValues(),i=[];resolveDeferredValueTree(this.onDisconnect_,e).forEachTree(Path.Empty,function(e,t){i=i.concat(r.serverSyncTree_.applyServerOverwrite(e,t));var n=r.abortTransactions_(e);r.rerunTransactions_(n)}),this.onDisconnect_=new SparseSnapshotTree,this.eventQueue_.raiseEventsForChangedPath(Path.Empty,i)},e.prototype.onDisconnectCancel=function(n,r){var i=this;this.server_.onDisconnectCancel(n.toString(),function(e,t){"ok"===e&&i.onDisconnect_.forget(n),i.callOnCompleteCallback(r,e,t)})},e.prototype.onDisconnectSet=function(n,e,r){var i=this,o=nodeFromJSON$1(e);this.server_.onDisconnectPut(n.toString(),o.val(!0),function(e,t){"ok"===e&&i.onDisconnect_.remember(n,o),i.callOnCompleteCallback(r,e,t)})},e.prototype.onDisconnectSetWithPriority=function(n,e,t,r){var i=this,o=nodeFromJSON$1(e,t);this.server_.onDisconnectPut(n.toString(),o.val(!0),function(e,t){"ok"===e&&i.onDisconnect_.remember(n,o),i.callOnCompleteCallback(r,e,t)})},e.prototype.onDisconnectUpdate=function(r,n,i){var o=this;if(isEmpty(n))return log("onDisconnect().update() called with empty data.  Don't do anything."),void this.callOnCompleteCallback(i,"ok");this.server_.onDisconnectMerge(r.toString(),n,function(e,t){"ok"===e&&forEach(n,function(e,t){var n=nodeFromJSON$1(t);o.onDisconnect_.remember(r.child(e),n)}),o.callOnCompleteCallback(i,e,t)})},e.prototype.addEventCallbackForQuery=function(e,t){var n;n=".info"===e.path.getFront()?this.infoSyncTree_.addEventRegistration(e,t):this.serverSyncTree_.addEventRegistration(e,t),this.eventQueue_.raiseEventsAtPath(e.path,n)},e.prototype.removeEventCallbackForQuery=function(e,t){var n;n=".info"===e.path.getFront()?this.infoSyncTree_.removeEventRegistration(e,t):this.serverSyncTree_.removeEventRegistration(e,t),this.eventQueue_.raiseEventsAtPath(e.path,n)},e.prototype.interrupt=function(){this.persistentConnection_&&this.persistentConnection_.interrupt(INTERRUPT_REASON)},e.prototype.resume=function(){this.persistentConnection_&&this.persistentConnection_.resume(INTERRUPT_REASON)},e.prototype.stats=function(e){if(void 0===e&&(e=!1),"undefined"!=typeof console){var t;e?(this.statsListener_||(this.statsListener_=new StatsListener(this.stats_)),t=this.statsListener_.get()):t=this.stats_.get();var r=Object.keys(t).reduce(function(e,t){return Math.max(t.length,e)},0);forEach(t,function(e,t){for(var n=e.length;n<r+2;n++)e+=" ";console.log(e+t)})}},e.prototype.statsIncrementCounter=function(e){this.stats_.incrementCounter(e),this.statsReporter_.includeStat(e)},e.prototype.log_=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="";this.persistentConnection_&&(n=this.persistentConnection_.id+":"),log.apply(void 0,[n].concat(e))},e.prototype.callOnCompleteCallback=function(r,i,o){r&&exceptionGuard(function(){if("ok"==i)r(null);else{var e=(i||"error").toUpperCase(),t=e;o&&(t+=": "+o);var n=new Error(t);n.code=e,r(n)}})},Object.defineProperty(e.prototype,"database",{get:function(){return this.__database||(this.__database=new Database(this))},enumerable:!0,configurable:!0}),e}(),RangedFilter=function(){function t(e){this.indexedFilter_=new IndexedFilter(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e)}return t.prototype.getStartPost=function(){return this.startPost_},t.prototype.getEndPost=function(){return this.endPost_},t.prototype.matches=function(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0},t.prototype.updateChild=function(e,t,n,r,i,o){return this.matches(new NamedNode(t,n))||(n=ChildrenNode.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,r,i,o)},t.prototype.updateFullNode=function(e,t,n){t.isLeafNode()&&(t=ChildrenNode.EMPTY_NODE);var r=t.withIndex(this.index_);r=r.updatePriority(ChildrenNode.EMPTY_NODE);var i=this;return t.forEachChild(PRIORITY_INDEX,function(e,t){i.matches(new NamedNode(e,t))||(r=r.updateImmediateChild(e,ChildrenNode.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,r,n)},t.prototype.updatePriority=function(e,t){return e},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.indexedFilter_},t.prototype.getIndex=function(){return this.index_},t.getStartPost_=function(e){if(e.hasStart()){var t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()},t.getEndPost_=function(e){if(e.hasEnd()){var t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()},t}(),LimitedFilter=function(){function e(e){this.rangedFilter_=new RangedFilter(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}return e.prototype.updateChild=function(e,t,n,r,i,o){return this.rangedFilter_.matches(new NamedNode(t,n))||(n=ChildrenNode.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,r,i,o):this.fullLimitUpdateChild_(e,t,n,i,o)},e.prototype.updateFullNode=function(e,t,n){var r;if(t.isLeafNode()||t.isEmpty())r=ChildrenNode.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){r=ChildrenNode.EMPTY_NODE.withIndex(this.index_);var i=void 0;i=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var o=0;i.hasNext()&&o<this.limit_;){var a=i.getNext();if(!(this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),a)<=0:this.index_.compare(a,this.rangedFilter_.getEndPost())<=0))break;r=r.updateImmediateChild(a.name,a.node),o++}}else{r=(r=t.withIndex(this.index_)).updatePriority(ChildrenNode.EMPTY_NODE);var s=void 0,u=void 0,c=void 0;if(i=void 0,this.reverse_){i=r.getReverseIterator(this.index_),s=this.rangedFilter_.getEndPost(),u=this.rangedFilter_.getStartPost();var l=this.index_.getCompare();c=function(e,t){return l(t,e)}}else i=r.getIterator(this.index_),s=this.rangedFilter_.getStartPost(),u=this.rangedFilter_.getEndPost(),c=this.index_.getCompare();o=0;for(var h=!1;i.hasNext();)a=i.getNext(),!h&&c(s,a)<=0&&(h=!0),h&&o<this.limit_&&c(a,u)<=0?o++:r=r.updateImmediateChild(a.name,ChildrenNode.EMPTY_NODE)}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,n)},e.prototype.updatePriority=function(e,t){return e},e.prototype.filtersNodes=function(){return!0},e.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},e.prototype.getIndex=function(){return this.index_},e.prototype.fullLimitUpdateChild_=function(e,t,n,r,i){var o;if(this.reverse_){var a=this.index_.getCompare();o=function(e,t){return a(t,e)}}else o=this.index_.getCompare();var s=e;assert(s.numChildren()==this.limit_,"");var u=new NamedNode(t,n),c=this.reverse_?s.getFirstChild(this.index_):s.getLastChild(this.index_),l=this.rangedFilter_.matches(u);if(s.hasChild(t)){for(var h=s.getImmediateChild(t),f=r.getChildAfterChild(this.index_,c,this.reverse_);null!=f&&(f.name==t||s.hasChild(f.name));)f=r.getChildAfterChild(this.index_,f,this.reverse_);var d=null==f?1:o(f,u);if(l&&!n.isEmpty()&&0<=d)return null!=i&&i.trackChildChange(Change.childChangedChange(t,n,h)),s.updateImmediateChild(t,n);null!=i&&i.trackChildChange(Change.childRemovedChange(t,h));var p=s.updateImmediateChild(t,ChildrenNode.EMPTY_NODE);return null!=f&&this.rangedFilter_.matches(f)?(null!=i&&i.trackChildChange(Change.childAddedChange(f.name,f.node)),p.updateImmediateChild(f.name,f.node)):p}return n.isEmpty()?e:l&&0<=o(c,u)?(null!=i&&(i.trackChildChange(Change.childRemovedChange(c.name,c.node)),i.trackChildChange(Change.childAddedChange(t,n))),s.updateImmediateChild(t,n).updateImmediateChild(c.name,ChildrenNode.EMPTY_NODE)):e},e}(),QueryParams=function(){function r(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=PRIORITY_INDEX}return r.prototype.hasStart=function(){return this.startSet_},r.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:this.viewFrom_===r.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT},r.prototype.getIndexStartValue=function(){return assert(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},r.prototype.getIndexStartName=function(){return assert(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:MIN_NAME},r.prototype.hasEnd=function(){return this.endSet_},r.prototype.getIndexEndValue=function(){return assert(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},r.prototype.getIndexEndName=function(){return assert(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:MAX_NAME},r.prototype.hasLimit=function(){return this.limitSet_},r.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},r.prototype.getLimit=function(){return assert(this.limitSet_,"Only valid if limit has been set"),this.limit_},r.prototype.getIndex=function(){return this.index_},r.prototype.copy_=function(){var e=new r;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e},r.prototype.limit=function(e){var t=this.copy_();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="",t},r.prototype.limitToFirst=function(e){var t=this.copy_();return t.limitSet_=!0,t.limit_=e,t.viewFrom_=r.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT,t},r.prototype.limitToLast=function(e){var t=this.copy_();return t.limitSet_=!0,t.limit_=e,t.viewFrom_=r.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_RIGHT,t},r.prototype.startAt=function(e,t){var n=this.copy_();return n.startSet_=!0,void 0===e&&(e=null),n.indexStartValue_=e,null!=t?(n.startNameSet_=!0,n.indexStartName_=t):(n.startNameSet_=!1,n.indexStartName_=""),n},r.prototype.endAt=function(e,t){var n=this.copy_();return n.endSet_=!0,void 0===e&&(e=null),n.indexEndValue_=e,void 0!==t?(n.endNameSet_=!0,n.indexEndName_=t):(n.endNameSet_=!1,n.indexEndName_=""),n},r.prototype.orderBy=function(e){var t=this.copy_();return t.index_=e,t},r.prototype.getQueryObject=function(){var e=r.WIRE_PROTOCOL_CONSTANTS_,t={};if(this.startSet_&&(t[e.INDEX_START_VALUE]=this.indexStartValue_,this.startNameSet_&&(t[e.INDEX_START_NAME]=this.indexStartName_)),this.endSet_&&(t[e.INDEX_END_VALUE]=this.indexEndValue_,this.endNameSet_&&(t[e.INDEX_END_NAME]=this.indexEndName_)),this.limitSet_){t[e.LIMIT]=this.limit_;var n=this.viewFrom_;""===n&&(n=this.isViewFromLeft()?e.VIEW_FROM_LEFT:e.VIEW_FROM_RIGHT),t[e.VIEW_FROM]=n}return this.index_!==PRIORITY_INDEX&&(t[e.INDEX]=this.index_.toString()),t},r.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},r.prototype.isDefault=function(){return this.loadsAllData()&&this.index_==PRIORITY_INDEX},r.prototype.getNodeFilter=function(){return this.loadsAllData()?new IndexedFilter(this.getIndex()):this.hasLimit()?new LimitedFilter(this):new RangedFilter(this)},r.prototype.toRestQueryStringParameters=function(){var e,t=r.REST_QUERY_CONSTANTS_,n={};return this.isDefault()||(this.index_===PRIORITY_INDEX?e=t.PRIORITY_INDEX:this.index_===VALUE_INDEX?e=t.VALUE_INDEX:this.index_===KEY_INDEX?e=t.KEY_INDEX:(assert(this.index_ instanceof PathIndex,"Unrecognized index type!"),e=this.index_.toString()),n[t.ORDER_BY]=stringify(e),this.startSet_&&(n[t.START_AT]=stringify(this.indexStartValue_),this.startNameSet_&&(n[t.START_AT]+=","+stringify(this.indexStartName_))),this.endSet_&&(n[t.END_AT]=stringify(this.indexEndValue_),this.endNameSet_&&(n[t.END_AT]+=","+stringify(this.indexEndName_))),this.limitSet_&&(this.isViewFromLeft()?n[t.LIMIT_TO_FIRST]=this.limit_:n[t.LIMIT_TO_LAST]=this.limit_)),n},r.WIRE_PROTOCOL_CONSTANTS_={INDEX_START_VALUE:"sp",INDEX_START_NAME:"sn",INDEX_END_VALUE:"ep",INDEX_END_NAME:"en",LIMIT:"l",VIEW_FROM:"vf",VIEW_FROM_LEFT:"l",VIEW_FROM_RIGHT:"r",INDEX:"i"},r.REST_QUERY_CONSTANTS_={ORDER_BY:"orderBy",PRIORITY_INDEX:"$priority",VALUE_INDEX:"$value",KEY_INDEX:"$key",START_AT:"startAt",END_AT:"endAt",LIMIT_TO_FIRST:"limitToFirst",LIMIT_TO_LAST:"limitToLast"},r.DEFAULT=new r,r}(),Reference=function(n){function t(e,t){if(!(e instanceof Repo))throw new Error("new Reference() no longer supported - use app.database().");return n.call(this,e,t,QueryParams.DEFAULT,!1)||this}return __extends(t,n),t.prototype.getKey=function(){return validateArgCount("Reference.key",0,0,arguments.length),this.path.isEmpty()?null:this.path.getBack()},t.prototype.child=function(e){return validateArgCount("Reference.child",1,1,arguments.length),"number"==typeof e?e=String(e):e instanceof Path||(null===this.path.getFront()?validateRootPathString("Reference.child",1,e,!1):validatePathString("Reference.child",1,e,!1)),new t(this.repo,this.path.child(e))},t.prototype.getParent=function(){validateArgCount("Reference.parent",0,0,arguments.length);var e=this.path.parent();return null===e?null:new t(this.repo,e)},t.prototype.getRoot=function(){validateArgCount("Reference.root",0,0,arguments.length);for(var e=this;null!==e.getParent();)e=e.getParent();return e},t.prototype.databaseProp=function(){return this.repo.database},t.prototype.set=function(e,t){validateArgCount("Reference.set",1,2,arguments.length),validateWritablePath("Reference.set",this.path),validateFirebaseDataArg("Reference.set",1,e,this.path,!1),validateCallback("Reference.set",2,t,!0);var n=new Deferred;return this.repo.setWithPriority(this.path,e,null,n.wrapCallback(t)),n.promise},t.prototype.update=function(e,t){if(validateArgCount("Reference.update",1,2,arguments.length),validateWritablePath("Reference.update",this.path),Array.isArray(e)){for(var n={},r=0;r<e.length;++r)n[""+r]=e[r];e=n,warn("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}validateFirebaseMergeDataArg("Reference.update",1,e,this.path,!1),validateCallback("Reference.update",2,t,!0);var i=new Deferred;return this.repo.update(this.path,e,i.wrapCallback(t)),i.promise},t.prototype.setWithPriority=function(e,t,n){if(validateArgCount("Reference.setWithPriority",2,3,arguments.length),validateWritablePath("Reference.setWithPriority",this.path),validateFirebaseDataArg("Reference.setWithPriority",1,e,this.path,!1),validatePriority("Reference.setWithPriority",2,t,!1),validateCallback("Reference.setWithPriority",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.setWithPriority failed: "+this.getKey()+" is a read-only object.";var r=new Deferred;return this.repo.setWithPriority(this.path,e,t,r.wrapCallback(n)),r.promise},t.prototype.remove=function(e){return validateArgCount("Reference.remove",0,1,arguments.length),validateWritablePath("Reference.remove",this.path),validateCallback("Reference.remove",1,e,!0),this.set(null,e)},t.prototype.transaction=function(e,r,t){if(validateArgCount("Reference.transaction",1,3,arguments.length),validateWritablePath("Reference.transaction",this.path),validateCallback("Reference.transaction",1,e,!1),validateCallback("Reference.transaction",2,r,!0),validateBoolean("Reference.transaction",3,t,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.transaction failed: "+this.getKey()+" is a read-only object.";void 0===t&&(t=!0);var i=new Deferred;return"function"==typeof r&&i.promise.catch(function(){}),this.repo.startTransaction(this.path,e,function(e,t,n){e?i.reject(e):i.resolve(new TransactionResult(t,n)),"function"==typeof r&&r(e,t,n)},t),i.promise},t.prototype.setPriority=function(e,t){validateArgCount("Reference.setPriority",1,2,arguments.length),validateWritablePath("Reference.setPriority",this.path),validatePriority("Reference.setPriority",1,e,!1),validateCallback("Reference.setPriority",2,t,!0);var n=new Deferred;return this.repo.setWithPriority(this.path.child(".priority"),e,null,n.wrapCallback(t)),n.promise},t.prototype.push=function(e,t){validateArgCount("Reference.push",0,2,arguments.length),validateWritablePath("Reference.push",this.path),validateFirebaseDataArg("Reference.push",1,e,this.path,!0),validateCallback("Reference.push",2,t,!0);var n,r=this.repo.serverTime(),i=nextPushId(r),o=this.child(i),a=this.child(i);return n=null!=e?o.set(e,t).then(function(){return a}):Promise.resolve(a),o.then=n.then.bind(n),o.catch=n.then.bind(n,void 0),"function"==typeof t&&n.catch(function(){}),o},t.prototype.onDisconnect=function(){return validateWritablePath("Reference.onDisconnect",this.path),new OnDisconnect(this.repo,this.path)},Object.defineProperty(t.prototype,"database",{get:function(){return this.databaseProp()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"key",{get:function(){return this.getKey()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this.getParent()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this.getRoot()},enumerable:!0,configurable:!0}),t}(Query);Query.__referenceConstructor=Reference,SyncPoint.__referenceConstructor=Reference;var TreeNode=function(){this.children={},this.childCount=0,this.value=null},Tree=function(){function i(e,t,n){void 0===e&&(e=""),void 0===t&&(t=null),void 0===n&&(n=new TreeNode),this.name_=e,this.parent_=t,this.node_=n}return i.prototype.subTree=function(e){for(var t,n=e instanceof Path?e:new Path(e),r=this;null!==(t=n.getFront());)r=new i(t,r,safeGet(r.node_.children,t)||new TreeNode),n=n.popFront();return r},i.prototype.getValue=function(){return this.node_.value},i.prototype.setValue=function(e){assert(void 0!==e,"Cannot set value to undefined"),this.node_.value=e,this.updateParents_()},i.prototype.clear=function(){this.node_.value=null,this.node_.children={},this.node_.childCount=0,this.updateParents_()},i.prototype.hasChildren=function(){return 0<this.node_.childCount},i.prototype.isEmpty=function(){return null===this.getValue()&&!this.hasChildren()},i.prototype.forEachChild=function(n){var r=this;forEach(this.node_.children,function(e,t){n(new i(e,r,t))})},i.prototype.forEachDescendant=function(t,e,n){e&&!n&&t(this),this.forEachChild(function(e){e.forEachDescendant(t,!0,n)}),e&&n&&t(this)},i.prototype.forEachAncestor=function(e,t){for(var n=t?this:this.parent();null!==n;){if(e(n))return!0;n=n.parent()}return!1},i.prototype.forEachImmediateDescendantWithValue=function(t){this.forEachChild(function(e){null!==e.getValue()?t(e):e.forEachImmediateDescendantWithValue(t)})},i.prototype.path=function(){return new Path(null===this.parent_?this.name_:this.parent_.path()+"/"+this.name_)},i.prototype.name=function(){return this.name_},i.prototype.parent=function(){return this.parent_},i.prototype.updateParents_=function(){null!==this.parent_&&this.parent_.updateChild_(this.name_,this)},i.prototype.updateChild_=function(e,t){var n=t.isEmpty(),r=contains(this.node_.children,e);n&&r?(delete this.node_.children[e],this.node_.childCount--,this.updateParents_()):n||r||(this.node_.children[e]=t.node_,this.node_.childCount++,this.updateParents_())},i}(),TransactionStatus,JVc;JVc=TransactionStatus||(TransactionStatus={}),JVc[JVc.RUN=0]="RUN",JVc[JVc.SENT=1]="SENT",JVc[JVc.COMPLETED=2]="COMPLETED",JVc[JVc.SENT_NEEDS_ABORT=3]="SENT_NEEDS_ABORT",JVc[JVc.NEEDS_ABORT=4]="NEEDS_ABORT",Repo.MAX_TRANSACTION_RETRIES_=25,Repo.prototype.transactions_init_=function(){this.transactionQueueTree_=new Tree},Repo.prototype.startTransaction=function(e,t,n,r){this.log_("transaction on "+e);var i=function(){},o=new Reference(this,e);o.on("value",i);var a={path:e,update:t,onComplete:n,status:null,order:LUIDGenerator(),applyLocally:r,retryCount:0,unwatcher:function(){o.off("value",i)},abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},s=this.getLatestState_(e);a.currentInputSnapshot=s;var u=a.update(s.val());if(void 0===u){if(a.unwatcher(),a.currentOutputSnapshotRaw=null,a.currentOutputSnapshotResolved=null,a.onComplete){var c=new DataSnapshot(a.currentInputSnapshot,new Reference(this,a.path),PRIORITY_INDEX);a.onComplete(null,!1,c)}}else{validateFirebaseData("transaction failed: Data returned ",u,a.path),a.status=TransactionStatus.RUN;var l=this.transactionQueueTree_.subTree(e),h=l.getValue()||[];h.push(a),l.setValue(h);var f=void 0;"object"==typeof u&&null!==u&&contains(u,".priority")?(f=safeGet(u,".priority"),assert(isValidPriority(f),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):f=(this.serverSyncTree_.calcCompleteEventCache(e)||ChildrenNode.EMPTY_NODE).getPriority().val(),f=f;var d=this.generateServerValues(),p=nodeFromJSON$1(u,f),v=resolveDeferredValueSnapshot(p,d);a.currentOutputSnapshotRaw=p,a.currentOutputSnapshotResolved=v,a.currentWriteId=this.getNextWriteId_();var m=this.serverSyncTree_.applyUserOverwrite(e,v,a.currentWriteId,a.applyLocally);this.eventQueue_.raiseEventsForChangedPath(e,m),this.sendReadyTransactions_()}},Repo.prototype.getLatestState_=function(e,t){return this.serverSyncTree_.calcCompleteEventCache(e,t)||ChildrenNode.EMPTY_NODE},Repo.prototype.sendReadyTransactions_=function(e){var t=this;if(void 0===e&&(e=this.transactionQueueTree_),e||this.pruneCompletedTransactionsBelowNode_(e),null!==e.getValue()){var n=this.buildTransactionQueue_(e);assert(0<n.length,"Sending zero length transaction queue"),n.every(function(e){return e.status===TransactionStatus.RUN})&&this.sendTransactionQueue_(e.path(),n)}else e.hasChildren()&&e.forEachChild(function(e){t.sendReadyTransactions_(e)})},Repo.prototype.sendTransactionQueue_=function(s,u){for(var c=this,e=u.map(function(e){return e.currentWriteId}),t=this.getLatestState_(s,e),n=t,r=t.hash(),i=0;i<u.length;i++){var o=u[i];assert(o.status===TransactionStatus.RUN,"tryToSendTransactionQueue_: items in queue should all be run."),o.status=TransactionStatus.SENT,o.retryCount++;var a=Path.relativePath(s,o.path);n=n.updateChild(a,o.currentOutputSnapshotRaw)}var l=n.val(!0),h=s;this.server_.put(h.toString(),l,function(e){c.log_("transaction put response",{path:h.toString(),status:e});var t=[];if("ok"===e){for(var n=[],r=0;r<u.length;r++){if(u[r].status=TransactionStatus.COMPLETED,t=t.concat(c.serverSyncTree_.ackUserWrite(u[r].currentWriteId)),u[r].onComplete){var i=u[r].currentOutputSnapshotResolved,o=new Reference(c,u[r].path),a=new DataSnapshot(i,o,PRIORITY_INDEX);n.push(u[r].onComplete.bind(null,null,!0,a))}u[r].unwatcher()}for(c.pruneCompletedTransactionsBelowNode_(c.transactionQueueTree_.subTree(s)),c.sendReadyTransactions_(),c.eventQueue_.raiseEventsForChangedPath(s,t),r=0;r<n.length;r++)exceptionGuard(n[r])}else{if("datastale"===e)for(r=0;r<u.length;r++)u[r].status===TransactionStatus.SENT_NEEDS_ABORT?u[r].status=TransactionStatus.NEEDS_ABORT:u[r].status=TransactionStatus.RUN;else for(warn("transaction at "+h.toString()+" failed: "+e),r=0;r<u.length;r++)u[r].status=TransactionStatus.NEEDS_ABORT,u[r].abortReason=e;c.rerunTransactions_(s)}},r)},Repo.prototype.rerunTransactions_=function(e){var t=this.getAncestorTransactionNode_(e),n=t.path(),r=this.buildTransactionQueue_(t);return this.rerunTransactionQueue_(r,n),n},Repo.prototype.rerunTransactionQueue_=function(e,t){if(0!==e.length){for(var n,r=[],i=[],o=e.filter(function(e){return e.status===TransactionStatus.RUN}).map(function(e){return e.currentWriteId}),a=0;a<e.length;a++){var s=e[a],u=Path.relativePath(t,s.path),c=!1,l=void 0;if(assert(null!==u,"rerunTransactionsUnderNode_: relativePath should not be null."),s.status===TransactionStatus.NEEDS_ABORT)c=!0,l=s.abortReason,i=i.concat(this.serverSyncTree_.ackUserWrite(s.currentWriteId,!0));else if(s.status===TransactionStatus.RUN)if(s.retryCount>=Repo.MAX_TRANSACTION_RETRIES_)c=!0,l="maxretry",i=i.concat(this.serverSyncTree_.ackUserWrite(s.currentWriteId,!0));else{var h=this.getLatestState_(s.path,o);s.currentInputSnapshot=h;var f=e[a].update(h.val());if(void 0!==f){validateFirebaseData("transaction failed: Data returned ",f,s.path);var d=nodeFromJSON$1(f);"object"==typeof f&&null!=f&&contains(f,".priority")||(d=d.updatePriority(h.getPriority()));var p=s.currentWriteId,v=this.generateServerValues(),m=resolveDeferredValueSnapshot(d,v);s.currentOutputSnapshotRaw=d,s.currentOutputSnapshotResolved=m,s.currentWriteId=this.getNextWriteId_(),o.splice(o.indexOf(p),1),i=(i=i.concat(this.serverSyncTree_.applyUserOverwrite(s.path,m,s.currentWriteId,s.applyLocally))).concat(this.serverSyncTree_.ackUserWrite(p,!0))}else c=!0,l="nodata",i=i.concat(this.serverSyncTree_.ackUserWrite(s.currentWriteId,!0))}if(this.eventQueue_.raiseEventsForChangedPath(t,i),i=[],c&&(e[a].status=TransactionStatus.COMPLETED,n=e[a].unwatcher,setTimeout(n,Math.floor(0)),e[a].onComplete))if("nodata"===l){var g=new Reference(this,e[a].path),y=e[a].currentInputSnapshot,b=new DataSnapshot(y,g,PRIORITY_INDEX);r.push(e[a].onComplete.bind(null,null,!1,b))}else r.push(e[a].onComplete.bind(null,new Error(l),!1,null))}for(this.pruneCompletedTransactionsBelowNode_(this.transactionQueueTree_),a=0;a<r.length;a++)exceptionGuard(r[a]);this.sendReadyTransactions_()}},Repo.prototype.getAncestorTransactionNode_=function(e){for(var t,n=this.transactionQueueTree_;null!==(t=e.getFront())&&null===n.getValue();)n=n.subTree(t),e=e.popFront();return n},Repo.prototype.buildTransactionQueue_=function(e){var t=[];return this.aggregateTransactionQueuesForNode_(e,t),t.sort(function(e,t){return e.order-t.order}),t},Repo.prototype.aggregateTransactionQueuesForNode_=function(e,t){var n=this,r=e.getValue();if(null!==r)for(var i=0;i<r.length;i++)t.push(r[i]);e.forEachChild(function(e){n.aggregateTransactionQueuesForNode_(e,t)})},Repo.prototype.pruneCompletedTransactionsBelowNode_=function(e){var t=this,n=e.getValue();if(n){for(var r=0,i=0;i<n.length;i++)n[i].status!==TransactionStatus.COMPLETED&&(n[r]=n[i],r++);n.length=r,e.setValue(0<n.length?n:null)}e.forEachChild(function(e){t.pruneCompletedTransactionsBelowNode_(e)})},Repo.prototype.abortTransactions_=function(e){var t=this,n=this.getAncestorTransactionNode_(e).path(),r=this.transactionQueueTree_.subTree(e);return r.forEachAncestor(function(e){t.abortTransactionsOnNode_(e)}),this.abortTransactionsOnNode_(r),r.forEachDescendant(function(e){t.abortTransactionsOnNode_(e)}),n},Repo.prototype.abortTransactionsOnNode_=function(e){var t=e.getValue();if(null!==t){for(var n=[],r=[],i=-1,o=0;o<t.length;o++)t[o].status===TransactionStatus.SENT_NEEDS_ABORT||(t[o].status===TransactionStatus.SENT?(assert(i===o-1,"All SENT items should be at beginning of queue."),t[i=o].status=TransactionStatus.SENT_NEEDS_ABORT,t[o].abortReason="set"):(assert(t[o].status===TransactionStatus.RUN,"Unexpected transaction status in abort"),t[o].unwatcher(),r=r.concat(this.serverSyncTree_.ackUserWrite(t[o].currentWriteId,!0)),t[o].onComplete&&n.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));for(-1===i?e.setValue(null):t.length=i+1,this.eventQueue_.raiseEventsForChangedPath(e.path(),r),o=0;o<n.length;o++)exceptionGuard(n[o])}};var DATABASE_URL_OPTION="databaseURL",_staticInstance,RepoManager=function(){function e(){this.repos_={},this.useRestClient_=!1}return e.getInstance=function(){return _staticInstance||(_staticInstance=new e),_staticInstance},e.prototype.interrupt=function(){for(var e in this.repos_)for(var t in this.repos_[e])this.repos_[e][t].interrupt()},e.prototype.resume=function(){for(var e in this.repos_)for(var t in this.repos_[e])this.repos_[e][t].resume()},e.prototype.databaseFromApp=function(e,t){var n=t||e.options[DATABASE_URL_OPTION];void 0===n&&fatal("Can't determine Firebase Database URL.  Be sure to include "+DATABASE_URL_OPTION+" option when calling firebase.initializeApp().");var r=parseRepoInfo(n),i=r.repoInfo;return validateUrl("Invalid Firebase Database URL",1,r),r.path.isEmpty()||fatal("Database URL must point to the root of a Firebase Database (not including a child path)."),this.createRepo(i,e).database},e.prototype.deleteRepo=function(e){var t=safeGet(this.repos_,e.app.name);t&&safeGet(t,e.repoInfo_.toURLString())===e||fatal("Database "+e.app.name+"("+e.repoInfo_+") has already been deleted."),e.interrupt(),delete t[e.repoInfo_.toURLString()]},e.prototype.createRepo=function(e,t){var n=safeGet(this.repos_,t.name);n||(n={},this.repos_[t.name]=n);var r=safeGet(n,e.toURLString());return r&&fatal("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),r=new Repo(e,this.useRestClient_,t),n[e.toURLString()]=r},e.prototype.forceRestClient=function(e){this.useRestClient_=e},e}(),Database=function(){function e(e){(this.repo_=e)instanceof Repo||fatal("Don't call new Database() directly - please use firebase.database()."),this.root_=new Reference(e,Path.Empty),this.INTERNAL=new DatabaseInternals(this)}return Object.defineProperty(e.prototype,"app",{get:function(){return this.repo_.app},enumerable:!0,configurable:!0}),e.prototype.ref=function(e){return this.checkDeleted_("ref"),validateArgCount("database.ref",0,1,arguments.length),e instanceof Reference?this.refFromURL(e.toString()):void 0!==e?this.root_.child(e):this.root_},e.prototype.refFromURL=function(e){var t="database.refFromURL";this.checkDeleted_(t),validateArgCount(t,1,1,arguments.length);var n=parseRepoInfo(e);validateUrl(t,1,n);var r=n.repoInfo;return r.host!==this.repo_.repoInfo_.host&&fatal(t+": Host name does not match the current database: (found "+r.host+" but expected "+this.repo_.repoInfo_.host+")"),this.ref(n.path.toString())},e.prototype.checkDeleted_=function(e){null===this.repo_&&fatal("Cannot call "+e+" on a deleted database.")},e.prototype.goOffline=function(){validateArgCount("database.goOffline",0,0,arguments.length),this.checkDeleted_("goOffline"),this.repo_.interrupt()},e.prototype.goOnline=function(){validateArgCount("database.goOnline",0,0,arguments.length),this.checkDeleted_("goOnline"),this.repo_.resume()},e.ServerValue={TIMESTAMP:{".sv":"timestamp"}},e}(),DatabaseInternals=function(){function e(e){this.database=e}return e.prototype.delete=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return this.database.checkDeleted_("delete"),RepoManager.getInstance().deleteRepo(this.database.repo_),this.database.repo_=null,this.database.root_=null,this.database.INTERNAL=null,this.database=null,[2]})})},e}(),forceLongPolling=function(){WebSocketConnection.forceDisallow(),BrowserPollConnection.forceAllow()},forceWebSockets=function(){BrowserPollConnection.forceDisallow()},isWebSocketsAvailable=function(){return WebSocketConnection.isAvailable()},setSecurityDebugCallback=function(e,t){e.repo.persistentConnection_.securityDebugCallback_=t},stats=function(e,t){e.repo.stats(t)},statsIncrementCounter=function(e,t){e.repo.statsIncrementCounter(t)},dataUpdateCount=function(e){return e.repo.dataUpdateCount},interceptServerData=function(e,t){return e.repo.interceptServerData_(t)},INTERNAL=Object.freeze({forceLongPolling:forceLongPolling,forceWebSockets:forceWebSockets,isWebSocketsAvailable:isWebSocketsAvailable,setSecurityDebugCallback:setSecurityDebugCallback,stats:stats,statsIncrementCounter:statsIncrementCounter,dataUpdateCount:dataUpdateCount,interceptServerData:interceptServerData}),DataConnection=PersistentConnection;PersistentConnection.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},PersistentConnection.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};var RealTimeConnection=Connection,hijackHash=function(i){var o=PersistentConnection.prototype.put;return PersistentConnection.prototype.put=function(e,t,n,r){void 0!==r&&(r=i()),o.call(this,e,t,n,r)},function(){PersistentConnection.prototype.put=o}},ConnectionTarget=RepoInfo,queryIdentifier=function(e){return e.queryIdentifier()},listens=function(e){return e.repo.persistentConnection_.listens_},forceRestClient=function(e){RepoManager.getInstance().forceRestClient(e)},TEST_ACCESS=Object.freeze({DataConnection:DataConnection,RealTimeConnection:RealTimeConnection,hijackHash:hijackHash,ConnectionTarget:ConnectionTarget,queryIdentifier:queryIdentifier,listens:listens,forceRestClient:forceRestClient}),ServerValue=Database.ServerValue;function registerDatabase(e){var t=e.INTERNAL.registerService("database",function(e,t,n){return RepoManager.getInstance().databaseFromApp(e,n)},{Reference:Reference,Query:Query,Database:Database,enableLogging:enableLogging,INTERNAL:INTERNAL,ServerValue:ServerValue,TEST_ACCESS:TEST_ACCESS},null,!0);isNodeSdk()&&(module.exports=t)}registerDatabase(firebase);var dist=createCommonjsModule$1(function(module){(function(){var g,goog=goog||{},k=this;function l(e){return"string"==typeof e}function n(e,t){e=e.split("."),t=t||k;for(var n=0;n<e.length;n++)if(null==(t=t[e[n]]))return null;return t}function aa(){}function ba(e){var t=typeof e;if("object"==t){if(!e)return"null";if(e instanceof Array)return"array";if(e instanceof Object)return t;var n=Object.prototype.toString.call(e);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof e.length&&void 0!==e.splice&&void 0!==e.propertyIsEnumerable&&!e.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==e.call&&void 0!==e.propertyIsEnumerable&&!e.propertyIsEnumerable("call"))return"function"}else if("function"==t&&void 0===e.call)return"object";return t}function p(e){return"array"==ba(e)}function ca(e){var t=ba(e);return"array"==t||"object"==t&&"number"==typeof e.length}function da(e){return"function"==ba(e)}function ea(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var q="closure_uid_"+(1e9*Math.random()>>>0),fa=0;function ha(e,t,n){return e.call.apply(e.bind,arguments)}function ia(t,n,e){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var e=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(e,r),t.apply(n,e)}}return function(){return t.apply(n,arguments)}}function r(e,t,n){return(r=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ha:ia).apply(null,arguments)}function ja(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var t=Date.now||function(){return+new Date};function u(e,o){function t(){}t.prototype=o.prototype,e.H=o.prototype,e.prototype=new t,(e.prototype.constructor=e).Ib=function(e,t,n){for(var r=Array(arguments.length-2),i=2;i<arguments.length;i++)r[i-2]=arguments[i];return o.prototype[t].apply(e,r)}}function ka(e){if(Error.captureStackTrace)Error.captureStackTrace(this,ka);else{var t=Error().stack;t&&(this.stack=t)}e&&(this.message=String(e))}function la(e,t){for(var n="",r=(e=e.split("%s")).length-1,i=0;i<r;i++)n+=e[i]+(i<t.length?t[i]:"%s");ka.call(this,n+e[r])}function ma(e,t){throw new la("Failure"+(e?": "+e:""),Array.prototype.slice.call(arguments,1))}function w(){0!=na&&(pa[this[q]||(this[q]=++fa)]=this),this.i=this.i,this.m=this.m}u(ka,Error),ka.prototype.name="CustomError",u(la,ka),la.prototype.name="AssertionError";var na=0,pa={};w.prototype.i=!1,w.prototype.$=function(){if(!this.i&&(this.i=!0,this.w(),0!=na)){var e=this[q]||(this[q]=++fa);if(0!=na&&this.m&&0<this.m.length)throw Error(this+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete pa[e]}},w.prototype.w=function(){if(this.m)for(;this.m.length;)this.m.shift()()};var qa=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if(l(e))return l(t)&&1==t.length?e.indexOf(t,0):-1;for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},ra=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){for(var r=e.length,i=l(e)?e.split(""):e,o=0;o<r;o++)o in i&&t.call(n,i[o],o,e)};function sa(e){e:{for(var t=ta,n=e.length,r=l(e)?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e)){t=i;break e}t=-1}return t<0?null:l(e)?e.charAt(t):e[t]}function ua(e){if(!p(e))for(var t=e.length-1;0<=t;t--)delete e[t];e.length=0}function va(e){return Array.prototype.concat.apply([],arguments)}function wa(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function xa(e){return/^[\s\xa0]*$/.test(e)}var ya=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]},x;function za(e,t){return e<t?-1:t<e?1:0}e:{var Aa=k.navigator;if(Aa){var Ba=Aa.userAgent;if(Ba){x=Ba;break e}}x=""}function y(e){return-1!=x.indexOf(e)}function Ca(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function Da(e){var t,n=[],r=0;for(t in e)n[r++]=e[t];return n}function Ea(e){var t,n=[],r=0;for(t in e)n[r++]=t;return n}function Fa(e){var t,n={};for(t in e)n[t]=e[t];return n}var Ga="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ha(e,t){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(var o=0;o<Ga.length;o++)n=Ga[o],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function Ia(e){return Ia[" "](e),e}function Ja(e,t){var n=Ka;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}Ia[" "]=aa;var La=y("Opera"),z=y("Trident")||y("MSIE"),Ma=y("Edge"),Na=Ma||z,Oa=y("Gecko")&&!(-1!=x.toLowerCase().indexOf("webkit")&&!y("Edge"))&&!(y("Trident")||y("MSIE"))&&!y("Edge"),Pa=-1!=x.toLowerCase().indexOf("webkit")&&!y("Edge"),Ra,a;function Qa(){var e=k.document;return e?e.documentMode:void 0}e:{var Sa="",Ta=(a=x,Oa?/rv:([^\);]+)(\)|;)/.exec(a):Ma?/Edge\/([\d\.]+)/.exec(a):z?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(a):Pa?/WebKit\/(\S+)/.exec(a):La?/(?:Version)[ \/]?(\S+)/.exec(a):void 0);if(Ta&&(Sa=Ta?Ta[1]:""),z){var Ua=Qa();if(null!=Ua&&Ua>parseFloat(Sa)){Ra=String(Ua);break e}}Ra=Sa}var Ka={},Wa;function Va(s){return Ja(s,function(){for(var e=0,t=ya(String(Ra)).split("."),n=ya(String(s)).split("."),r=Math.max(t.length,n.length),i=0;0==e&&i<r;i++){var o=t[i]||"",a=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==o[0].length&&0==a[0].length)break;e=za(0==o[1].length?0:parseInt(o[1],10),0==a[1].length?0:parseInt(a[1],10))||za(0==o[2].length,0==a[2].length)||za(o[2],a[2]),o=o[3],a=a[3]}while(0==e)}return 0<=e})}var Xa=k.document;Wa=Xa&&z?Qa()||("CSS1Compat"==Xa.compatMode?parseInt(Ra,10):5):void 0;var Ya=Object.freeze||function(e){return e},Za=!z||9<=Number(Wa),$a=z&&!Va("9"),ab=function(){if(!k.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});return k.addEventListener("test",aa,t),k.removeEventListener("test",aa,t),e}();function A(e,t){this.type=e,this.a=this.target=t,this.Ra=!0}function bb(e,t){if(A.call(this,e?e.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,e){var n=this.type=e.type,r=e.changedTouches?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.a=t,t=e.relatedTarget){if(Oa){e:{try{Ia(t.nodeName);var i=!0;break e}catch(e){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,null===r?(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0):(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=l(e.pointerType)?e.pointerType:cb[e.pointerType]||"",(this.c=e).defaultPrevented&&this.b()}}A.prototype.b=function(){this.Ra=!1},u(bb,A);var cb=Ya({2:"touch",3:"pen",4:"mouse"});bb.prototype.b=function(){bb.H.b.call(this);var e=this.c;if(e.preventDefault)e.preventDefault();else if(e.returnValue=!1,$a)try{(e.ctrlKey||112<=e.keyCode&&e.keyCode<=123)&&(e.keyCode=-1)}catch(e){}};var db="closure_listenable_"+(1e6*Math.random()|0),eb=0;function fb(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ga=i,this.key=++eb,this.Z=this.ba=!1}function gb(e){e.Z=!0,e.listener=null,e.proxy=null,e.src=null,e.ga=null}function hb(e){this.src=e,this.a={},this.b=0}function jb(e,t){var n=t.type;if(n in e.a){var r,i=e.a[n],o=qa(i,t);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(gb(t),0==e.a[n].length&&(delete e.a[n],e.b--))}}function ib(e,t,n,r){for(var i=0;i<e.length;++i){var o=e[i];if(!o.Z&&o.listener==t&&o.capture==!!n&&o.ga==r)return i}return-1}hb.prototype.add=function(e,t,n,r,i){var o=e.toString();(e=this.a[o])||(e=this.a[o]=[],this.b++);var a=ib(e,t,r,i);return-1<a?(t=e[a],n||(t.ba=!1)):((t=new fb(t,this.src,o,!!r,i)).ba=n,e.push(t)),t};var kb="closure_lm_"+(1e6*Math.random()|0),lb={};function nb(e,t,n,r,i){if(r&&r.once)return ob(e,t,n,r,i);if(p(t)){for(var o=0;o<t.length;o++)nb(e,t[o],n,r,i);return null}return n=pb(n),e&&e[db]?e.Ia(t,n,ea(r)?!!r.capture:!!r,i):qb(e,t,n,!1,r,i)}function qb(e,t,n,r,i,o){if(!t)throw Error("Invalid event type");var a=ea(i)?!!i.capture:!!i,s=rb(e);if(s||(e[kb]=s=new hb(e)),(n=s.add(t,n,r,a,o)).proxy)return n;if(r=sb(),(n.proxy=r).src=e,r.listener=n,e.addEventListener)ab||(i=a),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(tb(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function sb(){var t=ub,n=Za?function(e){return t.call(n.src,n.listener,e)}:function(e){if(!(e=t.call(n.src,n.listener,e)))return e};return n}function ob(e,t,n,r,i){if(p(t)){for(var o=0;o<t.length;o++)ob(e,t[o],n,r,i);return null}return n=pb(n),e&&e[db]?e.Ja(t,n,ea(r)?!!r.capture:!!r,i):qb(e,t,n,!0,r,i)}function vb(e,t,n,r,i){if(p(t))for(var o=0;o<t.length;o++)vb(e,t[o],n,r,i);else r=ea(r)?!!r.capture:!!r,n=pb(n),e&&e[db]?(e=e.f,(t=String(t).toString())in e.a&&-1<(n=ib(o=e.a[t],n,r,i))&&(gb(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete e.a[t],e.b--))):e&&(e=rb(e))&&(t=e.a[t.toString()],e=-1,t&&(e=ib(t,n,r,i)),(n=-1<e?t[e]:null)&&wb(n))}function wb(e){if("number"!=typeof e&&e&&!e.Z){var t=e.src;if(t&&t[db])jb(t.f,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(tb(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=rb(t))?(jb(n,e),0==n.b&&(n.src=null,t[kb]=null)):gb(e)}}}function tb(e){return e in lb?lb[e]:lb[e]="on"+e}function xb(e,t,n,r){var i=!0;if((e=rb(e))&&(t=e.a[t.toString()]))for(t=t.concat(),e=0;e<t.length;e++){var o=t[e];o&&o.capture==n&&!o.Z&&(o=yb(o,r),i=i&&!1!==o)}return i}function yb(e,t){var n=e.listener,r=e.ga||e.src;return e.ba&&wb(e),n.call(r,t)}function ub(e,t){if(e.Z)return!0;if(!Za){var r=t||n("window.event");t=new bb(r,this);var i=!0;if(!(r.keyCode<0||null!=r.returnValue)){e:{var o=!1;if(0==r.keyCode)try{r.keyCode=-1;break e}catch(e){o=!0}(o||null==r.returnValue)&&(r.returnValue=!0)}for(r=[],o=t.a;o;o=o.parentNode)r.push(o);for(e=e.type,o=r.length-1;0<=o;o--){t.a=r[o];var a=xb(r[o],e,!0,t);i=i&&a}for(o=0;o<r.length;o++)t.a=r[o],a=xb(r[o],e,!1,t),i=i&&a}return i}return yb(e,new bb(t,this))}function rb(e){return(e=e[kb])instanceof hb?e:null}var zb="__closure_events_fn_"+(1e9*Math.random()>>>0);function pb(t){return da(t)?t:(t[zb]||(t[zb]=function(e){return t.handleEvent(e)}),t[zb])}function B(){w.call(this),this.f=new hb(this),(this.N=this).J=null}function Ab(e,t,n,r){if(!(t=e.f.a[String(t)]))return!0;t=t.concat();for(var i=!0,o=0;o<t.length;++o){var a=t[o];if(a&&!a.Z&&a.capture==n){var s=a.listener,u=a.ga||a.src;a.ba&&jb(e.f,a),i=!1!==s.call(u,r)&&i}}return i&&0!=r.Ra}function Bb(e){return!/^\s*$/.test(e)&&/^[\],:{}\s\u2028\u2029]*$/.test(e.replace(/\\["\\\/bfnrtu]/g,"@").replace(/(?:"[^"\\\n\r\u2028\u2029\x00-\x08\x0a-\x1f]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)[\s\u2028\u2029]*(?=:|,|]|}|$)/g,"]").replace(/(?:^|:|,)(?:[\s\u2028\u2029]*\[)+/g,""))}function Cb(a){if(a=String(a),Bb(a))try{return eval("("+a+")")}catch(e){}throw Error("Invalid JSON string: "+a)}function Db(e){var t=[];return Eb(new Fb,e,t),t.join("")}function Fb(){}function Eb(e,t,n){if(null==t)n.push("null");else{if("object"==typeof t){if(p(t)){var r=t;t=r.length,n.push("[");for(var i="",o=0;o<t;o++)n.push(i),Eb(e,r[o],n),i=",";return void n.push("]")}if(!(t instanceof String||t instanceof Number||t instanceof Boolean)){for(r in n.push("{"),i="",t)Object.prototype.hasOwnProperty.call(t,r)&&"function"!=typeof(o=t[r])&&(n.push(i),Gb(r,n),n.push(":"),Eb(e,o,n),i=",");return void n.push("}")}t=t.valueOf()}switch(typeof t){case"string":Gb(t,n);break;case"number":n.push(isFinite(t)&&!isNaN(t)?String(t):"null");break;case"boolean":n.push(String(t));break;case"function":n.push("null");break;default:throw Error("Unknown type: "+typeof t)}}}u(B,w),B.prototype[db]=!0,g=B.prototype,g.addEventListener=function(e,t,n,r){nb(this,e,t,n,r)},g.removeEventListener=function(e,t,n,r){vb(this,e,t,n,r)},g.dispatchEvent=function(e){var t,n=this.J;if(n)for(t=[];n;n=n.J)t.push(n);n=this.N;var r=e.type||e;if(l(e))e=new A(e,n);else if(e instanceof A)e.target=e.target||n;else{var i=e;Ha(e=new A(r,n),i)}if(i=!0,t)for(var o=t.length-1;0<=o;o--){var a=e.a=t[o];i=Ab(a,r,!0,e)&&i}if(i=Ab(a=e.a=n,r,!0,e)&&i,i=Ab(a,r,!1,e)&&i,t)for(o=0;o<t.length;o++)i=Ab(a=e.a=t[o],r,!1,e)&&i;return i},g.w=function(){if(B.H.w.call(this),this.f){var e,t=this.f;for(e in t.a){for(var n=t.a[e],r=0;r<n.length;r++)gb(n[r]);delete t.a[e],t.b--}}this.J=null},g.Ia=function(e,t,n,r){return this.f.add(String(e),t,!1,n,r)},g.Ja=function(e,t,n,r){return this.f.add(String(e),t,!0,n,r)};var Hb={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},Ib=/\uffff/.test("￿")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function Gb(e,t){t.push('"',e.replace(Ib,function(e){var t=Hb[e];return t||(t="\\u"+(65536|e.charCodeAt(0)).toString(16).substr(1),Hb[e]=t),t}),'"')}function Jb(e,t){this.c=e,this.f=t,this.b=0,this.a=null}function Kb(){this.b=this.a=null}Jb.prototype.get=function(){if(0<this.b){this.b--;var e=this.a;this.a=e.next,e.next=null}else e=this.c();return e};var Nb=new Jb(function(){return new Lb},function(e){e.reset()}),Rb,Tb;function Ob(){var e=Pb,t=null;return e.a&&(t=e.a,e.a=e.a.next,e.a||(e.b=null),t.next=null),t}function Lb(){this.next=this.b=this.a=null}function Qb(e){k.setTimeout(function(){throw e},0)}function Sb(){var e=k.MessageChannel;if(void 0===e&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!y("Presto")&&(e=function(){var e=document.createElement("IFRAME");e.style.display="none",e.src="",document.documentElement.appendChild(e);var t=e.contentWindow;(e=t.document).open(),e.write(""),e.close();var n="callImmediate"+Math.random(),i="file:"==t.location.protocol?"*":t.location.protocol+"//"+t.location.host;e=r(function(e){"*"!=i&&e.origin!=i||e.data!=n||this.port1.onmessage()},this),t.addEventListener("message",e,!1),this.port1={},this.port2={postMessage:function(){t.postMessage(n,i)}}}),void 0!==e&&!y("Trident")&&!y("MSIE")){var t=new e,n={},i=n;return t.port1.onmessage=function(){if(void 0!==n.next){var e=(n=n.next).za;n.za=null,e()}},function(e){i.next={za:e},i=i.next,t.port2.postMessage(0)}}return"undefined"!=typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(e){var t=document.createElement("SCRIPT");t.onreadystatechange=function(){t.onreadystatechange=null,t.parentNode.removeChild(t),t=null,e(),e=null},document.documentElement.appendChild(t)}:function(e){k.setTimeout(e,0)}}function Ub(){if(-1!=String(k.Promise).indexOf("[native code]")){var e=k.Promise.resolve(void 0);Tb=function(){e.then(Vb)}}else Tb=function(){var e=Vb;!da(k.setImmediate)||k.Window&&k.Window.prototype&&!y("Edge")&&k.Window.prototype.setImmediate==k.setImmediate?(Rb||(Rb=Sb()),Rb(e)):k.setImmediate(e)}}Kb.prototype.add=function(e,t){var n=Nb.get();n.set(e,t),this.b?this.b.next=n:this.a=n,this.b=n},Lb.prototype.set=function(e,t){this.a=e,this.b=t,this.next=null},Lb.prototype.reset=function(){this.next=this.b=this.a=null};var Wb=!1,Pb=new Kb;function Vb(){for(var e;e=Ob();){try{e.a.call(e.b)}catch(e){Qb(e)}var t=Nb;t.f(e),t.b<100&&(t.b++,e.next=t.a,t.a=e)}Wb=!1}function Xb(e,n){B.call(this),this.b=e||1,this.a=n||k,this.c=r(this.qb,this),this.g=t()}function Yb(e){e.ea=!1,e.O&&(e.a.clearTimeout(e.O),e.O=null)}function Zb(e,t,n){if(da(e))n&&(e=r(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=r(e.handleEvent,e)}return 2147483647<Number(t)?-1:k.setTimeout(e,t||0)}function $b(e,t,n){w.call(this),this.f=null!=n?r(e,n):e,this.c=t,this.b=r(this.kb,this),this.a=[]}function ac(e){e.Y=Zb(e.b,e.c),e.f.apply(null,e.a)}function bc(e){w.call(this),this.b=e,this.a={}}u(Xb,B),g=Xb.prototype,g.ea=!1,g.O=null,g.qb=function(){if(this.ea){var e=t()-this.g;0<e&&e<.8*this.b?this.O=this.a.setTimeout(this.c,this.b-e):(this.O&&(this.a.clearTimeout(this.O),this.O=null),this.dispatchEvent("tick"),this.ea&&(this.O=this.a.setTimeout(this.c,this.b),this.g=t()))}},g.start=function(){this.ea=!0,this.O||(this.O=this.a.setTimeout(this.c,this.b),this.g=t())},g.w=function(){Xb.H.w.call(this),Yb(this),delete this.a},u($b,w),g=$b.prototype,g.ha=!1,g.Y=null,g.cb=function(e){this.a=arguments,this.Y?this.ha=!0:ac(this)},g.w=function(){$b.H.w.call(this),this.Y&&(k.clearTimeout(this.Y),this.Y=null,this.ha=!1,this.a=[])},g.kb=function(){this.Y=null,this.ha&&(this.ha=!1,ac(this))},u(bc,w);var cc=[];function dc(e,t,n,r){p(n)||(n&&(cc[0]=n.toString()),n=cc);for(var i=0;i<n.length;i++){var o=nb(t,n[i],r||e.handleEvent,!1,e.b||e);if(!o)break;e.a[o.key]=o}}function ec(e){Ca(e.a,function(e,t){this.a.hasOwnProperty(t)&&wb(e)},e),e.a={}}function fc(e,t,n){this.reset(e,t,n,void 0,void 0)}function hc(e){this.f=e,this.b=this.c=this.a=null}function C(e,t){this.name=e,this.value=t}bc.prototype.w=function(){bc.H.w.call(this),ec(this)},bc.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},fc.prototype.a=null,fc.prototype.reset=function(e,t,n,r,i){delete this.a},C.prototype.toString=function(){return this.name};var ic=new C("SEVERE",1e3),jc=new C("WARNING",900),kc=new C("INFO",800),lc=new C("CONFIG",700),mc=new C("FINE",500);function nc(e){return e.c?e.c:e.a?nc(e.a):(ma("Root logger has no level set."),null)}hc.prototype.log=function(e,t,n){if(e.value>=nc(this).value)for(da(t)&&(t=t()),e=new fc(e,String(t),this.f),n&&(e.a=n),n=this;n;)n=n.a};var oc={},pc=null;function qc(e){var t;if(pc||(pc=new hc(""),(oc[""]=pc).c=lc),!(t=oc[e])){t=new hc(e);var n=e.lastIndexOf("."),r=e.substr(n+1);(n=qc(e.substr(0,n))).b||(n.b={}),(n.b[r]=t).a=n,oc[e]=t}return t}function D(e,t){e&&e.log(jc,t,void 0)}function rc(e,t){e&&e.log(kc,t,void 0)}function E(e,t){e&&e.log(mc,t,void 0)}function sc(){this.a=qc("goog.labs.net.webChannel.WebChannelDebug"),this.b=!0}function tc(a,s,u,c,l,h){F(a,function(){if(a.b)if(h)for(var e="",t=h.split("&"),n=0;n<t.length;n++){var r=t[n].split("=");if(1<r.length){var i=r[0];r=r[1];var o=i.split("_");e=2<=o.length&&"type"==o[1]?e+(i+"=")+r+"&":e+(i+"=redacted&")}}else e=null;else e=h;return"XMLHTTP REQ ("+c+") [attempt "+l+"]: "+s+"\n"+u+"\n"+e})}function uc(e,t,n,r,i,o,a){F(e,function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+o+" "+a})}function G(e,t,n,r){F(e,function(){return"XMLHTTP TEXT ("+t+"): "+vc(e,n)+(r?" "+r:"")})}function wc(e,t){F(e,function(){return"TIMEOUT: "+t})}function H(e,t){E(e.a,t)}function xc(e,t,n){(e=e.a)&&e.log(ic,n||"Exception",t)}function F(e,t){rc(e.a,t)}function J(e,t){(e=e.a)&&e.log(ic,t,void 0)}function vc(e,t){if(!e.b)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(var r=0;r<n.length;r++)if(p(n[r])){var i=n[r];if(!(i.length<2)){var o=i[1];if(p(o)&&!(o.length<1)){var a=o[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var s=1;s<o.length;s++)o[s]=""}}}return Db(n)}catch(n){return H(e,"Exception parsing expected JS array - probably was not JS"),t}}sc.prototype.Fa=function(){this.b=!1};var yc=new B;function zc(e){A.call(this,"serverreachability",e)}function Ac(e){yc.dispatchEvent(new zc(yc,e))}function Bc(e){A.call(this,"statevent",e)}function K(e){yc.dispatchEvent(new Bc(yc,e))}function Cc(e){A.call(this,"timingevent",e)}function Dc(e,t,n){yc.dispatchEvent(new Cc(yc,e,t,n))}function Ec(e,t){if(!da(e))throw Error("Fn must not be null and must be a function");return k.setTimeout(function(){e()},t)}u(zc,A),u(Bc,A),u(Cc,A);var Fc={NO_ERROR:0,rb:1,yb:2,xb:3,ub:4,wb:5,zb:6,Ua:7,TIMEOUT:8,Cb:9},Gc={tb:"complete",Gb:"success",Va:"error",Ua:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",vb:"downloadprogress",Hb:"uploadprogress"};function Hc(){}function Ic(e){var t;return(t=e.a)||(t={},Jc(e)&&(t[0]=!0,t[1]=!0),t=e.a=t),t}function Kc(){}Hc.prototype.a=null;var Lc={OPEN:"a",sb:"b",Va:"c",Bb:"d"},Oc;function Mc(){A.call(this,"d")}function Nc(){A.call(this,"c")}function Pc(){}function Qc(e){return(e=Jc(e))?new ActiveXObject(e):new XMLHttpRequest}function Jc(e){if(!e.b&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var t=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<t.length;n++){var r=t[n];try{return new ActiveXObject(r),e.b=r}catch(e){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return e.b}function L(e,t,n,r){this.i=e,this.b=t,this.c=n,this.T=r||1,this.L=new bc(this),this.R=Rc,e=Na?125:void 0,this.S=new Xb(e),this.j=null,this.f=!1,this.l=this.g=this.h=this.J=this.D=this.U=this.s=null,this.u=[],this.a=null,this.G=0,this.m=this.o=null,this.C=-1,this.B=!1,this.N=0,this.I=null,this.v=this.X=this.K=!1}u(Mc,A),u(Nc,A),u(Pc,Hc),Oc=new Pc;var Rc=45e3;function Sc(e,t){switch(e){case 0:return"Non-200 return code ("+t+")";case 1:return"XMLHTTP failure (no data)";case 2:return"HttpConnection timeout";default:return"Unknown error"}}var Tc={},Uc={};function Vc(e,t,n){e.J=1,e.h=Wc(M(t)),e.l=n,e.K=!0,Xc(e,null)}function Yc(e,t,n,r){e.J=1,e.h=Wc(M(t)),e.l=null,e.K=n,Xc(e,r)}function Xc(e,n){e.D=t(),Zc(e),e.g=M(e.h),$c(e.g,"t",e.T),e.G=0,e.a=e.i.ca(e.i.ia()?n:null),0<e.N&&(e.I=new $b(r(e.Sa,e,e.a),e.N)),dc(e.L,e.a,"readystatechange",e.nb),n=e.j?Fa(e.j):{},e.l?(e.o||(e.o="POST"),n["Content-Type"]="application/x-www-form-urlencoded",e.a.fa(e.g,e.o,e.l,n)):(e.o="GET",e.a.fa(e.g,e.o,null,n)),Ac(1),tc(e.b,e.o,e.g,e.c,e.T,e.l)}function ad(e){var t=N(e.a),n=e.a.Ga(),r=e.a.W();if(!(t<3||3==t&&!Na&&!e.a.V())){e.B||4!=t||7==n||Ac(8==n||r<=0?3:2),bd(e);var i=e.a.W();e.C=i,(n=e.a.V())||H(e.b,function(){return"No response text for uri "+e.g+" status "+i}),e.f=200==i,uc(e.b,e.o,e.g,e.c,e.T,t,i),e.f?((r=cd(e))&&(G(e.b,e.c,r,"Initial handshake response via X-HTTP-Initial-Response"),e.v=!0,dd(e,r)),e.K?(ed(e,t,n),Na&&e.f&&3==t&&fd(e)):(G(e.b,e.c,n,null),dd(e,n)),4==t&&gd(e),e.f&&!e.B&&(4==t?e.i.ta(e):(e.f=!1,Zc(e)))):(400==i&&0<n.indexOf("Unknown SID")?(e.m=3,K(12),D(e.b.a,"XMLHTTP Unknown SID ("+e.c+")")):(e.m=0,K(13),D(e.b.a,"XMLHTTP Bad status "+i+" ("+e.c+")")),gd(e),hd(e))}}function cd(e){return!e.X||e.v?null:e.a&&(e=id(e.a,"X-HTTP-Initial-Response"))&&!xa(e)?e:null}function ed(e,t,n){for(var r=!0;!e.B&&e.G<n.length;){var i=jd(e,n);if(i==Uc){4==t&&(e.m=4,K(14),r=!1),G(e.b,e.c,null,"[Incomplete Response]");break}if(i==Tc){e.m=4,K(15),G(e.b,e.c,n,"[Invalid Chunk]"),r=!1;break}G(e.b,e.c,i,null),dd(e,i)}4==t&&0==n.length&&(e.m=1,K(16),r=!1),e.f=e.f&&r,r||(G(e.b,e.c,n,"[Invalid Chunked Response]"),gd(e),hd(e))}function fd(e){dc(e.L,e.S,"tick",e.mb),e.S.start()}function jd(e,t){var n=e.G,r=t.indexOf("\n",n);return-1==r?Uc:(n=Number(t.substring(n,r)),isNaN(n)?Tc:(r+=1)+n>t.length?Uc:(t=t.substr(r,n),e.G=r+n,t))}function Zc(e){e.U=t()+e.R,kd(e,e.R)}function kd(e,t){if(null!=e.s)throw Error("WatchDog timer not null");e.s=Ec(r(e.lb,e),t)}function bd(e){e.s&&(k.clearTimeout(e.s),e.s=null)}function hd(e){e.i.La()||e.B||e.i.ta(e)}function gd(e){bd(e);var t=e.I;t&&"function"==typeof t.$&&t.$(),e.I=null,Yb(e.S),ec(e.L),e.a&&(t=e.a,e.a=null,t.abort(),t.$())}function dd(e,t){try{e.i.Oa(e,t),Ac(4)}catch(t){xc(e.b,t,"Error in httprequest callback")}}function ld(e){if(e.A&&"function"==typeof e.A)return e.A();if(l(e))return e.split("");if(ca(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}return Da(e)}function md(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(ca(e)||l(e))ra(e,t,void 0);else{if(e.M&&"function"==typeof e.M)var n=e.M();else if(e.A&&"function"==typeof e.A)n=void 0;else if(ca(e)||l(e)){n=[];for(var r=e.length,i=0;i<r;i++)n.push(i)}else n=Ea(e);i=(r=ld(e)).length;for(var o=0;o<i;o++)t.call(void 0,r[o],n&&n[o],e)}}function O(e,t){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof O)for(n=e.M(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}function od(e){e.b={},e.a.length=0,e.c=0}function pd(e,t){return!!P(e.b,t)&&(delete e.b[t],e.c--,e.a.length>2*e.c&&nd(e),!0)}function nd(e){if(e.c!=e.a.length){for(var t=0,n=0;t<e.a.length;){var r=e.a[t];P(e.b,r)&&(e.a[n++]=r),t++}e.a.length=n}if(e.c!=e.a.length){var i={};for(n=t=0;t<e.a.length;)P(i,r=e.a[t])||(i[e.a[n++]=r]=1),t++;e.a.length=n}}function P(e,t){return Object.prototype.hasOwnProperty.call(e,t)}g=L.prototype,g.setTimeout=function(e){this.R=e},g.nb=function(e){e=e.target;var t=this.I;t&&3==N(e)?(H(this.b,"Throttling readystatechange."),t.cb()):this.Sa(e)},g.Sa=function(e){try{e==this.a?ad(this):D(this.b.a,"Called back with an unexpected xmlhttp")}catch(e){if(H(this.b,"Failed call to OnXmlHttpReadyStateChanged_"),this.a&&this.a.V()){var t=this;xc(this.b,e,function(){return"ResponseText: "+t.a.V()})}else xc(this.b,e,"No response text")}},g.mb=function(){if(this.a){var e=N(this.a),t=this.a.V();this.G<t.length&&(bd(this),ed(this,e,t),this.f&&4!=e&&Zc(this))}},g.cancel=function(){this.B=!0,gd(this)},g.lb=function(){this.s=null;var e=t();0<=e-this.U?(this.f&&J(this.b,"Received watchdog timeout even though request loaded successfully"),wc(this.b,this.g),2!=this.J&&(Ac(3),K(17)),gd(this),this.m=2,hd(this)):(D(this.b.a,"WatchDog timer called too early"),kd(this,this.U-e))},g=O.prototype,g.A=function(){nd(this);for(var e=[],t=0;t<this.a.length;t++)e.push(this.b[this.a[t]]);return e},g.M=function(){return nd(this),this.a.concat()},g.get=function(e,t){return P(this.b,e)?this.b[e]:t},g.set=function(e,t){P(this.b,e)||(this.c++,this.a.push(e)),this.b[e]=t},g.forEach=function(e,t){for(var n=this.M(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);e.call(t,o,i,this)}};var qd=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function rd(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var o=e[n].substring(0,r);i=e[n].substring(r+1)}else o=e[n];t(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function Q(e,t){var n;this.b=this.j=this.f="",this.i=null,this.g=this.a="",this.h=!1,e instanceof Q?(this.h=void 0!==t?t:e.h,sd(this,e.f),this.j=e.j,td(this,e.b),ud(this,e.i),this.a=e.a,vd(this,wd(e.c)),this.g=e.g):e&&(n=String(e).match(qd))?(this.h=!!t,sd(this,n[1]||"",!0),this.j=xd(n[2]||""),td(this,n[3]||"",!0),ud(this,n[4]),this.a=xd(n[5]||"",!0),vd(this,n[6]||"",!0),this.g=xd(n[7]||"")):(this.h=!!t,this.c=new yd(null,this.h))}function M(e){return new Q(e)}function sd(e,t,n){e.f=n?xd(t,!0):t,e.f&&(e.f=e.f.replace(/:$/,""))}function td(e,t,n){e.b=n?xd(t,!0):t}function ud(e,t){if(t){if(t=Number(t),isNaN(t)||t<0)throw Error("Bad port number "+t);e.i=t}else e.i=null}function vd(e,t,n){t instanceof yd?(e.c=t,Ed(e.c,e.h)):(n||(t=zd(t,Fd)),e.c=new yd(t,e.h))}function R(e,t,n){e.c.set(t,n)}function $c(e,t,n){p(n)||(n=[String(n)]),Gd(e.c,t,n)}function Wc(e){return R(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^t()).toString(36)),e}function Hd(e){return e instanceof Q?M(e):new Q(e,void 0)}function Id(e,t,n,r){var i=new Q(null,void 0);return e&&sd(i,e),t&&td(i,t),n&&ud(i,n),r&&(i.a=r),i}function xd(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function zd(e,t,n){return l(e)?(e=encodeURI(e).replace(t,Jd),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Jd(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}Q.prototype.toString=function(){var e=[],t=this.f;t&&e.push(zd(t,Ad,!0),":");var n=this.b;return(n||"file"==t)&&(e.push("//"),(t=this.j)&&e.push(zd(t,Ad,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.i)&&e.push(":",String(n))),(n=this.a)&&(this.b&&"/"!=n.charAt(0)&&e.push("/"),e.push(zd(n,"/"==n.charAt(0)?Bd:Cd,!0))),(n=this.c.toString())&&e.push("?",n),(n=this.g)&&e.push("#",zd(n,Dd)),e.join("")},Q.prototype.resolve=function(e){var t=M(this),n=!!e.f;n?sd(t,e.f):n=!!e.j,n?t.j=e.j:n=!!e.b,n?td(t,e.b):n=null!=e.i;var r=e.a;if(n)ud(t,e.i);else if(n=!!e.a){if("/"!=r.charAt(0))if(this.b&&!this.a)r="/"+r;else{var i=t.a.lastIndexOf("/");-1!=i&&(r=t.a.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(-1!=i.indexOf("./")||-1!=i.indexOf("/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],a=0;a<i.length;){var s=i[a++];"."==s?r&&a==i.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&a==i.length&&o.push("")):(o.push(s),r=!0)}r=o.join("/")}else r=i}return n?t.a=r:n=""!==e.c.toString(),n?vd(t,wd(e.c)):n=!!e.g,n&&(t.g=e.g),t};var Ad=/[#\/\?@]/g,Cd=/[#\?:]/g,Bd=/[#\?]/g,Fd=/[#\?@]/g,Dd=/#/g;function yd(e,t){this.b=this.a=null,this.c=e||null,this.f=!!t}function S(n){n.a||(n.a=new O,n.b=0,n.c&&rd(n.c,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function Ld(e,t){S(e),t=Kd(e,t),P(e.a.b,t)&&(e.c=null,e.b-=e.a.get(t).length,pd(e.a,t))}function Md(e,t){return S(e),t=Kd(e,t),P(e.a.b,t)}function Gd(e,t,n){Ld(e,t),0<n.length&&(e.c=null,e.a.set(Kd(e,t),wa(n)),e.b+=n.length)}function wd(e){var t=new yd;return t.c=e.c,e.a&&(t.a=new O(e.a),t.b=e.b),t}function Kd(e,t){return t=String(t),e.f&&(t=t.toLowerCase()),t}function Ed(e,t){t&&!e.f&&(S(e),e.c=null,e.a.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(Ld(this,t),Gd(this,n,e))},e)),e.f=t}function Pd(){}function Qd(){}function Rd(e,t){this.a=e,this.b=t,this.c=this.i=null,this.h=!1,this.m=null,this.f=-1,this.l=this.g=null}function Sd(e){H(e.b,"TestConnection: starting stage 2");var t=e.a.I.a;if(null!=t)H(e.b,function(){return"Buffered"}),K(4),t?(K(10),Td(e.a,e,!1)):(K(11),Td(e.a,e,!0));else{e.c=new L(e,e.b,void 0,void 0),e.c.j=e.i;var n=Ud(e.a,e.g,e.m);K(4),$c(n,"TYPE","xmlhttp");var r=e.a.j,i=e.a.K;r&&i&&R(n,r,i),Yc(e.c,n,!1,e.g)}}function Wd(){this.a=this.b=null}function Xd(){this.a=new O}function Yd(e){var t=typeof e;return"object"==t&&e||"function"==t?"o"+(e[q]||(e[q]=++fa)):t.charAt(0)+e}function Zd(e,t){this.a=e,this.b=t}function $d(e){this.g=e||ae,e=k.PerformanceNavigationTiming?0<(e=k.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(k.oa&&k.oa.Ma&&k.oa.Ma()&&k.oa.Ma().Jb),this.f=e?this.g:1,this.a=null,1<this.f&&(this.a=new Xd),this.b=null,this.c=[]}g=yd.prototype,g.add=function(e,t){S(this),this.c=null,e=Kd(this,e);var n=this.a.get(e);return n||this.a.set(e,n=[]),n.push(t),this.b+=1,this},g.forEach=function(n,r){S(this),this.a.forEach(function(e,t){ra(e,function(e){n.call(r,e,t,this)},this)},this)},g.M=function(){S(this);for(var e=this.a.A(),t=this.a.M(),n=[],r=0;r<t.length;r++)for(var i=e[r],o=0;o<i.length;o++)n.push(t[r]);return n},g.A=function(e){S(this);var t=[];if(l(e))Md(this,e)&&(t=va(t,this.a.get(Kd(this,e))));else{e=this.a.A();for(var n=0;n<e.length;n++)t=va(t,e[n])}return t},g.set=function(e,t){return S(this),this.c=null,Md(this,e=Kd(this,e))&&(this.b-=this.a.get(e).length),this.a.set(e,[t]),this.b+=1,this},g.get=function(e,t){return 0<(e=e?this.A(e):[]).length?String(e[0]):t},g.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var e=[],t=this.a.M(),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.A(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),e.push(a)}}return this.c=e.join("&")},u(Qd,Pd),g=Rd.prototype,g.P=null,g.ca=function(e){return this.a.ca(e)},g.abort=function(){this.c&&(this.c.cancel(),this.c=null),this.f=-1},g.La=function(){return!1},g.Oa=function(e,t){if(this.f=e.C,0==this.P){if(H(this.b,"TestConnection: Got data for stage 1"),!this.a.o&&(e=e.a)){var n=id(e,"X-Client-Wire-Protocol");this.l=n||null,this.a.j&&((e=id(e,"X-HTTP-Session-Id"))?this.a.K=e:D(this.b.a,"Missing X_HTTP_SESSION_ID in the handshake response"))}if(t){try{var r=this.a.la.a.parse(t)}catch(e){return xc(this.b,e),void Vd(this.a,this)}this.g=r[0]}else H(this.b,"TestConnection: Null responseText"),Vd(this.a,this)}else 1==this.P&&(this.h?K(6):"11111"==t?(K(5),this.h=!0,(!z||10<=Number(Wa))&&(this.f=200,this.c.cancel(),H(this.b,"Test connection succeeded; using streaming connection"),K(11),Td(this.a,this,!0))):(K(7),this.h=!1))},g.ta=function(){this.f=this.c.C,this.c.f?0==this.P?(this.P=1,H(this.b,"TestConnection: request complete for initial check"),Sd(this)):1==this.P&&(H(this.b,"TestConnection: request complete for stage 2"),this.h?(H(this.b,"Test connection succeeded; using streaming connection"),K(11),Td(this.a,this,!0)):(H(this.b,"Test connection failed; not using streaming"),K(10),Td(this.a,this,!1))):(H(this.b,"TestConnection: request failed, in state "+this.P),0==this.P?K(8):1==this.P&&K(9),Vd(this.a,this))},g.ia=function(){return this.a.ia()},g.qa=function(){return this.a.qa()},Xd.prototype.add=function(e){this.a.set(Yd(e),e)},Xd.prototype.A=function(){return this.a.A()};var ae=10;function be(e,t){e.a||-1==t.indexOf("spdy")&&-1==t.indexOf("quic")&&-1==t.indexOf("h2")||(e.f=e.g,e.a=new Xd,e.b&&(ce(e,e.b),e.b=null))}function de(e){return!!e.b||!!e.a&&e.a.a.c>=e.f}function ee(e,t){return e.b?e=e.b==t:e.a?(t=Yd(t),e=P(e.a.a.b,t)):e=!1,e}function ce(e,t){e.a?e.a.add(t):e.b=t}function fe(e,t){var n;e.b&&e.b==t?e.b=null:((n=e.a)&&(n=Yd(t),n=P(e.a.a.b,n)),n&&pd(e.a.a,Yd(t)))}function ge(e){if(null!=e.b)return e.c.concat(e.b.u);if(null!=e.a&&0!=e.a.a.c){var t=e.c;return ra(e.a.A(),function(e){t=t.concat(e.u)}),t}return wa(e.c)}function he(e,t){e.c=e.c.concat(t)}function ie(){}function je(){this.a=new ie}function ke(e,r,t){var i=t||"";try{md(e,function(e,t){var n=e;ea(e)&&(n=Db(e)),r.push(i+t+"="+encodeURIComponent(n))})}catch(e){throw r.push(i+"type="+encodeURIComponent("_badmap")),e}}function le(e,t){var n=new sc;H(n,"TestLoadImage: loading "+e);var r=new Image;r.onload=ja(me,n,r,"TestLoadImage: loaded",!0,t),r.onerror=ja(me,n,r,"TestLoadImage: error",!1,t),r.onabort=ja(me,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=ja(me,n,r,"TestLoadImage: timeout",!1,t),k.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}function me(e,t,n,r,i){try{H(e,n),t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(t){xc(e,t)}}function T(e){B.call(this),this.headers=new O,this.s=e||null,this.c=!1,this.D=this.a=null,this.K=this.B="",this.j=0,this.g="",this.h=this.I=this.u=this.G=!1,this.l=0,this.C=null,this.L=ne,this.v=this.o=!1}$d.prototype.cancel=function(){this.c=ge(this),this.b?(this.b.cancel(),this.b=null):this.a&&0!=this.a.a.c&&(ra(this.a.A(),function(e){e.cancel()}),od(this.a.a))},ie.prototype.stringify=function(e){return k.JSON.stringify(e,void 0)},ie.prototype.parse=function(e){return k.JSON.parse(e,void 0)},u(T,B);var ne="";T.prototype.b=qc("goog.net.XhrIo");var oe=/^https?$/i,pe=["POST","PUT"];function se(e){return z&&Va(9)&&"number"==typeof e.timeout&&void 0!==e.ontimeout}function ta(e){return"content-type"==e.toLowerCase()}function qe(e,t){e.c=!1,e.a&&(e.h=!0,e.a.abort(),e.h=!1),e.g=t,e.j=5,te(e),ue(e)}function te(e){e.G||(e.G=!0,e.dispatchEvent("complete"),e.dispatchEvent("error"))}function ve(e){if(e.c&&void 0!==goog)if(e.D[1]&&4==N(e)&&2==e.W())E(e.b,U(e,"Local request error detected and ignored"));else if(e.u&&4==N(e))Zb(e.Na,0,e);else if(e.dispatchEvent("readystatechange"),4==N(e)){E(e.b,U(e,"Request complete")),e.c=!1;try{var t,n=e.W();e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var i;if(i=0===n){var o=String(e.B).match(qd)[1]||null;if(!o&&k.self&&k.self.location){var a=k.self.location.protocol;o=a.substr(0,a.length-1)}i=!oe.test(o?o.toLowerCase():"")}t=i}t?(e.dispatchEvent("complete"),e.dispatchEvent("success")):(e.j=6,e.g=e.Ha()+" ["+e.W()+"]",te(e))}finally{ue(e)}}}function ue(e,t){if(e.a){re(e);var n=e.a,r=e.D[0]?aa:null;e.a=null,e.D=null,t||e.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){(e=e.b)&&e.log(ic,"Problem encountered resetting onreadystatechange: "+t.message,void 0)}}}function re(e){e.a&&e.v&&(e.a.ontimeout=null),e.C&&(k.clearTimeout(e.C),e.C=null)}function N(e){return e.a?e.a.readyState:0}function id(e,t){return e.a?e.a.getResponseHeader(t):null}function U(e,t){return t+" ["+e.K+" "+e.B+" "+e.W()+"]"}function we(e){var n="";return Ca(e,function(e,t){n+=t,n+=":",n+=e,n+="\r\n"}),n}function xe(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}if(r)return e;if(n=we(n),l(e)){if(t=encodeURIComponent(String(t)),t+=n=null!=n?"="+encodeURIComponent(String(n)):""){if((n=e.indexOf("#"))<0&&(n=e.length),(r=e.indexOf("?"))<0||n<r){r=n;var i=""}else i=e.substring(r+1,n);n=(e=[e.substr(0,r),i,e.substr(n)])[1],e[1]=t?n?n+"&"+t:t:n,e=e[0]+(e[1]?"?"+e[1]:"")+e[2]}return e}return R(e,t,n),e}function ye(e){this.ya=0,this.g=[],this.a=new sc,this.I=new Wd,this.X=this.ua=this.D=this.ja=this.b=this.K=this.j=this.U=this.h=this.L=this.i=null,this.Za=this.R=0,this.Xa=!!n("internalChannelParams.failFast",e),this.ka=this.C=this.s=this.l=this.m=this.f=null,this.u=this.xa=this.N=-1,this.T=this.B=this.v=0,this.Wa=n("internalChannelParams.baseRetryDelayMs",e)||5e3,this.$a=n("internalChannelParams.retryDelaySeedMs",e)||1e4,this.Ya=n("internalChannelParams.forwardChannelMaxRetries",e)||2,this.wa=n("internalChannelParams.forwardChannelRequestTimeoutMs",e)||2e4,this.Ta=e&&e.Kb||void 0,this.G=void 0,this.S=e&&e.supportsCrossDomainXhr||!1,this.J="",this.c=new $d(e&&e.concurrentRequestLimit),this.la=new je,this.o=!e||void 0===e.backgroundChannelTest||e.backgroundChannelTest,(this.va=e&&e.fastHandshake||!1)&&!this.o&&(D(this.a.a,"Force backgroundChannelTest when fastHandshake is enabled."),this.o=!0),e&&e.Fa&&this.a.Fa()}function ze(e){if(H(e.a,"disconnect()"),Ae(e),3==e.F){var n=e.R++,r=M(e.D);R(r,"SID",e.J),R(r,"RID",n),R(r,"TYPE","terminate"),Be(e,r),(n=new L(e,e.a,n,void 0)).J=2,n.h=Wc(M(r)),r=!1,k.navigator&&k.navigator.sendBeacon&&(r=k.navigator.sendBeacon(n.h.toString(),"")),!r&&k.Image&&((new Image).src=n.h,r=!0),r||(n.a=n.i.ca(null),n.a.fa(n.h)),n.D=t(),Zc(n)}Ce(e)}function Ae(e){e.C&&(e.C.abort(),e.C=null),e.b&&(e.b.cancel(),e.b=null),e.l&&(k.clearTimeout(e.l),e.l=null),De(e),e.c.cancel(),e.m&&(k.clearTimeout(e.m),e.m=null)}function Ee(e,t){1e3==e.g.length&&J(e.a,function(){return"Already have 1000 queued maps upon queueing "+Db(t)}),e.g.push(new Zd(e.Za++,t)),3==e.F&&Fe(e)}function Fe(e){de(e.c)||e.m||(e.m=Ec(r(e.Qa,e),0),e.v=0)}function Ge(e,t){var n=e.c;return(n.b?1:n.a?n.a.a.c:0)>=e.c.f-(e.m?1:0)?(J(e.a,"Unexpected retry request is scheduled."),!1):e.m?(H(e.a,"Use the retry request that is already scheduled."),e.g=t.u.concat(e.g),!0):!(1==e.F||2==e.F||e.v>=(e.Xa?0:e.Ya)||(H(e.a,"Going to retry POST"),e.m=Ec(r(e.Qa,e,t),He(e,e.v)),e.v++,0))}function Je(e,t){var n;n=t?t.c:e.R++;var r=M(e.D);R(r,"SID",e.J),R(r,"RID",n),R(r,"AID",e.N),Be(e,r),e.h&&e.i&&xe(r,e.h,e.i),n=new L(e,e.a,n,e.v+1),null===e.h&&(n.j=e.i),t&&(e.g=t.u.concat(e.g)),t=Ie(e,n),n.setTimeout(Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random())),ce(e.c,n),Vc(n,r,t)}function Be(e,n){e.f&&md({},function(e,t){R(n,t,e)})}function Ie(e,t){var n=Math.min(e.g.length,1e3),i=e.f?r(e.f.ab,e.f,e):null;e:for(var o=e.g,a=-1;;){var s=["count="+n];-1==a?0<n?(a=o[0].a,s.push("ofs="+a)):a=0:s.push("ofs="+a);for(var u=!0,c=0;c<n;c++){var l=o[c].a,h=o[c].b;if((l-=a)<0)a=Math.max(0,o[c].a-100),u=!1;else try{ke(h,s,"req"+l+"_")}catch(e){i&&i(h)}}if(u){i=s.join("&");break e}}return e=e.g.splice(0,n),t.u=e,i}function Ke(e){if(!e.b&&!e.l){e.T=1;var t=e.Pa;Tb||Ub(),Wb||(Tb(),Wb=!0),Pb.add(t,e),e.B=0}}function Le(e){return e.b||e.l?(J(e.a,"Request already in progress"),!1):!(3<=e.B||(H(e.a,"Going to retry GET"),e.T++,e.l=Ec(r(e.Pa,e),He(e,e.B)),e.B++,0))}function Td(e,t,n){H(e.a,"Test Connection Finished");var r=t.l;r&&be(e.c,r),e.ka=n,e.u=t.f,H(e.a,"connectChannel_()"),e.D=Me(e,e.ja),Fe(e)}function Vd(e,t){H(e.a,"Test Connection Failed"),e.u=t.f,V(e,2)}function De(e){null!=e.s&&(k.clearTimeout(e.s),e.s=null)}function He(e,t){var n=e.Wa+Math.floor(Math.random()*e.$a);return e.qa()||(H(e.a,"Inactive channel"),n*=2),n*t}function V(e,t){if(F(e.a,"Error code "+t),2==t){var n=null;e.f&&(n=null);var i=r(e.pb,e);n||(n=new Q("//www.google.com/images/cleardot.gif"),k.location&&"http"==k.location.protocol||sd(n,"https"),Wc(n)),le(n.toString(),i)}else K(2);H(e.a,"HttpChannel: error - "+t),e.F=0,e.f&&e.f.Ba(t),Ce(e),Ae(e)}function Ce(e){if(e.F=0,e.u=-1,e.f){var t=ge(e.c);0==t.length&&0==e.g.length||(H(e.a,function(){return"Number of undelivered maps, pending: "+t.length+", outgoing: "+e.g.length}),e.c.c.length=0,wa(e.g),e.g.length=0),e.f.Aa()}}function Me(e,t){return t=Ne(e,null,t),H(e.a,"GetForwardChannelUri: "+t),t}function Ud(e,t,n){return t=Ne(e,e.ia()?t:null,n),H(e.a,"GetBackChannelUri: "+t),t}function Ne(e,t,n){var r=Hd(n);if(""!=r.b)t&&td(r,t+"."+r.b),ud(r,r.i);else{var i,o=k.location;i=t?t+"."+o.hostname:o.hostname,r=Id(o.protocol,i,o.port,n)}return e.U&&Ca(e.U,function(e,t){R(r,t,e)}),t=e.j,n=e.K,t&&n&&R(r,t,n),R(r,"VER",e.na),Be(e,r),r}function Oe(){}function Pe(e){for(var t=e,n=1;n<arguments.length;n++){var r,i=arguments[n];0==i.lastIndexOf("/",0)?t=i:((r=""==t)||(r=0<=(r=t.length-1)&&t.indexOf("/",r)==r),t+=r?i:"/"+i)}return t}function Qe(){if(z&&!(10<=Number(Wa)))throw Error("Environmental error: no available transport.")}function W(e,t){B.call(this),this.a=new ye(t),this.b=e,this.o=t&&t.testUrl?t.testUrl:Pe(this.b,"test"),this.c=qc("goog.labs.net.webChannel.WebChannelBaseTransport"),this.g=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.a.i=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.Ea&&(e?e["X-WebChannel-Client-Profile"]=t.Ea:e={"X-WebChannel-Client-Profile":t.Ea}),this.a.L=e,(e=t&&t.httpHeadersOverwriteParam)&&!xa(e)&&(this.a.h=e),this.l=t&&t.supportsCrossDomainXhr||!1,this.j=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!xa(t)&&(this.a.j=t,null!==(e=this.g)&&t in e&&(t in(e=this.g)&&delete e[t],D(this.c,"Ignore httpSessionIdParam also specified with messageUrlParams: "+t))),this.h=new Re(this)}function Se(e){Mc.call(this);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.c=e)?(e=this.c,this.data=null!==t&&e in t?t[e]:void 0):this.data=t}else this.data=e}function Te(){Nc.call(this),this.status=1}function Re(e){this.a=e}g=T.prototype,g.fa=function(e,t,n,i){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+e);t=t?t.toUpperCase():"GET",this.B=e,this.g="",this.j=0,this.K=t,this.G=!1,this.c=!0,this.a=this.s?Qc(this.s):Qc(Oc),this.D=this.s?Ic(this.s):Ic(Oc),this.a.onreadystatechange=r(this.Na,this);try{E(this.b,U(this,"Opening Xhr")),this.I=!0,this.a.open(t,String(e),!0),this.I=!1}catch(e){return E(this.b,U(this,"Error opening Xhr: "+e.message)),void qe(this,e)}e=n||"";var o=new O(this.headers);i&&md(i,function(e,t){o.set(t,e)}),i=sa(o.M()),n=k.FormData&&e instanceof k.FormData,!(0<=qa(pe,t))||i||n||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(e,t){this.a.setRequestHeader(t,e)},this),this.L&&(this.a.responseType=this.L),"withCredentials"in this.a&&this.a.withCredentials!==this.o&&(this.a.withCredentials=this.o);try{re(this),0<this.l&&(this.v=se(this.a),E(this.b,U(this,"Will abort after "+this.l+"ms if incomplete, xhr2 "+this.v)),this.v?(this.a.timeout=this.l,this.a.ontimeout=r(this.Ka,this)):this.C=Zb(this.Ka,this.l,this)),E(this.b,U(this,"Sending request")),this.u=!0,this.a.send(e),this.u=!1}catch(e){E(this.b,U(this,"Send error: "+e.message)),qe(this,e)}},g.Ka=function(){void 0!==goog&&this.a&&(this.g="Timed out after "+this.l+"ms, aborting",this.j=8,E(this.b,U(this,this.g)),this.dispatchEvent("timeout"),this.abort(8))},g.abort=function(e){this.a&&this.c&&(E(this.b,U(this,"Aborting")),this.c=!1,this.h=!0,this.a.abort(),this.h=!1,this.j=e||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),ue(this))},g.w=function(){this.a&&(this.c&&(this.c=!1,this.h=!0,this.a.abort(),this.h=!1),ue(this,!0)),T.H.w.call(this)},g.Na=function(){this.i||(this.I||this.u||this.h?ve(this):this.jb())},g.jb=function(){ve(this)},g.W=function(){try{return 2<N(this)?this.a.status:-1}catch(e){return-1}},g.Ha=function(){try{return 2<N(this)?this.a.statusText:""}catch(e){return E(this.b,"Can not get status: "+e.message),""}},g.V=function(){try{return this.a?this.a.responseText:""}catch(e){return E(this.b,"Can not get responseText: "+e.message),""}},g.eb=function(e){if(this.a){var t=this.a.responseText;e&&0==t.indexOf(e)&&(t=t.substring(e.length));e:{if(e=t,k.JSON)try{var n=k.JSON.parse(e);break e}catch(e){}n=Cb(e)}return n}},g.Ga=function(){return this.j},g.hb=function(){return l(this.g)?this.g:String(this.g)},g=ye.prototype,g.na=8,g.F=1,g.La=function(){return 0==this.F},g.Qa=function(e){if(this.m=null,H(this.a,"startForwardChannel_"),1==this.F)if(e)J(this.a,"Not supposed to retry the open");else{H(this.a,"open_()"),this.R=Math.floor(1e5*Math.random()),e=this.R++;var t=new L(this,this.a,e,void 0),n=this.i;this.L&&(n?Ha(n=Fa(n),this.L):n=this.L),null===this.h&&(t.j=n);var r=Ie(this,t),i=M(this.D);R(i,"RID",e),R(i,"CVER",22),this.o&&this.j&&R(i,"X-HTTP-Session-Id",this.j),Be(this,i),this.h&&n&&xe(i,this.h,n),ce(this.c,t),this.va?(R(i,"$req",r),R(i,"SID","null"),t.X=!0,Vc(t,i,null)):Vc(t,i,r),this.F=2}else 3==this.F&&(e?Je(this,e):0==this.g.length?H(this.a,"startForwardChannel_ returned: nothing to send"):de(this.c)?J(this.a,"startForwardChannel_ returned: connection already in progress"):(Je(this),H(this.a,"startForwardChannel_ finished, sent request")))},g.Pa=function(){this.l=null,H(this.a,"Creating new HttpRequest"),this.b=new L(this,this.a,"rpc",this.T),null===this.h&&(this.b.j=this.i),this.b.N=0;var e=M(this.ua);R(e,"RID","rpc"),R(e,"SID",this.J),R(e,"CI",this.ka?"0":"1"),R(e,"AID",this.N),Be(this,e),R(e,"TYPE","xmlhttp"),this.h&&this.i&&xe(e,this.h,this.i),this.G&&this.b.setTimeout(this.G),Yc(this.b,e,!0,this.X),H(this.a,"New Request created")},g.Oa=function(e,t){if(0!=this.F&&(this.b==e||ee(this.c,e)))if(this.u=e.C,!e.v&&ee(this.c,e)&&3==this.F){try{var n=this.la.a.parse(t)}catch(e){n=null}if(p(n)&&3==n.length)if(0==(t=n)[0])e:if(H(this.a,"Server claims our backchannel is missing."),this.l)H(this.a,"But we are currently starting the request.");else{if(this.b){if(!(this.b.D+3e3<e.D))break e;De(this),this.b.cancel(),this.b=null}else D(this.a.a,"We do not have a BackChannel established");Le(this),K(18)}else this.xa=t[1],0<(e=this.xa-this.N)&&(t=t[2],H(this.a,t+" bytes (in "+e+" arrays) are outstanding on the BackChannel"),t<37500&&this.ka&&0==this.B&&!this.s&&(this.s=Ec(r(this.ib,this),6e3)));else H(this.a,"Bad POST response data returned"),V(this,11)}else if((e.v||this.b==e)&&De(this),!xa(t))for(t=n=this.la.a.parse(t),n=0;n<t.length;n++){var i=t[n];if(this.N=i[0],i=i[1],2==this.F)if("c"==i[0]){this.J=i[1],this.X=i[2];var o=i[3];null!=o&&(this.na=o,F(this.a,"VER="+this.na)),null!=(o=i[4])&&(this.ya=o,F(this.a,"SVER="+this.ya)),null!=(i=i[5])&&"number"==typeof i&&0<i&&(this.G=i*=1.5,F(this.a,"backChannelRequestTimeoutMs_="+i)),this.o&&(i=e.a)&&((o=id(i,"X-Client-Wire-Protocol"))&&be(this.c,o),this.j&&((i=id(i,"X-HTTP-Session-Id"))?(this.K=i,R(this.D,this.j,i)):D(this.a.a,"Missing X_HTTP_SESSION_ID in the handshake response"))),this.F=3,this.f&&this.f.Da(),i=e,this.ua=Ud(this,this.X,this.ja),i.v?(H(this.a,"Upgrade the handshake request to a backchannel."),fe(this.c,i),(o=this.G)&&i.setTimeout(o),i.s&&(bd(i),Zc(i)),this.b=i):Ke(this)}else"stop"!=i[0]&&"close"!=i[0]||V(this,7);else 3==this.F&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?V(this,7):ze(this):"noop"!=i[0]&&this.f&&this.f.Ca(i),this.B=0)}},g.ib=function(){null!=this.s&&(this.s=null,this.b.cancel(),this.b=null,Le(this),K(19))},g.ta=function(e){H(this.a,"Request complete");var n=null;if(this.b==e){De(this),this.b=null;var r=2}else{if(!ee(this.c,e))return;n=e.u,fe(this.c,e),r=1}if(this.u=e.C,0!=this.F)if(e.f)1==r?(Dc(e.l?e.l.length:0,t()-e.D,this.v),Fe(this)):Ke(this);else{var i=e.m;if(3==i||0==i&&0<this.u)H(this.a,"Not retrying due to error type");else{var o=this;if(H(this.a,function(){return"Maybe retrying, last error: "+Sc(i,o.u)}),1==r&&Ge(this,e)||2==r&&Le(this))return;H(this.a,"Exceeded max number of retries")}switch(n&&0<n.length&&he(this.c,n),H(this.a,"Error: HTTP request failed"),i){case 1:V(this,5);break;case 4:V(this,10);break;case 3:V(this,6);break;default:V(this,2)}}},g.pb=function(e){e?(F(this.a,"Successfully pinged google.com"),K(2)):(F(this.a,"Failed to ping google.com"),K(1))},g.ca=function(e){if(e&&!this.S)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new T(this.Ta)).o=this.S,e},g.qa=function(){return!!this.f&&!0},g.ia=function(){return this.S},g=Oe.prototype,g.Da=function(){},g.Ca=function(){},g.Ba=function(){},g.Aa=function(){},g.ab=function(){},Qe.prototype.a=function(e,t){return new W(e,t)},u(W,B),g=W.prototype,g.addEventListener=function(e,t,n,r){W.H.addEventListener.call(this,e,t,n,r)},g.removeEventListener=function(e,t,n,r){W.H.removeEventListener.call(this,e,t,n,r)},g.fb=function(){this.a.f=this.h,this.l&&(this.a.S=!0);var e=this.a,t=this.o,n=this.b,r=this.g||void 0;H(e.a,"connect()"),K(0),e.ja=n,e.U=r||{},e.o&&(H(e.a,"connect() bypassed channel-test."),e.I.b=[],e.I.a=!1),H(e.a,"connectTest_()"),e.C=new Rd(e,e.a),null===e.h&&(e.C.i=e.i),n=t,e.h&&e.i&&(n=xe(t,e.h,e.i)),(e=e.C).m=n,t=Me(e.a,e.m),K(3),null!=(n=e.a.I.b)?(e.g=n[0],e.P=1,Sd(e)):($c(t,"MODE","init"),!e.a.o&&e.a.j&&$c(t,"X-HTTP-Session-Id",e.a.j),e.c=new L(e,e.b,void 0,void 0),e.c.j=e.i,Yc(e.c,t,!1,null),e.P=0)},g.close=function(){ze(this.a)},g.gb=function(e){if(l(e)){var t={};t.__data__=e,Ee(this.a,t)}else this.j?((t={}).__data__=Db(e),Ee(this.a,t)):Ee(this.a,e)},g.w=function(){this.a.f=null,delete this.h,ze(this.a),delete this.a,W.H.w.call(this)},u(Se,Mc),u(Te,Nc),u(Re,Oe),Re.prototype.Da=function(){rc(this.a.c,"WebChannel opened on "+this.a.b),this.a.dispatchEvent("a")},Re.prototype.Ca=function(e){this.a.dispatchEvent(new Se(e))},Re.prototype.Ba=function(e){rc(this.a.c,"WebChannel aborted on "+this.a.b+" due to channel error: "+e),this.a.dispatchEvent(new Te(e))},Re.prototype.Aa=function(){rc(this.a.c,"WebChannel closed on "+this.a.b),this.a.dispatchEvent("b")};var Ue=ja(function(e,t){function n(){}n.prototype=e.prototype;var r=new n;return e.apply(r,Array.prototype.slice.call(arguments,1)),r},Qe);function Ve(){this.b=[],this.a=[]}function We(e){return 0==e.b.length&&(e.b=e.a,e.b.reverse(),e.a=[]),e.b.pop()}function Xe(e){return e.b.length+e.a.length}function Ye(e,t){if(w.call(this),this.h=e||0,this.c=t||10,this.h>this.c)throw Error(Ze);this.a=new Ve,this.b=new Xd,this.g=null,this.aa()}Ve.prototype.A=function(){for(var e=[],t=this.b.length-1;0<=t;--t)e.push(this.b[t]);var n=this.a.length;for(t=0;t<n;++t)e.push(this.a[t]);return e},u(Ye,w);var Ze="[goog.structs.Pool] Min can not be greater than max";function af(e){if("function"==typeof e.$)e.$();else for(var t in e)e[t]=null}function $e(e){return Xe(e.a)+e.b.a.c}function bf(e,t){this.a=e,this.b=t}function cf(e){if(this.a=[],e)e:{if(e instanceof cf){var t=e.M();if(e=e.A(),this.a.length<=0){for(var n=this.a,r=0;r<t.length;r++)n.push(new bf(t[r],e[r]));break e}}else t=Ea(e),e=Da(e);for(r=0;r<t.length;r++)df(this,t[r],e[r])}}function df(e,t,n){var r=e.a;for(r.push(new bf(t,n)),t=r.length-1,n=(e=e.a)[t];0<t&&e[r=t-1>>1].a>n.a;)e[t]=e[r],t=r;e[t]=n}function ef(){cf.call(this)}function Y(e,t){this.f=new ef,Ye.call(this,e,t)}function Z(e,t,n,r){this.l=e,this.j=!!r,Y.call(this,t,n)}g=Ye.prototype,g.da=function(){var e=t();if(!(null!=this.g&&e-this.g<0)){for(var n;0<Xe(this.a)&&(n=We(this.a),!this.sa(n));)this.aa();return!n&&$e(this)<this.c&&(n=this.pa()),n&&(this.g=e,this.b.add(n)),n}},g.ob=function(e){return!!pd(this.b.a,Yd(e))&&(this.ma(e),!0)},g.ma=function(e){pd(this.b.a,Yd(e)),this.sa(e)&&$e(this)<this.c?this.a.a.push(e):af(e)},g.aa=function(){for(var e=this.a;$e(this)<this.h;){var t=this.pa();e.a.push(t)}for(;$e(this)>this.c&&0<Xe(this.a);)af(We(e))},g.pa=function(){return{}},g.sa=function(e){return"function"!=typeof e.bb||e.bb()},g.w=function(){if(Ye.H.w.call(this),0<this.b.a.c)throw Error("[goog.structs.Pool] Objects not released");delete this.b;for(var e=this.a;0!=e.b.length||0!=e.a.length;)af(We(e));delete this.a},cf.prototype.A=function(){for(var e=this.a,t=[],n=e.length,r=0;r<n;r++)t.push(e[r].b);return t},cf.prototype.M=function(){for(var e=this.a,t=[],n=e.length,r=0;r<n;r++)t.push(e[r].a);return t},u(ef,cf),u(Y,Ye),g=Y.prototype,g.da=function(e,t){if(!e)return Y.H.da.call(this);df(this.f,void 0!==t?t:100,e),this.ra()},g.ra=function(){for(var e=this.f;0<e.a.length;){var t=this.da();if(!t)break;var n=e,r=n.a,i=r.length,o=r[0];if(i<=0)o=void 0;else{if(1==i)ua(r);else{r[0]=r.pop(),r=0,i=(n=n.a).length;for(var a=n[r];r<i>>1;){var s=2*r+1,u=2*r+2;if(n[s=u<i&&n[u].a<n[s].a?u:s].a>a.a)break;n[r]=n[s],r=s}n[r]=a}o=o.b}o.apply(this,[t])}},g.ma=function(e){Y.H.ma.call(this,e),this.ra()},g.aa=function(){Y.H.aa.call(this),this.ra()},g.w=function(){Y.H.w.call(this),k.clearTimeout(void 0),ua(this.f.a),this.f=null},u(Z,Y),Z.prototype.pa=function(){var n=new T,e=this.l;return e&&e.forEach(function(e,t){n.headers.set(t,e)}),this.j&&(n.o=!0),n},Z.prototype.sa=function(e){return!e.i&&!e.a},Qe.prototype.createWebChannel=Qe.prototype.a,W.prototype.send=W.prototype.gb,W.prototype.open=W.prototype.fb,W.prototype.close=W.prototype.close,Fc.NO_ERROR=0,Fc.TIMEOUT=8,Fc.HTTP_ERROR=6,Gc.COMPLETE="complete",Kc.EventType=Lc,Lc.OPEN="a",Lc.CLOSE="b",Lc.ERROR="c",Lc.MESSAGE="d",B.prototype.listen=B.prototype.Ia,Z.prototype.getObject=Z.prototype.da,Z.prototype.releaseObject=Z.prototype.ob,T.prototype.listenOnce=T.prototype.Ja,T.prototype.getLastError=T.prototype.hb,T.prototype.getLastErrorCode=T.prototype.Ga,T.prototype.getStatus=T.prototype.W,T.prototype.getStatusText=T.prototype.Ha,T.prototype.getResponseJson=T.prototype.eb,T.prototype.getResponseText=T.prototype.V,T.prototype.getResponseText=T.prototype.V,T.prototype.send=T.prototype.fa,module.exports={createWebChannelTransport:Ue,ErrorCode:Fc,EventType:Gc,WebChannel:Kc,XhrIoPool:Z}}).call(void 0!==commonjsGlobal?commonjsGlobal:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})}),dist_1=dist.createWebChannelTransport,dist_2=dist.ErrorCode,dist_3=dist.EventType,dist_4=dist.WebChannel,dist_5=dist.XhrIoPool,SDK_VERSION=firebase.SDK_VERSION,logClient$1=new Logger("@firebase/firestore"),LogLevel$1,LogLevel$$1;function getLogLevel(){return logClient$1.logLevel===LogLevel.DEBUG?LogLevel$1.DEBUG:logClient$1.logLevel===LogLevel.SILENT?LogLevel$1.SILENT:LogLevel$1.ERROR}function setLogLevel$1(e){switch(e){case LogLevel$1.DEBUG:logClient$1.logLevel=LogLevel.DEBUG;break;case LogLevel$1.ERROR:logClient$1.logLevel=LogLevel.ERROR;break;case LogLevel$1.SILENT:logClient$1.logLevel=LogLevel.SILENT;break;default:logClient$1.error("Firestore ("+SDK_VERSION+"): Invalid value passed to `setLogLevel`")}}function debug(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(logClient$1.logLevel<=LogLevel.DEBUG){var i=n.map(argToString);logClient$1.debug.apply(logClient$1,["Firestore ("+SDK_VERSION+") ["+e+"]: "+t].concat(i))}}function error$2(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(logClient$1.logLevel<=LogLevel.ERROR){var r=t.map(argToString);logClient$1.error.apply(logClient$1,["Firestore ("+SDK_VERSION+"): "+e].concat(r))}}function argToString(e){if("string"==typeof e)return e;var t=PlatformSupport.getPlatform();try{return t.formatJSON(e)}catch(t){return e}}function fail(e){var t="FIRESTORE ("+SDK_VERSION+") INTERNAL ASSERTION FAILED: "+e;throw error$2(t),new Error(t)}function assert$1(e,t){e||fail(t)}LogLevel$$1=LogLevel$1||(LogLevel$1={}),LogLevel$$1[LogLevel$$1.DEBUG=0]="DEBUG",LogLevel$$1[LogLevel$$1.ERROR=1]="ERROR",LogLevel$$1[LogLevel$$1.SILENT=2]="SILENT";var PlatformSupport=function(){function t(){}return t.setPlatform=function(e){t.platform&&fail("Platform already defined"),t.platform=e},t.getPlatform=function(){return t.platform||fail("Platform not set"),t.platform},t}();function emptyByteString(){return PlatformSupport.getPlatform().emptyByteString}var Code={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},FirestoreError=function(r){function e(e,t){var n=r.call(this,t)||this;return n.code=e,n.message=t,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}return __extends(e,r),e}(Error);function makeConstructorPrivate(e,t){function n(){var e="This constructor is private.";throw t&&(e+=" ",e+=t),new FirestoreError(Code.INVALID_ARGUMENT,e)}for(var r in n.prototype=e.prototype,e)e.hasOwnProperty(r)&&(n[r]=e[r]);return n}function contains$2(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function defaulted(e,t){return void 0!==e?e:t}function forEachNumber(e,t){for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Number(n);isNaN(r)||t(r,e[n])}}function forEach$1(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function isEmpty$1(e){for(var t in assert$1(null!=e&&"object"==typeof e,"isEmpty() expects object parameter."),e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function shallowCopy(e){assert$1(e&&"object"==typeof e,"shallowCopy() expects object parameter.");var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}function validateExactNumberOfArgs(e,t,n){if(t.length!==n)throw new FirestoreError(Code.INVALID_ARGUMENT,"Function "+e+"() requires "+formatPlural(n,"argument")+", but was called with "+formatPlural(t.length,"argument")+".")}function validateAtLeastNumberOfArgs(e,t,n){if(t.length<n)throw new FirestoreError(Code.INVALID_ARGUMENT,"Function "+e+"() requires at least "+formatPlural(n,"argument")+", but was called with "+formatPlural(t.length,"argument")+".")}function validateBetweenNumberOfArgs(e,t,n,r){if(t.length<n||t.length>r)throw new FirestoreError(Code.INVALID_ARGUMENT,"Function "+e+"() requires between "+n+" and "+r+" arguments, but was called with "+formatPlural(t.length,"argument")+".")}function validateNamedArrayAtLeastNumberOfElements(e,t,n,r){if(!(t instanceof Array)||t.length<r)throw new FirestoreError(Code.INVALID_ARGUMENT,"Function "+e+"() requires its "+n+" argument to be an array with at least "+formatPlural(r,"element")+".")}function validateArgType(e,t,n,r){validateType(e,t,ordinal(n)+" argument",r)}function validateOptionalArgType(e,t,n,r){void 0!==r&&validateArgType(e,t,n,r)}function validateNamedType(e,t,n,r){validateType(e,t,n+" option",r)}function validateNamedOptionalType(e,t,n,r){void 0!==r&&validateNamedType(e,t,n,r)}function validateArrayElements(e,t,n,r,i){if(!(r instanceof Array))throw new FirestoreError(Code.INVALID_ARGUMENT,"Function "+e+"() requires its "+t+" option to be an array, but it was: "+valueDescription(r));for(var o=0;o<r.length;++o)if(!i(r[o]))throw new FirestoreError(Code.INVALID_ARGUMENT,"Function "+e+"() requires all "+t+" elements to be "+n+", but the value at index "+o+" was: "+valueDescription(r[o]))}function validateOptionalArrayElements(e,t,n,r,i){void 0!==r&&validateArrayElements(e,t,n,r,i)}function validateNamedPropertyEquals(e,t,n,r,i){for(var o=[],a=0,s=i;a<s.length;a++){var u=s[a];if(u===r)return;o.push(valueDescription(u))}var c=valueDescription(r);throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid value "+c+" provided to function "+e+'() for option "'+n+'". Acceptable values: '+o.join(", "))}function validateNamedOptionalPropertyEquals(e,t,n,r,i){void 0!==r&&validateNamedPropertyEquals(e,t,n,r,i)}function validateType(e,t,n,r){if(typeof r!==t||"object"===t&&!isPlainObject(r)){var i=valueDescription(r);throw new FirestoreError(Code.INVALID_ARGUMENT,"Function "+e+"() requires its "+n+" to be of type "+t+", but it was: "+i)}}function isPlainObject(e){return"object"==typeof e&&null!==e&&Object.getPrototypeOf(e)===Object.prototype}function valueDescription(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";var t=tryGetCustomObjectType(e);return t?"a custom "+t+" object":"an object"}return"function"==typeof e?"a function":fail("Unknown wrong type: "+typeof e)}function tryGetCustomObjectType(e){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}function validateDefined(e,t,n){if(void 0===n)throw new FirestoreError(Code.INVALID_ARGUMENT,"Function "+e+"() requires a valid "+ordinal(t)+" argument, but it was undefined.")}function validateOptionNames(n,e,r){forEach$1(e,function(e,t){if(r.indexOf(e)<0)throw new FirestoreError(Code.INVALID_ARGUMENT,"Unknown option '"+e+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function invalidClassError(e,t,n,r){var i=valueDescription(r);return new FirestoreError(Code.INVALID_ARGUMENT,"Function "+e+"() requires its "+ordinal(n)+" argument to be a "+t+", but it was: "+i)}function ordinal(e){switch(e){case 1:return"first";case 2:return"second";case 3:return"third";default:return e+"th"}}function formatPlural(e,t){return e+" "+t+(1===e?"":"s")}var AutoId=function(){function e(){}return e.newId=function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t="",n=0;n<20;n++)t+=e.charAt(Math.floor(Math.random()*e.length));return assert$1(20===t.length,"Invalid auto ID: "+t),t},e}();function primitiveComparator(e,t){return e<t?-1:t<e?1:0}function equals(e,t){return null!=e?!(!t||!e.isEqual(t)):e===t}function arrayEquals(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!e[n].isEqual(t[n]))return!1;return!0}function immediatePredecessor(e){var t=e.length-1;return 0===e.length?"":"\0"===e.charAt(t)?e.substring(0,t):e.substring(0,t)+String.fromCharCode(e.charCodeAt(t)-1)}function immediateSuccessor(e){return e+"\0"}function assertUint8ArrayAvailable(){if("undefined"==typeof Uint8Array)throw new FirestoreError(Code.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function assertBase64Available(){if(!PlatformSupport.getPlatform().base64Available)throw new FirestoreError(Code.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Blob$1=function(){function t(e){assertBase64Available(),this._binaryString=e}return t.fromBase64String=function(e){validateExactNumberOfArgs("Blob.fromBase64String",arguments,1),validateArgType("Blob.fromBase64String","string",1,e),assertBase64Available();try{return new t(PlatformSupport.getPlatform().atob(e))}catch(e){throw new FirestoreError(Code.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+e)}},t.fromUint8Array=function(e){if(validateExactNumberOfArgs("Blob.fromUint8Array",arguments,1),assertUint8ArrayAvailable(),!(e instanceof Uint8Array))throw invalidClassError("Blob.fromUint8Array","Uint8Array",1,e);return new t(Array.prototype.map.call(e,function(e){return String.fromCharCode(e)}).join(""))},t.prototype.toBase64=function(){return validateExactNumberOfArgs("Blob.toBase64",arguments,0),assertBase64Available(),PlatformSupport.getPlatform().btoa(this._binaryString)},t.prototype.toUint8Array=function(){validateExactNumberOfArgs("Blob.toUint8Array",arguments,0),assertUint8ArrayAvailable();for(var e=new Uint8Array(this._binaryString.length),t=0;t<this._binaryString.length;t++)e[t]=this._binaryString.charCodeAt(t);return e},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(e){return this._binaryString===e._binaryString},t.prototype._compareTo=function(e){return primitiveComparator(this._binaryString,e._binaryString)},t}(),PublicBlob=makeConstructorPrivate(Blob$1,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),GeoPoint=function(){function e(e,t){if(validateExactNumberOfArgs("GeoPoint",arguments,2),validateArgType("GeoPoint","number",1,e),validateArgType("GeoPoint","number",2,t),!isFinite(e)||e<-90||90<e)throw new FirestoreError(Code.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||180<t)throw new FirestoreError(Code.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}return Object.defineProperty(e.prototype,"latitude",{get:function(){return this._lat},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"longitude",{get:function(){return this._long},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(e){return this._lat===e._lat&&this._long===e._long},e.prototype._compareTo=function(e){return primitiveComparator(this._lat,e._lat)||primitiveComparator(this._long,e._long)},e}(),Timestamp=function(){function n(e,t){if(this.seconds=e,(this.nanoseconds=t)<0)throw new FirestoreError(Code.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(1e9<=t)throw new FirestoreError(Code.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new FirestoreError(Code.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(253402300800<=e)throw new FirestoreError(Code.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}return n.now=function(){return n.fromMillis(Date.now())},n.fromDate=function(e){return n.fromMillis(e.getTime())},n.fromMillis=function(e){var t=Math.floor(e/1e3);return new n(t,1e6*(e-1e3*t))},n.prototype.toDate=function(){return new Date(this.toMillis())},n.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},n.prototype._compareTo=function(e){return this.seconds===e.seconds?primitiveComparator(this.nanoseconds,e.nanoseconds):primitiveComparator(this.seconds,e.seconds)},n.prototype.isEqual=function(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds},n.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},n}(),DatabaseInfo=function(e,t,n,r){this.databaseId=e,this.persistenceKey=t,this.host=n,this.ssl=r},DEFAULT_DATABASE_NAME="(default)",DatabaseId=function(){function t(e,t){this.projectId=e,this.database=t||DEFAULT_DATABASE_NAME}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return this.database===DEFAULT_DATABASE_NAME},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t.prototype.compareTo=function(e){return primitiveComparator(this.projectId,e.projectId)||primitiveComparator(this.database,e.database)},t}(),DOCUMENT_KEY_NAME="__name__",Path$1=function(){function n(e,t,n){this.init(e,t,n)}return n.prototype.init=function(e,t,n){void 0===t?t=0:t>e.length&&fail("offset "+t+" out of range "+e.length),void 0===n?n=e.length-t:n>e.length-t&&fail("length "+n+" out of range "+(e.length-t)),this.segments=e,this.offset=t,this.len=n},n.prototype.construct=function(e,t,n){var r=Object.create(Object.getPrototypeOf(this));return r.init(e,t,n),r},Object.defineProperty(n.prototype,"length",{get:function(){return this.len},enumerable:!0,configurable:!0}),n.prototype.isEqual=function(e){return 0===n.comparator(this,e)},n.prototype.child=function(e){var t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(function(e){t.push(e)}):"string"==typeof e?t.push(e):fail("Unknown parameter type for Path.child(): "+e),this.construct(t)},n.prototype.limit=function(){return this.offset+this.length},n.prototype.popFirst=function(e){return e=void 0===e?1:e,assert$1(this.length>=e,"Can't call popFirst() with less segments"),this.construct(this.segments,this.offset+e,this.length-e)},n.prototype.popLast=function(){return assert$1(!this.isEmpty(),"Can't call popLast() on empty path"),this.construct(this.segments,this.offset,this.length-1)},n.prototype.firstSegment=function(){return assert$1(!this.isEmpty(),"Can't call firstSegment() on empty path"),this.segments[this.offset]},n.prototype.lastSegment=function(){return assert$1(!this.isEmpty(),"Can't call lastSegment() on empty path"),this.segments[this.limit()-1]},n.prototype.get=function(e){return assert$1(e<this.length,"Index out of range"),this.segments[this.offset+e]},n.prototype.isEmpty=function(){return 0===this.length},n.prototype.isPrefixOf=function(e){if(e.length<this.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0},n.prototype.forEach=function(e){for(var t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])},n.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},n.comparator=function(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var i=e.get(r),o=t.get(r);if(i<o)return-1;if(o<i)return 1}return e.length<t.length?-1:e.length>t.length?1:0},n}(),ResourcePath=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.canonicalString=function(){return this.toArray().join("/")},t.prototype.toString=function(){return this.canonicalString()},t.fromString=function(e){if(0<=e.indexOf("//"))throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid path ("+e+"). Paths must not contain // in them.");return new t(e.split("/").filter(function(e){return 0<e.length}))},t.EMPTY_PATH=new t([]),t}(Path$1),identifierRegExp=/^[_a-zA-Z][_a-zA-Z0-9]*$/,FieldPath=function(e){function u(){return null!==e&&e.apply(this,arguments)||this}return __extends(u,e),u.isValidIdentifier=function(e){return identifierRegExp.test(e)},u.prototype.canonicalString=function(){return this.toArray().map(function(e){return e=e.replace("\\","\\\\").replace("`","\\`"),u.isValidIdentifier(e)||(e="`"+e+"`"),e}).join(".")},u.prototype.toString=function(){return this.canonicalString()},u.prototype.isKeyField=function(){return 1===this.length&&this.get(0)===DOCUMENT_KEY_NAME},u.keyField=function(){return new u([DOCUMENT_KEY_NAME])},u.fromServerFormat=function(e){for(var t=[],n="",r=0,i=function(){if(0===n.length)throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");t.push(n),n=""},o=!1;r<e.length;){var a=e[r];if("\\"===a){if(r+1===e.length)throw new FirestoreError(Code.INVALID_ARGUMENT,"Path has trailing escape character: "+e);var s=e[r+1];if("\\"!==s&&"."!==s&&"`"!==s)throw new FirestoreError(Code.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=s,r+=2}else"`"===a?o=!o:"."!==a||o?n+=a:i(),r++}if(i(),o)throw new FirestoreError(Code.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new u(t)},u.EMPTY_PATH=new u([]),u}(Path$1),DocumentKey=function(){function t(e){this.path=e,assert$1(t.isDocumentKey(e),"Invalid DocumentKey with an odd number of segments: "+e.toArray().join("/"))}return t.prototype.isEqual=function(e){return null!==e&&0===ResourcePath.comparator(this.path,e.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(e,t){return ResourcePath.comparator(e.path,t.path)},t.isDocumentKey=function(e){return e.length%2==0},t.fromSegments=function(e){return new t(new ResourcePath(e.slice()))},t.fromPathString=function(e){return new t(ResourcePath.fromString(e))},t.EMPTY=new t(new ResourcePath([])),t}(),Document=function(){function t(e,t,n,r){this.key=e,this.version=t,this.data=n,this.hasLocalMutations=r.hasLocalMutations}return t.prototype.field=function(e){return this.data.field(e)},t.prototype.fieldValue=function(e){var t=this.field(e);return t?t.value():void 0},t.prototype.value=function(){return this.data.value()},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.data.isEqual(e.data)&&this.hasLocalMutations===e.hasLocalMutations},t.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.data.toString()+", {hasLocalMutations: "+this.hasLocalMutations+"})"},t.compareByKey=function(e,t){return DocumentKey.comparator(e.key,t.key)},t.compareByField=function(e,t,n){var r=t.field(e),i=n.field(e);return void 0!==r&&void 0!==i?r.compareTo(i):fail("Trying to compare documents on fields that don't exist")},t}(),NoDocument=function(){function e(e,t){this.key=e,this.version=t}return e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},e.prototype.isEqual=function(e){return e&&e.version.isEqual(this.version)&&e.key.isEqual(this.key)},e.compareByKey=function(e,t){return DocumentKey.comparator(e.key,t.key)},e}(),SortedMap$1=function(){function n(e,t){this.comparator=e,this.root=t||LLRBNode$1.EMPTY}return n.prototype.insert=function(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,LLRBNode$1.BLACK,null,null))},n.prototype.remove=function(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,LLRBNode$1.BLACK,null,null))},n.prototype.get=function(e){for(var t=this.root;!t.isEmpty();){var n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:0<n&&(t=t.right)}return null},n.prototype.indexOf=function(e){for(var t=0,n=this.root;!n.isEmpty();){var r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1},n.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(n.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),n.prototype.minKey=function(){return this.root.minKey()},n.prototype.maxKey=function(){return this.root.maxKey()},n.prototype.inorderTraversal=function(e){return this.root.inorderTraversal(e)},n.prototype.forEach=function(n){this.inorderTraversal(function(e,t){return n(e,t),!1})},n.prototype.reverseTraversal=function(e){return this.root.reverseTraversal(e)},n.prototype.getIterator=function(){return new SortedMapIterator$1(this.root,null,this.comparator,!1)},n.prototype.getIteratorFrom=function(e){return new SortedMapIterator$1(this.root,e,this.comparator,!1)},n.prototype.getReverseIterator=function(){return new SortedMapIterator$1(this.root,null,this.comparator,!0)},n.prototype.getReverseIteratorFrom=function(e){return new SortedMapIterator$1(this.root,e,this.comparator,!0)},n}(),SortedMapIterator$1=function(){function e(e,t,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!e.isEmpty();)if(i=t?n(e.key,t):1,r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}return e.prototype.getNext=function(){assert$1(0<this.nodeStack.length,"getNext() called on iterator when hasNext() is false.");var e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t},e.prototype.hasNext=function(){return 0<this.nodeStack.length},e.prototype.peek=function(){if(0===this.nodeStack.length)return null;var e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}},e}(),LLRBNode$1=function(){function o(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:o.RED,this.left=null!=r?r:o.EMPTY,this.right=null!=i?i:o.EMPTY,this.size=this.left.size+1+this.right.size}return o.prototype.copy=function(e,t,n,r,i){return new o(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},o.prototype.isEmpty=function(){return!1},o.prototype.inorderTraversal=function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)},o.prototype.reverseTraversal=function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)},o.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},o.prototype.minKey=function(){return this.min().key},o.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},o.prototype.insert=function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp()},o.prototype.removeMin=function(){if(this.left.isEmpty())return o.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},o.prototype.remove=function(e,t){var n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return o.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()},o.prototype.isRed=function(){return this.color},o.prototype.fixUp=function(){var e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e},o.prototype.moveRedLeft=function(){var e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e},o.prototype.moveRedRight=function(){var e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e},o.prototype.rotateLeft=function(){var e=this.copy(null,null,o.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},o.prototype.rotateRight=function(){var e=this.copy(null,null,o.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},o.prototype.colorFlip=function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)},o.prototype.checkMaxDepth=function(){var e=this.check();return Math.pow(2,e)<=this.size+1},o.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw fail("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed())throw fail("Right child of ("+this.key+","+this.value+") is red");var e=this.left.check();if(e!==this.right.check())throw fail("Black depths differ");return e+(this.isRed()?0:1)},o.EMPTY=null,o.RED=!0,o.BLACK=!1,o}(),LLRBEmptyNode$1=function(){function e(){this.size=0}return e.prototype.copy=function(e,t,n,r,i){return this},e.prototype.insert=function(e,t,n){return new LLRBNode$1(e,t)},e.prototype.remove=function(e,t){return this},e.prototype.isEmpty=function(){return!0},e.prototype.inorderTraversal=function(e){return!1},e.prototype.reverseTraversal=function(e){return!1},e.prototype.minKey=function(){return null},e.prototype.maxKey=function(){return null},e.prototype.isRed=function(){return!1},e.prototype.checkMaxDepth=function(){return!0},e.prototype.check=function(){return 0},e}(),TypeOrder,ServerTimestampBehavior,iid,hid;LLRBNode$1.EMPTY=new LLRBEmptyNode$1,hid=TypeOrder||(TypeOrder={}),hid[hid.NullValue=0]="NullValue",hid[hid.BooleanValue=1]="BooleanValue",hid[hid.NumberValue=2]="NumberValue",hid[hid.TimestampValue=3]="TimestampValue",hid[hid.StringValue=4]="StringValue",hid[hid.BlobValue=5]="BlobValue",hid[hid.RefValue=6]="RefValue",hid[hid.GeoPointValue=7]="GeoPointValue",hid[hid.ArrayValue=8]="ArrayValue",hid[hid.ObjectValue=9]="ObjectValue",iid=ServerTimestampBehavior||(ServerTimestampBehavior={}),iid[iid.Default=0]="Default",iid[iid.Estimate=1]="Estimate",iid[iid.Previous=2]="Previous";var FieldValueOptions=function(){function n(e,t){this.serverTimestampBehavior=e,this.timestampsInSnapshots=t}return n.fromSnapshotOptions=function(e,t){switch(e.serverTimestamps){case"estimate":return new n(ServerTimestampBehavior.Estimate,t);case"previous":return new n(ServerTimestampBehavior.Previous,t);case"none":case void 0:return new n(ServerTimestampBehavior.Default,t);default:return fail("fromSnapshotOptions() called with invalid options.")}},n}(),FieldValue=function(){function e(){}return e.prototype.toString=function(){var e=this.value();return null===e?"null":e.toString()},e.prototype.defaultCompareTo=function(e){return assert$1(this.typeOrder!==e.typeOrder,"Default compareTo should not be used for values of same type."),primitiveComparator(this.typeOrder,e.typeOrder)},e}(),NullValue=function(t){function n(){var e=t.call(this)||this;return e.typeOrder=TypeOrder.NullValue,e.internalValue=null,e}return __extends(n,t),n.prototype.value=function(e){return null},n.prototype.isEqual=function(e){return e instanceof n},n.prototype.compareTo=function(e){return e instanceof n?0:this.defaultCompareTo(e)},n.INSTANCE=new n,n}(FieldValue),BooleanValue=function(n){function t(e){var t=n.call(this)||this;return t.internalValue=e,t.typeOrder=TypeOrder.BooleanValue,t}return __extends(t,n),t.prototype.value=function(e){return this.internalValue},t.prototype.isEqual=function(e){return e instanceof t&&this.internalValue===e.internalValue},t.prototype.compareTo=function(e){return e instanceof t?primitiveComparator(this,e):this.defaultCompareTo(e)},t.of=function(e){return e?t.TRUE:t.FALSE},t.TRUE=new t(!0),t.FALSE=new t(!1),t}(FieldValue),NumberValue=function(n){function t(e){var t=n.call(this)||this;return t.internalValue=e,t.typeOrder=TypeOrder.NumberValue,t}return __extends(t,n),t.prototype.value=function(e){return this.internalValue},t.prototype.compareTo=function(e){return e instanceof t?numericComparator(this.internalValue,e.internalValue):this.defaultCompareTo(e)},t}(FieldValue);function numericComparator(e,t){return e<t?-1:t<e?1:e===t?0:isNaN(e)?isNaN(t)?0:-1:1}function numericEquals(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}var IntegerValue=function(t){function n(e){return t.call(this,e)||this}return __extends(n,t),n.prototype.isEqual=function(e){return e instanceof n&&numericEquals(this.internalValue,e.internalValue)},n}(NumberValue),DoubleValue=function(n){function t(e){var t=n.call(this,e)||this;return t.internalValue=e,t}return __extends(t,n),t.prototype.isEqual=function(e){return e instanceof t&&numericEquals(this.internalValue,e.internalValue)},t.NAN=new t(NaN),t.POSITIVE_INFINITY=new t(1/0),t.NEGATIVE_INFINITY=new t(-1/0),t}(NumberValue),StringValue=function(n){function t(e){var t=n.call(this)||this;return t.internalValue=e,t.typeOrder=TypeOrder.StringValue,t}return __extends(t,n),t.prototype.value=function(e){return this.internalValue},t.prototype.isEqual=function(e){return e instanceof t&&this.internalValue===e.internalValue},t.prototype.compareTo=function(e){return e instanceof t?primitiveComparator(this.internalValue,e.internalValue):this.defaultCompareTo(e)},t}(FieldValue),TimestampValue=function(n){function t(e){var t=n.call(this)||this;return t.internalValue=e,t.typeOrder=TypeOrder.TimestampValue,t}return __extends(t,n),t.prototype.value=function(e){return e&&e.timestampsInSnapshots?this.internalValue:this.internalValue.toDate()},t.prototype.isEqual=function(e){return e instanceof t&&this.internalValue.isEqual(e.internalValue)},t.prototype.compareTo=function(e){return e instanceof t?this.internalValue._compareTo(e.internalValue):e instanceof ServerTimestampValue?-1:this.defaultCompareTo(e)},t}(FieldValue),ServerTimestampValue=function(r){function t(e,t){var n=r.call(this)||this;return n.localWriteTime=e,n.previousValue=t,n.typeOrder=TypeOrder.TimestampValue,n}return __extends(t,r),t.prototype.value=function(e){return e&&e.serverTimestampBehavior===ServerTimestampBehavior.Estimate?new TimestampValue(this.localWriteTime).value(e):e&&e.serverTimestampBehavior===ServerTimestampBehavior.Previous&&this.previousValue?this.previousValue.value(e):null},t.prototype.isEqual=function(e){return e instanceof t&&this.localWriteTime.isEqual(e.localWriteTime)},t.prototype.compareTo=function(e){return e instanceof t?this.localWriteTime._compareTo(e.localWriteTime):e instanceof TimestampValue?1:this.defaultCompareTo(e)},t.prototype.toString=function(){return"<ServerTimestamp localTime="+this.localWriteTime.toString()+">"},t}(FieldValue),BlobValue=function(n){function t(e){var t=n.call(this)||this;return t.internalValue=e,t.typeOrder=TypeOrder.BlobValue,t}return __extends(t,n),t.prototype.value=function(e){return this.internalValue},t.prototype.isEqual=function(e){return e instanceof t&&this.internalValue.isEqual(e.internalValue)},t.prototype.compareTo=function(e){return e instanceof t?this.internalValue._compareTo(e.internalValue):this.defaultCompareTo(e)},t}(FieldValue),RefValue=function(r){function n(e,t){var n=r.call(this)||this;return n.databaseId=e,n.key=t,n.typeOrder=TypeOrder.RefValue,n}return __extends(n,r),n.prototype.value=function(e){return this.key},n.prototype.isEqual=function(e){return e instanceof n&&this.key.isEqual(e.key)&&this.databaseId.isEqual(e.databaseId)},n.prototype.compareTo=function(e){if(e instanceof n){var t=this.databaseId.compareTo(e.databaseId);return 0!==t?t:DocumentKey.comparator(this.key,e.key)}return this.defaultCompareTo(e)},n}(FieldValue),GeoPointValue=function(n){function t(e){var t=n.call(this)||this;return t.internalValue=e,t.typeOrder=TypeOrder.GeoPointValue,t}return __extends(t,n),t.prototype.value=function(e){return this.internalValue},t.prototype.isEqual=function(e){return e instanceof t&&this.internalValue.isEqual(e.internalValue)},t.prototype.compareTo=function(e){return e instanceof t?this.internalValue._compareTo(e.internalValue):this.defaultCompareTo(e)},t}(FieldValue),ObjectValue=function(n){function a(e){var t=n.call(this)||this;return t.internalValue=e,t.typeOrder=TypeOrder.ObjectValue,t}return __extends(a,n),a.prototype.value=function(n){var r={};return this.internalValue.inorderTraversal(function(e,t){r[e]=t.value(n)}),r},a.prototype.forEach=function(e){this.internalValue.inorderTraversal(e)},a.prototype.isEqual=function(e){if(e instanceof a){for(var t=this.internalValue.getIterator(),n=e.internalValue.getIterator();t.hasNext()&&n.hasNext();){var r=t.getNext(),i=n.getNext();if(r.key!==i.key||!r.value.isEqual(i.value))return!1}return!t.hasNext()&&!n.hasNext()}return!1},a.prototype.compareTo=function(e){if(e instanceof a){for(var t=this.internalValue.getIterator(),n=e.internalValue.getIterator();t.hasNext()&&n.hasNext();){var r=t.getNext(),i=n.getNext(),o=primitiveComparator(r.key,i.key)||r.value.compareTo(i.value);if(o)return o}return primitiveComparator(t.hasNext(),n.hasNext())}return this.defaultCompareTo(e)},a.prototype.set=function(e,t){if(assert$1(!e.isEmpty(),"Cannot set field for empty path on ObjectValue"),1===e.length)return this.setChild(e.firstSegment(),t);var n=this.child(e.firstSegment());n instanceof a||(n=a.EMPTY);var r=n.set(e.popFirst(),t);return this.setChild(e.firstSegment(),r)},a.prototype.delete=function(e){if(assert$1(!e.isEmpty(),"Cannot delete field for empty path on ObjectValue"),1===e.length)return new a(this.internalValue.remove(e.firstSegment()));var t=this.child(e.firstSegment());if(t instanceof a){var n=t.delete(e.popFirst());return new a(this.internalValue.insert(e.firstSegment(),n))}return this},a.prototype.contains=function(e){return void 0!==this.field(e)},a.prototype.field=function(e){assert$1(!e.isEmpty(),"Can't get field of empty path");var t=this;return e.forEach(function(e){t=t instanceof a&&t.internalValue.get(e)||void 0}),t},a.prototype.toString=function(){return JSON.stringify(this.value())},a.prototype.child=function(e){return this.internalValue.get(e)||void 0},a.prototype.setChild=function(e,t){return new a(this.internalValue.insert(e,t))},a.EMPTY=new a(new SortedMap$1(primitiveComparator)),a}(FieldValue),ArrayValue=function(n){function i(e){var t=n.call(this)||this;return t.internalValue=e,t.typeOrder=TypeOrder.ArrayValue,t}return __extends(i,n),i.prototype.value=function(t){return this.internalValue.map(function(e){return e.value(t)})},i.prototype.forEach=function(e){this.internalValue.forEach(e)},i.prototype.isEqual=function(e){if(e instanceof i){if(this.internalValue.length!==e.internalValue.length)return!1;for(var t=0;t<this.internalValue.length;t++)if(!this.internalValue[t].isEqual(e.internalValue[t]))return!1;return!0}return!1},i.prototype.compareTo=function(e){if(e instanceof i){for(var t=Math.min(this.internalValue.length,e.internalValue.length),n=0;n<t;n++){var r=this.internalValue[n].compareTo(e.internalValue[n]);if(r)return r}return primitiveComparator(this.internalValue.length,e.internalValue.length)}return this.defaultCompareTo(e)},i.prototype.toString=function(){return JSON.stringify(this.value())},i}(FieldValue),NumberAsAny=Number,MIN_SAFE_INTEGER=NumberAsAny.MIN_SAFE_INTEGER||-(Math.pow(2,53)-1),MAX_SAFE_INTEGER=NumberAsAny.MAX_SAFE_INTEGER||Math.pow(2,53)-1,isInteger=NumberAsAny.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e};function isNullOrUndefined(e){return null==e}function isSafeInteger(e){return isInteger(e)&&e<=MAX_SAFE_INTEGER&&MIN_SAFE_INTEGER<=e}var Query$1=function(){function n(e,t,n,r,i,o){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===r&&(r=null),void 0===i&&(i=null),void 0===o&&(o=null),this.path=e,this.explicitOrderBy=t,this.filters=n,this.limit=r,this.startAt=i,this.endAt=o,this.memoizedCanonicalId=null,this.memoizedOrderBy=null,this.startAt&&this.assertValidBound(this.startAt),this.endAt&&this.assertValidBound(this.endAt)}return n.atPath=function(e){return new n(e)},Object.defineProperty(n.prototype,"orderBy",{get:function(){if(null===this.memoizedOrderBy){var e=this.getInequalityFilterField(),t=this.getFirstOrderByField();if(null!==e&&null===t)e.isKeyField()?this.memoizedOrderBy=[KEY_ORDERING_ASC]:this.memoizedOrderBy=[new OrderBy(e),KEY_ORDERING_ASC];else{assert$1(null===e||null!==t&&e.isEqual(t),"First orderBy should match inequality field.");for(var n=!(this.memoizedOrderBy=[]),r=0,i=this.explicitOrderBy;r<i.length;r++){var o=i[r];this.memoizedOrderBy.push(o),o.field.isKeyField()&&(n=!0)}if(!n){var a=0<this.explicitOrderBy.length?this.explicitOrderBy[this.explicitOrderBy.length-1].dir:Direction.ASCENDING;this.memoizedOrderBy.push(a===Direction.ASCENDING?KEY_ORDERING_ASC:KEY_ORDERING_DESC)}}}return this.memoizedOrderBy},enumerable:!0,configurable:!0}),n.prototype.addFilter=function(e){assert$1(null==this.getInequalityFilterField()||!(e instanceof RelationFilter)||!e.isInequality()||e.field.isEqual(this.getInequalityFilterField()),"Query must only have one inequality field."),assert$1(!DocumentKey.isDocumentKey(this.path),"No filtering allowed for document query");var t=this.filters.concat([e]);return new n(this.path,this.explicitOrderBy.slice(),t,this.limit,this.startAt,this.endAt)},n.prototype.addOrderBy=function(e){assert$1(!DocumentKey.isDocumentKey(this.path),"No ordering allowed for document query"),assert$1(!this.startAt&&!this.endAt,"Bounds must be set after orderBy");var t=this.explicitOrderBy.concat([e]);return new n(this.path,t,this.filters.slice(),this.limit,this.startAt,this.endAt)},n.prototype.withLimit=function(e){return new n(this.path,this.explicitOrderBy.slice(),this.filters.slice(),e,this.startAt,this.endAt)},n.prototype.withStartAt=function(e){return new n(this.path,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,e,this.endAt)},n.prototype.withEndAt=function(e){return new n(this.path,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.startAt,e)},n.prototype.canonicalId=function(){if(null===this.memoizedCanonicalId){var e=this.path.canonicalString();e+="|f:";for(var t=0,n=this.filters;t<n.length;t++)e+=n[t].canonicalId(),e+=",";e+="|ob:";for(var r=0,i=this.orderBy;r<i.length;r++)e+=i[r].canonicalId(),e+=",";isNullOrUndefined(this.limit)||(e+="|l:",e+=this.limit),this.startAt&&(e+="|lb:",e+=this.startAt.canonicalId()),this.endAt&&(e+="|ub:",e+=this.endAt.canonicalId()),this.memoizedCanonicalId=e}return this.memoizedCanonicalId},n.prototype.toString=function(){var e="Query("+this.path.canonicalString();return 0<this.filters.length&&(e+=", filters: ["+this.filters.join(", ")+"]"),isNullOrUndefined(this.limit)||(e+=", limit: "+this.limit),0<this.explicitOrderBy.length&&(e+=", orderBy: ["+this.explicitOrderBy.join(", ")+"]"),this.startAt&&(e+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(e+=", endAt: "+this.endAt.canonicalId()),e+")"},n.prototype.isEqual=function(e){if(this.limit!==e.limit)return!1;if(this.orderBy.length!==e.orderBy.length)return!1;for(var t=0;t<this.orderBy.length;t++)if(!this.orderBy[t].isEqual(e.orderBy[t]))return!1;if(this.filters.length!==e.filters.length)return!1;for(t=0;t<this.filters.length;t++)if(!this.filters[t].isEqual(e.filters[t]))return!1;return!!this.path.isEqual(e.path)&&!(null!==this.startAt?!this.startAt.isEqual(e.startAt):null!==e.startAt)&&(null!==this.endAt?this.endAt.isEqual(e.endAt):null===e.endAt)},n.prototype.docComparator=function(e,t){for(var n=!1,r=0,i=this.orderBy;r<i.length;r++){var o=i[r],a=o.compare(e,t);if(0!==a)return a;n=n||o.field.isKeyField()}return assert$1(n,"orderBy used that doesn't compare on key field"),0},n.prototype.matches=function(e){return this.matchesAncestor(e)&&this.matchesOrderBy(e)&&this.matchesFilters(e)&&this.matchesBounds(e)},n.prototype.hasLimit=function(){return!isNullOrUndefined(this.limit)},n.prototype.getFirstOrderByField=function(){return 0<this.explicitOrderBy.length?this.explicitOrderBy[0].field:null},n.prototype.getInequalityFilterField=function(){for(var e=0,t=this.filters;e<t.length;e++){var n=t[e];if(n instanceof RelationFilter&&n.isInequality())return n.field}return null},n.prototype.isDocumentQuery=function(){return DocumentKey.isDocumentKey(this.path)&&0===this.filters.length},n.prototype.matchesAncestor=function(e){var t=e.key.path;return DocumentKey.isDocumentKey(this.path)?this.path.isEqual(t):this.path.isPrefixOf(t)&&this.path.length===t.length-1},n.prototype.matchesOrderBy=function(e){for(var t=0,n=this.explicitOrderBy;t<n.length;t++){var r=n[t];if(!r.field.isKeyField()&&void 0===e.field(r.field))return!1}return!0},n.prototype.matchesFilters=function(e){for(var t=0,n=this.filters;t<n.length;t++)if(!n[t].matches(e))return!1;return!0},n.prototype.matchesBounds=function(e){return!(this.startAt&&!this.startAt.sortsBeforeDocument(this.orderBy,e)||this.endAt&&this.endAt.sortsBeforeDocument(this.orderBy,e))},n.prototype.assertValidBound=function(e){assert$1(e.position.length<=this.orderBy.length,"Bound is longer than orderBy")},n}(),RelationOp=function(){function t(e){this.name=e}return t.fromString=function(e){switch(e){case"<":return t.LESS_THAN;case"<=":return t.LESS_THAN_OR_EQUAL;case"==":return t.EQUAL;case">=":return t.GREATER_THAN_OR_EQUAL;case">":return t.GREATER_THAN;case"array-contains":return t.ARRAY_CONTAINS;default:return fail("Unknown relation: "+e)}},t.prototype.toString=function(){return this.name},t.prototype.isEqual=function(e){return this.name===e.name},t.LESS_THAN=new t("<"),t.LESS_THAN_OR_EQUAL=new t("<="),t.EQUAL=new t("=="),t.GREATER_THAN=new t(">"),t.GREATER_THAN_OR_EQUAL=new t(">="),t.ARRAY_CONTAINS=new t("array-contains"),t}(),RelationFilter=function(){function t(e,t,n){this.field=e,this.op=t,this.value=n}return t.prototype.matches=function(e){if(this.field.isKeyField()){assert$1(this.value instanceof RefValue,"Comparing on key, but filter value not a RefValue"),assert$1(this.op!==RelationOp.ARRAY_CONTAINS,"array-contains queries don't make sense on document keys.");var t=this.value,n=DocumentKey.comparator(e.key,t.key);return this.matchesComparison(n)}var r=e.field(this.field);return void 0!==r&&this.matchesValue(r)},t.prototype.matchesValue=function(e){var t=this;return this.op===RelationOp.ARRAY_CONTAINS?e instanceof ArrayValue&&void 0!==e.internalValue.find(function(e){return e.isEqual(t.value)}):this.value.typeOrder===e.typeOrder&&this.matchesComparison(e.compareTo(this.value))},t.prototype.matchesComparison=function(e){switch(this.op){case RelationOp.LESS_THAN:return e<0;case RelationOp.LESS_THAN_OR_EQUAL:return e<=0;case RelationOp.EQUAL:return 0===e;case RelationOp.GREATER_THAN:return 0<e;case RelationOp.GREATER_THAN_OR_EQUAL:return 0<=e;default:return fail("Unknown relation op"+this.op)}},t.prototype.isInequality=function(){return this.op!==RelationOp.EQUAL&&this.op!==RelationOp.ARRAY_CONTAINS},t.prototype.canonicalId=function(){return this.field.canonicalString()+this.op.toString()+this.value.toString()},t.prototype.isEqual=function(e){return e instanceof t&&this.op.isEqual(e.op)&&this.field.isEqual(e.field)&&this.value.isEqual(e.value)},t.prototype.toString=function(){return this.field.canonicalString()+" "+this.op+" "+this.value.value()},t}(),NullFilter=function(){function t(e){this.field=e}return t.prototype.matches=function(e){var t=e.field(this.field);return void 0!==t&&null===t.value()},t.prototype.canonicalId=function(){return this.field.canonicalString()+" IS null"},t.prototype.toString=function(){return this.field.canonicalString()+" IS null"},t.prototype.isEqual=function(e){return e instanceof t&&this.field.isEqual(e.field)},t}(),NanFilter=function(){function t(e){this.field=e}return t.prototype.matches=function(e){var t=e.field(this.field).value();return"number"==typeof t&&isNaN(t)},t.prototype.canonicalId=function(){return this.field.canonicalString()+" IS NaN"},t.prototype.toString=function(){return this.field.canonicalString()+" IS NaN"},t.prototype.isEqual=function(e){return e instanceof t&&this.field.isEqual(e.field)},t}();function fieldFilter(e,t,n){if(n.isEqual(NullValue.INSTANCE)){if(t!==RelationOp.EQUAL)throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid query. You can only perform equals comparisons on null.");return new NullFilter(e)}if(n.isEqual(DoubleValue.NAN)){if(t!==RelationOp.EQUAL)throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid query. You can only perform equals comparisons on NaN.");return new NanFilter(e)}return new RelationFilter(e,t,n)}var Direction=function(){function e(e){this.name=e}return e.prototype.toString=function(){return this.name},e.ASCENDING=new e("asc"),e.DESCENDING=new e("desc"),e}(),Bound=function(){function e(e,t){this.position=e,this.before=t}return e.prototype.canonicalId=function(){for(var e=this.before?"b:":"a:",t=0,n=this.position;t<n.length;t++)e+=n[t].toString();return e},e.prototype.sortsBeforeDocument=function(e,t){assert$1(this.position.length<=e.length,"Bound has more components than query's orderBy");for(var n=0,r=0;r<this.position.length;r++){var i=e[r],o=this.position[r];if(i.field.isKeyField())assert$1(o instanceof RefValue,"Bound has a non-key value where the key path is being used."),n=DocumentKey.comparator(o.key,t.key);else{var a=t.field(i.field);assert$1(void 0!==a,"Field should exist since document matched the orderBy already."),n=o.compareTo(a)}if(i.dir===Direction.DESCENDING&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},e.prototype.isEqual=function(e){if(null===e)return!1;if(this.before!==e.before||this.position.length!==e.position.length)return!1;for(var t=0;t<this.position.length;t++){var n=this.position[t],r=e.position[t];return n.isEqual(r)}return!0},e}(),OrderBy=function(){function e(e,t){this.field=e,void 0===t&&(t=Direction.ASCENDING),this.dir=t,this.isKeyOrderBy=e.isKeyField()}return e.prototype.compare=function(e,t){var n=this.isKeyOrderBy?Document.compareByKey(e,t):Document.compareByField(this.field,e,t);switch(this.dir){case Direction.ASCENDING:return n;case Direction.DESCENDING:return-1*n;default:return fail("Unknown direction: "+this.dir)}},e.prototype.canonicalId=function(){return this.field.canonicalString()+this.dir.toString()},e.prototype.toString=function(){return this.field.canonicalString()+" ("+this.dir+")"},e.prototype.isEqual=function(e){return this.dir===e.dir&&this.field.isEqual(e.field)},e}(),KEY_ORDERING_ASC=new OrderBy(FieldPath.keyField(),Direction.ASCENDING),KEY_ORDERING_DESC=new OrderBy(FieldPath.keyField(),Direction.DESCENDING),SnapshotVersion=function(){function n(e){this.timestamp=e}return n.fromMicroseconds=function(e){var t=Math.floor(e/1e6);return new n(new Timestamp(t,e%1e6*1e3))},n.fromTimestamp=function(e){return new n(e)},n.forDeletedDoc=function(){return n.MIN},n.prototype.compareTo=function(e){return this.timestamp._compareTo(e.timestamp)},n.prototype.isEqual=function(e){return this.timestamp.isEqual(e.timestamp)},n.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},n.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},n.prototype.toTimestamp=function(){return this.timestamp},n.MIN=new n(new Timestamp(0,0)),n}(),QueryPurpose,Smd;Smd=QueryPurpose||(QueryPurpose={}),Smd[Smd.Listen=0]="Listen",Smd[Smd.ExistenceFilterMismatch=1]="ExistenceFilterMismatch",Smd[Smd.LimboResolution=2]="LimboResolution";var QueryData=function(){function t(e,t,n,r,i){void 0===r&&(r=SnapshotVersion.MIN),void 0===i&&(i=emptyByteString()),this.query=e,this.targetId=t,this.purpose=n,this.snapshotVersion=r,this.resumeToken=i}return t.prototype.update=function(e){return new t(this.query,this.targetId,this.purpose,e.snapshotVersion,e.resumeToken)},t.prototype.isEqual=function(e){return this.targetId===e.targetId&&this.purpose===e.purpose&&this.snapshotVersion.isEqual(e.snapshotVersion)&&this.resumeToken===e.resumeToken&&this.query.isEqual(e.query)},t}(),FieldMask=function(){function e(e){this.fields=e}return e.prototype.covers=function(e){for(var t=0,n=this.fields;t<n.length;t++)if(n[t].isPrefixOf(e))return!0;return!1},e.prototype.isEqual=function(e){return arrayEquals(this.fields,e.fields)},e}(),FieldTransform=function(){function e(e,t){this.field=e,this.transform=t}return e.prototype.isEqual=function(e){return this.field.isEqual(e.field)&&this.transform.isEqual(e.transform)},e}(),MutationResult=function(e,t){this.version=e,this.transformResults=t},MutationType,lnd;lnd=MutationType||(MutationType={}),lnd[lnd.Set=0]="Set",lnd[lnd.Patch=1]="Patch",lnd[lnd.Transform=2]="Transform",lnd[lnd.Delete=3]="Delete";var Precondition=function(){function t(e,t){this.updateTime=e,this.exists=t,assert$1(void 0===e||void 0===t,'Precondition can specify "exists" or "updateTime" but not both')}return t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),t.prototype.isValidFor=function(e){return void 0!==this.updateTime?e instanceof Document&&e.version.isEqual(this.updateTime):void 0!==this.exists?this.exists?e instanceof Document:null===e||e instanceof NoDocument:(assert$1(this.isNone,"Precondition should be empty"),!0)},t.prototype.isEqual=function(e){return equals(this.updateTime,e.updateTime)&&this.exists===e.exists},t.NONE=new t,t}(),Mutation=function(){function e(){}return e.prototype.verifyKeyMatches=function(e){null!=e&&assert$1(e.key.isEqual(this.key),"Can only apply a mutation to a document with the same key")},e.getPostMutationVersion=function(e){return e instanceof Document?e.version:SnapshotVersion.MIN},e}(),SetMutation=function(i){function t(e,t,n){var r=i.call(this)||this;return r.key=e,r.value=t,r.precondition=n,r.type=MutationType.Set,r}return __extends(t,i),t.prototype.applyToRemoteDocument=function(e,t){this.verifyKeyMatches(e),assert$1(null==t.transformResults,"Transform results received by SetMutation.");var n=Mutation.getPostMutationVersion(e);return new Document(this.key,n,this.value,{hasLocalMutations:!1})},t.prototype.applyToLocalView=function(e,t,n){if(this.verifyKeyMatches(e),!this.precondition.isValidFor(e))return e;var r=Mutation.getPostMutationVersion(e);return new Document(this.key,r,this.value,{hasLocalMutations:!0})},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.value.isEqual(e.value)&&this.precondition.isEqual(e.precondition)},t}(Mutation),PatchMutation=function(o){function t(e,t,n,r){var i=o.call(this)||this;return i.key=e,i.data=t,i.fieldMask=n,i.precondition=r,i.type=MutationType.Patch,i}return __extends(t,o),t.prototype.applyToRemoteDocument=function(e,t){if(this.verifyKeyMatches(e),assert$1(null==t.transformResults,"Transform results received by PatchMutation."),!this.precondition.isValidFor(e))return e;var n=Mutation.getPostMutationVersion(e),r=this.patchDocument(e);return new Document(this.key,n,r,{hasLocalMutations:!1})},t.prototype.applyToLocalView=function(e,t,n){if(this.verifyKeyMatches(e),!this.precondition.isValidFor(e))return e;var r=Mutation.getPostMutationVersion(e),i=this.patchDocument(e);return new Document(this.key,r,i,{hasLocalMutations:!0})},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.fieldMask.isEqual(e.fieldMask)&&this.precondition.isEqual(e.precondition)},t.prototype.patchDocument=function(e){var t;return t=e instanceof Document?e.data:ObjectValue.EMPTY,this.patchObject(t)},t.prototype.patchObject=function(e){for(var t=0,n=this.fieldMask.fields;t<n.length;t++){var r=n[t],i=this.data.field(r);e=void 0!==i?e.set(r,i):e.delete(r)}return e},t}(Mutation),TransformMutation=function(r){function t(e,t){var n=r.call(this)||this;return n.key=e,n.fieldTransforms=t,n.type=MutationType.Transform,n.precondition=Precondition.exists(!0),n}return __extends(t,r),t.prototype.applyToRemoteDocument=function(e,t){if(this.verifyKeyMatches(e),assert$1(null!=t.transformResults,"Transform results missing for TransformMutation."),!this.precondition.isValidFor(e))return e;var n=this.requireDocument(e),r=this.serverTransformResults(e,t.transformResults),i=this.transformObject(n.data,r);return new Document(this.key,n.version,i,{hasLocalMutations:!1})},t.prototype.applyToLocalView=function(e,t,n){if(this.verifyKeyMatches(e),!this.precondition.isValidFor(e))return e;var r=this.requireDocument(e),i=this.localTransformResults(n,t),o=this.transformObject(r.data,i);return new Document(this.key,r.version,o,{hasLocalMutations:!0})},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&arrayEquals(this.fieldTransforms,e.fieldTransforms)&&this.precondition.isEqual(e.precondition)},t.prototype.requireDocument=function(e){assert$1(e instanceof Document,"Unknown MaybeDocument type "+e);var t=e;return assert$1(t.key.isEqual(this.key),"Can only transform a document with the same key"),t},t.prototype.serverTransformResults=function(e,t){var n=[];assert$1(this.fieldTransforms.length===t.length,"server transform result count ("+t.length+") should match field transform count ("+this.fieldTransforms.length+")");for(var r=0;r<t.length;r++){var i=this.fieldTransforms[r],o=i.transform,a=null;e instanceof Document&&(a=e.field(i.field)||null),n.push(o.applyToRemoteDocument(a,t[r]))}return n},t.prototype.localTransformResults=function(e,t){for(var n=[],r=0,i=this.fieldTransforms;r<i.length;r++){var o=i[r],a=o.transform,s=null;t instanceof Document&&(s=t.field(o.field)||null),n.push(a.applyToLocalView(s,e))}return n},t.prototype.transformObject=function(e,t){assert$1(t.length===this.fieldTransforms.length,"TransformResults length mismatch.");for(var n=0;n<this.fieldTransforms.length;n++){var r=this.fieldTransforms[n].field;e=e.set(r,t[n])}return e},t}(Mutation),DeleteMutation=function(r){function t(e,t){var n=r.call(this)||this;return n.key=e,n.precondition=t,n.type=MutationType.Delete,n}return __extends(t,r),t.prototype.applyToRemoteDocument=function(e,t){return this.verifyKeyMatches(e),assert$1(null==t.transformResults,"Transform results received by DeleteMutation."),new NoDocument(this.key,SnapshotVersion.MIN)},t.prototype.applyToLocalView=function(e,t,n){return this.verifyKeyMatches(e),this.precondition.isValidFor(e)?(e&&assert$1(e.key.isEqual(this.key),"Can only apply mutation to document with same key"),new NoDocument(this.key,SnapshotVersion.forDeletedDoc())):e},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.precondition.isEqual(e.precondition)},t}(Mutation),ExistenceFilter=function(){function e(e){this.count=e}return e.prototype.isEqual=function(e){return e&&e.count===this.count},e}(),RpcCode,kpd;function isPermanentError(e){switch(e){case Code.OK:return fail("Treated status OK as error");case Code.CANCELLED:case Code.UNKNOWN:case Code.DEADLINE_EXCEEDED:case Code.RESOURCE_EXHAUSTED:case Code.INTERNAL:case Code.UNAVAILABLE:case Code.UNAUTHENTICATED:return!1;case Code.INVALID_ARGUMENT:case Code.NOT_FOUND:case Code.ALREADY_EXISTS:case Code.PERMISSION_DENIED:case Code.FAILED_PRECONDITION:case Code.ABORTED:case Code.OUT_OF_RANGE:case Code.UNIMPLEMENTED:case Code.DATA_LOSS:return!0;default:return fail("Unknown status code: "+e)}}function mapCodeFromRpcStatus(e){var t=RpcCode[e];if(void 0!==t)return mapCodeFromRpcCode(t)}function mapCodeFromRpcCode(e){if(void 0===e)return error$2("GRPC error has no .code"),Code.UNKNOWN;switch(e){case RpcCode.OK:return Code.OK;case RpcCode.CANCELLED:return Code.CANCELLED;case RpcCode.UNKNOWN:return Code.UNKNOWN;case RpcCode.DEADLINE_EXCEEDED:return Code.DEADLINE_EXCEEDED;case RpcCode.RESOURCE_EXHAUSTED:return Code.RESOURCE_EXHAUSTED;case RpcCode.INTERNAL:return Code.INTERNAL;case RpcCode.UNAVAILABLE:return Code.UNAVAILABLE;case RpcCode.UNAUTHENTICATED:return Code.UNAUTHENTICATED;case RpcCode.INVALID_ARGUMENT:return Code.INVALID_ARGUMENT;case RpcCode.NOT_FOUND:return Code.NOT_FOUND;case RpcCode.ALREADY_EXISTS:return Code.ALREADY_EXISTS;case RpcCode.PERMISSION_DENIED:return Code.PERMISSION_DENIED;case RpcCode.FAILED_PRECONDITION:return Code.FAILED_PRECONDITION;case RpcCode.ABORTED:return Code.ABORTED;case RpcCode.OUT_OF_RANGE:return Code.OUT_OF_RANGE;case RpcCode.UNIMPLEMENTED:return Code.UNIMPLEMENTED;case RpcCode.DATA_LOSS:return Code.DATA_LOSS;default:return fail("Unknown status code: "+e)}}function mapRpcCodeFromCode(e){if(void 0===e)return RpcCode.OK;switch(e){case Code.OK:return RpcCode.OK;case Code.CANCELLED:return RpcCode.CANCELLED;case Code.UNKNOWN:return RpcCode.UNKNOWN;case Code.DEADLINE_EXCEEDED:return RpcCode.DEADLINE_EXCEEDED;case Code.RESOURCE_EXHAUSTED:return RpcCode.RESOURCE_EXHAUSTED;case Code.INTERNAL:return RpcCode.INTERNAL;case Code.UNAVAILABLE:return RpcCode.UNAVAILABLE;case Code.UNAUTHENTICATED:return RpcCode.UNAUTHENTICATED;case Code.INVALID_ARGUMENT:return RpcCode.INVALID_ARGUMENT;case Code.NOT_FOUND:return RpcCode.NOT_FOUND;case Code.ALREADY_EXISTS:return RpcCode.ALREADY_EXISTS;case Code.PERMISSION_DENIED:return RpcCode.PERMISSION_DENIED;case Code.FAILED_PRECONDITION:return RpcCode.FAILED_PRECONDITION;case Code.ABORTED:return RpcCode.ABORTED;case Code.OUT_OF_RANGE:return RpcCode.OUT_OF_RANGE;case Code.UNIMPLEMENTED:return RpcCode.UNIMPLEMENTED;case Code.DATA_LOSS:return RpcCode.DATA_LOSS;default:return fail("Unknown status code: "+e)}}function mapCodeFromHttpStatus(e){switch(e){case 200:return Code.OK;case 400:return Code.INVALID_ARGUMENT;case 401:return Code.UNAUTHENTICATED;case 403:return Code.PERMISSION_DENIED;case 404:return Code.NOT_FOUND;case 409:return Code.ABORTED;case 416:return Code.OUT_OF_RANGE;case 429:return Code.RESOURCE_EXHAUSTED;case 499:return Code.CANCELLED;case 500:return Code.UNKNOWN;case 501:return Code.UNIMPLEMENTED;case 503:return Code.UNAVAILABLE;case 504:return Code.DEADLINE_EXCEEDED;default:return 200<=e&&e<300?Code.OK:400<=e&&e<500?Code.FAILED_PRECONDITION:500<=e&&e<600?Code.INTERNAL:Code.UNKNOWN}}kpd=RpcCode||(RpcCode={}),kpd[kpd.OK=0]="OK",kpd[kpd.CANCELLED=1]="CANCELLED",kpd[kpd.UNKNOWN=2]="UNKNOWN",kpd[kpd.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",kpd[kpd.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",kpd[kpd.NOT_FOUND=5]="NOT_FOUND",kpd[kpd.ALREADY_EXISTS=6]="ALREADY_EXISTS",kpd[kpd.PERMISSION_DENIED=7]="PERMISSION_DENIED",kpd[kpd.UNAUTHENTICATED=16]="UNAUTHENTICATED",kpd[kpd.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",kpd[kpd.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",kpd[kpd.ABORTED=10]="ABORTED",kpd[kpd.OUT_OF_RANGE=11]="OUT_OF_RANGE",kpd[kpd.UNIMPLEMENTED=12]="UNIMPLEMENTED",kpd[kpd.INTERNAL=13]="INTERNAL",kpd[kpd.UNAVAILABLE=14]="UNAVAILABLE",kpd[kpd.DATA_LOSS=15]="DATA_LOSS";var SortedSet=function(){function o(e){this.comparator=e,this.data=new SortedMap$1(this.comparator)}return o.fromMapKeys=function(e){var t=new o(e.comparator);return e.forEach(function(e){t=t.add(e)}),t},o.prototype.has=function(e){return null!==this.data.get(e)},o.prototype.first=function(){return this.data.minKey()},o.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(o.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),o.prototype.indexOf=function(e){return this.data.indexOf(e)},o.prototype.forEach=function(n){this.data.inorderTraversal(function(e,t){return n(e),!1})},o.prototype.forEachInRange=function(e,t){for(var n=this.data.getIteratorFrom(e[0]);n.hasNext();){var r=n.getNext();if(0<=this.comparator(r.key,e[1]))return;t(r.key)}},o.prototype.forEachWhile=function(e,t){var n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return},o.prototype.firstAfterOrEqual=function(e){var t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null},o.prototype.add=function(e){return this.copy(this.data.remove(e).insert(e,!0))},o.prototype.delete=function(e){return this.has(e)?this.copy(this.data.remove(e)):this},o.prototype.isEmpty=function(){return this.data.isEmpty()},o.prototype.unionWith=function(e){var t=this;return e.forEach(function(e){t=t.add(e)}),t},o.prototype.isEqual=function(e){if(!(e instanceof o))return!1;if(this.size!==e.size)return!1;for(var t=this.data.getIterator(),n=e.data.getIterator();t.hasNext();){var r=t.getNext().key,i=n.getNext().key;if(0!==this.comparator(r,i))return!1}return!0},o.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),"SortedSet("+t.toString()+")"},o.prototype.copy=function(e){var t=new o(this.comparator);return t.data=e,t},o}(),EMPTY_MAYBE_DOCUMENT_MAP=new SortedMap$1(DocumentKey.comparator);function maybeDocumentMap(){return EMPTY_MAYBE_DOCUMENT_MAP}var EMPTY_DOCUMENT_MAP=new SortedMap$1(DocumentKey.comparator);function documentMap(){return EMPTY_DOCUMENT_MAP}var EMPTY_DOCUMENT_VERSION_MAP=new SortedMap$1(DocumentKey.comparator);function documentVersionMap(){return EMPTY_DOCUMENT_VERSION_MAP}var EMPTY_DOCUMENT_KEY_SET=new SortedSet(DocumentKey.comparator);function documentKeySet(){return EMPTY_DOCUMENT_KEY_SET}var RemoteEvent=function(){function e(e,t,n,r){this.snapshotVersion=e,this.targetChanges=t,this.documentUpdates=n,this.limboDocuments=r}return e.prototype.addDocumentUpdate=function(e){this.documentUpdates=this.documentUpdates.insert(e.key,e)},e.prototype.handleExistenceFilterMismatch=function(e){this.targetChanges[e]={mapping:new ResetMapping,snapshotVersion:SnapshotVersion.MIN,currentStatusUpdate:CurrentStatusUpdate.MarkNotCurrent,resumeToken:emptyByteString()}},e.prototype.synthesizeDeleteForLimboTargetChange=function(e,t){e.currentStatusUpdate!==CurrentStatusUpdate.MarkCurrent||this.documentUpdates.get(t)||(this.documentUpdates=this.documentUpdates.insert(t,new NoDocument(t,this.snapshotVersion)),this.limboDocuments=this.limboDocuments.add(t))},e}(),CurrentStatusUpdate,_pd;_pd=CurrentStatusUpdate||(CurrentStatusUpdate={}),_pd[_pd.None=0]="None",_pd[_pd.MarkNotCurrent=1]="MarkNotCurrent",_pd[_pd.MarkCurrent=2]="MarkCurrent";var EMPTY_KEY_SET=documentKeySet(),ResetMapping=function(){function e(){this.docs=EMPTY_KEY_SET}return Object.defineProperty(e.prototype,"documents",{get:function(){return this.docs},enumerable:!0,configurable:!0}),e.prototype.add=function(e){this.docs=this.docs.add(e)},e.prototype.delete=function(e){this.docs=this.docs.delete(e)},e.prototype.isEqual=function(e){return null!==e&&this.docs.isEqual(e.docs)},e.prototype.filterUpdates=function(e){},e}(),UpdateMapping=function(){function e(){this.addedDocuments=EMPTY_KEY_SET,this.removedDocuments=EMPTY_KEY_SET}return e.prototype.applyToKeySet=function(e){var t=e;return this.addedDocuments.forEach(function(e){return t=t.add(e)}),this.removedDocuments.forEach(function(e){return t=t.delete(e)}),t},e.prototype.add=function(e){this.addedDocuments=this.addedDocuments.add(e),this.removedDocuments=this.removedDocuments.delete(e)},e.prototype.delete=function(e){this.addedDocuments=this.addedDocuments.delete(e),this.removedDocuments=this.removedDocuments.add(e)},e.prototype.isEqual=function(e){return null!==e&&this.addedDocuments.isEqual(e.addedDocuments)&&this.removedDocuments.isEqual(e.removedDocuments)},e.prototype.filterUpdates=function(t){var n=this.addedDocuments;this.addedDocuments.forEach(function(e){t.has(e)&&(n=n.delete(e))}),this.addedDocuments=n},e}(),DocumentWatchChange=function(e,t,n,r){this.updatedTargetIds=e,this.removedTargetIds=t,this.key=n,this.newDoc=r},ExistenceFilterChange=function(e,t){this.targetId=e,this.existenceFilter=t},WatchTargetChangeState,wqd;wqd=WatchTargetChangeState||(WatchTargetChangeState={}),wqd[wqd.NoChange=0]="NoChange",wqd[wqd.Added=1]="Added",wqd[wqd.Removed=2]="Removed",wqd[wqd.Current=3]="Current",wqd[wqd.Reset=4]="Reset";var WatchTargetChange=function(e,t,n,r){void 0===n&&(n=emptyByteString()),void 0===r&&(r=null),this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r},WatchChangeAggregator=function(){function e(e,t,n){this.snapshotVersion=e,this.listenTargets=t,this.existenceFilters={},this.targetChanges={},this.documentUpdates=maybeDocumentMap(),this.frozen=!1,this.limboDocuments=documentKeySet(),this.pendingTargetResponses=shallowCopy(n)}return e.prototype.add=function(e){assert$1(!this.frozen,"Trying to modify frozen WatchChangeAggregator."),e instanceof DocumentWatchChange?this.addDocumentChange(e):e instanceof WatchTargetChange?this.addTargetChange(e):e instanceof ExistenceFilterChange?this.addExistenceFilterChange(e):fail("Unknown watch change: "+e)},e.prototype.addChanges=function(e){var t=this;assert$1(!this.frozen,"Trying to modify frozen WatchChangeAggregator."),e.forEach(function(e){return t.add(e)})},e.prototype.createRemoteEvent=function(){var t=this,n=this.targetChanges;return forEachNumber(this.targetChanges,function(e){t.isActiveTarget(e)||delete n[e]}),this.frozen=!0,new RemoteEvent(this.snapshotVersion,n,this.documentUpdates,this.limboDocuments)},e.prototype.ensureTargetChange=function(e){var t=this.targetChanges[e];return t||(t={currentStatusUpdate:CurrentStatusUpdate.None,snapshotVersion:this.snapshotVersion,mapping:new UpdateMapping,resumeToken:emptyByteString()},this.targetChanges[e]=t),t},e.prototype.queryDataForActiveTarget=function(e){var t=this.listenTargets[e];return t&&!contains$2(this.pendingTargetResponses,e)?t:null},e.prototype.isActiveTarget=function(e){return null!==this.queryDataForActiveTarget(e)},e.prototype.updateLimboDocuments=function(e,t,n){return!!n&&(this.documentUpdates.get(e)?t.purpose===QueryPurpose.LimboResolution||(this.limboDocuments=this.limboDocuments.delete(e),!1):t.purpose===QueryPurpose.LimboResolution&&(this.limboDocuments=this.limboDocuments.add(e),!0))},e.prototype.addDocumentChange=function(e){for(var t=!1,n=!0,r=0,i=e.updatedTargetIds;r<i.length;r++){var o=i[r];if(c=this.queryDataForActiveTarget(o)){var a=this.ensureTargetChange(o);n=this.updateLimboDocuments(e.key,c,n),a.mapping.add(e.key),t=!0}}for(var s=0,u=e.removedTargetIds;s<u.length;s++){var c;o=u[s],(c=this.queryDataForActiveTarget(o))&&(a=this.ensureTargetChange(o),n=this.updateLimboDocuments(e.key,c,n),a.mapping.delete(e.key),t=!0)}e.newDoc&&t&&(this.documentUpdates=this.documentUpdates.insert(e.key,e.newDoc))},e.prototype.addTargetChange=function(n){var r=this;n.targetIds.forEach(function(e){var t=r.ensureTargetChange(e);switch(n.state){case WatchTargetChangeState.NoChange:r.isActiveTarget(e)&&applyResumeToken(t,n.resumeToken);break;case WatchTargetChangeState.Added:r.recordTargetResponse(e),contains$2(r.pendingTargetResponses,e)||(t.mapping=new UpdateMapping,t.currentStatusUpdate=CurrentStatusUpdate.None,delete r.existenceFilters[e]),applyResumeToken(t,n.resumeToken);break;case WatchTargetChangeState.Removed:r.recordTargetResponse(e),assert$1(!n.cause,"WatchChangeAggregator does not handle errored targets");break;case WatchTargetChangeState.Current:r.isActiveTarget(e)&&(t.currentStatusUpdate=CurrentStatusUpdate.MarkCurrent,applyResumeToken(t,n.resumeToken));break;case WatchTargetChangeState.Reset:r.isActiveTarget(e)&&(t.mapping=new ResetMapping,applyResumeToken(t,n.resumeToken));break;default:fail("Unknown target watch change state: "+n.state)}})},e.prototype.recordTargetResponse=function(e){var t=(this.pendingTargetResponses[e]||0)-1;0===t?delete this.pendingTargetResponses[e]:this.pendingTargetResponses[e]=t},e.prototype.addExistenceFilterChange=function(e){this.isActiveTarget(e.targetId)&&(this.existenceFilters[e.targetId]=e.existenceFilter)},e}();function applyResumeToken(e,t){0<t.length&&(e.resumeToken=t)}var ServerTimestampTransform=function(){function t(){}return t.prototype.applyToLocalView=function(e,t){return new ServerTimestampValue(t,e)},t.prototype.applyToRemoteDocument=function(e,t){return t},t.prototype.isEqual=function(e){return e instanceof t},t.instance=new t,t}(),ArrayUnionTransformOperation=function(){function t(e){this.elements=e}return t.prototype.applyToLocalView=function(e,t){return this.apply(e)},t.prototype.applyToRemoteDocument=function(e,t){return this.apply(e)},t.prototype.apply=function(e){for(var n=coercedFieldValuesArray(e),t=function(t){n.find(function(e){return e.isEqual(t)})||n.push(t)},r=0,i=this.elements;r<i.length;r++)t(i[r]);return new ArrayValue(n)},t.prototype.isEqual=function(e){return e instanceof t&&arrayEquals(e.elements,this.elements)},t}(),ArrayRemoveTransformOperation=function(){function t(e){this.elements=e}return t.prototype.applyToLocalView=function(e,t){return this.apply(e)},t.prototype.applyToRemoteDocument=function(e,t){return this.apply(e)},t.prototype.apply=function(e){for(var n=coercedFieldValuesArray(e),t=function(t){n=n.filter(function(e){return!e.isEqual(t)})},r=0,i=this.elements;r<i.length;r++)t(i[r]);return new ArrayValue(n)},t.prototype.isEqual=function(e){return e instanceof t&&arrayEquals(e.elements,this.elements)},t}();function coercedFieldValuesArray(e){return e instanceof ArrayValue?e.internalValue.slice():[]}var DIRECTIONS=(dirs={},dirs[Direction.ASCENDING.name]="ASCENDING",dirs[Direction.DESCENDING.name]="DESCENDING",dirs),dirs,OPERATORS=(ops={},ops[RelationOp.LESS_THAN.name]="LESS_THAN",ops[RelationOp.LESS_THAN_OR_EQUAL.name]="LESS_THAN_OR_EQUAL",ops[RelationOp.GREATER_THAN.name]="GREATER_THAN",ops[RelationOp.GREATER_THAN_OR_EQUAL.name]="GREATER_THAN_OR_EQUAL",ops[RelationOp.EQUAL.name]="EQUAL",ops[RelationOp.ARRAY_CONTAINS.name]="ARRAY_CONTAINS",ops),ops,ISO_REG_EXP=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function assertPresent(e,t){assert$1(!isNullOrUndefined(e),t+" is missing")}function parseInt64(e){return"number"==typeof e?e:"string"==typeof e?Number(e):fail("can't parse "+e)}var JsonProtoSerializer=function(){function e(e,t){this.databaseId=e,this.options=t}return e.prototype.emptyByteString=function(){return this.options.useProto3Json?"":new Uint8Array(0)},e.prototype.unsafeCastProtoByteString=function(e){return e},e.prototype.fromRpcStatus=function(e){var t=void 0===e.code?Code.UNKNOWN:mapCodeFromRpcCode(e.code);return new FirestoreError(t,e.message||"")},e.prototype.toInt32Value=function(e){return isNullOrUndefined(e)?void 0:{value:e}},e.prototype.fromInt32Value=function(e){var t;return isNullOrUndefined(t="object"==typeof e?e.value:e)?null:t},e.prototype.toTimestamp=function(e){return{seconds:e.seconds,nanos:e.nanoseconds}},e.prototype.fromTimestamp=function(e){if("string"==typeof e)return this.fromIso8601String(e);assert$1(!!e,"Cannot deserialize null or undefined timestamp.");var t=parseInt64(e.seconds||"0"),n=e.nanos||0;return new Timestamp(t,n)},e.prototype.fromIso8601String=function(e){var t=0,n=ISO_REG_EXP.exec(e);if(assert$1(!!n,"invalid timestamp: "+e),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),t=Number(r)}var i=new Date(e),o=Math.floor(i.getTime()/1e3);return new Timestamp(o,t)},e.prototype.toBytes=function(e){return this.options.useProto3Json?e.toBase64():this.unsafeCastProtoByteString(e.toUint8Array())},e.prototype.fromBlob=function(e){return"string"==typeof e?(assert$1(this.options.useProto3Json,"Expected bytes to be passed in as Uint8Array, but got a string instead."),Blob$1.fromBase64String(e)):(assert$1(!this.options.useProto3Json,"Expected bytes to be passed in as string, but got something else instead."),Blob$1.fromUint8Array(e))},e.prototype.toVersion=function(e){return this.toTimestamp(e.toTimestamp())},e.prototype.fromVersion=function(e){return assert$1(!!e,"Trying to deserialize version that isn't set"),SnapshotVersion.fromTimestamp(this.fromTimestamp(e))},e.prototype.toResourceName=function(e,t){return this.fullyQualifiedPrefixPath(e).child("documents").child(t).canonicalString()},e.prototype.fromResourceName=function(e){var t=ResourcePath.fromString(e);return assert$1(this.isValidResourceName(t),"Tried to deserialize invalid key "+t.toString()),t},e.prototype.toName=function(e){return this.toResourceName(this.databaseId,e.path)},e.prototype.fromName=function(e){var t=this.fromResourceName(e);return assert$1(t.get(1)===this.databaseId.projectId,"Tried to deserialize key from different project: "+t.get(1)+" vs "+this.databaseId.projectId),assert$1(!t.get(3)&&!this.databaseId.database||t.get(3)===this.databaseId.database,"Tried to deserialize key from different database: "+t.get(3)+" vs "+this.databaseId.database),new DocumentKey(this.extractLocalPathFromResourceName(t))},e.prototype.toQueryPath=function(e){return 0===e.length?this.encodedDatabaseId:this.toResourceName(this.databaseId,e)},e.prototype.fromQueryPath=function(e){var t=this.fromResourceName(e);return 4===t.length?ResourcePath.EMPTY_PATH:this.extractLocalPathFromResourceName(t)},Object.defineProperty(e.prototype,"encodedDatabaseId",{get:function(){return new ResourcePath(["projects",this.databaseId.projectId,"databases",this.databaseId.database]).canonicalString()},enumerable:!0,configurable:!0}),e.prototype.fullyQualifiedPrefixPath=function(e){return new ResourcePath(["projects",e.projectId,"databases",e.database])},e.prototype.extractLocalPathFromResourceName=function(e){return assert$1(4<e.length&&"documents"===e.get(4),"tried to deserialize invalid key "+e.toString()),e.popFirst(5)},e.prototype.isValidResourceName=function(e){return 4<=e.length&&"projects"===e.get(0)&&"databases"===e.get(2)},e.prototype.toValue=function(e){if(e instanceof NullValue)return{nullValue:"NULL_VALUE"};if(e instanceof BooleanValue)return{booleanValue:e.value()};if(e instanceof IntegerValue)return{integerValue:""+e.value()};if(e instanceof DoubleValue){var t=e.value();if(this.options.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:e.value()}}return e instanceof StringValue?{stringValue:e.value()}:e instanceof ObjectValue?{mapValue:this.toMapValue(e)}:e instanceof ArrayValue?{arrayValue:this.toArrayValue(e)}:e instanceof TimestampValue?{timestampValue:this.toTimestamp(e.internalValue)}:e instanceof GeoPointValue?{geoPointValue:{latitude:e.value().latitude,longitude:e.value().longitude}}:e instanceof BlobValue?{bytesValue:this.toBytes(e.value())}:e instanceof RefValue?{referenceValue:this.toResourceName(e.databaseId,e.key.path)}:fail("Unknown FieldValue "+JSON.stringify(e))},e.prototype.fromValue=function(e){var t=this,n=e.value_type;if(hasTag(e,n,"nullValue"))return NullValue.INSTANCE;if(hasTag(e,n,"booleanValue"))return BooleanValue.of(e.booleanValue);if(hasTag(e,n,"integerValue"))return new IntegerValue(parseInt64(e.integerValue));if(hasTag(e,n,"doubleValue")){if(this.options.useProto3Json){if("NaN"===e.doubleValue)return DoubleValue.NAN;if("Infinity"===e.doubleValue)return DoubleValue.POSITIVE_INFINITY;if("-Infinity"===e.doubleValue)return DoubleValue.NEGATIVE_INFINITY}return new DoubleValue(e.doubleValue)}if(hasTag(e,n,"stringValue"))return new StringValue(e.stringValue);if(hasTag(e,n,"mapValue"))return this.fromFields(e.mapValue.fields||{});if(hasTag(e,n,"arrayValue")){assertPresent(e.arrayValue,"arrayValue");var r=e.arrayValue.values||[];return new ArrayValue(r.map(function(e){return t.fromValue(e)}))}if(hasTag(e,n,"timestampValue"))return assertPresent(e.timestampValue,"timestampValue"),new TimestampValue(this.fromTimestamp(e.timestampValue));if(hasTag(e,n,"geoPointValue")){assertPresent(e.geoPointValue,"geoPointValue");var i=e.geoPointValue.latitude||0,o=e.geoPointValue.longitude||0;return new GeoPointValue(new GeoPoint(i,o))}if(hasTag(e,n,"bytesValue")){assertPresent(e.bytesValue,"bytesValue");var a=this.fromBlob(e.bytesValue);return new BlobValue(a)}if(hasTag(e,n,"referenceValue")){assertPresent(e.referenceValue,"referenceValue");var s=this.fromResourceName(e.referenceValue),u=new DatabaseId(s.get(1),s.get(3)),c=new DocumentKey(this.extractLocalPathFromResourceName(s));return new RefValue(u,c)}return fail("Unknown Value proto "+JSON.stringify(e))},e.prototype.toMutationDocument=function(e,t){return{name:this.toName(e),fields:this.toFields(t)}},e.prototype.toDocument=function(e){return assert$1(!e.hasLocalMutations,"Can't serialize documents with mutations."),{name:this.toName(e.key),fields:this.toFields(e.data),updateTime:this.toTimestamp(e.version.toTimestamp())}},e.prototype.fromDocument=function(e){return new Document(this.fromName(e.name),this.fromVersion(e.updateTime),this.fromFields(e.fields||{}),{hasLocalMutations:!1})},e.prototype.toFields=function(e){var n=this,r={};return e.forEach(function(e,t){r[e]=n.toValue(t)}),r},e.prototype.fromFields=function(e){var n=this,t=e,r=ObjectValue.EMPTY;return forEach$1(t,function(e,t){r=r.set(new FieldPath([e]),n.fromValue(t))}),r},e.prototype.toMapValue=function(e){return{fields:this.toFields(e)}},e.prototype.toArrayValue=function(e){var t=this,n=[];return e.forEach(function(e){n.push(t.toValue(e))}),{values:n}},e.prototype.fromFound=function(e){assert$1(!!e.found,"Tried to deserialize a found document from a missing document."),assertPresent(e.found.name,"doc.found.name"),assertPresent(e.found.updateTime,"doc.found.updateTime");var t=this.fromName(e.found.name),n=this.fromVersion(e.found.updateTime),r=this.fromFields(e.found.fields||{});return new Document(t,n,r,{hasLocalMutations:!1})},e.prototype.fromMissing=function(e){assert$1(!!e.missing,"Tried to deserialize a missing document from a found document."),assert$1(!!e.readTime,"Tried to deserialize a missing document without a read time.");var t=this.fromName(e.missing),n=this.fromVersion(e.readTime);return new NoDocument(t,n)},e.prototype.fromMaybeDocument=function(e){var t=e.result;return hasTag(e,t,"found")?this.fromFound(e):hasTag(e,t,"missing")?this.fromMissing(e):fail("invalid batch get response: "+JSON.stringify(e))},e.prototype.toWatchTargetChangeState=function(e){switch(e){case WatchTargetChangeState.Added:return"ADD";case WatchTargetChangeState.Current:return"CURRENT";case WatchTargetChangeState.NoChange:return"NO_CHANGE";case WatchTargetChangeState.Removed:return"REMOVE";case WatchTargetChangeState.Reset:return"RESET";default:return fail("Unknown WatchTargetChangeState: "+e)}},e.prototype.toTestWatchChange=function(e){if(e instanceof ExistenceFilterChange)return{filter:{count:e.existenceFilter.count,targetId:e.targetId}};if(e instanceof DocumentWatchChange){if(e.newDoc instanceof Document){var t=e.newDoc;return{documentChange:{document:{name:this.toName(t.key),fields:this.toFields(t.data),updateTime:this.toVersion(t.version)},targetIds:e.updatedTargetIds,removedTargetIds:e.removedTargetIds}}}if(e.newDoc instanceof NoDocument)return t=e.newDoc,{documentDelete:{document:this.toName(t.key),readTime:this.toVersion(t.version),removedTargetIds:e.removedTargetIds}};if(null===e.newDoc)return{documentRemove:{document:this.toName(e.key),removedTargetIds:e.removedTargetIds}}}if(e instanceof WatchTargetChange){var n=void 0;return e.cause&&(n={code:mapRpcCodeFromCode(e.cause.code),message:e.cause.message}),{targetChange:{targetChangeType:this.toWatchTargetChangeState(e.state),targetIds:e.targetIds,resumeToken:this.unsafeCastProtoByteString(e.resumeToken),cause:n}}}return fail("Unrecognized watch change: "+JSON.stringify(e))},e.prototype.fromWatchChange=function(e){var t,n=e.response_type;if(hasTag(e,n,"targetChange")){assertPresent(e.targetChange,"targetChange");var r=this.fromWatchTargetChangeState(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=e.targetChange.resumeToken||this.emptyByteString(),a=e.targetChange.cause,s=a&&this.fromRpcStatus(a);t=new WatchTargetChange(r,i,o,s||null)}else if(hasTag(e,n,"documentChange")){assertPresent(e.documentChange,"documentChange"),assertPresent(e.documentChange.document,"documentChange.name"),assertPresent(e.documentChange.document.name,"documentChange.document.name"),assertPresent(e.documentChange.document.updateTime,"documentChange.document.updateTime");var u=e.documentChange,c=this.fromName(u.document.name),l=this.fromVersion(u.document.updateTime),h=this.fromFields(u.document.fields||{}),f=new Document(c,l,h,{hasLocalMutations:!1}),d=u.targetIds||[],p=u.removedTargetIds||[];t=new DocumentWatchChange(d,p,f.key,f)}else if(hasTag(e,n,"documentDelete")){assertPresent(e.documentDelete,"documentDelete"),assertPresent(e.documentDelete.document,"documentDelete.document");var v=e.documentDelete;c=this.fromName(v.document),l=v.readTime?this.fromVersion(v.readTime):SnapshotVersion.forDeletedDoc(),f=new NoDocument(c,l),p=v.removedTargetIds||[],t=new DocumentWatchChange([],p,f.key,f)}else if(hasTag(e,n,"documentRemove")){assertPresent(e.documentRemove,"documentRemove"),assertPresent(e.documentRemove.document,"documentRemove");var m=e.documentRemove;c=this.fromName(m.document),p=m.removedTargetIds||[],t=new DocumentWatchChange([],p,c,null)}else{if(!hasTag(e,n,"filter"))return fail("Unknown change type "+JSON.stringify(e));assertPresent(e.filter,"filter"),assertPresent(e.filter.targetId,"filter.targetId");var g=e.filter,y=g.count||0,b=new ExistenceFilter(y),_=g.targetId;t=new ExistenceFilterChange(_,b)}return t},e.prototype.fromWatchTargetChangeState=function(e){return"NO_CHANGE"===e?WatchTargetChangeState.NoChange:"ADD"===e?WatchTargetChangeState.Added:"REMOVE"===e?WatchTargetChangeState.Removed:"CURRENT"===e?WatchTargetChangeState.Current:"RESET"===e?WatchTargetChangeState.Reset:fail("Got unexpected TargetChange.state: "+e)},e.prototype.versionFromListenResponse=function(e){if(!hasTag(e,e.response_type,"targetChange"))return SnapshotVersion.MIN;var t=e.targetChange;return t.targetIds&&t.targetIds.length?SnapshotVersion.MIN:t.readTime?this.fromVersion(t.readTime):SnapshotVersion.MIN},e.prototype.toMutation=function(e){var t,n=this;if(e instanceof SetMutation)t={update:this.toMutationDocument(e.key,e.value)};else if(e instanceof DeleteMutation)t={delete:this.toName(e.key)};else if(e instanceof PatchMutation)t={update:this.toMutationDocument(e.key,e.data),updateMask:this.toDocumentMask(e.fieldMask)};else{if(!(e instanceof TransformMutation))return fail("Unknown mutation type "+e.type);t={transform:{document:this.toName(e.key),fieldTransforms:e.fieldTransforms.map(function(e){return n.toFieldTransform(e)})}}}return e.precondition.isNone||(t.currentDocument=this.toPrecondition(e.precondition)),t},e.prototype.fromMutation=function(e){var t=this,n=e.currentDocument?this.fromPrecondition(e.currentDocument):Precondition.NONE;if(e.update){assertPresent(e.update.name,"name");var r=this.fromName(e.update.name),i=this.fromFields(e.update.fields||{});if(e.updateMask){var o=this.fromDocumentMask(e.updateMask);return new PatchMutation(r,i,o,n)}return new SetMutation(r,i,n)}if(e.delete)return r=this.fromName(e.delete),new DeleteMutation(r,n);if(e.transform){r=this.fromName(e.transform.document);var a=e.transform.fieldTransforms.map(function(e){return t.fromFieldTransform(e)});return assert$1(!0===n.exists,'Transforms only support precondition "exists == true"'),new TransformMutation(r,a)}return fail("unknown mutation proto: "+JSON.stringify(e))},e.prototype.toPrecondition=function(e){return assert$1(!e.isNone,"Can't serialize an empty precondition"),void 0!==e.updateTime?{updateTime:this.toVersion(e.updateTime)}:void 0!==e.exists?{exists:e.exists}:fail("Unknown precondition")},e.prototype.fromPrecondition=function(e){return void 0!==e.updateTime?Precondition.updateTime(this.fromVersion(e.updateTime)):void 0!==e.exists?Precondition.exists(e.exists):Precondition.NONE},e.prototype.fromWriteResult=function(e){var t=this,n=e.updateTime?this.fromVersion(e.updateTime):null,r=null;return e.transformResults&&0<e.transformResults.length&&(r=e.transformResults.map(function(e){return t.fromValue(e)})),new MutationResult(n,r)},e.prototype.fromWriteResults=function(e){var t=this;return(e||[]).map(function(e){return t.fromWriteResult(e)})},e.prototype.toFieldTransform=function(e){var t=this,n=e.transform;return n instanceof ServerTimestampTransform?{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"}:n instanceof ArrayUnionTransformOperation?{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements.map(function(e){return t.toValue(e)})}}:n instanceof ArrayRemoveTransformOperation?{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements.map(function(e){return t.toValue(e)})}}:void fail("Unknown transform: "+e.transform)},e.prototype.fromFieldTransform=function(e){var t=this,n=e.transform_type,r=null;if(hasTag(e,n,"setToServerValue"))assert$1("REQUEST_TIME"===e.setToServerValue,"Unknown server value transform proto: "+JSON.stringify(e)),r=ServerTimestampTransform.instance;else if(hasTag(e,n,"appendMissingElements")){var i=e.appendMissingElements.values||[];r=new ArrayUnionTransformOperation(i.map(function(e){return t.fromValue(e)}))}else hasTag(e,n,"removeAllFromArray")?(i=e.removeAllFromArray.values||[],r=new ArrayRemoveTransformOperation(i.map(function(e){return t.fromValue(e)}))):fail("Unknown transform proto: "+JSON.stringify(e));var o=FieldPath.fromServerFormat(e.fieldPath);return new FieldTransform(o,r)},e.prototype.toDocumentsTarget=function(e){return{documents:[this.toQueryPath(e.path)]}},e.prototype.fromDocumentsTarget=function(e){var t=e.documents.length;assert$1(1===t,"DocumentsTarget contained other than 1 document: "+t);var n=e.documents[0];return Query$1.atPath(this.fromQueryPath(n))},e.prototype.toQueryTarget=function(e){var t={structuredQuery:{}};if(e.path.isEmpty())t.parent=this.toQueryPath(ResourcePath.EMPTY_PATH);else{var n=e.path;assert$1(n.length%2!=0,"Document queries with filters are not supported."),t.parent=this.toQueryPath(n.popLast()),t.structuredQuery.from=[{collectionId:n.lastSegment()}]}var r=this.toFilter(e.filters);r&&(t.structuredQuery.where=r);var i=this.toOrder(e.orderBy);i&&(t.structuredQuery.orderBy=i);var o=this.toInt32Value(e.limit);return void 0!==o&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt=this.toCursor(e.startAt)),e.endAt&&(t.structuredQuery.endAt=this.toCursor(e.endAt)),t},e.prototype.fromQueryTarget=function(e){var t=this.fromQueryPath(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0;if(0<r){assert$1(1===r,"StructuredQuery.from with more than one collection is not supported.");var i=n.from[0];t=t.child(i.collectionId)}var o=[];n.where&&(o=this.fromFilter(n.where));var a=[];n.orderBy&&(a=this.fromOrder(n.orderBy));var s=null;n.limit&&(s=this.fromInt32Value(n.limit));var u=null;n.startAt&&(u=this.fromCursor(n.startAt));var c=null;return n.endAt&&(c=this.fromCursor(n.endAt)),new Query$1(t,a,o,s,u,c)},e.prototype.toListenRequestLabels=function(e){var t=this.toLabel(e.purpose);return null==t?null:{"goog-listen-tags":t}},e.prototype.toLabel=function(e){switch(e){case QueryPurpose.Listen:return null;case QueryPurpose.ExistenceFilterMismatch:return"existence-filter-mismatch";case QueryPurpose.LimboResolution:return"limbo-document";default:return fail("Unrecognized query purpose: "+e)}},e.prototype.toTarget=function(e){var t,n=e.query;return(t=n.isDocumentQuery()?{documents:this.toDocumentsTarget(n)}:{query:this.toQueryTarget(n)}).targetId=e.targetId,0<e.resumeToken.length&&(t.resumeToken=this.unsafeCastProtoByteString(e.resumeToken)),t},e.prototype.toFilter=function(e){var t=this;if(0!==e.length){var n=e.map(function(e){return e instanceof RelationFilter?t.toRelationFilter(e):t.toUnaryFilter(e)});return 1===n.length?n[0]:{compositeFilter:{op:"AND",filters:n}}}},e.prototype.fromFilter=function(e){var t=this;return e?void 0!==e.unaryFilter?[this.fromUnaryFilter(e)]:void 0!==e.fieldFilter?[this.fromRelationFilter(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(function(e){return t.fromFilter(e)}).reduce(function(e,t){return e.concat(t)}):fail("Unknown filter: "+JSON.stringify(e)):[]},e.prototype.toOrder=function(e){var t=this;if(0!==e.length)return e.map(function(e){return t.toPropertyOrder(e)})},e.prototype.fromOrder=function(e){var t=this;return e.map(function(e){return t.fromPropertyOrder(e)})},e.prototype.toCursor=function(e){var t=this;return{before:e.before,values:e.position.map(function(e){return t.toValue(e)})}},e.prototype.fromCursor=function(e){var t=this,n=!!e.before,r=e.values.map(function(e){return t.fromValue(e)});return new Bound(r,n)},e.prototype.toDirection=function(e){return DIRECTIONS[e.name]},e.prototype.fromDirection=function(e){switch(e){case"ASCENDING":return Direction.ASCENDING;case"DESCENDING":return Direction.DESCENDING;default:return}},e.prototype.toOperatorName=function(e){return OPERATORS[e.name]},e.prototype.fromOperatorName=function(e){switch(e){case"EQUAL":return RelationOp.EQUAL;case"GREATER_THAN":return RelationOp.GREATER_THAN;case"GREATER_THAN_OR_EQUAL":return RelationOp.GREATER_THAN_OR_EQUAL;case"LESS_THAN":return RelationOp.LESS_THAN;case"LESS_THAN_OR_EQUAL":return RelationOp.LESS_THAN_OR_EQUAL;case"ARRAY_CONTAINS":return RelationOp.ARRAY_CONTAINS;case"OPERATOR_UNSPECIFIED":return fail("Unspecified relation");default:return fail("Unknown relation")}},e.prototype.toFieldPathReference=function(e){return{fieldPath:e.canonicalString()}},e.prototype.fromFieldPathReference=function(e){return FieldPath.fromServerFormat(e.fieldPath)},e.prototype.toPropertyOrder=function(e){return{field:this.toFieldPathReference(e.field),direction:this.toDirection(e.dir)}},e.prototype.fromPropertyOrder=function(e){return new OrderBy(this.fromFieldPathReference(e.field),this.fromDirection(e.direction))},e.prototype.toRelationFilter=function(e){return e instanceof RelationFilter?{fieldFilter:{field:this.toFieldPathReference(e.field),op:this.toOperatorName(e.op),value:this.toValue(e.value)}}:fail("Unrecognized filter: "+JSON.stringify(e))},e.prototype.fromRelationFilter=function(e){return new RelationFilter(this.fromFieldPathReference(e.fieldFilter.field),this.fromOperatorName(e.fieldFilter.op),this.fromValue(e.fieldFilter.value))},e.prototype.toUnaryFilter=function(e){return e instanceof NanFilter?{unaryFilter:{field:this.toFieldPathReference(e.field),op:"IS_NAN"}}:e instanceof NullFilter?{unaryFilter:{field:this.toFieldPathReference(e.field),op:"IS_NULL"}}:fail("Unrecognized filter: "+JSON.stringify(e))},e.prototype.fromUnaryFilter=function(e){switch(e.unaryFilter.op){case"IS_NAN":var t=this.fromFieldPathReference(e.unaryFilter.field);return new NanFilter(t);case"IS_NULL":var n=this.fromFieldPathReference(e.unaryFilter.field);return new NullFilter(n);case"OPERATOR_UNSPECIFIED":return fail("Unspecified filter");default:return fail("Unknown filter")}},e.prototype.toDocumentMask=function(e){return{fieldPaths:e.fields.map(function(e){return e.canonicalString()})}},e.prototype.fromDocumentMask=function(e){var t=(e.fieldPaths||[]).map(function(e){return FieldPath.fromServerFormat(e)});return new FieldMask(t)},e}();function hasTag(e,t,n){return t===n||!t&&n in e}var isReactNative$1=function(){return"object"==typeof navigator&&"ReactNative"===navigator.product},ERROR_NAME$1="FirebaseError",captureStackTrace$1=Error.captureStackTrace,FirebaseError$1=function(e,t){if(this.code=e,this.message=t,captureStackTrace$1)captureStackTrace$1(this,ErrorFactory$1.prototype.create);else{var n=Error.apply(this,arguments);this.name=ERROR_NAME$1,Object.defineProperty(this,"stack",{get:function(){return n.stack}})}};FirebaseError$1.prototype=Object.create(Error.prototype),FirebaseError$1.prototype.constructor=FirebaseError$1,FirebaseError$1.prototype.name=ERROR_NAME$1;var ErrorFactory$1=function(){function e(e,t,n){this.service=e,this.serviceName=t,this.errors=n,this.pattern=/\{\$([^}]+)}/g}return e.prototype.create=function(e,r){void 0===r&&(r={});var t,n=this.errors[e],i=this.service+"/"+e;t=void 0===n?"Error":n.replace(this.pattern,function(e,t){var n=r[t];return void 0!==n?n.toString():"<"+t+"?>"}),t=this.serviceName+": "+t+" ("+i+").";var o=new FirebaseError$1(i,t);for(var a in r)r.hasOwnProperty(a)&&"_"!==a.slice(-1)&&(o[a]=r[a]);return o},e}(),Hash$1=function(){this.blockSize=-1},Sha1$1=function(n){function e(){var e=n.call(this)||this;e.chain_=[],e.buf_=[],e.W_=[],e.pad_=[],e.inbuf_=0,e.total_=0,e.blockSize=64,e.pad_[0]=128;for(var t=1;t<e.blockSize;++t)e.pad_[t]=0;return e.reset(),e}return __extends(e,n),e.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},e.prototype.compress_=function(e,t){t||(t=0);var n=this.W_;if("string"==typeof e)for(var r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(r=0;r<16;r++)n[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var o,a,s=this.chain_[0],u=this.chain_[1],c=this.chain_[2],l=this.chain_[3],h=this.chain_[4];for(r=0;r<80;r++)r<40?r<20?(o=l^u&(c^l),a=1518500249):(o=u^c^l,a=1859775393):r<60?(o=u&c|l&(u|c),a=2400959708):(o=u^c^l,a=3395469782),i=(s<<5|s>>>27)+o+h+a+n[r]&4294967295,h=l,l=c,c=4294967295&(u<<30|u>>>2),u=s,s=i;this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295},e.prototype.update=function(e,t){if(null!=e){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<t;){if(0==o)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[o]=e.charCodeAt(r),++r,++o==this.blockSize){this.compress_(i),o=0;break}}else for(;r<t;)if(i[o]=e[r],++r,++o==this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=t}},e.prototype.digest=function(){var e=[],t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;56<=n;n--)this.buf_[n]=255&t,t/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;0<=i;i-=8)e[r]=this.chain_[n]>>i&255,++r;return e},e}(Hash$1),StreamBridge=function(){function e(e){this.sendFn=e.sendFn,this.closeFn=e.closeFn}return e.prototype.onOpen=function(e){assert$1(!this.wrappedOnOpen,"Called onOpen on stream twice!"),this.wrappedOnOpen=e},e.prototype.onClose=function(e){assert$1(!this.wrappedOnClose,"Called onClose on stream twice!"),this.wrappedOnClose=e},e.prototype.onMessage=function(e){assert$1(!this.wrappedOnMessage,"Called onMessage on stream twice!"),this.wrappedOnMessage=e},e.prototype.close=function(){this.closeFn()},e.prototype.send=function(e){this.sendFn(e)},e.prototype.callOnOpen=function(){assert$1(void 0!==this.wrappedOnOpen,"Cannot call onOpen because no callback was set"),this.wrappedOnOpen()},e.prototype.callOnClose=function(e){assert$1(void 0!==this.wrappedOnClose,"Cannot call onClose because no callback was set"),this.wrappedOnClose(e)},e.prototype.callOnMessage=function(e){assert$1(void 0!==this.wrappedOnMessage,"Cannot call onMessage because no callback was set"),this.wrappedOnMessage(e)},e}(),LOG_TAG="Connection",RPC_STREAM_SERVICE="google.firestore.v1beta1.Firestore",RPC_URL_VERSION="v1beta1",RPC_NAME_REST_MAPPING={BatchGetDocuments:"batchGet",Commit:"commit"},X_GOOG_API_CLIENT_VALUE="gl-js/ fire/"+SDK_VERSION,XHR_TIMEOUT_SECS=15,WebChannelConnection=function(){function e(e){this.databaseId=e.databaseId,this.pool=new dist_5;var t=e.ssl?"https":"http";this.baseUrl=t+"://"+e.host}return e.prototype.modifyHeadersForRequest=function(e,t){if(t)for(var n in t.authHeaders)t.authHeaders.hasOwnProperty(n)&&(e[n]=t.authHeaders[n]);e["X-Goog-Api-Client"]=X_GOOG_API_CLIENT_VALUE},e.prototype.invokeRPC=function(o,a,s){var u=this,c=this.makeUrl(o);return new Promise(function(r,i){u.pool.getObject(function(n){n.listenOnce(dist_3.COMPLETE,function(){try{switch(n.getLastErrorCode()){case dist_2.NO_ERROR:var e=n.getResponseJson();debug(LOG_TAG,"XHR received:",JSON.stringify(e)),r(e);break;case dist_2.TIMEOUT:debug(LOG_TAG,'RPC "'+o+'" timed out'),i(new FirestoreError(Code.DEADLINE_EXCEEDED,"Request time out"));break;case dist_2.HTTP_ERROR:var t=n.getStatus();debug(LOG_TAG,'RPC "'+o+'" failed with status:',t,"response text:",n.getResponseText()),0<t?i(new FirestoreError(mapCodeFromHttpStatus(t),"Server responded with status "+n.getStatusText())):(debug(LOG_TAG,'RPC "'+o+'" failed'),i(new FirestoreError(Code.UNAVAILABLE,"Connection failed.")));break;default:fail('RPC "'+o+'" failed with unanticipated webchannel error '+n.getLastErrorCode()+": "+n.getLastError()+", giving up.")}}finally{debug(LOG_TAG,'RPC "'+o+'" completed.'),u.pool.releaseObject(n)}});var e=JSON.stringify(a);debug(LOG_TAG,"XHR sending: ",c+" "+e);var t={"Content-Type":"text/plain"};u.modifyHeadersForRequest(t,s),n.send(c,"POST",e,t,XHR_TIMEOUT_SECS)})})},e.prototype.invokeStreamingRPC=function(e,t,n){return this.invokeRPC(e,t,n)},e.prototype.openStream=function(e,t){var n=[this.baseUrl,"/",RPC_STREAM_SERVICE,"/",e,"/channel"],r=dist_1(),i={backgroundChannelTest:!0,httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0};this.modifyHeadersForRequest(i.initMessageHeaders,t),isReactNative$1()||(i.httpHeadersOverwriteParam="$httpHeaders");var o=n.join("");debug(LOG_TAG,"Creating WebChannel: "+o+" "+i);var a=r.createWebChannel(o,i),s=!1,u=!1,c=new StreamBridge({sendFn:function(e){u?debug(LOG_TAG,"Not sending because WebChannel is closed:",e):(s||(debug(LOG_TAG,"Opening WebChannel transport."),a.open(),s=!0),debug(LOG_TAG,"WebChannel sending:",e),a.send(e))},closeFn:function(){return a.close()}}),l=function(e,t){a.listen(e,function(e){try{t(e)}catch(e){setTimeout(function(){throw e},0)}})};return l(dist_4.EventType.OPEN,function(){u||debug(LOG_TAG,"WebChannel transport opened.")}),l(dist_4.EventType.CLOSE,function(){u||(u=!0,debug(LOG_TAG,"WebChannel transport closed"),c.callOnClose())}),l(dist_4.EventType.ERROR,function(e){u||(u=!0,debug(LOG_TAG,"WebChannel transport errored:",e),c.callOnClose(new FirestoreError(Code.UNAVAILABLE,"The operation could not be completed")))}),l(dist_4.EventType.MESSAGE,function(e){if(!u){var t=e.data[0];assert$1(!!t,"Got a webchannel message without data.");var n=t.error||t[0]&&t[0].error;if(n){debug(LOG_TAG,"WebChannel received error:",n);var r=n.status,i=mapCodeFromRpcStatus(r),o=n.message;void 0===i&&(i=Code.INTERNAL,o="Unknown error status: "+r+" with message "+n.message),u=!0,c.callOnClose(new FirestoreError(i,o)),a.close()}else debug(LOG_TAG,"WebChannel received:",t),c.callOnMessage(t)}}),setTimeout(function(){c.callOnOpen()},0),c},e.prototype.makeUrl=function(e){var t=RPC_NAME_REST_MAPPING[e];assert$1(void 0!==t,"Unknown REST mapping for: "+e);var n=[this.baseUrl,"/",RPC_URL_VERSION];return n.push("/projects/"),n.push(this.databaseId.projectId),n.push("/databases/"),n.push(this.databaseId.database),n.push("/documents"),n.push(":"),n.push(t),n.join("")},e}(),BrowserPlatform=function(){function e(){this.emptyByteString="",this.base64Available="undefined"!=typeof atob}return e.prototype.loadConnection=function(e){return Promise.resolve(new WebChannelConnection(e))},e.prototype.newSerializer=function(e){return new JsonProtoSerializer(e,{useProto3Json:!0})},e.prototype.formatJSON=function(e){return JSON.stringify(e)},e.prototype.atob=function(e){return atob(e)},e.prototype.btoa=function(e){return btoa(e)},e}();PlatformSupport.setPlatform(new BrowserPlatform);var FieldPath$1=function(){function t(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];validateNamedArrayAtLeastNumberOfElements("FieldPath",e,"fieldNames",1);for(var n=0;n<e.length;++n)if(validateArgType("FieldPath","string",n,e[n]),0===e[n].length)throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new FieldPath(e)}return t.documentId=function(){return t._DOCUMENT_ID},t.prototype.isEqual=function(e){if(!(e instanceof t))throw invalidClassError("isEqual","FieldPath",1,e);return this._internalPath.isEqual(e._internalPath)},t._DOCUMENT_ID=new t(FieldPath.keyField().canonicalString()),t}(),RESERVED=new RegExp("[~\\*/\\[\\]]"),OnlineState,ChangeType,SyncState,Yxd,Xxd,Wxd;function fromDotSeparatedString(t){if(0<=t.search(RESERVED))throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(FieldPath$1.bind.apply(FieldPath$1,[void 0].concat(t.split("."))))}catch(e){throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}Wxd=OnlineState||(OnlineState={}),Wxd[Wxd.Unknown=0]="Unknown",Wxd[Wxd.Online=1]="Online",Wxd[Wxd.Offline=2]="Offline",Xxd=ChangeType||(ChangeType={}),Xxd[Xxd.Added=0]="Added",Xxd[Xxd.Removed=1]="Removed",Xxd[Xxd.Modified=2]="Modified",Xxd[Xxd.Metadata=3]="Metadata",Yxd=SyncState||(SyncState={}),Yxd[Yxd.Local=0]="Local",Yxd[Yxd.Synced=1]="Synced";var DocumentChangeSet=function(){function e(){this.changeMap=new SortedMap$1(DocumentKey.comparator)}return e.prototype.track=function(e){var t=e.doc.key,n=this.changeMap.get(t);n?e.type!==ChangeType.Added&&n.type===ChangeType.Metadata?this.changeMap=this.changeMap.insert(t,e):e.type===ChangeType.Metadata&&n.type!==ChangeType.Removed?this.changeMap=this.changeMap.insert(t,{type:n.type,doc:e.doc}):e.type===ChangeType.Modified&&n.type===ChangeType.Modified?this.changeMap=this.changeMap.insert(t,{type:ChangeType.Modified,doc:e.doc}):e.type===ChangeType.Modified&&n.type===ChangeType.Added?this.changeMap=this.changeMap.insert(t,{type:ChangeType.Added,doc:e.doc}):e.type===ChangeType.Removed&&n.type===ChangeType.Added?this.changeMap=this.changeMap.remove(t):e.type===ChangeType.Removed&&n.type===ChangeType.Modified?this.changeMap=this.changeMap.insert(t,{type:ChangeType.Removed,doc:n.doc}):e.type===ChangeType.Added&&n.type===ChangeType.Removed?this.changeMap=this.changeMap.insert(t,{type:ChangeType.Modified,doc:e.doc}):fail("unsupported combination of changes: "+JSON.stringify(e)+" after "+JSON.stringify(n)):this.changeMap=this.changeMap.insert(t,e)},e.prototype.getChanges=function(){var n=[];return this.changeMap.inorderTraversal(function(e,t){n.push(t)}),n},e}(),ViewSnapshot=function(){function e(e,t,n,r,i,o,a,s){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.fromCache=i,this.hasPendingWrites=o,this.syncStateChanged=a,this.excludesMetadataChanges=s}return e.prototype.isEqual=function(e){if(this.fromCache!==e.fromCache||this.hasPendingWrites!==e.hasPendingWrites||this.syncStateChanged!==e.syncStateChanged||!this.query.isEqual(e.query)||!this.docs.isEqual(e.docs)||!this.oldDocs.isEqual(e.oldDocs))return!1;var t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0},e}(),DocumentSet=function(){function o(n){this.comparator=n?function(e,t){return n(e,t)||DocumentKey.comparator(e.key,t.key)}:function(e,t){return DocumentKey.comparator(e.key,t.key)},this.keyedMap=documentMap(),this.sortedSet=new SortedMap$1(this.comparator)}return o.emptySet=function(e){return new o(e.comparator)},o.prototype.has=function(e){return null!=this.keyedMap.get(e)},o.prototype.get=function(e){return this.keyedMap.get(e)},o.prototype.first=function(){return this.sortedSet.minKey()},o.prototype.last=function(){return this.sortedSet.maxKey()},o.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},o.prototype.indexOf=function(e){var t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1},Object.defineProperty(o.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!0,configurable:!0}),o.prototype.forEach=function(n){this.sortedSet.inorderTraversal(function(e,t){return n(e),!1})},o.prototype.add=function(e){var t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))},o.prototype.delete=function(e){var t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this},o.prototype.isEqual=function(e){if(!(e instanceof o))return!1;if(this.size!==e.size)return!1;for(var t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();t.hasNext();){var r=t.getNext().key,i=n.getNext().key;if(!r.isEqual(i))return!1}return!0},o.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},o.prototype.copy=function(e,t){var n=new o;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n},o}(),ObjectMap=function(){function e(e){this.mapKeyFn=e,this.inner={}}return e.prototype.get=function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];if(a.isEqual(e))return s}},e.prototype.has=function(e){return void 0!==this.get(e)},e.prototype.set=function(e,t){var n=this.mapKeyFn(e),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(r[i][0].isEqual(e))return void(r[i]=[e,t]);r.push([e,t])}else this.inner[n]=[[e,t]]},e.prototype.delete=function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(n[r][0].isEqual(e))return 1===n.length?delete this.inner[t]:n.splice(r,1),!0;return!1},e.prototype.forEach=function(s){forEach$1(this.inner,function(e,t){for(var n=0,r=t;n<r.length;n++){var i=r[n],o=i[0],a=i[1];s(o,a)}})},e.prototype.isEmpty=function(){return isEmpty$1(this.inner)},e}(),QueryListenersInfo=function(){this.listeners=[]},EventManager=function(){function e(e){this.syncEngine=e,this.queries=new ObjectMap(function(e){return e.canonicalId()}),this.onlineState=OnlineState.Unknown,this.syncEngine.subscribe(this.onChange.bind(this),this.onError.bind(this))}return e.prototype.listen=function(e){var t=e.query,n=!1,r=this.queries.get(t);return r||(n=!0,r=new QueryListenersInfo,this.queries.set(t,r)),r.listeners.push(e),e.applyOnlineStateChange(this.onlineState),r.viewSnap&&e.onViewSnapshot(r.viewSnap),n?this.syncEngine.listen(t).then(function(e){return r.targetId=e}):Promise.resolve(r.targetId)},e.prototype.unlisten=function(o){return __awaiter(this,void 0,void 0,function(){var t,n,r,i;return __generator(this,function(e){return t=o.query,n=!1,(r=this.queries.get(t))&&0<=(i=r.listeners.indexOf(o))&&(r.listeners.splice(i,1),n=0===r.listeners.length),n?(this.queries.delete(t),[2,this.syncEngine.unlisten(t)]):[2]})})},e.prototype.onChange=function(e){for(var t=0,n=e;t<n.length;t++){var r=n[t],i=r.query,o=this.queries.get(i);if(o){for(var a=0,s=o.listeners;a<s.length;a++)s[a].onViewSnapshot(r);o.viewSnap=r}}},e.prototype.onError=function(e,t){var n=this.queries.get(e);if(n)for(var r=0,i=n.listeners;r<i.length;r++)i[r].onError(t);this.queries.delete(e)},e.prototype.applyOnlineStateChange=function(i){this.onlineState=i,this.queries.forEach(function(e,t){for(var n=0,r=t.listeners;n<r.length;n++)r[n].applyOnlineStateChange(i)})},e}(),QueryListener=function(){function t(e,t,n){this.query=e,this.queryObserver=t,this.raisedInitialEvent=!1,this.onlineState=OnlineState.Unknown,this.options=n||{}}return t.prototype.onViewSnapshot=function(e){if(assert$1(0<e.docChanges.length||e.syncStateChanged,"We got a new snapshot with no changes?"),!this.options.includeMetadataChanges){for(var t=[],n=0,r=e.docChanges;n<r.length;n++){var i=r[n];i.type!==ChangeType.Metadata&&t.push(i)}e=new ViewSnapshot(e.query,e.docs,e.oldDocs,t,e.fromCache,e.hasPendingWrites,e.syncStateChanged,!0)}this.raisedInitialEvent?this.shouldRaiseEvent(e)&&this.queryObserver.next(e):this.shouldRaiseInitialEvent(e,this.onlineState)&&this.raiseInitialEvent(e),this.snap=e},t.prototype.onError=function(e){this.queryObserver.error(e)},t.prototype.applyOnlineStateChange=function(e){this.onlineState=e,this.snap&&!this.raisedInitialEvent&&this.shouldRaiseInitialEvent(this.snap,e)&&this.raiseInitialEvent(this.snap)},t.prototype.shouldRaiseInitialEvent=function(e,t){if(assert$1(!this.raisedInitialEvent,"Determining whether to raise first event but already had first event"),!e.fromCache)return!0;var n=t!==OnlineState.Offline;return this.options.waitForSyncWhenOnline&&n?(assert$1(e.fromCache,"Waiting for sync, but snapshot is not from cache"),!1):!e.docs.isEmpty()||t===OnlineState.Offline},t.prototype.shouldRaiseEvent=function(e){if(0<e.docChanges.length)return!0;var t=this.snap&&this.snap.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges},t.prototype.raiseInitialEvent=function(e){assert$1(!this.raisedInitialEvent,"Trying to raise initial events for second time"),e=new ViewSnapshot(e.query,e.docs,DocumentSet.emptySet(e.docs),t.getInitialViewChanges(e),e.fromCache,e.hasPendingWrites,!0,!1),this.raisedInitialEvent=!0,this.queryObserver.next(e)},t.getInitialViewChanges=function(e){var t=[];return e.docs.forEach(function(e){t.push({type:ChangeType.Added,doc:e})}),t},t}(),PersistencePromise=function(){function a(e){var t=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(function(e){t.isDone=!0,t.result=e,t.nextCallback&&t.nextCallback(e)},function(e){t.isDone=!0,t.error=e,t.catchCallback&&t.catchCallback(e)})}return a.prototype.catch=function(e){return this.next(void 0,e)},a.prototype.next=function(r,i){var o=this;return this.callbackAttached&&fail("Called next() or catch() twice for PersistencePromise"),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(i,this.error):this.wrapSuccess(r,this.result):new a(function(t,n){o.nextCallback=function(e){o.wrapSuccess(r,e).next(t,n)},o.catchCallback=function(e){o.wrapFailure(i,e).next(t,n)}})},a.prototype.toPromise=function(){var n=this;return new Promise(function(e,t){n.next(e,t)})},a.prototype.wrapUserFunction=function(e){try{var t=e();return t instanceof a?t:a.resolve(t)}catch(e){return a.reject(e)}},a.prototype.wrapSuccess=function(e,t){return e?this.wrapUserFunction(function(){return e(t)}):a.resolve(t)},a.prototype.wrapFailure=function(e,t){return e?this.wrapUserFunction(function(){return e(t)}):a.reject(t)},a.resolve=function(n){return new a(function(e,t){e(n)})},a.reject=function(n){return new a(function(e,t){t(n)})},a.waitFor=function(e){return e.reduce(function(e,t,n){return e.next(function(){return t})},a.resolve())},a.map=function(e){var n=[],r=!0,t=a.resolve(null);return e.reduce(function(e,t){return e.next(function(e){return r||n.push(e),r=!1,t})},t).next(function(e){return n.push(e),n})},a}(),EagerGarbageCollector=function(){function e(){this.isEager=!0,this.sources=[],this.potentialGarbage=documentKeySet()}return e.prototype.addGarbageSource=function(e){this.sources.push(e),e.setGarbageCollector(this)},e.prototype.removeGarbageSource=function(e){this.sources.splice(this.sources.indexOf(e),1),e.setGarbageCollector(null)},e.prototype.addPotentialGarbageKey=function(e){this.potentialGarbage=this.potentialGarbage.add(e)},e.prototype.collectGarbage=function(n){var r=this,i=[],o=documentKeySet();return this.potentialGarbage.forEach(function(t){var e=r.documentHasAnyReferences(n,t);i.push(e.next(function(e){return e||(o=o.add(t)),PersistencePromise.resolve()}))}),this.potentialGarbage=documentKeySet(),PersistencePromise.waitFor(i).next(function(){return o})},e.prototype.documentHasAnyReferences=function(t,n){var e=PersistencePromise.resolve(!1);return this.sources.map(function(e){return function(){return e.containsKey(t,n)}}).reduce(function(e,t){return e.next(function(e){return e?PersistencePromise.resolve(!0):t()})},e)},e}(),LocalViewChanges=function(){function a(e,t,n){this.query=e,this.addedKeys=t,this.removedKeys=n}return a.fromSnapshot=function(e){for(var t=documentKeySet(),n=documentKeySet(),r=0,i=e.docChanges;r<i.length;r++){var o=i[r];switch(o.type){case ChangeType.Added:t=t.add(o.doc.key);break;case ChangeType.Removed:n=n.add(o.doc.key)}}return new a(e.query,t,n)},a}(),ReferenceSet=function(){function e(){this.refsByKey=new SortedSet(DocReference.compareByKey),this.refsByTarget=new SortedSet(DocReference.compareByTargetId),this.garbageCollector=null}return e.prototype.isEmpty=function(){return this.refsByKey.isEmpty()},e.prototype.addReference=function(e,t){var n=new DocReference(e,t);this.refsByKey=this.refsByKey.add(n),this.refsByTarget=this.refsByTarget.add(n)},e.prototype.addReferences=function(e,t){var n=this;e.forEach(function(e){return n.addReference(e,t)})},e.prototype.removeReference=function(e,t){this.removeRef(new DocReference(e,t))},e.prototype.removeReferences=function(e,t){var n=this;e.forEach(function(e){return n.removeReference(e,t)})},e.prototype.removeReferencesForId=function(e){var t=this,n=DocumentKey.EMPTY,r=new DocReference(n,e),i=new DocReference(n,e+1);this.refsByTarget.forEachInRange([r,i],function(e){t.removeRef(e)})},e.prototype.removeAllReferences=function(){var t=this;this.refsByKey.forEach(function(e){return t.removeRef(e)})},e.prototype.removeRef=function(e){this.refsByKey=this.refsByKey.delete(e),this.refsByTarget=this.refsByTarget.delete(e),null!==this.garbageCollector&&this.garbageCollector.addPotentialGarbageKey(e.key)},e.prototype.referencesForId=function(e){var t=DocumentKey.EMPTY,n=new DocReference(t,e),r=new DocReference(t,e+1),i=documentKeySet();return this.refsByTarget.forEachInRange([n,r],function(e){i=i.add(e.key)}),i},e.prototype.setGarbageCollector=function(e){this.garbageCollector=e},e.prototype.containsKey=function(e,t){var n=new DocReference(t,0),r=this.refsByKey.firstAfterOrEqual(n);return PersistencePromise.resolve(null!==r&&t.isEqual(r.key))},e}(),DocReference=function(){function e(e,t){this.key=e,this.targetOrBatchId=t}return e.compareByKey=function(e,t){return DocumentKey.comparator(e.key,t.key)||primitiveComparator(e.targetOrBatchId,t.targetOrBatchId)},e.compareByTargetId=function(e,t){return primitiveComparator(e.targetOrBatchId,t.targetOrBatchId)||DocumentKey.comparator(e.key,t.key)},e}(),RESERVED_BITS=1,GeneratorIds,sCd;sCd=GeneratorIds||(GeneratorIds={}),sCd[sCd.LocalStore=0]="LocalStore",sCd[sCd.SyncEngine=1]="SyncEngine";var TargetIdGenerator=function(){function t(e,t){void 0===t&&(t=0),this.generatorId=e;var n=t>>RESERVED_BITS<<RESERVED_BITS,r=t-n;this.previousId=e<=r?n|this.generatorId:(n|this.generatorId)-(1<<RESERVED_BITS)}return t.prototype.next=function(){return this.previousId+=1<<RESERVED_BITS,this.previousId},t.forLocalStore=function(e){return void 0===e&&(e=0),new t(GeneratorIds.LocalStore,e)},t.forSyncEngine=function(){return new t(GeneratorIds.SyncEngine)},t}(),AddedLimboDocument=function(e){this.key=e},RemovedLimboDocument=function(e){this.key=e},View$1=function(){function e(e,t){this.query=e,this._syncedDocuments=t,this.syncState=null,this.current=!1,this.limboDocuments=documentKeySet(),this.mutatedKeys=documentKeySet(),this.documentSet=new DocumentSet(e.docComparator.bind(e))}return Object.defineProperty(e.prototype,"syncedDocuments",{get:function(){return this._syncedDocuments},enumerable:!0,configurable:!0}),e.prototype.computeDocChanges=function(e,t){var o=this,a=t?t.changeSet:new DocumentChangeSet,s=t?t.documentSet:this.documentSet,u=t?t.mutatedKeys:this.mutatedKeys,c=s,l=!1,h=this.query.hasLimit()&&s.size===this.query.limit?s.last():null;if(e.inorderTraversal(function(e,t){var n=s.get(e),r=t instanceof Document?t:null;if(r&&(assert$1(e.isEqual(r.key),"Mismatching keys found in document changes: "+e+" != "+r.key),r=o.query.matches(r)?r:null),r?(c=c.add(r),u=r.hasLocalMutations?u.add(e):u.delete(e)):(c=c.delete(e),u=u.delete(e)),n&&r){var i=n.data.isEqual(r.data);i&&n.hasLocalMutations===r.hasLocalMutations||(i?a.track({type:ChangeType.Metadata,doc:r}):a.track({type:ChangeType.Modified,doc:r}),h&&0<o.query.docComparator(r,h)&&(l=!0))}else!n&&r?a.track({type:ChangeType.Added,doc:r}):n&&!r&&(a.track({type:ChangeType.Removed,doc:n}),h&&(l=!0))}),this.query.hasLimit())for(;c.size>this.query.limit;){var n=c.last();c=c.delete(n.key),a.track({type:ChangeType.Removed,doc:n})}return assert$1(!l||!t,"View was refilled using docs that themselves needed refilling."),{documentSet:c,changeSet:a,needsRefill:l,mutatedKeys:u}},e.prototype.applyChanges=function(e,t){var n=this;assert$1(!e.needsRefill,"Cannot apply changes that need a refill");var r=this.documentSet;this.documentSet=e.documentSet,this.mutatedKeys=e.mutatedKeys;var i=e.changeSet.getChanges();i.sort(function(e,t){return compareChangeType(e.type,t.type)||n.query.docComparator(e.doc,t.doc)}),this.applyTargetChange(t);var o=this.updateLimboDocuments(),a=0===this.limboDocuments.size&&this.current?SyncState.Synced:SyncState.Local,s=a!==this.syncState;return this.syncState=a,0!==i.length||s?{snapshot:new ViewSnapshot(this.query,e.documentSet,r,i,a===SyncState.Local,!e.mutatedKeys.isEmpty(),s,!1),limboChanges:o}:{limboChanges:o}},e.prototype.applyOnlineStateChange=function(e){return this.current&&e===OnlineState.Offline?(this.current=!1,this.applyChanges({documentSet:this.documentSet,changeSet:new DocumentChangeSet,mutatedKeys:this.mutatedKeys,needsRefill:!1})):{limboChanges:[]}},e.prototype.shouldBeInLimbo=function(e){return!this._syncedDocuments.has(e)&&!!this.documentSet.has(e)&&!this.documentSet.get(e).hasLocalMutations},e.prototype.applyTargetChange=function(e){if(e){var t=e.mapping;switch(t instanceof ResetMapping?this._syncedDocuments=t.documents:t instanceof UpdateMapping&&(this._syncedDocuments=t.applyToKeySet(this._syncedDocuments)),e.currentStatusUpdate){case CurrentStatusUpdate.MarkCurrent:this.current=!0;break;case CurrentStatusUpdate.MarkNotCurrent:this.current=!1;break;case CurrentStatusUpdate.None:break;default:fail("Unknown current status update: "+e.currentStatusUpdate)}}},e.prototype.updateLimboDocuments=function(){var t=this;if(!this.current)return[];var n=this.limboDocuments;this.limboDocuments=documentKeySet(),this.documentSet.forEach(function(e){t.shouldBeInLimbo(e.key)&&(t.limboDocuments=t.limboDocuments.add(e.key))});var r=[];return n.forEach(function(e){t.limboDocuments.has(e)||r.push(new RemovedLimboDocument(e))}),this.limboDocuments.forEach(function(e){n.has(e)||r.push(new AddedLimboDocument(e))}),r},e}();function compareChangeType(e,t){var n=function(e){switch(e){case ChangeType.Added:return 1;case ChangeType.Modified:case ChangeType.Metadata:return 2;case ChangeType.Removed:return 0;default:return fail("Unknown ChangeType: "+e)}};return n(e)-n(t)}var LOG_TAG$1="SyncEngine",QueryView=function(e,t,n,r){this.query=e,this.targetId=t,this.resumeToken=n,this.view=r},SyncEngine=function(){function e(e,t,n){this.localStore=e,this.remoteStore=t,this.currentUser=n,this.viewHandler=null,this.errorHandler=null,this.queryViewsByQuery=new ObjectMap(function(e){return e.canonicalId()}),this.queryViewsByTarget={},this.limboTargetsByKey=new SortedMap$1(DocumentKey.comparator),this.limboKeysByTarget={},this.limboDocumentRefs=new ReferenceSet,this.limboCollector=new EagerGarbageCollector,this.mutationUserCallbacks={},this.targetIdGenerator=TargetIdGenerator.forSyncEngine()}return e.prototype.subscribe=function(e,t){assert$1(null!==e&&null!==t,"View and error handlers cannot be null"),assert$1(null===this.viewHandler&&null===this.errorHandler,"SyncEngine already has a subscriber."),this.viewHandler=e,this.errorHandler=t,this.limboCollector.addGarbageSource(this.limboDocumentRefs)},e.prototype.listen=function(s){var u=this;return this.assertSubscribed("listen()"),assert$1(!this.queryViewsByQuery.has(s),"We already listen to the query: "+s),this.localStore.allocateQuery(s).then(function(a){return u.localStore.executeQuery(s).then(function(o){return u.localStore.remoteDocumentKeys(a.targetId).then(function(e){var t=new View$1(s,e),n=t.computeDocChanges(o),r=t.applyChanges(n);assert$1(0===r.limboChanges.length,"View returned limbo docs before target ack from the server."),assert$1(!!r.snapshot,"applyChanges for new view should always return a snapshot");var i=new QueryView(s,a.targetId,a.resumeToken,t);u.queryViewsByQuery.set(s,i),u.queryViewsByTarget[a.targetId]=i,u.viewHandler([r.snapshot]),u.remoteStore.listen(a)})}).then(function(){return a.targetId})})},e.prototype.unlisten=function(e){var t=this;this.assertSubscribed("unlisten()");var n=this.queryViewsByQuery.get(e);return assert$1(!!n,"Trying to unlisten on query not found:"+e),this.localStore.releaseQuery(e).then(function(){return t.remoteStore.unlisten(n.targetId),t.removeAndCleanupQuery(n).then(function(){return t.localStore.collectGarbage()})})},e.prototype.write=function(e,t){var n=this;return this.assertSubscribed("write()"),this.localStore.localWrite(e).then(function(e){return n.addMutationCallback(e.batchId,t),n.emitNewSnapsAndNotifyLocalStore(e.changes)}).then(function(){return n.remoteStore.fillWritePipeline()})},e.prototype.wrapUpdateFunctionError=function(e){return e},e.prototype.runTransaction=function(t,n){var r=this;void 0===n&&(n=5),assert$1(0<=n,"Got negative number of retries for transaction.");var i=this.remoteStore.createTransaction();return function(){try{var e=t(i);return!isNullOrUndefined(e)&&e.catch&&e.then?e.catch(function(e){return Promise.reject(r.wrapUpdateFunctionError(e))}):Promise.reject(Error("Transaction callback must return a Promise"))}catch(e){return Promise.reject(r.wrapUpdateFunctionError(e))}}().then(function(e){return i.commit().then(function(){return e}).catch(function(e){return 0===n?Promise.reject(e):r.runTransaction(t,n-1)})})},e.prototype.applyRemoteEvent=function(i){var o=this;return this.assertSubscribed("applyRemoteEvent()"),forEachNumber(i.targetChanges,function(e,t){var n=o.limboKeysByTarget[e];if(n)i.synthesizeDeleteForLimboTargetChange(t,n);else{var r=o.queryViewsByTarget[e];assert$1(!!r,"Missing QueryView for non-limbo query: "+e),t.mapping.filterUpdates(r.view.syncedDocuments)}}),this.localStore.applyRemoteEvent(i).then(function(e){return o.emitNewSnapsAndNotifyLocalStore(e,i)})},e.prototype.applyOnlineStateChange=function(r){var i=[];this.queryViewsByQuery.forEach(function(e,t){var n=t.view.applyOnlineStateChange(r);assert$1(0===n.limboChanges.length,"OnlineState should not affect limbo documents."),n.snapshot&&i.push(n.snapshot)}),this.viewHandler(i)},e.prototype.rejectListen=function(e,t){var n=this;this.assertSubscribed("rejectListens()");var r=this.limboKeysByTarget[e];if(r){this.limboTargetsByKey=this.limboTargetsByKey.remove(r),delete this.limboKeysByTarget[e];var i=new SortedMap$1(DocumentKey.comparator);i=i.insert(r,new NoDocument(r,SnapshotVersion.forDeletedDoc()));var o=documentKeySet().add(r),a=new RemoteEvent(SnapshotVersion.MIN,{},i,o);return this.applyRemoteEvent(a)}var s=this.queryViewsByTarget[e];return assert$1(!!s,"Unknown targetId: "+e),this.localStore.releaseQuery(s.query).then(function(){return n.removeAndCleanupQuery(s).then(function(){n.errorHandler(s.query,t)})})},e.prototype.applySuccessfulWrite=function(e){var t=this;return this.assertSubscribed("applySuccessfulWrite()"),this.processUserCallback(e.batch.batchId,null),this.localStore.acknowledgeBatch(e).then(function(e){return t.emitNewSnapsAndNotifyLocalStore(e)})},e.prototype.rejectFailedWrite=function(e,t){var n=this;return this.assertSubscribed("rejectFailedWrite()"),this.processUserCallback(e,t),this.localStore.rejectBatch(e).then(function(e){return n.emitNewSnapsAndNotifyLocalStore(e)})},e.prototype.addMutationCallback=function(e,t){var n=this.mutationUserCallbacks[this.currentUser.toKey()];n||(n=new SortedMap$1(primitiveComparator)),n=n.insert(e,t),this.mutationUserCallbacks[this.currentUser.toKey()]=n},e.prototype.processUserCallback=function(e,t){var n=this.mutationUserCallbacks[this.currentUser.toKey()];if(n){var r=n.get(e);r&&(assert$1(e===n.minKey(),"Mutation callbacks processed out-of-order?"),t?r.reject(t):r.resolve(),n=n.remove(e)),this.mutationUserCallbacks[this.currentUser.toKey()]=n}},e.prototype.removeAndCleanupQuery=function(e){return this.queryViewsByQuery.delete(e.query),delete this.queryViewsByTarget[e.targetId],this.limboDocumentRefs.removeReferencesForId(e.targetId),this.gcLimboDocuments()},e.prototype.updateTrackedLimbos=function(e,t){for(var n=0,r=t;n<r.length;n++){var i=r[n];i instanceof AddedLimboDocument?(this.limboDocumentRefs.addReference(i.key,e),this.trackLimboChange(i)):i instanceof RemovedLimboDocument?(debug(LOG_TAG$1,"Document no longer in limbo: "+i.key),this.limboDocumentRefs.removeReference(i.key,e)):fail("Unknown limbo change: "+JSON.stringify(i))}return this.gcLimboDocuments()},e.prototype.trackLimboChange=function(e){var t=e.key;if(!this.limboTargetsByKey.get(t)){debug(LOG_TAG$1,"New document in limbo: "+t);var n=this.targetIdGenerator.next(),r=Query$1.atPath(t.path);this.limboKeysByTarget[n]=t,this.remoteStore.listen(new QueryData(r,n,QueryPurpose.Listen)),this.limboTargetsByKey=this.limboTargetsByKey.insert(t,n)}},e.prototype.gcLimboDocuments=function(){var n=this;return this.limboCollector.collectGarbage(null).next(function(e){e.forEach(function(e){var t=n.limboTargetsByKey.get(e);null!==t&&(n.remoteStore.unlisten(t),n.limboTargetsByKey=n.limboTargetsByKey.remove(e),delete n.limboKeysByTarget[t])})}).toPromise()},e.prototype.currentLimboDocs=function(){return this.limboTargetsByKey},e.prototype.emitNewSnapsAndNotifyLocalStore=function(n,i){var o=this,a=[],s=[],t=[];return this.queryViewsByQuery.forEach(function(e,r){t.push(Promise.resolve().then(function(){var t=r.view.computeDocChanges(n);return t.needsRefill?o.localStore.executeQuery(r.query).then(function(e){return r.view.computeDocChanges(e,t)}):t}).then(function(e){var t=i&&i.targetChanges[r.targetId],n=r.view.applyChanges(e,t);return o.updateTrackedLimbos(r.targetId,n.limboChanges).then(function(){if(n.snapshot){a.push(n.snapshot);var e=LocalViewChanges.fromSnapshot(n.snapshot);s.push(e)}})}))}),Promise.all(t).then(function(){return o.viewHandler(a),o.localStore.notifyLocalViewChanges(s)}).then(function(){return o.localStore.collectGarbage()})},e.prototype.assertSubscribed=function(e){assert$1(null!==this.viewHandler&&null!==this.errorHandler,"Trying to call "+e+" before calling subscribe().")},e.prototype.handleUserChange=function(e){var t=this;return this.currentUser=e,this.localStore.handleUserChange(e).then(function(e){return t.emitNewSnapsAndNotifyLocalStore(e)}).then(function(){return t.remoteStore.handleUserChange(e)})},e}(),BATCHID_UNKNOWN=-1,MutationBatch=function(){function e(e,t,n){this.batchId=e,this.localWriteTime=t,this.mutations=n}return e.prototype.applyToRemoteDocument=function(e,t,n){t&&assert$1(t.key.isEqual(e),"applyToRemoteDocument: key "+e+" should match maybeDoc key\n        "+t.key);var r=n.mutationResults;assert$1(r.length===this.mutations.length,"Mismatch between mutations length\n      ("+this.mutations.length+") and mutation results length\n      ("+r.length+").");for(var i=0;i<this.mutations.length;i++){var o=this.mutations[i];if(o.key.isEqual(e)){var a=r[i];t=o.applyToRemoteDocument(t,a)}}return t},e.prototype.applyToLocalView=function(e,t){t&&assert$1(t.key.isEqual(e),"applyToLocalDocument: key "+e+" should match maybeDoc key\n        "+t.key);for(var n=t,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(e)&&(t=i.applyToLocalView(t,n,this.localWriteTime))}return t},e.prototype.keys=function(){for(var e=documentKeySet(),t=0,n=this.mutations;t<n.length;t++){var r=n[t];e=e.add(r.key)}return e},e.prototype.isEqual=function(e){return this.batchId===e.batchId&&arrayEquals(this.mutations,e.mutations)},e.prototype.isTombstone=function(){return 0===this.mutations.length},e.prototype.toTombstone=function(){return new e(this.batchId,this.localWriteTime,[])},e}(),MutationBatchResult=function(){function u(e,t,n,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.streamToken=r,this.docVersions=i}return u.from=function(e,t,n,r){assert$1(e.mutations.length===n.length,"Mutations sent "+e.mutations.length+" must equal results received "+n.length);for(var i=documentVersionMap(),o=e.mutations,a=0;a<o.length;a++){var s=n[a].version;null===s&&(s=t),i=i.insert(o[a].key,s)}return new u(e,t,n,r,i)},u}(),escapeChar="",encodedSeparatorChar="",encodedNul="",encodedEscape="";function encode(e){for(var t="",n=0;n<e.length;n++)0<t.length&&(t=encodeSeparator(t)),t=encodeSegment(e.get(n),t);return encodeSeparator(t)}function encodeSegment(e,t){for(var n=t,r=e.length,i=0;i<r;i++){var o=e.charAt(i);switch(o){case"\0":n+=escapeChar+encodedNul;break;case escapeChar:n+=escapeChar+encodedEscape;break;default:n+=o}}return n}function encodeSeparator(e){return e+escapeChar+encodedSeparatorChar}function decode$1(e){var t=e.length;if(assert$1(2<=t,"Invalid path "+e),2===t)return assert$1(e.charAt(0)===escapeChar&&e.charAt(1)===encodedSeparatorChar,"Non-empty path "+e+" had length 2"),ResourcePath.EMPTY_PATH;for(var n=t-2,r=[],i="",o=0;o<t;){var a=e.indexOf(escapeChar,o);switch((a<0||n<a)&&fail('Invalid encoded resource path: "'+e+'"'),e.charAt(a+1)){case encodedSeparatorChar:var s=e.substring(o,a),u=void 0;0===i.length?u=s:(u=i+=s,i=""),r.push(u);break;case encodedNul:i+=e.substring(o,a),i+="\0";break;case encodedEscape:i+=e.substring(o,a+1);break;default:fail('Invalid encoded resource path: "'+e+'"')}o=a+2}return new ResourcePath(r)}var SCHEMA_VERSION=2;function createOrUpgradeDb(e,t,n,r){assert$1(n<r&&0<=n&&r<=2,"Unexpected schema upgrade from v${fromVersion} to v{toVersion}."),n<1&&1<=r&&(createOwnerStore(e),createMutationQueue(e),createQueryCache(e),createRemoteDocumentCache(e));var i=PersistencePromise.resolve();return n<2&&2<=r&&(i=ensureTargetGlobalExists(t).next(function(e){return saveTargetCount(t,e)})),i}var DbTimestamp=function(e,t){this.seconds=e,this.nanoseconds=t},DbOwner=function(){function e(e,t){this.ownerId=e,this.leaseTimestampMs=t}return e.store="owner",e}();function createOwnerStore(e){e.createObjectStore(DbOwner.store)}var DbMutationQueue=function(){function e(e,t,n){this.userId=e,this.lastAcknowledgedBatchId=t,this.lastStreamToken=n}return e.store="mutationQueues",e.keyPath="userId",e}(),DbMutationBatch=function(){function e(e,t,n,r){this.userId=e,this.batchId=t,this.localWriteTimeMs=n,this.mutations=r}return e.store="mutations",e.keyPath=["userId","batchId"],e}();function createMutationQueue(e){e.createObjectStore(DbMutationQueue.store,{keyPath:DbMutationQueue.keyPath}),e.createObjectStore(DbMutationBatch.store,{keyPath:DbMutationBatch.keyPath}),e.createObjectStore(DbDocumentMutation.store)}var DbDocumentMutation=function(){function e(){}return e.prefixForUser=function(e){return[e]},e.prefixForPath=function(e,t){return[e,encode(t)]},e.key=function(e,t,n){return[e,encode(t),n]},e.store="documentMutations",e.PLACEHOLDER=new e,e}();function createRemoteDocumentCache(e){e.createObjectStore(DbRemoteDocument.store)}var DbNoDocument=function(e,t){this.path=e,this.readTime=t},DbRemoteDocument=function(){function e(e,t){this.noDocument=e,this.document=t}return e.store="remoteDocuments",e}(),DbTarget=function(){function e(e,t,n,r,i,o){this.targetId=e,this.canonicalId=t,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.query=o}return e.store="targets",e.keyPath="targetId",e.queryTargetsIndexName="queryTargetsIndex",e.queryTargetsKeyPath=["canonicalId","targetId"],e}(),DbTargetDocument=function(){function e(e,t){this.targetId=e,this.path=t}return e.store="targetDocuments",e.keyPath=["targetId","path"],e.documentTargetsIndex="documentTargetsIndex",e.documentTargetsKeyPath=["path","targetId"],e}(),DbTargetGlobal=function(){function e(e,t,n,r){this.highestTargetId=e,this.highestListenSequenceNumber=t,this.lastRemoteSnapshotVersion=n,this.targetCount=r}return e.key="targetGlobalKey",e.store="targetGlobal",e}();function createQueryCache(e){e.createObjectStore(DbTargetDocument.store,{keyPath:DbTargetDocument.keyPath}).createIndex(DbTargetDocument.documentTargetsIndex,DbTargetDocument.documentTargetsKeyPath,{unique:!0}),e.createObjectStore(DbTarget.store,{keyPath:DbTarget.keyPath}).createIndex(DbTarget.queryTargetsIndexName,DbTarget.queryTargetsKeyPath,{unique:!0}),e.createObjectStore(DbTargetGlobal.store)}function saveTargetCount(e,t){var n=e.store(DbTargetGlobal.store);return e.store(DbTarget.store).count().next(function(e){return t.targetCount=e,n.put(DbTargetGlobal.key,t)})}function ensureTargetGlobalExists(e){var t=e.store(DbTargetGlobal.store);return t.get(DbTargetGlobal.key).next(function(e){return null!=e?PersistencePromise.resolve(e):(e=new DbTargetGlobal(0,0,SnapshotVersion.MIN.toTimestamp(),0),t.put(DbTargetGlobal.key,e).next(function(){return e}))})}var ALL_STORES=[DbMutationQueue.store,DbMutationBatch.store,DbDocumentMutation.store,DbRemoteDocument.store,DbTarget.store,DbOwner.store,DbTargetGlobal.store,DbTargetDocument.store],LOG_TAG$2="SimpleDb",SimpleDb=function(){function a(e){this.db=e}return a.openOrCreate=function(i,e,o){return assert$1(a.isAvailable(),"IndexedDB not supported in current environment."),debug(LOG_TAG$2,"Opening database:",i),new PersistencePromise(function(n,t){var r=window.indexedDB.open(i,e);r.onsuccess=function(e){var t=e.target.result;n(new a(t))},r.onerror=function(e){t(e.target.error)},r.onupgradeneeded=function(e){debug(LOG_TAG$2,'Database "'+i+'" requires upgrade from version:',e.oldVersion);var t=e.target.result,n=new SimpleDbTransaction(r.transaction);o(t,n,e.oldVersion,SCHEMA_VERSION).next(function(){debug(LOG_TAG$2,"Database upgrade to version "+SCHEMA_VERSION+" complete")})}}).toPromise()},a.delete=function(e){return debug(LOG_TAG$2,"Removing database:",e),wrapRequest(window.indexedDB.deleteDatabase(e)).toPromise()},a.isAvailable=function(){if("undefined"==typeof window||null==window.indexedDB)return!1;if(void 0===window.navigator)return"YES"===process.env.USE_MOCK_PERSISTENCE;var e=window.navigator.userAgent;return!(0<e.indexOf("MSIE ")||0<e.indexOf("Trident/")||0<e.indexOf("Edge/"))},a.prototype.runTransaction=function(e,t,n){var r=SimpleDbTransaction.open(this.db,e,t),i=n(r).catch(function(e){return r.abort(),PersistencePromise.reject(e)}).toPromise();return r.completionPromise.then(function(){return i})},a.prototype.close=function(){this.db.close()},a}(),IterationController=function(){function e(e){this.dbCursor=e,this.shouldStop=!1,this.nextKey=null}return Object.defineProperty(e.prototype,"isDone",{get:function(){return this.shouldStop},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"skipToKey",{get:function(){return this.nextKey},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cursor",{set:function(e){this.dbCursor=e},enumerable:!0,configurable:!0}),e.prototype.done=function(){this.shouldStop=!0},e.prototype.skip=function(e){this.nextKey=e},e.prototype.delete=function(){return wrapRequest(this.dbCursor.delete())},e}(),SimpleDbTransaction=function(){function r(e){var r=this;this.transaction=e,this.aborted=!1,this.completionPromise=new Promise(function(t,n){r.transaction.onabort=r.transaction.oncomplete=function(e){t()},r.transaction.onerror=function(e){n(e.target.error)}})}return r.open=function(e,t,n){return new r(e.transaction(n,t))},r.prototype.abort=function(){this.aborted||(debug(LOG_TAG$2,"Aborting transaction."),this.aborted=!0,this.transaction.abort())},r.prototype.store=function(e){var t=this.transaction.objectStore(e);return assert$1(!!t,"Object store not part of transaction: "+e),new SimpleDbStore(t)},r}(),SimpleDbStore=function(){function e(e){this.store=e}return e.prototype.put=function(e,t){var n;return void 0!==t?(debug(LOG_TAG$2,"PUT",this.store.name,e,t),n=this.store.put(t,e)):(debug(LOG_TAG$2,"PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),wrapRequest(n)},e.prototype.get=function(t){var n=this;return wrapRequest(this.store.get(t)).next(function(e){return void 0===e&&(e=null),debug(LOG_TAG$2,"GET",n.store.name,t,e),e})},e.prototype.delete=function(e){return debug(LOG_TAG$2,"DELETE",this.store.name,e),wrapRequest(this.store.delete(e))},e.prototype.count=function(){return debug(LOG_TAG$2,"COUNT",this.store.name),wrapRequest(this.store.count())},e.prototype.loadAll=function(e,t){var n=this.cursor(this.options(e,t)),r=[];return this.iterateCursor(n,function(e,t){r.push(t)}).next(function(){return r})},e.prototype.deleteAll=function(e,t){debug(LOG_TAG$2,"DELETE ALL",this.store.name);var n=this.options(e,t);n.keysOnly=!1;var r=this.cursor(n);return this.iterateCursor(r,function(e,t,n){return n.delete()})},e.prototype.iterate=function(e,t){var n;t?n=e:(n={},t=e);var r=this.cursor(n);return this.iterateCursor(r,t)},e.prototype.iterateCursor=function(e,o){var a=[];return new PersistencePromise(function(i,t){e.onerror=function(e){t(e.target.error)},e.onsuccess=function(e){var t=e.target.result;if(t){var n=new IterationController(t),r=o(t.primaryKey,t.value,n);r instanceof PersistencePromise&&a.push(r),n.isDone?i():null===n.skipToKey?t.continue():t.continue(n.skipToKey)}else i()}}).next(function(){return PersistencePromise.waitFor(a)})},e.prototype.options=function(e,t){var n=void 0;return void 0!==e&&("string"==typeof e?n=e:(assert$1(void 0===t,"3rd argument must not be defined if 2nd is a range."),t=e)),{index:n,range:t}},e.prototype.cursor=function(e){var t="next";if(e.reverse&&(t="prev"),e.index){var n=this.store.index(e.index);return e.keysOnly?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)},e}();function wrapRequest(e){return new PersistencePromise(function(n,t){e.onsuccess=function(e){var t=e.target.result;n(t)},e.onerror=function(e){t(e.target.error)}})}var IndexedDbMutationQueue=function(){function r(e,t){this.userId=e,this.serializer=t,this.garbageCollector=null}return r.forUser=function(e,t){return assert$1(""!==e.uid,"UserID must not be an empty string."),new r(e.isAuthenticated()?e.uid:"",t)},r.prototype.start=function(t){var n=this;return r.loadNextBatchIdFromDb(t).next(function(e){return n.nextBatchId=e,mutationQueuesStore(t).get(n.userId)}).next(function(e){return e||(e=new DbMutationQueue(n.userId,BATCHID_UNKNOWN,"")),n.metadata=e,n.metadata.lastAcknowledgedBatchId>=n.nextBatchId?n.checkEmpty(t).next(function(e){return assert$1(e,"Reset nextBatchID is only possible when the queue is empty"),n.metadata.lastAcknowledgedBatchId=BATCHID_UNKNOWN,mutationQueuesStore(t).put(n.metadata)}):PersistencePromise.resolve()})},r.loadNextBatchIdFromDb=function(e){var o=BATCHID_UNKNOWN;return mutationsStore(e).iterate({reverse:!0},function(e,t,n){var r=e[0];if(e[1]>o&&(o=t.batchId),""===r)n.done();else{var i=immediatePredecessor(r);n.skip([i])}}).next(function(){return o+1})},r.prototype.checkEmpty=function(e){var r=!0,t=IDBKeyRange.bound(this.keyForBatchId(Number.NEGATIVE_INFINITY),this.keyForBatchId(Number.POSITIVE_INFINITY));return mutationsStore(e).iterate({range:t},function(e,t,n){r=!1,n.done()}).next(function(){return r})},r.prototype.getNextBatchId=function(e){return PersistencePromise.resolve(this.nextBatchId)},r.prototype.getHighestAcknowledgedBatchId=function(e){return PersistencePromise.resolve(this.metadata.lastAcknowledgedBatchId)},r.prototype.acknowledgeBatch=function(e,t,n){var r=t.batchId;return assert$1(r>this.metadata.lastAcknowledgedBatchId,"Mutation batchIDs must be acknowledged in order"),this.metadata.lastAcknowledgedBatchId=r,this.metadata.lastStreamToken=convertStreamToken(n),mutationQueuesStore(e).put(this.metadata)},r.prototype.getLastStreamToken=function(e){return PersistencePromise.resolve(this.metadata.lastStreamToken)},r.prototype.setLastStreamToken=function(e,t){return this.metadata.lastStreamToken=convertStreamToken(t),mutationQueuesStore(e).put(this.metadata)},r.prototype.addMutationBatch=function(o,e,a){var s=this,u=this.nextBatchId;this.nextBatchId++;var t=new MutationBatch(u,e,a),n=this.serializer.toDbMutationBatch(this.userId,t);return mutationsStore(o).put(n).next(function(){for(var e=[],t=0,n=a;t<n.length;t++){var r=n[t],i=DbDocumentMutation.key(s.userId,r.key.path,u);e.push(documentMutationsStore(o).put(i,DbDocumentMutation.PLACEHOLDER))}return PersistencePromise.waitFor(e)}).next(function(){return t})},r.prototype.lookupMutationBatch=function(e,t){var n=this;return mutationsStore(e).get(this.keyForBatchId(t)).next(function(e){return e?n.serializer.fromDbMutationBatch(e):null})},r.prototype.getNextMutationBatchAfterBatchId=function(e,t){var r=this,i=Math.max(t,this.metadata.lastAcknowledgedBatchId)+1,n=IDBKeyRange.lowerBound(this.keyForBatchId(i)),o=null;return mutationsStore(e).iterate({range:n},function(e,t,n){t.userId===r.userId&&(assert$1(t.batchId>=i,"Should have found mutation after "+i),o=r.serializer.fromDbMutationBatch(t)),n.done()}).next(function(){return o})},r.prototype.getAllMutationBatches=function(e){var t=this,n=IDBKeyRange.bound(this.keyForBatchId(BATCHID_UNKNOWN),this.keyForBatchId(Number.POSITIVE_INFINITY));return mutationsStore(e).loadAll(n).next(function(e){return e.map(function(e){return t.serializer.fromDbMutationBatch(e)})})},r.prototype.getAllMutationBatchesThroughBatchId=function(e,t){var n=this,r=IDBKeyRange.bound(this.keyForBatchId(BATCHID_UNKNOWN),this.keyForBatchId(t));return mutationsStore(e).loadAll(r).next(function(e){return e.map(function(e){return n.serializer.fromDbMutationBatch(e)})})},r.prototype.getAllMutationBatchesAffectingDocumentKey=function(u,c){var l=this,e=DbDocumentMutation.prefixForPath(this.userId,c.path),t=IDBKeyRange.lowerBound(e),h=[];return documentMutationsStore(u).iterate({range:t},function(t,e,n){var r=t[0],i=t[1],o=t[2],a=decode$1(i);if(r===l.userId&&c.path.isEqual(a)){var s=l.keyForBatchId(o);return mutationsStore(u).get(s).next(function(e){null===e&&fail("Dangling document-mutation reference found: "+t+" which points to "+s),h.push(l.serializer.fromDbMutationBatch(e))})}n.done()}).next(function(){return h})},r.prototype.getAllMutationBatchesAffectingQuery=function(i,e){var s=this;assert$1(!e.isDocumentQuery(),"Document queries shouldn't go down this path");var u=e.path,c=u.length+1,t=DbDocumentMutation.prefixForPath(this.userId,u),n=IDBKeyRange.lowerBound(t),l=new SortedSet(primitiveComparator);return documentMutationsStore(i).iterate({range:n},function(e,t,n){var r=e[0],i=e[1],o=e[2],a=decode$1(i);r===s.userId&&u.isPrefixOf(a)?a.length===c&&(l=l.add(o)):n.done()}).next(function(){var n=[],r=[];return l.forEach(function(e){var t=s.keyForBatchId(e);r.push(mutationsStore(i).get(t).next(function(e){null===e&&fail("Dangling document-mutation reference found, which points to "+t),n.push(s.serializer.fromDbMutationBatch(e))}))}),PersistencePromise.waitFor(r).next(function(){return n})})},r.prototype.removeMutationBatches=function(e,t){for(var u=mutationsStore(e),c=documentMutationsStore(e),l=[],n=function(e){var t=IDBKeyRange.only(h.keyForBatchId(e.batchId)),r=0,n=u.iterate({range:t},function(e,t,n){return r++,n.delete()});l.push(n.next(function(){assert$1(1===r,"Dangling document-mutation reference found: Missing batch "+e.batchId)}));for(var i=0,o=e.mutations;i<o.length;i++){var a=o[i],s=DbDocumentMutation.key(h.userId,a.key.path,e.batchId);l.push(c.delete(s)),null!==h.garbageCollector&&h.garbageCollector.addPotentialGarbageKey(a.key)}},h=this,r=0,i=t;r<i.length;r++)n(i[r]);return PersistencePromise.waitFor(l)},r.prototype.performConsistencyCheck=function(n){var o=this;return this.checkEmpty(n).next(function(e){if(!e)return PersistencePromise.resolve();var t=IDBKeyRange.lowerBound(DbDocumentMutation.prefixForUser(o.userId)),i=[];return documentMutationsStore(n).iterate({range:t},function(e,t,n){if(e[0]===o.userId){var r=decode$1(e[1]);i.push(r)}else n.done()}).next(function(){assert$1(0===i.length,"Document leak -- detected dangling mutation references when queue is empty. Dangling keys: "+i.map(function(e){return e.canonicalString()}))})})},r.prototype.setGarbageCollector=function(e){this.garbageCollector=e},r.prototype.containsKey=function(e,t){var o=this,n=DbDocumentMutation.prefixForPath(this.userId,t.path),a=n[1],r=IDBKeyRange.lowerBound(n),s=!1;return documentMutationsStore(e).iterate({range:r,keysOnly:!0},function(e,t,n){var r=e[0],i=e[1];e[2],r===o.userId&&i===a&&(s=!0),n.done()}).next(function(){return s})},r.prototype.keyForBatchId=function(e){return[this.userId,e]},r}();function convertStreamToken(e){return e instanceof Uint8Array?(assert$1("YES"===process.env.USE_MOCK_PERSISTENCE,"Persisting non-string stream tokens is only supported with mock persistence ."),e.toString()):e}function mutationsStore(e){return getStore(e,DbMutationBatch.store)}function documentMutationsStore(e){return getStore(e,DbDocumentMutation.store)}function mutationQueuesStore(e){return getStore(e,DbMutationQueue.store)}function getStore(e,t){return e instanceof SimpleDbTransaction?e.store(t):fail("Invalid transaction object provided!")}var IndexedDbQueryCache=function(){function e(e){this.serializer=e,this.lastRemoteSnapshotVersion=SnapshotVersion.MIN,this.metadata=null,this.garbageCollector=null}return e.prototype.start=function(e){var n=this;return globalTargetStore(e).get(DbTargetGlobal.key).next(function(e){assert$1(null!==e,"Missing metadata row that should be added by schema migration.");var t=(n.metadata=e).lastRemoteSnapshotVersion;return n.lastRemoteSnapshotVersion=SnapshotVersion.fromTimestamp(new Timestamp(t.seconds,t.nanoseconds)),PersistencePromise.resolve()})},e.prototype.getHighestTargetId=function(){return this.metadata.highestTargetId},e.prototype.getLastRemoteSnapshotVersion=function(){return this.lastRemoteSnapshotVersion},e.prototype.setLastRemoteSnapshotVersion=function(e,t){return this.lastRemoteSnapshotVersion=t,this.metadata.lastRemoteSnapshotVersion=t.toTimestamp(),globalTargetStore(e).put(DbTargetGlobal.key,this.metadata)},e.prototype.addQueryData=function(e,t){var n=this;return this.saveQueryData(e,t).next(function(){return n.metadata.targetCount+=1,n.updateMetadataFromQueryData(t),n.saveMetadata(e)})},e.prototype.updateQueryData=function(e,t){var n=this;return this.saveQueryData(e,t).next(function(){return n.updateMetadataFromQueryData(t)?n.saveMetadata(e):PersistencePromise.resolve()})},e.prototype.removeQueryData=function(e,t){var n=this;return assert$1(0<this.metadata.targetCount,"Removing from an empty query cache"),this.removeMatchingKeysForTargetId(e,t.targetId).next(function(){return targetsStore(e).delete(t.targetId)}).next(function(){return n.metadata.targetCount-=1,n.saveMetadata(e)})},e.prototype.saveMetadata=function(e){return globalTargetStore(e).put(DbTargetGlobal.key,this.metadata)},e.prototype.saveQueryData=function(e,t){return targetsStore(e).put(this.serializer.toDbTarget(t))},e.prototype.updateMetadataFromQueryData=function(e){var t=!1;return e.targetId>this.metadata.highestTargetId&&(this.metadata.highestTargetId=e.targetId,t=!0),t},Object.defineProperty(e.prototype,"count",{get:function(){return this.metadata.targetCount},enumerable:!0,configurable:!0}),e.prototype.getQueryData=function(e,i){var o=this,t=i.canonicalId(),n=IDBKeyRange.bound([t,Number.NEGATIVE_INFINITY],[t,Number.POSITIVE_INFINITY]),a=null;return targetsStore(e).iterate({range:n,index:DbTarget.queryTargetsIndexName},function(e,t,n){var r=o.serializer.fromDbTarget(t);i.isEqual(r.query)&&(a=r,n.done())}).next(function(){return a})},e.prototype.addMatchingKeys=function(e,t,n){var r=[],i=documentTargetStore(e);return t.forEach(function(e){var t=encode(e.path);r.push(i.put(new DbTargetDocument(n,t)))}),PersistencePromise.waitFor(r)},e.prototype.removeMatchingKeys=function(e,t,n){var r=this,i=[],o=documentTargetStore(e);return t.forEach(function(e){var t=encode(e.path);i.push(o.delete([n,t])),null!==r.garbageCollector&&r.garbageCollector.addPotentialGarbageKey(e)}),PersistencePromise.waitFor(i)},e.prototype.removeMatchingKeysForTargetId=function(e,t){var n=documentTargetStore(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return this.notifyGCForRemovedKeys(e,r).next(function(){return n.delete(r)})},e.prototype.notifyGCForRemovedKeys=function(e,t){var o=this,n=documentTargetStore(e);return null!==this.garbageCollector&&this.garbageCollector.isEager?n.iterate({range:t,keysOnly:!0},function(e,t,n){var r=decode$1(e[1]),i=new DocumentKey(r);assert$1(null!==o.garbageCollector,"GarbageCollector for query cache set to null during key removal."),o.garbageCollector.addPotentialGarbageKey(i)}):PersistencePromise.resolve()},e.prototype.getMatchingKeysForTargetId=function(e,t){var n=IDBKeyRange.bound([t],[t+1],!1,!0),r=documentTargetStore(e),o=documentKeySet();return r.iterate({range:n,keysOnly:!0},function(e,t,n){var r=decode$1(e[1]),i=new DocumentKey(r);o=o.add(i)}).next(function(){return o})},e.prototype.setGarbageCollector=function(e){this.garbageCollector=e},e.prototype.containsKey=function(e,t){assert$1(null!==e,"Persistence Transaction cannot be null for query cache containsKey");var n=encode(t.path),r=IDBKeyRange.bound([n],[immediateSuccessor(n)],!1,!0),i=0;return documentTargetStore(e).iterate({index:DbTargetDocument.documentTargetsIndex,keysOnly:!0,range:r},function(e,t,n){i++,n.done()}).next(function(){return 0<i})},e}();function targetsStore(e){return getStore$1(e,DbTarget.store)}function globalTargetStore(e){return getStore$1(e,DbTargetGlobal.store)}function documentTargetStore(e){return getStore$1(e,DbTargetDocument.store)}function getStore$1(e,t){return e instanceof SimpleDbTransaction?e.store(t):fail("Invalid transaction object provided!")}var IndexedDbRemoteDocumentCache=function(){function e(e){this.serializer=e}return e.prototype.addEntry=function(e,t){return remoteDocumentsStore(e).put(dbKey(t.key),this.serializer.toDbRemoteDocument(t))},e.prototype.removeEntry=function(e,t){return remoteDocumentsStore(e).delete(dbKey(t))},e.prototype.getEntry=function(e,t){var n=this;return remoteDocumentsStore(e).get(dbKey(t)).next(function(e){return e?n.serializer.fromDbRemoteDocument(e):null})},e.prototype.getDocumentsMatchingQuery=function(e,i){var o=this,a=documentMap(),t=i.path.toArray(),n=IDBKeyRange.lowerBound(t);return remoteDocumentsStore(e).iterate({range:n},function(e,t,n){var r=o.serializer.fromDbRemoteDocument(t);i.path.isPrefixOf(r.key.path)?r instanceof Document&&i.matches(r)&&(a=a.insert(r.key,r)):n.done()}).next(function(){return a})},e}();function remoteDocumentsStore(e){return e instanceof SimpleDbTransaction?e.store(DbRemoteDocument.store):fail("Invalid transaction object provided!")}function dbKey(e){return e.path.toArray()}var LocalSerializer=function(){function e(e){this.remoteSerializer=e}return e.prototype.fromDbRemoteDocument=function(e){if(e.document)return this.remoteSerializer.fromDocument(e.document);if(e.noDocument){var t=DocumentKey.fromSegments(e.noDocument.path),n=e.noDocument.readTime,r=new Timestamp(n.seconds,n.nanoseconds);return new NoDocument(t,SnapshotVersion.fromTimestamp(r))}return fail("Unexpected DbRemoteDocument")},e.prototype.toDbRemoteDocument=function(e){if(e instanceof Document){var t=this.remoteSerializer.toDocument(e);return new DbRemoteDocument(null,t)}var n=e.key.path.toArray(),r=e.version.toTimestamp(),i=new DbTimestamp(r.seconds,r.nanoseconds);return new DbRemoteDocument(new DbNoDocument(n,i),null)},e.prototype.toDbMutationBatch=function(e,t){var n=this,r=t.mutations.map(function(e){return n.remoteSerializer.toMutation(e)});return new DbMutationBatch(e,t.batchId,t.localWriteTime.toMillis(),r)},e.prototype.fromDbMutationBatch=function(e){var t=this,n=e.mutations.map(function(e){return t.remoteSerializer.fromMutation(e)}),r=Timestamp.fromMillis(e.localWriteTimeMs);return new MutationBatch(e.batchId,r,n)},e.prototype.fromDbTarget=function(e){var t,n=new Timestamp(e.readTime.seconds,e.readTime.nanoseconds),r=SnapshotVersion.fromTimestamp(n);return t=isDocumentQuery(e.query)?this.remoteSerializer.fromDocumentsTarget(e.query):this.remoteSerializer.fromQueryTarget(e.query),new QueryData(t,e.targetId,QueryPurpose.Listen,r,e.resumeToken)},e.prototype.toDbTarget=function(e){assert$1(QueryPurpose.Listen===e.purpose,"Only queries with purpose "+QueryPurpose.Listen+" may be stored, got "+e.purpose);var t,n,r=e.snapshotVersion.toTimestamp(),i=new DbTimestamp(r.seconds,r.nanoseconds);return t=e.query.isDocumentQuery()?this.remoteSerializer.toDocumentsTarget(e.query):this.remoteSerializer.toQueryTarget(e.query),e.resumeToken instanceof Uint8Array?(assert$1("YES"===process.env.USE_MOCK_PERSISTENCE,"Persisting non-string stream tokens is only supported with mock persistence ."),n=e.resumeToken.toString()):n=e.resumeToken,new DbTarget(e.targetId,e.query.canonicalId(),i,n,0,t)},e}();function isDocumentQuery(e){return void 0!==e.documents}var LOG_TAG$3="IndexedDbPersistence",OWNER_LEASE_MAX_AGE_MS=5e3,OWNER_LEASE_REFRESH_INTERVAL_MS=4e3,ZOMBIE_OWNER_LOCALSTORAGE_SUFFIX="zombiedOwnerId",EXISTING_OWNER_ERROR_MSG="There is another tab open with offline persistence enabled. Only one such tab is allowed at a time. The other tab must be closed or persistence must be disabled.",UNSUPPORTED_PLATFORM_ERROR_MSG="This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.",IndexedDbPersistence=function(){function n(e,t){this.ownerId=this.generateOwnerId(),this.dbName=e+n.MAIN_DATABASE,this.serializer=new LocalSerializer(t),this.localStoragePrefix=e}return n.prototype.start=function(){var t=this;return n.isAvailable()?(assert$1(!this.started,"IndexedDbPersistence double-started!"),this.started=!0,SimpleDb.openOrCreate(this.dbName,SCHEMA_VERSION,createOrUpgradeDb).then(function(e){t.simpleDb=e}).then(function(){return t.tryAcquireOwnerLease()}).then(function(){t.scheduleOwnerLeaseRefreshes(),t.attachWindowUnloadHook()})):(this.persistenceError=new FirestoreError(Code.UNIMPLEMENTED,UNSUPPORTED_PLATFORM_ERROR_MSG),Promise.reject(this.persistenceError))},n.prototype.shutdown=function(e){var t=this;return assert$1(this.started,"IndexedDbPersistence shutdown without start!"),this.started=!1,this.detachWindowUnloadHook(),this.stopOwnerLeaseRefreshes(),this.releaseOwnerLease().then(function(){if(t.simpleDb.close(),e)return SimpleDb.delete(t.dbName)})},n.prototype.getMutationQueue=function(e){return IndexedDbMutationQueue.forUser(e,this.serializer)},n.prototype.getQueryCache=function(){return new IndexedDbQueryCache(this.serializer)},n.prototype.getRemoteDocumentCache=function(){return new IndexedDbRemoteDocumentCache(this.serializer)},n.prototype.runTransaction=function(e,t){var n=this;return this.persistenceError?Promise.reject(this.persistenceError):(debug(LOG_TAG$3,"Starting transaction:",e),this.simpleDb.runTransaction("readwrite",ALL_STORES,function(e){return n.ensureOwnerLease(e).next(function(){return t(e)})}))},n.isAvailable=function(){return SimpleDb.isAvailable()},n.buildStoragePrefix=function(e){var t=e.databaseId.projectId;return e.databaseId.isDefaultDatabase||(t+="."+e.databaseId.database),"firestore/"+e.persistenceKey+"/"+t+"/"},n.prototype.tryAcquireOwnerLease=function(){var r=this;return this.simpleDb.runTransaction("readwrite",[DbOwner.store],function(e){var n=e.store(DbOwner.store);return n.get("owner").next(function(e){if(r.validOwner(e))return debug(LOG_TAG$3,"Valid owner already. Failing. Current owner:",e),r.persistenceError=new FirestoreError(Code.FAILED_PRECONDITION,EXISTING_OWNER_ERROR_MSG),PersistencePromise.reject(r.persistenceError);var t=new DbOwner(r.ownerId,Date.now());return debug(LOG_TAG$3,"No valid owner. Acquiring owner lease. Current owner:",e,"New owner:",t),n.put("owner",t)})})},n.prototype.releaseOwnerLease=function(){var n=this;return this.simpleDb.runTransaction("readwrite",[DbOwner.store],function(e){var t=e.store(DbOwner.store);return t.get("owner").next(function(e){return null!==e&&e.ownerId===n.ownerId?(debug(LOG_TAG$3,"Releasing owner lease."),t.delete("owner")):PersistencePromise.resolve()})})},n.prototype.ensureOwnerLease=function(e){var t=this;return e.store(DbOwner.store).get("owner").next(function(e){return null===e||e.ownerId!==t.ownerId?(t.persistenceError=new FirestoreError(Code.FAILED_PRECONDITION,EXISTING_OWNER_ERROR_MSG),PersistencePromise.reject(t.persistenceError)):PersistencePromise.resolve()})},n.prototype.validOwner=function(e){var t=Date.now(),n=t-OWNER_LEASE_MAX_AGE_MS,r=t;return!(null===e||e.leaseTimestampMs<n||(e.leaseTimestampMs>r?(error$2("Persistence owner-lease is in the future. Discarding.",e),1):e.ownerId===this.getZombiedOwnerId()))},n.prototype.scheduleOwnerLeaseRefreshes=function(){var t=this;this.ownerLeaseRefreshHandle=setInterval(function(){t.runTransaction("Refresh owner timestamp",function(e){return e.store(DbOwner.store).put("owner",new DbOwner(t.ownerId,Date.now()))}).catch(function(e){error$2(e),t.stopOwnerLeaseRefreshes()})},OWNER_LEASE_REFRESH_INTERVAL_MS)},n.prototype.stopOwnerLeaseRefreshes=function(){this.ownerLeaseRefreshHandle&&(clearInterval(this.ownerLeaseRefreshHandle),this.ownerLeaseRefreshHandle=null)},n.prototype.attachWindowUnloadHook=function(){var e=this;"object"==typeof window&&"function"==typeof window.addEventListener&&(this.windowUnloadHandler=function(){e.setZombiedOwnerId(e.ownerId),e.shutdown()},window.addEventListener("unload",this.windowUnloadHandler))},n.prototype.detachWindowUnloadHook=function(){this.windowUnloadHandler&&(assert$1("object"==typeof window&&"function"==typeof window.removeEventListener,"Expected 'window.removeEventListener' to be a function"),window.removeEventListener("unload",this.windowUnloadHandler),this.windowUnloadHandler=null)},n.prototype.getZombiedOwnerId=function(){try{var e=window.localStorage.getItem(this.zombiedOwnerLocalStorageKey());return debug(LOG_TAG$3,"Zombied ownerID from LocalStorage:",e),e}catch(e){return error$2("Failed to get zombie owner id.",e),null}},n.prototype.setZombiedOwnerId=function(e){try{null===e?window.localStorage.removeItem(this.zombiedOwnerLocalStorageKey()):window.localStorage.setItem(this.zombiedOwnerLocalStorageKey(),e)}catch(e){error$2("Failed to set zombie owner id.",e)}},n.prototype.zombiedOwnerLocalStorageKey=function(){return this.localStoragePrefix+ZOMBIE_OWNER_LOCALSTORAGE_SUFFIX},n.prototype.generateOwnerId=function(){return AutoId.newId()},n.MAIN_DATABASE="main",n}(),LocalDocumentsView=function(){function e(e,t){this.remoteDocumentCache=e,this.mutationQueue=t}return e.prototype.getDocument=function(t,n){var r=this;return this.remoteDocumentCache.getEntry(t,n).next(function(e){return r.computeLocalDocument(t,n,e)})},e.prototype.getDocuments=function(e,t){var n=this,r=[],i=maybeDocumentMap();return t.forEach(function(t){r.push(n.getDocument(e,t).next(function(e){e||(e=new NoDocument(t,SnapshotVersion.forDeletedDoc())),i=i.insert(t,e)}))}),PersistencePromise.waitFor(r).next(function(){return i})},e.prototype.getDocumentsMatchingQuery=function(e,t){return DocumentKey.isDocumentKey(t.path)?this.getDocumentsMatchingDocumentQuery(e,t.path):this.getDocumentsMatchingCollectionQuery(e,t)},e.prototype.getDocumentsMatchingDocumentQuery=function(e,t){return this.getDocument(e,new DocumentKey(t)).next(function(e){var t=documentMap();return e instanceof Document&&(t=t.insert(e.key,e)),t})},e.prototype.getDocumentsMatchingCollectionQuery=function(u,n){var c,l=this;return this.remoteDocumentCache.getDocumentsMatchingQuery(u,n).next(function(e){return l.computeLocalDocuments(u,e)}).next(function(e){return c=e,l.mutationQueue.getAllMutationBatchesAffectingQuery(u,n)}).next(function(e){for(var t=documentKeySet(),n=0,r=e;n<r.length;n++)for(var i=0,o=r[n].mutations;i<o.length;i++){var a=o[i];c.get(a.key)||(t=t.add(a.key))}var s=[];return t.forEach(function(e){s.push(l.getDocument(u,e).next(function(e){e instanceof Document&&(c=c.insert(e.key,e))}))}),PersistencePromise.waitFor(s)}).next(function(){return c.forEach(function(e,t){n.matches(t)||(c=c.remove(e))}),c})},e.prototype.computeLocalDocument=function(e,i,o){return this.mutationQueue.getAllMutationBatchesAffectingDocumentKey(e,i).next(function(e){for(var t=0,n=e;t<n.length;t++){var r=n[t];o=r.applyToLocalView(i,o)}return o})},e.prototype.computeLocalDocuments=function(n,r){var i=this,o=[];return r.forEach(function(e,t){o.push(i.computeLocalDocument(n,e,t).next(function(e){e instanceof Document?r=r.insert(e.key,e):e instanceof NoDocument?r=r.remove(e.key):fail("Unknown MaybeDocument: "+e)}))}),PersistencePromise.waitFor(o).next(function(){return r})},e}(),RemoteDocumentChangeBuffer=function(){function e(e){this.remoteDocumentCache=e,this.changes=maybeDocumentMap()}return e.prototype.addEntry=function(e){var t=this.assertChanges();this.changes=t.insert(e.key,e)},e.prototype.getEntry=function(e,t){var n=this.assertChanges().get(t);return n?PersistencePromise.resolve(n):this.remoteDocumentCache.getEntry(e,t)},e.prototype.apply=function(n){var r=this,i=[];return this.assertChanges().forEach(function(e,t){i.push(r.remoteDocumentCache.addEntry(n,t))}),this.changes=null,PersistencePromise.waitFor(i)},e.prototype.assertChanges=function(){return assert$1(null!==this.changes,"Changes have already been applied."),this.changes},e}(),LOG_TAG$4="LocalStore",LocalStore=function(){function e(e,t,n){this.persistence=e,this.garbageCollector=n,this.localViewReferences=new ReferenceSet,this.targetIds={},this.targetIdGenerator=TargetIdGenerator.forLocalStore(),this.heldBatchResults=[],this.mutationQueue=e.getMutationQueue(t),this.remoteDocuments=e.getRemoteDocumentCache(),this.queryCache=e.getQueryCache(),this.localDocuments=new LocalDocumentsView(this.remoteDocuments,this.mutationQueue),this.garbageCollector.addGarbageSource(this.localViewReferences),this.garbageCollector.addGarbageSource(this.queryCache),this.garbageCollector.addGarbageSource(this.mutationQueue)}return e.prototype.start=function(){var t=this;return this.persistence.runTransaction("Start LocalStore",function(e){return t.startMutationQueue(e).next(function(){return t.startQueryCache(e)})})},e.prototype.handleUserChange=function(t){var h=this;return this.persistence.runTransaction("Handle user change",function(c){var l;return h.mutationQueue.getAllMutationBatches(c).next(function(e){return l=e,h.garbageCollector.removeGarbageSource(h.mutationQueue),h.mutationQueue=h.persistence.getMutationQueue(t),h.garbageCollector.addGarbageSource(h.mutationQueue),h.startMutationQueue(c)}).next(function(){return h.localDocuments=new LocalDocumentsView(h.remoteDocuments,h.mutationQueue),h.mutationQueue.getAllMutationBatches(c)}).next(function(e){for(var t=documentKeySet(),n=0,r=[l,e];n<r.length;n++)for(var i=0,o=r[n];i<o.length;i++)for(var a=0,s=o[i].mutations;a<s.length;a++){var u=s[a];t=t.add(u.key)}return h.localDocuments.getDocuments(c,t)})})},e.prototype.startQueryCache=function(e){var t=this;return this.queryCache.start(e).next(function(){var e=t.queryCache.getHighestTargetId();t.targetIdGenerator=TargetIdGenerator.forLocalStore(e)})},e.prototype.startMutationQueue=function(t){var n=this;return this.mutationQueue.start(t).next(function(){return n.heldBatchResults=[],n.mutationQueue.getHighestAcknowledgedBatchId(t)}).next(function(e){return e!==BATCHID_UNKNOWN?n.mutationQueue.getAllMutationBatchesThroughBatchId(t,e):PersistencePromise.resolve([])}).next(function(e){return 0<e.length?n.mutationQueue.removeMutationBatches(t,e):PersistencePromise.resolve()})},e.prototype.localWrite=function(t){var i=this;return this.persistence.runTransaction("Locally write mutations",function(n){var r,e=Timestamp.now();return i.mutationQueue.addMutationBatch(n,e,t).next(function(e){var t=(r=e).keys();return i.localDocuments.getDocuments(n,t)}).next(function(e){return{batchId:r.batchId,changes:e}})})},e.prototype.acknowledgeBatch=function(e){var i=this;return this.persistence.runTransaction("Acknowledge batch",function(n){var r;return i.mutationQueue.acknowledgeBatch(n,e.batch,e.streamToken).next(function(){if(i.shouldHoldBatchResult(e.commitVersion))return i.heldBatchResults.push(e),r=documentKeySet(),PersistencePromise.resolve();var t=new RemoteDocumentChangeBuffer(i.remoteDocuments);return i.releaseBatchResults(n,[e],t).next(function(e){return r=e,t.apply(n)})}).next(function(){return i.mutationQueue.performConsistencyCheck(n)}).next(function(){return i.localDocuments.getDocuments(n,r)})})},e.prototype.rejectBatch=function(i){var o=this;return this.persistence.runTransaction("Reject batch",function(t){var n,r;return o.mutationQueue.lookupMutationBatch(t,i).next(function(e){return assert$1(null!=e,"Attempt to reject nonexistent batch!"),n=e,o.mutationQueue.getHighestAcknowledgedBatchId(t).next(function(e){return assert$1(e<i,"Acknowledged batches can't be rejected."),n})}).next(function(){return o.removeMutationBatch(t,n)}).next(function(e){return r=e,o.mutationQueue.performConsistencyCheck(t)}).next(function(){return o.localDocuments.getDocuments(t,r)})})},e.prototype.getLastStreamToken=function(){var t=this;return this.persistence.runTransaction("Get last stream token",function(e){return t.mutationQueue.getLastStreamToken(e)})},e.prototype.setLastStreamToken=function(t){var n=this;return this.persistence.runTransaction("Set last stream token",function(e){return n.mutationQueue.setLastStreamToken(e,t)})},e.prototype.getLastRemoteSnapshotVersion=function(){return this.queryCache.getLastRemoteSnapshotVersion()},e.prototype.applyRemoteEvent=function(i){var s=this,u=new RemoteDocumentChangeBuffer(this.remoteDocuments);return this.persistence.runTransaction("Apply remote event",function(o){var a=[];forEachNumber(i.targetChanges,function(e,t){var n=s.targetIds[e];if(n){var r=t.mapping;if(r)if(r instanceof ResetMapping)a.push(s.queryCache.removeMatchingKeysForTargetId(o,e).next(function(){return s.queryCache.addMatchingKeys(o,r.documents,e)}));else{if(!(r instanceof UpdateMapping))return fail("Unknown mapping type: "+JSON.stringify(r));a.push(s.queryCache.removeMatchingKeys(o,r.removedDocuments,e).next(function(){return s.queryCache.addMatchingKeys(o,r.addedDocuments,e)}))}var i=t.resumeToken;0<i.length&&(n=n.update({resumeToken:i,snapshotVersion:t.snapshotVersion}),s.targetIds[e]=n,a.push(s.queryCache.updateQueryData(o,n)))}});var e=documentKeySet();i.documentUpdates.forEach(function(t,n){e=e.add(t),a.push(u.getEntry(o,t).next(function(e){null==e||n.version.isEqual(SnapshotVersion.MIN)||0<=n.version.compareTo(e.version)?u.addEntry(n):debug(LOG_TAG$4,"Ignoring outdated watch update for ",t,". Current version:",e.version," Watch version:",n.version),s.garbageCollector.addPotentialGarbageKey(t)}))});var t,n=s.queryCache.getLastRemoteSnapshotVersion(),r=i.snapshotVersion;return r.isEqual(SnapshotVersion.MIN)||(assert$1(0<=r.compareTo(n),"Watch stream reverted to previous snapshot?? "+r+" < "+n),a.push(s.queryCache.setLastRemoteSnapshotVersion(o,r))),PersistencePromise.waitFor(a).next(function(){return s.releaseHeldBatchResults(o,u)}).next(function(e){return t=e,u.apply(o)}).next(function(){return s.localDocuments.getDocuments(o,e.unionWith(t))})})},e.prototype.notifyLocalViewChanges=function(o){var a=this;return this.persistence.runTransaction("Notify local view changes",function(e){for(var t=[],n=function(n){t.push(a.queryCache.getQueryData(e,n.query).next(function(e){assert$1(null!==e,"Local view changes contain unallocated query.");var t=e.targetId;a.localViewReferences.addReferences(n.addedKeys,t),a.localViewReferences.removeReferences(n.removedKeys,t)}))},r=0,i=o;r<i.length;r++)n(i[r]);return PersistencePromise.waitFor(t)})},e.prototype.nextMutationBatch=function(t){var n=this;return this.persistence.runTransaction("Get next mutation batch",function(e){return void 0===t&&(t=BATCHID_UNKNOWN),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)})},e.prototype.readDocument=function(t){var n=this;return this.persistence.runTransaction("read document",function(e){return n.localDocuments.getDocument(e,t)})},e.prototype.allocateQuery=function(i){var o=this;return this.persistence.runTransaction("Allocate query",function(n){var r;return o.queryCache.getQueryData(n,i).next(function(e){if(e)return r=e,PersistencePromise.resolve();var t=o.targetIdGenerator.next();return r=new QueryData(i,t,QueryPurpose.Listen),o.queryCache.addQueryData(n,r)}).next(function(){return assert$1(!o.targetIds[r.targetId],"Tried to allocate an already allocated query: "+i),o.targetIds[r.targetId]=r})})},e.prototype.releaseQuery=function(n){var r=this;return this.persistence.runTransaction("Release query",function(t){return r.queryCache.getQueryData(t,n).next(function(e){return assert$1(null!=e,"Tried to release nonexistent query: "+n),r.localViewReferences.removeReferencesForId(e.targetId),delete r.targetIds[e.targetId],r.garbageCollector.isEager?r.queryCache.removeQueryData(t,e):PersistencePromise.resolve()}).next(function(){if(isEmpty$1(r.targetIds)){var e=new RemoteDocumentChangeBuffer(r.remoteDocuments);return r.releaseHeldBatchResults(t,e).next(function(){e.apply(t)})}return PersistencePromise.resolve()})})},e.prototype.executeQuery=function(t){var n=this;return this.persistence.runTransaction("Execute query",function(e){return n.localDocuments.getDocumentsMatchingQuery(e,t)})},e.prototype.remoteDocumentKeys=function(t){var n=this;return this.persistence.runTransaction("Remote document keys",function(e){return n.queryCache.getMatchingKeysForTargetId(e,t)})},e.prototype.collectGarbage=function(){var r=this;return this.persistence.runTransaction("Garbage collection",function(n){return r.garbageCollector.collectGarbage(n).next(function(e){var t=[];return e.forEach(function(e){t.push(r.remoteDocuments.removeEntry(n,e))}),PersistencePromise.waitFor(t)})})},e.prototype.releaseHeldBatchResults=function(e,t){for(var n=[],r=0,i=this.heldBatchResults;r<i.length;r++){var o=i[r];if(!this.isRemoteUpToVersion(o.commitVersion))break;n.push(o)}return 0===n.length?PersistencePromise.resolve(documentKeySet()):(this.heldBatchResults.splice(0,n.length),this.releaseBatchResults(e,n,t))},e.prototype.isRemoteUpToVersion=function(e){var t=this.queryCache.getLastRemoteSnapshotVersion();return e.compareTo(t)<=0||isEmpty$1(this.targetIds)},e.prototype.shouldHoldBatchResult=function(e){return!this.isRemoteUpToVersion(e)||0<this.heldBatchResults.length},e.prototype.releaseBatchResults=function(t,e,n){for(var r=this,i=PersistencePromise.resolve(),o=function(e){i=i.next(function(){return r.applyWriteToRemoteDocuments(t,e,n)})},a=0,s=e;a<s.length;a++)o(s[a]);return i.next(function(){return r.removeMutationBatches(t,e.map(function(e){return e.batch}))})},e.prototype.removeMutationBatch=function(e,t){return this.removeMutationBatches(e,[t])},e.prototype.removeMutationBatches=function(e,t){for(var n=documentKeySet(),r=0,i=t;r<i.length;r++)for(var o=0,a=i[r].mutations;o<a.length;o++){var s=a[o].key;n=n.add(s)}return this.mutationQueue.removeMutationBatches(e,t).next(function(){return n})},e.prototype.applyWriteToRemoteDocuments=function(e,i,o){var a=i.batch,t=a.keys(),n=PersistencePromise.resolve();return t.forEach(function(r){n=n.next(function(){return o.getEntry(e,r)}).next(function(e){var t=e,n=i.docVersions.get(r);assert$1(null!==n,"ackVersions should contain every doc in the write."),(!t||t.version.compareTo(n)<0)&&((t=a.applyToRemoteDocument(r,t,i))?o.addEntry(t):assert$1(!e,"Mutation batch "+a+" applied to document "+e+" resulted in null"))})}),n},e}(),MemoryMutationQueue=function(){function e(){this.mutationQueue=[],this.nextBatchId=1,this.highestAcknowledgedBatchId=BATCHID_UNKNOWN,this.lastStreamToken=emptyByteString(),this.garbageCollector=null,this.batchesByDocumentKey=new SortedSet(DocReference.compareByKey)}return e.prototype.start=function(e){return 0===this.mutationQueue.length&&(this.nextBatchId=1,this.highestAcknowledgedBatchId=BATCHID_UNKNOWN),assert$1(this.highestAcknowledgedBatchId<this.nextBatchId,"highestAcknowledgedBatchId must be less than the nextBatchId"),PersistencePromise.resolve()},e.prototype.checkEmpty=function(e){return PersistencePromise.resolve(0===this.mutationQueue.length)},e.prototype.getNextBatchId=function(e){return PersistencePromise.resolve(this.nextBatchId)},e.prototype.getHighestAcknowledgedBatchId=function(e){return PersistencePromise.resolve(this.highestAcknowledgedBatchId)},e.prototype.acknowledgeBatch=function(e,t,n){var r=t.batchId;assert$1(r>this.highestAcknowledgedBatchId,"Mutation batchIDs must be acknowledged in order");var i=this.indexOfExistingBatchId(r,"acknowledged"),o=this.mutationQueue[i];return assert$1(r===o.batchId,"Queue ordering failure: expected batch "+r+", got batch "+o.batchId),assert$1(!o.isTombstone(),"Can't acknowledge a previously removed batch"),this.highestAcknowledgedBatchId=r,this.lastStreamToken=n,PersistencePromise.resolve()},e.prototype.getLastStreamToken=function(e){return PersistencePromise.resolve(this.lastStreamToken)},e.prototype.setLastStreamToken=function(e,t){return this.lastStreamToken=t,PersistencePromise.resolve()},e.prototype.addMutationBatch=function(e,t,n){assert$1(0!==n.length,"Mutation batches should not be empty");var r=this.nextBatchId;this.nextBatchId++,0<this.mutationQueue.length&&assert$1(this.mutationQueue[this.mutationQueue.length-1].batchId<r,"Mutation batchIDs must be monotonically increasing order");var i=new MutationBatch(r,t,n);this.mutationQueue.push(i);for(var o=0,a=n;o<a.length;o++){var s=a[o];this.batchesByDocumentKey=this.batchesByDocumentKey.add(new DocReference(s.key,r))}return PersistencePromise.resolve(i)},e.prototype.lookupMutationBatch=function(e,t){return PersistencePromise.resolve(this.findMutationBatch(t))},e.prototype.getNextMutationBatchAfterBatchId=function(e,t){for(var n=this.mutationQueue.length,r=Math.max(t,this.highestAcknowledgedBatchId)+1,i=this.indexOfBatchId(r),o=i<0?0:i;o<n;o++){var a=this.mutationQueue[o];if(!a.isTombstone())return PersistencePromise.resolve(a)}return PersistencePromise.resolve(null)},e.prototype.getAllMutationBatches=function(e){return PersistencePromise.resolve(this.getAllLiveMutationBatchesBeforeIndex(this.mutationQueue.length))},e.prototype.getAllMutationBatchesThroughBatchId=function(e,t){var n=this.mutationQueue.length,r=this.indexOfBatchId(t);return r<0?r=0:n<=r?r=n:r++,PersistencePromise.resolve(this.getAllLiveMutationBatchesBeforeIndex(r))},e.prototype.getAllMutationBatchesAffectingDocumentKey=function(e,n){var r=this,t=new DocReference(n,0),i=new DocReference(n,Number.POSITIVE_INFINITY),o=[];return this.batchesByDocumentKey.forEachInRange([t,i],function(e){assert$1(n.isEqual(e.key),"Should only iterate over a single key's batches");var t=r.findMutationBatch(e.targetOrBatchId);assert$1(null!==t,"Batches in the index must exist in the main table"),o.push(t)}),PersistencePromise.resolve(o)},e.prototype.getAllMutationBatchesAffectingQuery=function(e,t){var n=this,r=t.path,i=r.length+1,o=r;DocumentKey.isDocumentKey(o)||(o=o.child(""));var a=new DocReference(new DocumentKey(o),0),s=new SortedSet(primitiveComparator);this.batchesByDocumentKey.forEachWhile(function(e){var t=e.key.path;return!!r.isPrefixOf(t)&&(t.length===i&&(s=s.add(e.targetOrBatchId)),!0)},a);var u=[];return s.forEach(function(e){var t=n.findMutationBatch(e);null!==t&&u.push(t)}),PersistencePromise.resolve(u)},e.prototype.removeMutationBatches=function(e,t){var n=t.length;assert$1(0<n,"Should not remove mutations when none exist.");var r=t[0].batchId,i=this.mutationQueue.length,o=this.indexOfExistingBatchId(r,"removed");assert$1(this.mutationQueue[o].batchId===r,"Removed batches must exist in the queue");for(var a=1,s=o+1;a<n&&s<i;)(d=this.mutationQueue[s]).isTombstone()||(assert$1(d.batchId===t[a].batchId,"Removed batches must be contiguous in the queue"),a++),s++;if(0===o){for(;s<i&&(d=this.mutationQueue[s]).isTombstone();s++);var u=s-o;this.mutationQueue.splice(o,u)}else for(var c=o;c<s;c++)this.mutationQueue[c]=this.mutationQueue[c].toTombstone();for(var l=this.batchesByDocumentKey,h=0,f=t;h<f.length;h++)for(var d,p=(d=f[h]).batchId,v=0,m=d.mutations;v<m.length;v++){var g=m[v].key;null!==this.garbageCollector&&this.garbageCollector.addPotentialGarbageKey(g);var y=new DocReference(g,p);l=l.delete(y)}return this.batchesByDocumentKey=l,PersistencePromise.resolve()},e.prototype.setGarbageCollector=function(e){this.garbageCollector=e},e.prototype.containsKey=function(e,t){var n=new DocReference(t,0),r=this.batchesByDocumentKey.firstAfterOrEqual(n);return PersistencePromise.resolve(t.isEqual(r&&r.key))},e.prototype.performConsistencyCheck=function(e){return 0===this.mutationQueue.length&&assert$1(this.batchesByDocumentKey.isEmpty(),"Document leak -- detected dangling mutation references when queue is empty."),PersistencePromise.resolve()},e.prototype.getAllLiveMutationBatchesBeforeIndex=function(e){for(var t=[],n=0;n<e;n++){var r=this.mutationQueue[n];r.isTombstone()||t.push(r)}return t},e.prototype.indexOfExistingBatchId=function(e,t){var n=this.indexOfBatchId(e);return assert$1(0<=n&&n<this.mutationQueue.length,"Batches must exist to be "+t),n},e.prototype.indexOfBatchId=function(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId},e.prototype.findMutationBatch=function(e){var t=this.indexOfBatchId(e);if(t<0||t>=this.mutationQueue.length)return null;var n=this.mutationQueue[t];return assert$1(n.batchId===e,"If found batch must match"),n.isTombstone()?null:n},e}(),MemoryQueryCache=function(){function e(){this.queries=new ObjectMap(function(e){return e.canonicalId()}),this.lastRemoteSnapshotVersion=SnapshotVersion.MIN,this.highestTargetId=0,this.references=new ReferenceSet,this.targetCount=0}return e.prototype.start=function(e){return PersistencePromise.resolve()},e.prototype.getLastRemoteSnapshotVersion=function(){return this.lastRemoteSnapshotVersion},e.prototype.getHighestTargetId=function(){return this.highestTargetId},e.prototype.setLastRemoteSnapshotVersion=function(e,t){return this.lastRemoteSnapshotVersion=t,PersistencePromise.resolve()},e.prototype.saveQueryData=function(e){this.queries.set(e.query,e);var t=e.targetId;t>this.highestTargetId&&(this.highestTargetId=t)},e.prototype.addQueryData=function(e,t){return assert$1(!this.queries.has(t.query),"Adding a query that already exists"),this.saveQueryData(t),this.targetCount+=1,PersistencePromise.resolve()},e.prototype.updateQueryData=function(e,t){return assert$1(this.queries.has(t.query),"Updating a non-existent query"),this.saveQueryData(t),PersistencePromise.resolve()},e.prototype.removeQueryData=function(e,t){return assert$1(0<this.targetCount,"Removing a target from an empty cache"),assert$1(this.queries.has(t.query),"Removing a non-existent target from the cache"),this.queries.delete(t.query),this.references.removeReferencesForId(t.targetId),this.targetCount-=1,PersistencePromise.resolve()},Object.defineProperty(e.prototype,"count",{get:function(){return this.targetCount},enumerable:!0,configurable:!0}),e.prototype.getQueryData=function(e,t){var n=this.queries.get(t)||null;return PersistencePromise.resolve(n)},e.prototype.addMatchingKeys=function(e,t,n){return this.references.addReferences(t,n),PersistencePromise.resolve()},e.prototype.removeMatchingKeys=function(e,t,n){return this.references.removeReferences(t,n),PersistencePromise.resolve()},e.prototype.removeMatchingKeysForTargetId=function(e,t){return this.references.removeReferencesForId(t),PersistencePromise.resolve()},e.prototype.getMatchingKeysForTargetId=function(e,t){var n=this.references.referencesForId(t);return PersistencePromise.resolve(n)},e.prototype.setGarbageCollector=function(e){this.references.setGarbageCollector(e)},e.prototype.containsKey=function(e,t){return this.references.containsKey(e,t)},e}(),MemoryRemoteDocumentCache=function(){function e(){this.docs=maybeDocumentMap()}return e.prototype.addEntry=function(e,t){return this.docs=this.docs.insert(t.key,t),PersistencePromise.resolve()},e.prototype.removeEntry=function(e,t){return this.docs=this.docs.remove(t),PersistencePromise.resolve()},e.prototype.getEntry=function(e,t){return PersistencePromise.resolve(this.docs.get(t))},e.prototype.getDocumentsMatchingQuery=function(e,t){for(var n=documentMap(),r=new DocumentKey(t.path.child("")),i=this.docs.getIteratorFrom(r);i.hasNext();){var o=i.getNext(),a=o.key,s=o.value;if(!t.path.isPrefixOf(a.path))break;s instanceof Document&&t.matches(s)&&(n=n.insert(s.key,s))}return PersistencePromise.resolve(n)},e}(),LOG_TAG$5="MemoryPersistence",MemoryPersistence=function(){function e(){this.mutationQueues={},this.remoteDocumentCache=new MemoryRemoteDocumentCache,this.queryCache=new MemoryQueryCache,this.started=!1}return e.prototype.start=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return assert$1(!this.started,"MemoryPersistence double-started!"),this.started=!0,[2]})})},e.prototype.shutdown=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return assert$1(this.started,"MemoryPersistence shutdown without start!"),this.started=!1,[2]})})},e.prototype.getMutationQueue=function(e){var t=this.mutationQueues[e.toKey()];return t||(t=new MemoryMutationQueue,this.mutationQueues[e.toKey()]=t),t},e.prototype.getQueryCache=function(){return this.queryCache},e.prototype.getRemoteDocumentCache=function(){return this.remoteDocumentCache},e.prototype.runTransaction=function(e,t){return debug(LOG_TAG$5,"Starting transaction:",e),t(new MemoryPersistenceTransaction).toPromise()},e}(),MemoryPersistenceTransaction=function(){},NoOpGarbageCollector=function(){function e(){this.isEager=!1}return e.prototype.addGarbageSource=function(e){},e.prototype.removeGarbageSource=function(e){},e.prototype.addPotentialGarbageKey=function(e){},e.prototype.collectGarbage=function(e){return PersistencePromise.resolve(documentKeySet())},e}(),Deferred$1=function(){var n=this;this.promise=new Promise(function(e,t){n.resolve=e,n.reject=t})},TimerId,LVd;LVd=TimerId||(TimerId={}),LVd.All="all",LVd.ListenStreamIdle="listen_stream_idle",LVd.ListenStreamConnectionBackoff="listen_stream_connection_backoff",LVd.WriteStreamIdle="write_stream_idle",LVd.WriteStreamConnectionBackoff="write_stream_connection_backoff",LVd.OnlineStateTimeout="online_state_timeout";var DelayedOperation=function(){function a(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Deferred$1,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.catch=this.deferred.promise.catch.bind(this.deferred.promise),this.deferred.promise.catch(function(e){})}return a.createAndSchedule=function(e,t,n,r,i){var o=new a(e,t,Date.now()+n,r,i);return o.start(n),o},a.prototype.start=function(e){var t=this;this.timerHandle=setTimeout(function(){return t.handleDelayElapsed()},e)},a.prototype.skipDelay=function(){return this.handleDelayElapsed()},a.prototype.cancel=function(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new FirestoreError(Code.CANCELLED,"Operation cancelled"+(e?": "+e:""))))},a.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueue(function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then(function(e){return t.deferred.resolve(e)})):Promise.resolve()})},a.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},a}(),AsyncQueue=function(){function e(){this.tail=Promise.resolve(),this.delayedOperations=[],this.operationInProgress=!1}return e.prototype.enqueue=function(e){var n=this;this.verifyNotFailed();var t=this.tail.then(function(){return n.operationInProgress=!0,e().catch(function(e){n.failure=e,n.operationInProgress=!1;var t=e.stack||e.message||"";throw error$2("INTERNAL UNHANDLED ERROR: ",t),t.indexOf("Firestore Test Simulated Error")<0&&setTimeout(function(){throw e},0),e}).then(function(e){return n.operationInProgress=!1,e})});return this.tail=t},e.prototype.enqueueAfterDelay=function(e,t,n){var r=this;this.verifyNotFailed(),assert$1(!this.containsDelayedOperation(e),"Attempted to schedule multiple operations with timer id "+e+".");var i=DelayedOperation.createAndSchedule(this,e,t,n,function(e){return r.removeDelayedOperation(e)});return this.delayedOperations.push(i),i},e.prototype.verifyNotFailed=function(){this.failure&&fail("AsyncQueue is already failed: "+(this.failure.stack||this.failure.message))},e.prototype.verifyOperationInProgress=function(){assert$1(this.operationInProgress,"verifyOpInProgress() called when no op in progress on this queue.")},e.prototype.drain=function(){return this.enqueue(function(){return Promise.resolve()})},e.prototype.containsDelayedOperation=function(t){return 0<=this.delayedOperations.findIndex(function(e){return e.timerId===t})},e.prototype.runDelayedOperationsEarly=function(r){var i=this;return this.drain().then(function(){assert$1(r===TimerId.All||i.containsDelayedOperation(r),"Attempted to drain to missing operation "+r),i.delayedOperations.sort(function(e,t){return e.targetTimeMs-t.targetTimeMs});for(var e=0,t=i.delayedOperations;e<t.length;e++){var n=t[e];if(n.skipDelay(),r!==TimerId.All&&n.timerId===r)break}return i.drain()})},e.prototype.removeDelayedOperation=function(e){var t=this.delayedOperations.indexOf(e);assert$1(0<=t,"Delayed operation not found."),this.delayedOperations.splice(t,1)},e}(),LOG_TAG$6="ExponentialBackoff",ExponentialBackoff=function(){function e(e,t,n,r,i){this.queue=e,this.timerId=t,this.initialDelayMs=n,this.backoffFactor=r,this.maxDelayMs=i,this.timerPromise=null,this.reset()}return e.prototype.reset=function(){this.currentBaseMs=0},e.prototype.resetToMax=function(){this.currentBaseMs=this.maxDelayMs},e.prototype.backoffAndRun=function(e){this.cancel();var t=this.currentBaseMs+this.jitterDelayMs();0<this.currentBaseMs&&debug(LOG_TAG$6,"Backing off for "+t+" ms (base delay: "+this.currentBaseMs+" ms)"),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,t,e),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)},e.prototype.cancel=function(){null!==this.timerPromise&&(this.timerPromise.cancel(),this.timerPromise=null)},e.prototype.jitterDelayMs=function(){return(Math.random()-.5)*this.currentBaseMs},e}(),LOG_TAG$7="PersistentStream",PersistentStreamState,IWd;IWd=PersistentStreamState||(PersistentStreamState={}),IWd[IWd.Initial=0]="Initial",IWd[IWd.Auth=1]="Auth",IWd[IWd.Open=2]="Open",IWd[IWd.Error=3]="Error",IWd[IWd.Backoff=4]="Backoff",IWd[IWd.Stopped=5]="Stopped";var BACKOFF_INITIAL_DELAY_MS=1e3,BACKOFF_MAX_DELAY_MS=6e4,BACKOFF_FACTOR=1.5,IDLE_TIMEOUT_MS=6e4,PersistentStream=function(){function e(e,t,n,r,i){this.queue=e,this.idleTimerId=n,this.connection=r,this.credentialsProvider=i,this.inactivityTimerPromise=null,this.stream=null,this.listener=null,this.backoff=new ExponentialBackoff(e,t,BACKOFF_INITIAL_DELAY_MS,BACKOFF_FACTOR,BACKOFF_MAX_DELAY_MS),this.state=PersistentStreamState.Initial}return e.prototype.isStarted=function(){return this.state===PersistentStreamState.Backoff||this.state===PersistentStreamState.Auth||this.state===PersistentStreamState.Open},e.prototype.isOpen=function(){return this.state===PersistentStreamState.Open},e.prototype.start=function(e){this.state!==PersistentStreamState.Error?(assert$1(this.state===PersistentStreamState.Initial,"Already started"),this.listener=e,this.auth()):this.performBackoff(e)},e.prototype.stop=function(){this.isStarted()&&this.close(PersistentStreamState.Stopped)},e.prototype.inhibitBackoff=function(){assert$1(!this.isStarted(),"Can only inhibit backoff in a stopped state"),this.state=PersistentStreamState.Initial,this.backoff.reset()},e.prototype.markIdle=function(){var e=this;this.isOpen()&&null===this.inactivityTimerPromise&&(this.inactivityTimerPromise=this.queue.enqueueAfterDelay(this.idleTimerId,IDLE_TIMEOUT_MS,function(){return e.handleIdleCloseTimer()}))},e.prototype.sendRequest=function(e){this.cancelIdleCheck(),this.stream.send(e)},e.prototype.handleIdleCloseTimer=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return this.isOpen()?[2,this.close(PersistentStreamState.Initial)]:[2]})})},e.prototype.cancelIdleCheck=function(){this.inactivityTimerPromise&&(this.inactivityTimerPromise.cancel(),this.inactivityTimerPromise=null)},e.prototype.close=function(n,r){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){return assert$1(n===PersistentStreamState.Error||isNullOrUndefined(r),"Can't provide an error when not in an error state."),this.cancelIdleCheck(),this.backoff.cancel(),n!==PersistentStreamState.Error?this.backoff.reset():r&&r.code===Code.RESOURCE_EXHAUSTED&&(error$2(r.toString()),error$2("Using maximum backoff delay to prevent overloading the backend."),this.backoff.resetToMax()),null!==this.stream&&(this.tearDown(),this.stream.close(),this.stream=null),this.state=n,t=this.listener,this.listener=null,n!==PersistentStreamState.Stopped?[2,t.onClose(r)]:[2]})})},e.prototype.tearDown=function(){},e.prototype.auth=function(){var t=this;assert$1(this.state===PersistentStreamState.Initial,"Must be in initial state to auth"),this.state=PersistentStreamState.Auth,this.credentialsProvider.getToken(!1).then(function(e){t.startStream(e)},function(n){t.queue.enqueue(function(){return __awaiter(t,void 0,void 0,function(){var t;return __generator(this,function(e){return this.state!==PersistentStreamState.Stopped?(t=new FirestoreError(Code.UNKNOWN,"Fetching auth token failed: "+n.message),[2,this.handleStreamClose(t)]):[2]})})})})},e.prototype.startStream=function(e){var r=this;if(this.state!==PersistentStreamState.Stopped){assert$1(this.state===PersistentStreamState.Auth,"Trying to start stream in a non-auth state");var t=function(t,n){r.queue.enqueue(function(){return __awaiter(r,void 0,void 0,function(){return __generator(this,function(e){return this.stream===t?[2,n()]:[2]})})})};if(null!==this.listener){var n=this.startRpc(e);this.stream=n,this.stream.onOpen(function(){t(n,function(){return assert$1(r.state===PersistentStreamState.Auth,"Expected stream to be in state auth, but was "+r.state),r.state=PersistentStreamState.Open,r.listener.onOpen()})}),this.stream.onClose(function(e){t(n,function(){return r.handleStreamClose(e)})}),this.stream.onMessage(function(e){t(n,function(){return r.onMessage(e)})})}}},e.prototype.performBackoff=function(t){var e=this;assert$1(this.state===PersistentStreamState.Error,"Should only perform backoff in an error case"),this.state=PersistentStreamState.Backoff,this.backoff.backoffAndRun(function(){return __awaiter(e,void 0,void 0,function(){return __generator(this,function(e){return this.state===PersistentStreamState.Stopped||(this.state=PersistentStreamState.Initial,this.start(t),assert$1(this.isStarted(),"PersistentStream should have started")),[2]})})})},e.prototype.handleStreamClose=function(e){return assert$1(this.isStarted(),"Can't handle server close on non-started stream"),debug(LOG_TAG$7,"close with error: "+e),this.stream=null,this.close(PersistentStreamState.Error,e)},e}(),PersistentListenStream=function(o){function e(e,t,n,r){var i=o.call(this,e,TimerId.ListenStreamConnectionBackoff,TimerId.ListenStreamIdle,t,n)||this;return i.serializer=r,i}return __extends(e,o),e.prototype.startRpc=function(e){return this.connection.openStream("Listen",e)},e.prototype.onMessage=function(e){this.backoff.reset();var t=this.serializer.fromWatchChange(e),n=this.serializer.versionFromListenResponse(e);return this.listener.onWatchChange(t,n)},e.prototype.watch=function(e){var t={};t.database=this.serializer.encodedDatabaseId,t.addTarget=this.serializer.toTarget(e);var n=this.serializer.toListenRequestLabels(e);n&&(t.labels=n),this.sendRequest(t)},e.prototype.unwatch=function(e){var t={};t.database=this.serializer.encodedDatabaseId,t.removeTarget=e,this.sendRequest(t)},e}(PersistentStream),PersistentWriteStream=function(o){function e(e,t,n,r){var i=o.call(this,e,TimerId.WriteStreamConnectionBackoff,TimerId.WriteStreamIdle,t,n)||this;return i.serializer=r,i.handshakeComplete_=!1,i}return __extends(e,o),Object.defineProperty(e.prototype,"handshakeComplete",{get:function(){return this.handshakeComplete_},enumerable:!0,configurable:!0}),e.prototype.start=function(e){this.handshakeComplete_=!1,o.prototype.start.call(this,e)},e.prototype.tearDown=function(){this.handshakeComplete_&&this.writeMutations([])},e.prototype.startRpc=function(e){return this.connection.openStream("Write",e)},e.prototype.onMessage=function(e){if(assert$1(!!e.streamToken,"Got a write response without a stream token"),this.lastStreamToken=e.streamToken,this.handshakeComplete_){this.backoff.reset();var t=this.serializer.fromWriteResults(e.writeResults),n=this.serializer.fromVersion(e.commitTime);return this.listener.onMutationResult(n,t)}return assert$1(!e.writeResults||0===e.writeResults.length,"Got mutation results for handshake"),this.handshakeComplete_=!0,this.listener.onHandshakeComplete()},e.prototype.writeHandshake=function(){assert$1(this.isOpen(),"Writing handshake requires an opened stream"),assert$1(!this.handshakeComplete_,"Handshake already completed");var e={};e.database=this.serializer.encodedDatabaseId,this.sendRequest(e)},e.prototype.writeMutations=function(e){var t=this;assert$1(this.isOpen(),"Writing mutations requires an opened stream"),assert$1(this.handshakeComplete_,"Handshake must be complete before writing mutations"),assert$1(0<this.lastStreamToken.length,"Trying to write mutation without a token");var n={streamToken:this.lastStreamToken,writes:e.map(function(e){return t.serializer.toMutation(e)})};this.sendRequest(n)},e}(PersistentStream),Datastore=function(){function e(e,t,n,r){this.queue=e,this.connection=t,this.credentials=n,this.serializer=r}return e.prototype.newPersistentWriteStream=function(){return new PersistentWriteStream(this.queue,this.connection,this.credentials,this.serializer)},e.prototype.newPersistentWatchStream=function(){return new PersistentListenStream(this.queue,this.connection,this.credentials,this.serializer)},e.prototype.commit=function(e){var t=this,n={database:this.serializer.encodedDatabaseId,writes:e.map(function(e){return t.serializer.toMutation(e)})};return this.invokeRPC("Commit",n).then(function(e){return t.serializer.fromWriteResults(e.writeResults)})},e.prototype.lookup=function(t){var i=this,e={database:this.serializer.encodedDatabaseId,documents:t.map(function(e){return i.serializer.toName(e)})};return this.invokeStreamingRPC("BatchGetDocuments",e).then(function(e){var n=maybeDocumentMap();e.forEach(function(e){var t=i.serializer.fromMaybeDocument(e);n=n.insert(t.key,t)});var r=[];return t.forEach(function(e){var t=n.get(e);assert$1(!!t,"Missing entity in write response for "+e),r.push(t)}),r})},e.prototype.invokeRPC=function(t,n){var r=this;return this.credentials.getToken(!1).then(function(e){return r.connection.invokeRPC(t,n,e)})},e.prototype.invokeStreamingRPC=function(t,n){var r=this;return this.credentials.getToken(!1).then(function(e){return r.connection.invokeStreamingRPC(t,n,e)})},e}(),Transaction=function(){function e(e){this.datastore=e,this.readVersions=documentVersionMap(),this.mutations=[],this.committed=!1}return e.prototype.recordVersion=function(e){var t=e.version;e instanceof NoDocument&&(t=SnapshotVersion.forDeletedDoc());var n=this.readVersions.get(e.key);if(null!==n){if(!t.isEqual(n))throw new FirestoreError(Code.ABORTED,"Document version changed between two reads.")}else this.readVersions=this.readVersions.insert(e.key,t)},e.prototype.lookup=function(e){var t=this;return this.committed?Promise.reject("Transaction has already completed."):0<this.mutations.length?Promise.reject("Transactions lookups are invalid after writes."):this.datastore.lookup(e).then(function(e){return e.forEach(function(e){return t.recordVersion(e)}),e})},e.prototype.write=function(e){if(this.committed)throw new FirestoreError(Code.FAILED_PRECONDITION,"Transaction has already completed.");this.mutations=this.mutations.concat(e)},e.prototype.precondition=function(e){var t=this.readVersions.get(e);return t?Precondition.updateTime(t):Precondition.NONE},e.prototype.preconditionForUpdate=function(e){var t=this.readVersions.get(e);if(t&&t.isEqual(SnapshotVersion.forDeletedDoc()))throw new FirestoreError(Code.FAILED_PRECONDITION,"Can't update a document that doesn't exist.");return t?Precondition.updateTime(t):Precondition.exists(!0)},e.prototype.set=function(e,t){this.write(t.toMutations(e,this.precondition(e)))},e.prototype.update=function(e,t){this.write(t.toMutations(e,this.preconditionForUpdate(e)))},e.prototype.delete=function(e){this.write([new DeleteMutation(e,this.precondition(e))]),this.readVersions=this.readVersions.insert(e,SnapshotVersion.forDeletedDoc())},e.prototype.commit=function(){var e=this,t=this.readVersions;return this.mutations.forEach(function(e){t=t.remove(e.key)}),t.isEmpty()?this.datastore.commit(this.mutations).then(function(){e.committed=!0}):Promise.reject(Error("Every document read in a transaction must also be written."))},e}(),LOG_TAG$8="OnlineStateTracker",MAX_WATCH_STREAM_FAILURES=2,ONLINE_STATE_TIMEOUT_MS=1e4,OnlineStateTracker=function(){function e(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state=OnlineState.Unknown,this.watchStreamFailures=0,this.onlineStateTimer=null,this.shouldWarnClientIsOffline=!0}return e.prototype.handleWatchStreamStart=function(){var e=this;0===this.watchStreamFailures&&(this.setAndBroadcast(OnlineState.Unknown),assert$1(null===this.onlineStateTimer,"onlineStateTimer shouldn't be started yet"),this.onlineStateTimer=this.asyncQueue.enqueueAfterDelay(TimerId.OnlineStateTimeout,ONLINE_STATE_TIMEOUT_MS,function(){return e.onlineStateTimer=null,assert$1(e.state===OnlineState.Unknown,"Timer should be canceled if we transitioned to a different state."),debug(LOG_TAG$8,"Watch stream didn't reach online or offline within "+ONLINE_STATE_TIMEOUT_MS+"ms. Considering client offline."),e.logClientOfflineWarningIfNecessary(),e.setAndBroadcast(OnlineState.Offline),Promise.resolve()}))},e.prototype.handleWatchStreamFailure=function(){this.state===OnlineState.Online?(this.setAndBroadcast(OnlineState.Unknown),assert$1(0===this.watchStreamFailures,"watchStreamFailures must be 0"),assert$1(null===this.onlineStateTimer,"onlineStateTimer must be null")):(this.watchStreamFailures++,this.watchStreamFailures>=MAX_WATCH_STREAM_FAILURES&&(this.clearOnlineStateTimer(),this.logClientOfflineWarningIfNecessary(),this.setAndBroadcast(OnlineState.Offline)))},e.prototype.set=function(e){this.clearOnlineStateTimer(),this.watchStreamFailures=0,e===OnlineState.Online&&(this.shouldWarnClientIsOffline=!1),this.setAndBroadcast(e)},e.prototype.setAndBroadcast=function(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))},e.prototype.logClientOfflineWarningIfNecessary=function(){this.shouldWarnClientIsOffline&&(error$2("Could not reach Firestore backend."),this.shouldWarnClientIsOffline=!1)},e.prototype.clearOnlineStateTimer=function(){null!==this.onlineStateTimer&&(this.onlineStateTimer.cancel(),this.onlineStateTimer=null)},e}(),LOG_TAG$9="RemoteStore",MAX_PENDING_WRITES=10,RemoteStore=function(){function e(e,t,n,r){this.localStore=e,this.datastore=t,this.pendingWrites=[],this.lastBatchSeen=BATCHID_UNKNOWN,this.listenTargets={},this.pendingTargetResponses={},this.accumulatedWatchChanges=[],this.watchStream=null,this.writeStream=null,this.onlineStateTracker=new OnlineStateTracker(n,r)}return e.prototype.start=function(){return this.enableNetwork()},e.prototype.isNetworkEnabled=function(){return assert$1(null==this.watchStream==(null==this.writeStream),"WatchStream and WriteStream should both be null or non-null"),null!=this.watchStream},e.prototype.enableNetwork=function(){var t=this;return this.isNetworkEnabled()?Promise.resolve():(this.watchStream=this.datastore.newPersistentWatchStream(),this.writeStream=this.datastore.newPersistentWriteStream(),this.localStore.getLastStreamToken().then(function(e){return t.writeStream.lastStreamToken=e,t.shouldStartWatchStream()?t.startWatchStream():t.onlineStateTracker.set(OnlineState.Unknown),t.fillWritePipeline()}))},e.prototype.disableNetwork=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return this.disableNetworkInternal(),this.onlineStateTracker.set(OnlineState.Offline),[2]})})},e.prototype.disableNetworkInternal=function(){this.isNetworkEnabled()&&(this.watchStream.stop(),this.writeStream.stop(),this.cleanUpWatchStreamState(),this.cleanUpWriteStreamState(),this.writeStream=null,this.watchStream=null)},e.prototype.shutdown=function(){return debug(LOG_TAG$9,"RemoteStore shutting down."),this.disableNetworkInternal(),this.onlineStateTracker.set(OnlineState.Unknown),Promise.resolve()},e.prototype.listen=function(e){assert$1(!contains$2(this.listenTargets,e.targetId),"listen called with duplicate targetId!"),this.listenTargets[e.targetId]=e,this.shouldStartWatchStream()?this.startWatchStream():this.isNetworkEnabled()&&this.watchStream.isOpen()&&this.sendWatchRequest(e)},e.prototype.unlisten=function(e){assert$1(contains$2(this.listenTargets,e),"unlisten called without assigned target ID!"),delete this.listenTargets[e],this.isNetworkEnabled()&&this.watchStream.isOpen()&&(this.sendUnwatchRequest(e),isEmpty$1(this.listenTargets)&&this.watchStream.markIdle())},e.prototype.sendWatchRequest=function(e){this.recordPendingTargetRequest(e.targetId),this.watchStream.watch(e)},e.prototype.sendUnwatchRequest=function(e){this.recordPendingTargetRequest(e),this.watchStream.unwatch(e)},e.prototype.recordPendingTargetRequest=function(e){this.pendingTargetResponses[e]=(this.pendingTargetResponses[e]||0)+1},e.prototype.startWatchStream=function(){assert$1(this.shouldStartWatchStream(),"startWriteStream() called when shouldStartWatchStream() is false."),this.watchStream.start({onOpen:this.onWatchStreamOpen.bind(this),onClose:this.onWatchStreamClose.bind(this),onWatchChange:this.onWatchStreamChange.bind(this)}),this.onlineStateTracker.handleWatchStreamStart()},e.prototype.shouldStartWatchStream=function(){return this.isNetworkEnabled()&&!this.watchStream.isStarted()&&!isEmpty$1(this.listenTargets)},e.prototype.cleanUpWatchStreamState=function(){this.accumulatedWatchChanges=[],this.pendingTargetResponses={}},e.prototype.onWatchStreamOpen=function(){return __awaiter(this,void 0,void 0,function(){var n=this;return __generator(this,function(e){return forEachNumber(this.listenTargets,function(e,t){n.sendWatchRequest(t)}),[2]})})},e.prototype.onWatchStreamClose=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return assert$1(this.isNetworkEnabled(),"onWatchStreamClose() should only be called when the network is enabled"),this.cleanUpWatchStreamState(),this.onlineStateTracker.handleWatchStreamFailure(),this.shouldStartWatchStream()?this.startWatchStream():this.onlineStateTracker.set(OnlineState.Unknown),[2]})})},e.prototype.onWatchStreamChange=function(n,r){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){return this.onlineStateTracker.set(OnlineState.Online),n instanceof WatchTargetChange&&n.state===WatchTargetChangeState.Removed&&n.cause?[2,this.handleTargetError(n)]:(this.accumulatedWatchChanges.push(n),!r.isEqual(SnapshotVersion.MIN)&&0<=r.compareTo(this.localStore.getLastRemoteSnapshotVersion())?(t=this.accumulatedWatchChanges,this.accumulatedWatchChanges=[],[2,this.handleWatchChangeBatch(r,t)]):[2])})})},e.prototype.handleWatchChangeBatch=function(r,e){var u=this,t=new WatchChangeAggregator(r,this.listenTargets,this.pendingTargetResponses);t.addChanges(e);var c=t.createRemoteEvent();this.pendingTargetResponses=t.pendingTargetResponses;var l=[];return forEachNumber(t.existenceFilters,function(i,o){var a=u.listenTargets[i];if(a){var s=a.query;if(s.isDocumentQuery())if(0===o.count){var e=new DocumentKey(s.path),t=new NoDocument(e,r);c.addDocumentUpdate(t)}else assert$1(1===o.count,"Single document existence filter with count: "+o.count);else{var n=u.localStore.remoteDocumentKeys(i).then(function(e){if(c.targetChanges[i]){var t=c.targetChanges[i].mapping;null!==t&&(t instanceof UpdateMapping?e=t.applyToKeySet(e):(assert$1(t instanceof ResetMapping,"Expected either reset or update mapping but got something else: "+t),e=t.documents))}if(e.size!==o.count){c.handleExistenceFilterMismatch(i);var n=new QueryData(s,i,a.purpose);u.listenTargets[i]=n,u.sendUnwatchRequest(i);var r=new QueryData(s,i,QueryPurpose.ExistenceFilterMismatch);u.sendWatchRequest(r)}});l.push(n)}}}),Promise.all(l).then(function(){return forEachNumber(c.targetChanges,function(e,t){if(0<t.resumeToken.length){var n=u.listenTargets[e];n&&(u.listenTargets[e]=n.update({resumeToken:t.resumeToken,snapshotVersion:t.snapshotVersion}))}}),u.syncEngine.applyRemoteEvent(c)})},e.prototype.handleTargetError=function(e){var n=this;assert$1(!!e.cause,"Handling target error without a cause");var r=e.cause,i=Promise.resolve();return e.targetIds.forEach(function(t){i=i.then(function(){return __awaiter(n,void 0,void 0,function(){return __generator(this,function(e){return contains$2(this.listenTargets,t)?(delete this.listenTargets[t],[2,this.syncEngine.rejectListen(t,r)]):[2]})})})}),i},e.prototype.cleanUpWriteStreamState=function(){this.lastBatchSeen=BATCHID_UNKNOWN,debug(LOG_TAG$9,"Stopping write stream with "+this.pendingWrites.length+" pending writes"),this.pendingWrites=[]},e.prototype.fillWritePipeline=function(){return __awaiter(this,void 0,void 0,function(){var t=this;return __generator(this,function(e){return this.canWriteMutations()?[2,this.localStore.nextMutationBatch(this.lastBatchSeen).then(function(e){if(null!==e)return t.commit(e),t.fillWritePipeline();0===t.pendingWrites.length&&t.writeStream.markIdle()})]:[2]})})},e.prototype.canWriteMutations=function(){return this.isNetworkEnabled()&&this.pendingWrites.length<MAX_PENDING_WRITES},e.prototype.outstandingWrites=function(){return this.pendingWrites.length},e.prototype.commit=function(e){assert$1(this.canWriteMutations(),"commit called when batches can't be written"),this.lastBatchSeen=e.batchId,this.pendingWrites.push(e),this.shouldStartWriteStream()?this.startWriteStream():this.isNetworkEnabled()&&this.writeStream.handshakeComplete&&this.writeStream.writeMutations(e.mutations)},e.prototype.shouldStartWriteStream=function(){return this.isNetworkEnabled()&&!this.writeStream.isStarted()&&0<this.pendingWrites.length},e.prototype.startWriteStream=function(){assert$1(this.shouldStartWriteStream(),"startWriteStream() called when shouldStartWriteStream() is false."),this.writeStream.start({onOpen:this.onWriteStreamOpen.bind(this),onClose:this.onWriteStreamClose.bind(this),onHandshakeComplete:this.onWriteHandshakeComplete.bind(this),onMutationResult:this.onMutationResult.bind(this)})},e.prototype.onWriteStreamOpen=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return this.writeStream.writeHandshake(),[2]})})},e.prototype.onWriteHandshakeComplete=function(){var r=this;return this.localStore.setLastStreamToken(this.writeStream.lastStreamToken).then(function(){for(var e=0,t=r.pendingWrites;e<t.length;e++){var n=t[e];r.writeStream.writeMutations(n.mutations)}})},e.prototype.onMutationResult=function(e,t){var n=this;assert$1(0<this.pendingWrites.length,"Got result for empty pending writes");var r=this.pendingWrites.shift(),i=MutationBatchResult.from(r,e,t,this.writeStream.lastStreamToken);return this.syncEngine.applySuccessfulWrite(i).then(function(){return n.fillWritePipeline()})},e.prototype.onWriteStreamClose=function(n){return __awaiter(this,void 0,void 0,function(){var t=this;return __generator(this,function(e){return assert$1(this.isNetworkEnabled(),"onWriteStreamClose() should only be called when the network is enabled"),n&&0<this.pendingWrites.length?(assert$1(!!n,"We have pending writes, but the write stream closed without an error"),[2,(this.writeStream.handshakeComplete?this.handleWriteError(n):this.handleHandshakeError(n)).then(function(){t.shouldStartWriteStream()&&t.startWriteStream()})]):[2]})})},e.prototype.handleHandshakeError=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return isPermanentError(t.code)||t.code===Code.ABORTED?(debug(LOG_TAG$9,"RemoteStore error before completed handshake; resetting stream token: ",this.writeStream.lastStreamToken),this.writeStream.lastStreamToken=emptyByteString(),[2,this.localStore.setLastStreamToken(emptyByteString())]):[2]})})},e.prototype.handleWriteError=function(r){return __awaiter(this,void 0,void 0,function(){var t,n=this;return __generator(this,function(e){return isPermanentError(r.code)?(t=this.pendingWrites.shift(),this.writeStream.inhibitBackoff(),[2,this.syncEngine.rejectFailedWrite(t.batchId,r).then(function(){return n.fillWritePipeline()})]):[2]})})},e.prototype.createTransaction=function(){return new Transaction(this.datastore)},e.prototype.handleUserChange=function(e){if(debug(LOG_TAG$9,"RemoteStore changing users: uid=",e.uid),this.isNetworkEnabled())return this.disableNetworkInternal(),this.onlineStateTracker.set(OnlineState.Unknown),this.enableNetwork()},e}(),LOG_TAG$10="FirestoreClient",FirestoreClient=function(){function e(e,t,n,r){this.platform=e,this.databaseInfo=t,this.credentials=n,this.asyncQueue=r}return e.prototype.start=function(t){var n=this,r=new Deferred$1,i=new Deferred$1,o=!1;return this.credentials.setUserChangeListener(function(e){o?n.asyncQueue.enqueue(function(){return n.handleUserChange(e)}):(o=!0,n.initializePersistence(t,i).then(function(){return n.initializeRest(e)}).then(r.resolve,r.reject))}),this.asyncQueue.enqueue(function(){return r.promise}),i.promise},e.prototype.enableNetwork=function(){var e=this;return this.asyncQueue.enqueue(function(){return e.remoteStore.enableNetwork()})},e.prototype.initializePersistence=function(e,t){var n=this;return e?this.startIndexedDbPersistence().then(t.resolve).catch(function(e){return t.reject(e),n.canFallback(e)?(console.warn("Error enabling offline storage. Falling back to storage disabled: "+e),n.startMemoryPersistence()):Promise.reject(e)}):(t.resolve(),this.startMemoryPersistence())},e.prototype.canFallback=function(e){return e.code===Code.FAILED_PRECONDITION||e.code===Code.UNIMPLEMENTED},e.prototype.startIndexedDbPersistence=function(){this.garbageCollector=new NoOpGarbageCollector;var e=IndexedDbPersistence.buildStoragePrefix(this.databaseInfo),t=new JsonProtoSerializer(this.databaseInfo.databaseId,{useProto3Json:!0});return this.persistence=new IndexedDbPersistence(e,t),this.persistence.start()},e.prototype.startMemoryPersistence=function(){return this.garbageCollector=new EagerGarbageCollector,this.persistence=new MemoryPersistence,this.persistence.start()},e.prototype.initializeRest=function(r){var i=this;return this.platform.loadConnection(this.databaseInfo).then(function(e){i.localStore=new LocalStore(i.persistence,r,i.garbageCollector);var t=i.platform.newSerializer(i.databaseInfo.databaseId),n=new Datastore(i.asyncQueue,e,i.credentials,t);return i.remoteStore=new RemoteStore(i.localStore,n,i.asyncQueue,function(e){i.syncEngine.applyOnlineStateChange(e),i.eventMgr.applyOnlineStateChange(e)}),i.syncEngine=new SyncEngine(i.localStore,i.remoteStore,r),i.remoteStore.syncEngine=i.syncEngine,i.eventMgr=new EventManager(i.syncEngine),i.localStore.start()}).then(function(){return i.remoteStore.start()})},e.prototype.handleUserChange=function(e){return this.asyncQueue.verifyOperationInProgress(),debug(LOG_TAG$10,"User Changed: "+e.uid),this.syncEngine.handleUserChange(e)},e.prototype.disableNetwork=function(){var e=this;return this.asyncQueue.enqueue(function(){return e.remoteStore.disableNetwork()})},e.prototype.shutdown=function(e){var t=this;return this.asyncQueue.enqueue(function(){return t.credentials.removeUserChangeListener(),t.remoteStore.shutdown()}).then(function(){return t.persistence.shutdown(e&&e.purgePersistenceWithDataLoss)})},e.prototype.listen=function(e,t,n){var r=this,i=new QueryListener(e,t,n);return this.asyncQueue.enqueue(function(){return r.eventMgr.listen(i)}),i},e.prototype.unlisten=function(e){var t=this;this.asyncQueue.enqueue(function(){return t.eventMgr.unlisten(e)})},e.prototype.getDocumentFromLocalCache=function(e){var t=this;return this.asyncQueue.enqueue(function(){return t.localStore.readDocument(e)}).then(function(e){if(e instanceof Document)return e;throw new FirestoreError(Code.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")})},e.prototype.getDocumentsFromLocalCache=function(i){var e=this;return this.asyncQueue.enqueue(function(){return e.localStore.executeQuery(i)}).then(function(e){var t=documentKeySet(),n=new View$1(i,t),r=n.computeDocChanges(e);return n.applyChanges(r).snapshot})},e.prototype.write=function(e){var t=this,n=new Deferred$1;return this.asyncQueue.enqueue(function(){return t.syncEngine.write(e,n)}),n.promise},e.prototype.databaseId=function(){return this.databaseInfo.databaseId},e.prototype.transaction=function(e){var t=this;return this.asyncQueue.enqueue(function(){return __awaiter(t,void 0,void 0,function(){return __generator(this,function(e){return[2]})})}).then(function(){return t.syncEngine.runTransaction(e)})},e}(),AsyncObserver=function(){function e(e){this.observer=e,this.muted=!1}return e.prototype.next=function(e){this.scheduleEvent(this.observer.next,e)},e.prototype.error=function(e){this.scheduleEvent(this.observer.error,e)},e.prototype.mute=function(){this.muted=!0},e.prototype.scheduleEvent=function(e,t){var n=this;this.muted||setTimeout(function(){n.muted||e(t)},0)},e}(),User=function(){function e(e){this.uid=e}return e.prototype.isAuthenticated=function(){return null!=this.uid},e.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},e.prototype.isEqual=function(e){return e.uid===this.uid},e.UNAUTHENTICATED=new e(null),e.GOOGLE_CREDENTIALS=new e("google-credentials-uid"),e.FIRST_PARTY=new e("first-party-uid"),e}(),OAuthToken=function(e,t){this.user=t,this.type="OAuth",this.authHeaders={Authorization:"Bearer "+e}},EmptyCredentialsProvider=function(){function e(){this.userListener=null}return e.prototype.getToken=function(e){return Promise.resolve(null)},e.prototype.setUserChangeListener=function(e){assert$1(!this.userListener,"Can only call setUserChangeListener() once."),(this.userListener=e)(User.UNAUTHENTICATED)},e.prototype.removeUserChangeListener=function(){assert$1(null!==this.userListener,"removeUserChangeListener() when no listener registered"),this.userListener=null},e}(),FirebaseCredentialsProvider=function(){function e(e){var t=this;this.app=e,this.tokenListener=null,this.userCounter=0,this.userListener=null,this.tokenListener=function(){var e=t.getUser();t.currentUser&&e.isEqual(t.currentUser)||(t.currentUser=e,t.userCounter++,t.userListener&&t.userListener(t.currentUser))},this.userCounter=0,this.app.INTERNAL.addAuthTokenListener(this.tokenListener)}return e.prototype.getToken=function(e){var t=this;assert$1(null!=this.tokenListener,"getToken cannot be called after listener removed.");var n=this.userCounter;return this.app.INTERNAL.getToken(e).then(function(e){if(t.userCounter!==n)throw new FirestoreError(Code.ABORTED,"getToken aborted due to uid change.");return e?(assert$1("string"==typeof e.accessToken,"Invalid tokenData returned from getToken():"+e),new OAuthToken(e.accessToken,t.currentUser)):null})},e.prototype.setUserChangeListener=function(e){assert$1(!this.userListener,"Can only call setUserChangeListener() once."),this.userListener=e,this.currentUser&&e(this.currentUser)},e.prototype.removeUserChangeListener=function(){assert$1(null!=this.tokenListener,"removeUserChangeListener() called twice"),assert$1(null!==this.userListener,"removeUserChangeListener() called when no listener registered"),this.app.INTERNAL.removeAuthTokenListener(this.tokenListener),this.tokenListener=null,this.userListener=null},e.prototype.getUser=function(){"function"!=typeof this.app.INTERNAL.getUid&&fail("This version of the Firestore SDK requires at least version 3.7.0 of firebase.js.");var e=this.app.INTERNAL.getUid();return assert$1(null===e||"string"==typeof e,"Received invalid UID: "+e),new User(e)},e}(),FirstPartyToken=function(){function e(e,t){this.gapi=e,this.sessionIndex=t,this.type="FirstParty",this.user=User.FIRST_PARTY,assert$1(this.gapi&&this.gapi.auth&&this.gapi.auth.getAuthHeaderValueForFirstParty,"unexpected gapi interface")}return Object.defineProperty(e.prototype,"authHeaders",{get:function(){return{Authorization:this.gapi.auth.getAuthHeaderValueForFirstParty([]),"X-Goog-AuthUser":this.sessionIndex}},enumerable:!0,configurable:!0}),e}(),FirstPartyCredentialsProvider=function(){function e(e,t){this.gapi=e,this.sessionIndex=t,assert$1(this.gapi&&this.gapi.auth&&this.gapi.auth.getAuthHeaderValueForFirstParty,"unexpected gapi interface")}return e.prototype.getToken=function(e){return Promise.resolve(new FirstPartyToken(this.gapi,this.sessionIndex))},e.prototype.setUserChangeListener=function(e){e(User.FIRST_PARTY)},e.prototype.removeUserChangeListener=function(){},e}();function makeCredentialsProvider(e){if(!e)return new EmptyCredentialsProvider;switch(e.type){case"gapi":return new FirstPartyCredentialsProvider(e.client,e.sessionIndex||"0");case"provider":return e.client;default:throw new FirestoreError(Code.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}function isPartialObserver(e){return implementsAnyMethods$1(e,["next","error","complete"])}function implementsAnyMethods$1(e,t){if("object"!=typeof e||null===e)return!1;for(var n=e,r=0,i=t;r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}var FieldValueImpl=function(){function e(e){this.methodName=e}return e.delete=function(){return DeleteFieldValueImpl.instance},e.serverTimestamp=function(){return ServerTimestampFieldValueImpl.instance},e._arrayUnion=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return validateAtLeastNumberOfArgs("FieldValue.arrayUnion",arguments,1),new ArrayUnionFieldValueImpl(e)},e._arrayRemove=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return validateAtLeastNumberOfArgs("FieldValue.arrayRemove",arguments,1),new ArrayRemoveFieldValueImpl(e)},e.prototype.isEqual=function(e){return this===e},e}(),DeleteFieldValueImpl=function(e){function t(){return e.call(this,"FieldValue.delete")||this}return __extends(t,e),t.instance=new t,t}(FieldValueImpl),ServerTimestampFieldValueImpl=function(e){function t(){return e.call(this,"FieldValue.serverTimestamp")||this}return __extends(t,e),t.instance=new t,t}(FieldValueImpl),ArrayUnionFieldValueImpl=function(n){function e(e){var t=n.call(this,"FieldValue.arrayUnion")||this;return t._elements=e,t}return __extends(e,n),e}(FieldValueImpl),ArrayRemoveFieldValueImpl=function(n){function e(e){var t=n.call(this,"FieldValue.arrayRemove")||this;return t._elements=e,t}return __extends(e,n),e}(FieldValueImpl),PublicFieldValue=makeConstructorPrivate(FieldValueImpl,"Use FieldValue.<field>() instead."),RESERVED_FIELD_REGEX=/^__.*__$/,ParsedSetData=function(){function e(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}return e.prototype.toMutations=function(e,t){var n=[];return null!==this.fieldMask?n.push(new PatchMutation(e,this.data,this.fieldMask,t)):n.push(new SetMutation(e,this.data,t)),0<this.fieldTransforms.length&&n.push(new TransformMutation(e,this.fieldTransforms)),n},e}(),ParsedUpdateData=function(){function e(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}return e.prototype.toMutations=function(e,t){var n=[new PatchMutation(e,this.data,this.fieldMask,t)];return 0<this.fieldTransforms.length&&n.push(new TransformMutation(e,this.fieldTransforms)),n},e}(),UserDataSource,G0d;function isWrite(e){switch(e){case UserDataSource.Set:case UserDataSource.MergeSet:case UserDataSource.Update:return!0;case UserDataSource.Argument:return!1;default:throw fail("Unexpected case for UserDataSource: "+e)}}G0d=UserDataSource||(UserDataSource={}),G0d[G0d.Set=0]="Set",G0d[G0d.Update=1]="Update",G0d[G0d.MergeSet=2]="MergeSet",G0d[G0d.Argument=3]="Argument";var ParseContext=function(){function r(e,t,n,r,i,o){this.dataSource=e,this.methodName=t,this.path=n,this.arrayElement=r,void 0===i&&this.validatePath(),this.arrayElement=void 0!==r&&r,this.fieldTransforms=i||[],this.fieldMask=o||[]}return r.prototype.childContextForField=function(e){var t=null==this.path?null:this.path.child(e),n=new r(this.dataSource,this.methodName,t,!1,this.fieldTransforms,this.fieldMask);return n.validatePathSegment(e),n},r.prototype.childContextForFieldPath=function(e){var t=null==this.path?null:this.path.child(e),n=new r(this.dataSource,this.methodName,t,!1,this.fieldTransforms,this.fieldMask);return n.validatePath(),n},r.prototype.childContextForArray=function(e){return new r(this.dataSource,this.methodName,null,!0,this.fieldTransforms,this.fieldMask)},r.prototype.createError=function(e){var t=null===this.path||this.path.isEmpty()?"":" (found in field "+this.path.toString()+")";return new FirestoreError(Code.INVALID_ARGUMENT,"Function "+this.methodName+"() called with invalid data. "+e+t)},r.prototype.validatePath=function(){if(null!==this.path)for(var e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))},r.prototype.validatePathSegment=function(e){if(isWrite(this.dataSource)&&RESERVED_FIELD_REGEX.test(e))throw this.createError("Document fields cannot begin and end with __")},r}(),DocumentKeyReference=function(e,t){this.databaseId=e,this.key=t},UserDataConverter=function(){function e(e){this.preConverter=e}return e.prototype.parseSetData=function(e,t){var n=new ParseContext(UserDataSource.Set,e,FieldPath.EMPTY_PATH);validatePlainObject("Data must be an object, but it was:",n,t);var r=this.parseData(t,n);return new ParsedSetData(r,null,n.fieldTransforms)},e.prototype.parseMergeData=function(e,t,n){var r=new ParseContext(UserDataSource.MergeSet,e,FieldPath.EMPTY_PATH);validatePlainObject("Data must be an object, but it was:",r,t);var i,o,a=this.parseData(t,r);if(n){for(var s=[],u=0,c=n;u<c.length;u++){var l=c[u],h=void 0;if(l instanceof FieldPath$1?h=l:"string"==typeof l?h=fieldPathFromDotSeparatedString(e,l):fail("Expected stringOrFieldPath to be a string or a FieldPath"),!a.contains(h))throw new FirestoreError(Code.INVALID_ARGUMENT,"Field '"+h+"' is specified in your field mask but missing from your input data.");s.push(h)}i=new FieldMask(s),o=r.fieldTransforms.filter(function(e){return i.covers(e.field)})}else i=new FieldMask(r.fieldMask),o=r.fieldTransforms;return new ParsedSetData(a,i,o)},e.prototype.parseUpdateData=function(o,e){var a=this,s=new ParseContext(UserDataSource.Update,o,FieldPath.EMPTY_PATH);validatePlainObject("Data must be an object, but it was:",s,e);var u=[],c=ObjectValue.EMPTY;forEach$1(e,function(e,t){var n=fieldPathFromDotSeparatedString(o,e),r=s.childContextForFieldPath(n);if((t=a.runPreConverter(t,r))instanceof DeleteFieldValueImpl)u.push(n);else{var i=a.parseData(t,r);null!=i&&(u.push(n),c=c.set(n,i))}});var t=new FieldMask(u);return new ParsedUpdateData(c,t,s.fieldTransforms)},e.prototype.parseUpdateVarargs=function(e,t,n,r){var i=new ParseContext(UserDataSource.Update,e,FieldPath.EMPTY_PATH),o=[fieldPathFromArgument(e,t)],a=[n];if(r.length%2!=0)throw new FirestoreError(Code.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var s=0;s<r.length;s+=2)o.push(fieldPathFromArgument(e,r[s])),a.push(r[s+1]);var u=[],c=ObjectValue.EMPTY;for(s=0;s<o.length;++s){var l=o[s],h=i.childContextForFieldPath(l),f=this.runPreConverter(a[s],h);if(f instanceof DeleteFieldValueImpl)u.push(l);else{var d=this.parseData(f,h);null!=d&&(u.push(l),c=c.set(l,d))}}var p=new FieldMask(u);return new ParsedUpdateData(c,p,i.fieldTransforms)},e.prototype.parseQueryValue=function(e,t){var n=new ParseContext(UserDataSource.Argument,e,FieldPath.EMPTY_PATH),r=this.parseData(t,n);return assert$1(null!=r,"Parsed data should not be null."),assert$1(0===n.fieldTransforms.length,"Field transforms should have been disallowed."),r},e.prototype.runPreConverter=function(e,t){try{return this.preConverter(e)}catch(e){var n=errorMessage(e);throw t.createError(n)}},e.prototype.parseData=function(e,t){if(looksLikeJsonObject(e=this.runPreConverter(e,t)))return validatePlainObject("Unsupported field value:",t,e),this.parseObject(e,t);if(e instanceof FieldValueImpl)return this.parseSentinelFieldValue(e,t),null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.arrayElement)throw t.createError("Nested arrays are not supported");return this.parseArray(e,t)}return this.parseScalarValue(e,t)},e.prototype.parseObject=function(e,r){var i=this,o=new SortedMap$1(primitiveComparator);return forEach$1(e,function(e,t){var n=i.parseData(t,r.childContextForField(e));null!=n&&(o=o.insert(e,n))}),new ObjectValue(o)},e.prototype.parseArray=function(e,t){for(var n=[],r=0,i=0,o=e;i<o.length;i++){var a=o[i],s=this.parseData(a,t.childContextForArray(r));null==s&&(s=NullValue.INSTANCE),n.push(s),r++}return new ArrayValue(n)},e.prototype.parseSentinelFieldValue=function(e,t){if(!isWrite(t.dataSource))throw t.createError(e.methodName+"() can only be used with update() and set()");if(null===t.path)throw t.createError(e.methodName+"() is not currently supported inside arrays");if(e instanceof DeleteFieldValueImpl){if(t.dataSource!==UserDataSource.MergeSet)throw t.dataSource===UserDataSource.Update?(assert$1(0<t.path.length,"FieldValue.delete() at the top level should have already been handled."),t.createError("FieldValue.delete() can only appear at the top level of your update data")):t.createError("FieldValue.delete() cannot be used with set() unless you pass {merge:true}");t.fieldMask.push(t.path)}else if(e instanceof ServerTimestampFieldValueImpl)t.fieldTransforms.push(new FieldTransform(t.path,ServerTimestampTransform.instance));else if(e instanceof ArrayUnionFieldValueImpl){var n=this.parseArrayTransformElements(e.methodName,e._elements),r=new ArrayUnionTransformOperation(n);t.fieldTransforms.push(new FieldTransform(t.path,r))}else if(e instanceof ArrayRemoveFieldValueImpl){n=this.parseArrayTransformElements(e.methodName,e._elements);var i=new ArrayRemoveTransformOperation(n);t.fieldTransforms.push(new FieldTransform(t.path,i))}else fail("Unknown FieldValue type: "+e)},e.prototype.parseScalarValue=function(e,t){if(null===e)return NullValue.INSTANCE;if("number"==typeof e)return isSafeInteger(e)?new IntegerValue(e):new DoubleValue(e);if("boolean"==typeof e)return BooleanValue.of(e);if("string"==typeof e)return new StringValue(e);if(e instanceof Date)return new TimestampValue(Timestamp.fromDate(e));if(e instanceof Timestamp)return new TimestampValue(new Timestamp(e.seconds,1e3*Math.floor(e.nanoseconds/1e3)));if(e instanceof GeoPoint)return new GeoPointValue(e);if(e instanceof Blob$1)return new BlobValue(e);if(e instanceof DocumentKeyReference)return new RefValue(e.databaseId,e.key);throw t.createError("Unsupported field value: "+valueDescription(e))},e.prototype.parseArrayTransformElements=function(r,e){var i=this;return e.map(function(e,t){var n=new ParseContext(UserDataSource.Argument,r,FieldPath.EMPTY_PATH);return i.parseData(e,n.childContextForArray(t))})},e}();function looksLikeJsonObject(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Timestamp||e instanceof GeoPoint||e instanceof Blob$1||e instanceof DocumentKeyReference||e instanceof FieldValueImpl)}function validatePlainObject(e,t,n){if(!looksLikeJsonObject(n)||!isPlainObject(n)){var r=valueDescription(n);throw"an object"===r?t.createError(e+" a custom object"):t.createError(e+" "+r)}}function fieldPathFromArgument(e,t){if(t instanceof FieldPath$1)return t._internalPath;if("string"==typeof t)return fieldPathFromDotSeparatedString(e,t);throw new FirestoreError(Code.INVALID_ARGUMENT,"Function "+e+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function fieldPathFromDotSeparatedString(e,t){try{return fromDotSeparatedString(t)._internalPath}catch(t){var n=errorMessage(t);throw new FirestoreError(Code.INVALID_ARGUMENT,"Function "+e+"() called with invalid data. "+n)}}function errorMessage(e){return e instanceof Error?e.message:e.toString()}var DEFAULT_HOST="firestore.googleapis.com",DEFAULT_SSL=!0,DEFAULT_TIMESTAMPS_IN_SNAPSHOTS=!1,FirestoreSettings=function(){function e(e){if(void 0===e.host){if(void 0!==e.ssl)throw new FirestoreError(Code.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=DEFAULT_HOST,this.ssl=DEFAULT_SSL}else validateNamedType("settings","string","host",e.host),this.host=e.host,validateNamedOptionalType("settings","boolean","ssl",e.ssl),this.ssl=defaulted(e.ssl,DEFAULT_SSL);validateOptionNames("settings",e,["host","ssl","credentials","timestampsInSnapshots"]),validateNamedOptionalType("settings","object","credentials",e.credentials),this.credentials=e.credentials,validateNamedOptionalType("settings","boolean","timestampsInSnapshots",e.timestampsInSnapshots),this.timestampsInSnapshots=defaulted(e.timestampsInSnapshots,DEFAULT_TIMESTAMPS_IN_SNAPSHOTS)}return e.prototype.isEqual=function(e){return this.host===e.host&&this.ssl===e.ssl&&this.timestampsInSnapshots===e.timestampsInSnapshots&&this.credentials===e.credentials},e}(),FirestoreConfig=function(){},Firestore=function(){function o(e){var n=this;this._queue=new AsyncQueue,this.INTERNAL={delete:function(t){return __awaiter(n,void 0,void 0,function(){return __generator(this,function(e){return this._firestoreClient?[2,this._firestoreClient.shutdown(t)]:[2]})})}};var t=new FirestoreConfig;if("object"==typeof e.options){var r=e;t.firebaseApp=r,t.databaseId=o.databaseIdFromApp(r),t.persistenceKey=t.firebaseApp.name,t.credentials=new FirebaseCredentialsProvider(r)}else{var i=e;if(!i.projectId)throw new FirestoreError(Code.INVALID_ARGUMENT,"Must provide projectId");t.databaseId=new DatabaseId(i.projectId,i.database),t.persistenceKey="[DEFAULT]",t.credentials=new EmptyCredentialsProvider}t.settings=new FirestoreSettings({}),this._config=t,this._databaseId=t.databaseId}return o.prototype.settings=function(e){if(validateExactNumberOfArgs("Firestore.settings",arguments,1),validateArgType("Firestore.settings","object",1,e),contains$2(e,"persistence"))throw new FirestoreError(Code.INVALID_ARGUMENT,'"persistence" is now specified with a separate call to firestore.enablePersistence().');var t=new FirestoreSettings(e);if(this._firestoreClient&&!this._config.settings.isEqual(t))throw new FirestoreError(Code.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this._config.settings=t).credentials&&(this._config.credentials=makeCredentialsProvider(t.credentials))},o.prototype.enableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.enableNetwork()},o.prototype.disableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.disableNetwork()},o.prototype.enablePersistence=function(){if(this._firestoreClient)throw new FirestoreError(Code.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");return this.configureClient(!0)},o.prototype.ensureClientConfigured=function(){return this._firestoreClient||this.configureClient(!1),this._firestoreClient},o.prototype.configureClient=function(e){var r=this;assert$1(!!this._config.settings.host,"FirestoreSettings.host cannot be falsey"),this._config.settings.timestampsInSnapshots||error$2("\nThe behavior for Date objects stored in Firestore is going to change\nAND YOUR APP MAY BREAK.\nTo hide this warning and ensure your app does not break, you need to add the\nfollowing code to your app before calling any other Cloud Firestore methods:\n\n  const firestore = firebase.firestore();\n  const settings = {/* your settings... */ timestampsInSnapshots: true};\n  firestore.settings(settings);\n\nWith this change, timestamps stored in Cloud Firestore will be read back as\nFirebase Timestamp objects instead of as system Date objects. So you will also\nneed to update code expecting a Date to instead expect a Timestamp. For example:\n\n  // Old:\n  const date = snapshot.get('created_at');\n  // New:\n  const timestamp = snapshot.get('created_at');\n  const date = timestamp.toDate();\n\nPlease audit all existing usages of Date when you enable the new behavior. In a\nfuture release, the behavior will change to the new behavior, so if you do not\nfollow these steps, YOUR APP MAY BREAK."),assert$1(!this._firestoreClient,"configureClient() called multiple times");var t=new DatabaseInfo(this._config.databaseId,this._config.persistenceKey,this._config.settings.host,this._config.settings.ssl);return this._dataConverter=new UserDataConverter(function(e){if(e instanceof DocumentReference){var t=r._config.databaseId,n=e.firestore._config.databaseId;if(!n.isEqual(t))throw new FirestoreError(Code.INVALID_ARGUMENT,"Document reference is for database "+n.projectId+"/"+n.database+" but should be for database "+t.projectId+"/"+t.database);return new DocumentKeyReference(r._config.databaseId,e._key)}return e}),this._firestoreClient=new FirestoreClient(PlatformSupport.getPlatform(),t,this._config.credentials,this._queue),this._firestoreClient.start(e)},o.databaseIdFromApp=function(e){var t=e.options;if(!contains$2(t,"projectId")){if(contains$2(t,"firestoreId"))throw new FirestoreError(Code.INVALID_ARGUMENT,'"firestoreId" is now specified as "projectId" in firebase.initializeApp.');throw new FirestoreError(Code.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.')}if(contains$2(t,"firestoreOptions"))throw new FirestoreError(Code.INVALID_ARGUMENT,'"firestoreOptions" values are now specified with Firestore.settings()');var n=t.projectId;if(!n||"string"!=typeof n)throw new FirestoreError(Code.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new DatabaseId(n)},Object.defineProperty(o.prototype,"app",{get:function(){if(!this._config.firebaseApp)throw new FirestoreError(Code.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._config.firebaseApp},enumerable:!0,configurable:!0}),o.prototype.collection=function(e){if(validateExactNumberOfArgs("Firestore.collection",arguments,1),validateArgType("Firestore.collection","string",1,e),!e)throw new FirestoreError(Code.INVALID_ARGUMENT,"Must provide a non-empty collection path to collection()");return this.ensureClientConfigured(),new CollectionReference(ResourcePath.fromString(e),this)},o.prototype.doc=function(e){if(validateExactNumberOfArgs("Firestore.doc",arguments,1),validateArgType("Firestore.doc","string",1,e),!e)throw new FirestoreError(Code.INVALID_ARGUMENT,"Must provide a non-empty document path to doc()");return this.ensureClientConfigured(),DocumentReference.forPath(ResourcePath.fromString(e),this)},o.prototype.runTransaction=function(t){var n=this;return validateExactNumberOfArgs("Firestore.runTransaction",arguments,1),validateArgType("Firestore.runTransaction","function",1,t),this.ensureClientConfigured().transaction(function(e){return t(new Transaction$1(n,e))})},o.prototype.batch=function(){return this.ensureClientConfigured(),new WriteBatch(this)},Object.defineProperty(o,"logLevel",{get:function(){switch(getLogLevel()){case LogLevel$1.DEBUG:return"debug";case LogLevel$1.ERROR:return"error";case LogLevel$1.SILENT:return"silent";default:return fail("Unknown log level: "+getLogLevel())}},enumerable:!0,configurable:!0}),o.setLogLevel=function(e){switch(validateExactNumberOfArgs("Firestore.setLogLevel",arguments,1),validateArgType("Firestore.setLogLevel","string",1,e),e){case"debug":setLogLevel$1(LogLevel$1.DEBUG);break;case"error":setLogLevel$1(LogLevel$1.ERROR);break;case"silent":setLogLevel$1(LogLevel$1.SILENT);break;default:throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid log level: "+e)}},o.prototype._areTimestampsInSnapshotsEnabled=function(){return this._config.settings.timestampsInSnapshots},o}(),Transaction$1=function(){function e(e,t){this._firestore=e,this._transaction=t}return e.prototype.get=function(e){var n=this;validateExactNumberOfArgs("Transaction.get",arguments,1);var r=validateReference("Transaction.get",e,this._firestore);return this._transaction.lookup([r._key]).then(function(e){if(!e||1!==e.length)return fail("Mismatch in docs returned from document lookup.");var t=e[0];return new DocumentSnapshot(n._firestore,r._key,t instanceof NoDocument?null:t,!1)})},e.prototype.set=function(e,t,n){validateBetweenNumberOfArgs("Transaction.set",arguments,2,3);var r=validateReference("Transaction.set",e,this._firestore),i=(n=validateSetOptions("Transaction.set",n)).merge||n.mergeFields?this._firestore._dataConverter.parseMergeData("Transaction.set",t,n.mergeFields):this._firestore._dataConverter.parseSetData("Transaction.set",t);return this._transaction.set(r._key,i),this},e.prototype.update=function(e,t,n){for(var r,i,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return"string"==typeof t||t instanceof FieldPath$1?(validateAtLeastNumberOfArgs("Transaction.update",arguments,3),r=validateReference("Transaction.update",e,this._firestore),i=this._firestore._dataConverter.parseUpdateVarargs("Transaction.update",t,n,o)):(validateExactNumberOfArgs("Transaction.update",arguments,2),r=validateReference("Transaction.update",e,this._firestore),i=this._firestore._dataConverter.parseUpdateData("Transaction.update",t)),this._transaction.update(r._key,i),this},e.prototype.delete=function(e){validateExactNumberOfArgs("Transaction.delete",arguments,1);var t=validateReference("Transaction.delete",e,this._firestore);return this._transaction.delete(t._key),this},e}(),WriteBatch=function(){function e(e){this._firestore=e,this._mutations=[],this._committed=!1}return e.prototype.set=function(e,t,n){validateBetweenNumberOfArgs("WriteBatch.set",arguments,2,3),this.verifyNotCommitted();var r=validateReference("WriteBatch.set",e,this._firestore),i=(n=validateSetOptions("WriteBatch.set",n)).merge||n.mergeFields?this._firestore._dataConverter.parseMergeData("WriteBatch.set",t,n.mergeFields):this._firestore._dataConverter.parseSetData("WriteBatch.set",t);return this._mutations=this._mutations.concat(i.toMutations(r._key,Precondition.NONE)),this},e.prototype.update=function(e,t,n){for(var r,i,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return this.verifyNotCommitted(),"string"==typeof t||t instanceof FieldPath$1?(validateAtLeastNumberOfArgs("WriteBatch.update",arguments,3),r=validateReference("WriteBatch.update",e,this._firestore),i=this._firestore._dataConverter.parseUpdateVarargs("WriteBatch.update",t,n,o)):(validateExactNumberOfArgs("WriteBatch.update",arguments,2),r=validateReference("WriteBatch.update",e,this._firestore),i=this._firestore._dataConverter.parseUpdateData("WriteBatch.update",t)),this._mutations=this._mutations.concat(i.toMutations(r._key,Precondition.exists(!0))),this},e.prototype.delete=function(e){validateExactNumberOfArgs("WriteBatch.delete",arguments,1),this.verifyNotCommitted();var t=validateReference("WriteBatch.delete",e,this._firestore);return this._mutations=this._mutations.concat(new DeleteMutation(t._key,Precondition.NONE)),this},e.prototype.commit=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return this.verifyNotCommitted(),this._committed=!0,0<this._mutations.length?[2,this._firestore.ensureClientConfigured().write(this._mutations)]:[2]})})},e.prototype.verifyNotCommitted=function(){if(this._committed)throw new FirestoreError(Code.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},e}(),DocumentReference=function(){function n(e,t){this._key=e,this.firestore=t,this._firestoreClient=this.firestore.ensureClientConfigured()}return n.forPath=function(e,t){if(e.length%2!=0)throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new n(new DocumentKey(e),t)},Object.defineProperty(n.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"parent",{get:function(){return new CollectionReference(this._key.path.popLast(),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!0,configurable:!0}),n.prototype.collection=function(e){if(validateExactNumberOfArgs("DocumentReference.collection",arguments,1),validateArgType("DocumentReference.collection","string",1,e),!e)throw new FirestoreError(Code.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var t=ResourcePath.fromString(e);return new CollectionReference(this._key.path.child(t),this.firestore)},n.prototype.isEqual=function(e){if(!(e instanceof n))throw invalidClassError("isEqual","DocumentReference",1,e);return this.firestore===e.firestore&&this._key.isEqual(e._key)},n.prototype.set=function(e,t){validateBetweenNumberOfArgs("DocumentReference.set",arguments,1,2);var n=(t=validateSetOptions("DocumentReference.set",t)).merge||t.mergeFields?this.firestore._dataConverter.parseMergeData("DocumentReference.set",e,t.mergeFields):this.firestore._dataConverter.parseSetData("DocumentReference.set",e);return this._firestoreClient.write(n.toMutations(this._key,Precondition.NONE))},n.prototype.update=function(e,t){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return"string"==typeof e||e instanceof FieldPath$1?(validateAtLeastNumberOfArgs("DocumentReference.update",arguments,2),n=this.firestore._dataConverter.parseUpdateVarargs("DocumentReference.update",e,t,r)):(validateExactNumberOfArgs("DocumentReference.update",arguments,1),n=this.firestore._dataConverter.parseUpdateData("DocumentReference.update",e)),this._firestoreClient.write(n.toMutations(this._key,Precondition.exists(!0)))},n.prototype.delete=function(){return validateExactNumberOfArgs("DocumentReference.delete",arguments,0),this._firestoreClient.write([new DeleteMutation(this._key,Precondition.NONE)])},n.prototype.onSnapshot=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];validateBetweenNumberOfArgs("DocumentReference.onSnapshot",arguments,1,4);var n,r={includeMetadataChanges:!1},i=0;"object"!=typeof e[i]||isPartialObserver(e[i])||(validateOptionNames("DocumentReference.onSnapshot",r=e[i],["includeMetadataChanges"]),validateNamedOptionalType("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++);var o={includeMetadataChanges:r.includeMetadataChanges};return isPartialObserver(e[i])?n=e[i]:(validateArgType("DocumentReference.onSnapshot","function",i,e[i]),validateOptionalArgType("DocumentReference.onSnapshot","function",i+1,e[i+1]),validateOptionalArgType("DocumentReference.onSnapshot","function",i+2,e[i+2]),n={next:e[i],error:e[i+1],complete:e[i+2]}),this.onSnapshotInternal(o,n)},n.prototype.onSnapshotInternal=function(e,n){var r=this,t=function(e){console.error("Uncaught Error in onSnapshot:",e)};n.error&&(t=n.error.bind(n));var i=new AsyncObserver({next:function(e){if(n.next){assert$1(e.docs.size<=1,"Too many documents returned on a document query");var t=e.docs.get(r._key);n.next(new DocumentSnapshot(r.firestore,r._key,t,e.fromCache))}},error:t}),o=this._firestoreClient.listen(Query$1.atPath(this._key.path),i,e);return function(){i.mute(),r._firestoreClient.unlisten(o)}},n.prototype.get=function(n){var r=this;return validateOptionNames("DocumentReference.get",n,["source"]),n&&validateNamedOptionalPropertyEquals("DocumentReference.get","options","source",n.source,["default","server","cache"]),new Promise(function(t,e){n&&"cache"===n.source?r.firestore.ensureClientConfigured().getDocumentFromLocalCache(r._key).then(function(e){t(new DocumentSnapshot(r.firestore,r._key,e,!0))},e):r.getViaSnapshotListener(t,e,n)})},n.prototype.getViaSnapshotListener=function(t,n,r){var i=this.onSnapshotInternal({includeMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(e){i(),!e.exists&&e.metadata.fromCache?n(new FirestoreError(Code.UNAVAILABLE,"Failed to get document because the client is offline.")):e.exists&&e.metadata.fromCache&&r&&"server"===r.source?n(new FirestoreError(Code.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):t(e)},error:n})},n}(),SnapshotMetadata=function(){function e(e,t){this.hasPendingWrites=e,this.fromCache=t}return e.prototype.isEqual=function(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache},e}(),DocumentSnapshot=function(){function t(e,t,n,r){this._firestore=e,this._key=t,this._document=n,this._fromCache=r}return t.prototype.data=function(e){return validateBetweenNumberOfArgs("DocumentSnapshot.data",arguments,0,1),e=validateSnapshotOptions("DocumentSnapshot.data",e),this._document?this.convertObject(this._document.data,FieldValueOptions.fromSnapshotOptions(e,this._firestore._areTimestampsInSnapshotsEnabled())):void 0},t.prototype.get=function(e,t){if(validateBetweenNumberOfArgs("DocumentSnapshot.get",arguments,1,2),t=validateSnapshotOptions("DocumentSnapshot.get",t),this._document){var n=this._document.data.field(fieldPathFromArgument("DocumentSnapshot.get",e));if(void 0!==n)return this.convertValue(n,FieldValueOptions.fromSnapshotOptions(t,this._firestore._areTimestampsInSnapshotsEnabled()))}},Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new DocumentReference(this._key,this._firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return null!==this._document},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return new SnapshotMetadata(null!==this._document&&this._document.hasLocalMutations,this._fromCache)},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){if(!(e instanceof t))throw invalidClassError("isEqual","DocumentSnapshot",1,e);return this._firestore===e._firestore&&this._fromCache===e._fromCache&&this._key.isEqual(e._key)&&(null===this._document?null===e._document:this._document.isEqual(e._document))},t.prototype.convertObject=function(e,n){var r=this,i={};return e.forEach(function(e,t){i[e]=r.convertValue(t,n)}),i},t.prototype.convertValue=function(e,t){if(e instanceof ObjectValue)return this.convertObject(e,t);if(e instanceof ArrayValue)return this.convertArray(e,t);if(e instanceof RefValue){var n=e.value(t),r=this._firestore.ensureClientConfigured().databaseId();return e.databaseId.isEqual(r)||error$2("Document "+this._key.path+" contains a document reference within a different database ("+e.databaseId.projectId+"/"+e.databaseId.database+") which is not supported. It will be treated as a reference in the current database ("+r.projectId+"/"+r.database+") instead."),new DocumentReference(n,this._firestore)}return e.value(t)},t.prototype.convertArray=function(e,t){var n=this;return e.internalValue.map(function(e){return n.convertValue(e,t)})},t}(),QueryDocumentSnapshot=function(i){function e(e,t,n,r){return i.call(this,e,t,n,r)||this}return __extends(e,i),e.prototype.data=function(e){var t=i.prototype.data.call(this,e);return assert$1("object"==typeof t,"Document in a QueryDocumentSnapshot should exist"),t},e}(DocumentSnapshot),Query$1$1=function(){function c(e,t){this._query=e,this.firestore=t}return c.prototype.where=function(e,t,n){var r;validateExactNumberOfArgs("Query.where",arguments,3),validateArgType("Query.where","string",2,t),validateDefined("Query.where",3,n);var i=fieldPathFromArgument("Query.where",e),o=RelationOp.fromString(t);if(i.isKeyField()){if(o===RelationOp.ARRAY_CONTAINS)throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid Query. You can't perform array-contains queries on FieldPath.documentId() since document IDs are not arrays.");if("string"==typeof n){if(-1!==n.indexOf("/"))throw new FirestoreError(Code.INVALID_ARGUMENT,"Function Query.where() requires its third parameter to be a valid document ID if the first parameter is FieldPath.documentId(), but it contains a slash.");if(""===n)throw new FirestoreError(Code.INVALID_ARGUMENT,"Function Query.where() requires its third parameter to be a valid document ID if the first parameter is FieldPath.documentId(), but it was an empty string.");var a=this._query.path.child(new ResourcePath([n]));assert$1(a.length%2==0,"Path should be a document key"),r=new RefValue(this.firestore._databaseId,new DocumentKey(a))}else{if(!(n instanceof DocumentReference))throw new FirestoreError(Code.INVALID_ARGUMENT,"Function Query.where() requires its third parameter to be a string or a DocumentReference if the first parameter is FieldPath.documentId(), but it was: "+valueDescription(n)+".");var s=n;r=new RefValue(this.firestore._databaseId,s._key)}}else r=this.firestore._dataConverter.parseQueryValue("Query.where",n);var u=fieldFilter(i,o,r);return this.validateNewFilter(u),new c(this._query.addFilter(u),this.firestore)},c.prototype.orderBy=function(e,t){var n;if(validateBetweenNumberOfArgs("Query.orderBy",arguments,1,2),validateOptionalArgType("Query.orderBy","string",2,t),void 0===t||"asc"===t)n=Direction.ASCENDING;else{if("desc"!==t)throw new FirestoreError(Code.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+t+"', expected 'asc' or 'desc'.");n=Direction.DESCENDING}if(null!==this._query.startAt)throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this._query.endAt)throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var r=fieldPathFromArgument("Query.orderBy",e),i=new OrderBy(r,n);return this.validateNewOrderBy(i),new c(this._query.addOrderBy(i),this.firestore)},c.prototype.limit=function(e){if(validateExactNumberOfArgs("Query.limit",arguments,1),validateArgType("Query.limit","number",1,e),e<=0)throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid Query. Query limit ("+e+") is invalid. Limit must be positive.");return new c(this._query.withLimit(e),this.firestore)},c.prototype.startAt=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];validateAtLeastNumberOfArgs("Query.startAt",arguments,1);var r=this.boundFromDocOrFields("Query.startAt",e,t,!0);return new c(this._query.withStartAt(r),this.firestore)},c.prototype.startAfter=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];validateAtLeastNumberOfArgs("Query.startAfter",arguments,1);var r=this.boundFromDocOrFields("Query.startAfter",e,t,!1);return new c(this._query.withStartAt(r),this.firestore)},c.prototype.endBefore=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];validateAtLeastNumberOfArgs("Query.endBefore",arguments,1);var r=this.boundFromDocOrFields("Query.endBefore",e,t,!0);return new c(this._query.withEndAt(r),this.firestore)},c.prototype.endAt=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];validateAtLeastNumberOfArgs("Query.endAt",arguments,1);var r=this.boundFromDocOrFields("Query.endAt",e,t,!1);return new c(this._query.withEndAt(r),this.firestore)},c.prototype.isEqual=function(e){if(!(e instanceof c))throw invalidClassError("isEqual","Query",1,e);return this.firestore===e.firestore&&this._query.isEqual(e._query)},c.prototype.boundFromDocOrFields=function(e,t,n,r){if(validateDefined(e,1,t),t instanceof DocumentSnapshot){if(0<n.length)throw new FirestoreError(Code.INVALID_ARGUMENT,"Too many arguments provided to "+e+"().");var i=t;if(!i.exists)throw new FirestoreError(Code.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+e+"().");return this.boundFromDocument(e,i._document,r)}var o=[t].concat(n);return this.boundFromFields(e,o,r)},c.prototype.boundFromDocument=function(e,t,n){for(var r=[],i=0,o=this._query.orderBy;i<o.length;i++){var a=o[i];if(a.field.isKeyField())r.push(new RefValue(this.firestore._databaseId,t.key));else{var s=t.field(a.field);if(void 0===s){var u=a.field.canonicalString();throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}r.push(s)}}return new Bound(r,n)},c.prototype.boundFromFields=function(e,t,n){var r=this._query.explicitOrderBy;if(t.length>r.length)throw new FirestoreError(Code.INVALID_ARGUMENT,"Too many arguments provided to "+e+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var i=[],o=0;o<t.length;o++){var a=t[o];if(r[o].field.isKeyField()){if("string"!=typeof a)throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+e+"(), but got a "+typeof a);if(-1!==a.indexOf("/"))throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid query. Document ID '"+a+"' contains a slash in "+e+"()");var s=new DocumentKey(this._query.path.child(a));i.push(new RefValue(this.firestore._databaseId,s))}else{var u=this.firestore._dataConverter.parseQueryValue(e,a);i.push(u)}}return new Bound(i,n)},c.prototype.onSnapshot=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];validateBetweenNumberOfArgs("Query.onSnapshot",arguments,1,4);var n,r={},i=0;return"object"!=typeof e[i]||isPartialObserver(e[i])||(validateOptionNames("Query.onSnapshot",r=e[i],["includeMetadataChanges"]),validateNamedOptionalType("Query.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++),isPartialObserver(e[i])?n=e[i]:(validateArgType("Query.onSnapshot","function",i,e[i]),validateOptionalArgType("Query.onSnapshot","function",i+1,e[i+1]),validateOptionalArgType("Query.onSnapshot","function",i+2,e[i+2]),n={next:e[i],error:e[i+1],complete:e[i+2]}),this.onSnapshotInternal(r,n)},c.prototype.onSnapshotInternal=function(e,t){var n=this,r=function(e){console.error("Uncaught Error in onSnapshot:",e)};t.error&&(r=t.error.bind(t));var i=new AsyncObserver({next:function(e){t.next&&t.next(new QuerySnapshot(n.firestore,n._query,e))},error:r}),o=this.firestore.ensureClientConfigured(),a=o.listen(this._query,i,e);return function(){i.mute(),o.unlisten(a)}},c.prototype.get=function(n){var r=this;return validateBetweenNumberOfArgs("Query.get",arguments,0,1),new Promise(function(t,e){n&&"cache"===n.source?r.firestore.ensureClientConfigured().getDocumentsFromLocalCache(r._query).then(function(e){t(new QuerySnapshot(r.firestore,r._query,e))},e):r.getViaSnapshotListener(t,e,n)})},c.prototype.getViaSnapshotListener=function(t,n,r){var i=this.onSnapshotInternal({includeMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(e){i(),e.metadata.fromCache&&r&&"server"===r.source?n(new FirestoreError(Code.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):t(e)},error:n})},c.prototype.validateNewFilter=function(e){if(e instanceof RelationFilter&&e.isInequality()){var t=this._query.getInequalityFilterField();if(null!==t&&!t.isEqual(e.field))throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+t.toString()+"' and '"+e.field.toString()+"'");var n=this._query.getFirstOrderByField();null!==n&&this.validateOrderByAndInequalityMatch(e.field,n)}},c.prototype.validateNewOrderBy=function(e){if(null===this._query.getFirstOrderByField()){var t=this._query.getInequalityFilterField();null!==t&&this.validateOrderByAndInequalityMatch(t,e.field)}},c.prototype.validateOrderByAndInequalityMatch=function(e,t){if(!t.isEqual(e))throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+t.toString()+"' instead.")},c}(),QuerySnapshot=function(){function t(e,t,n){this._firestore=e,this._originalQuery=t,this._snapshot=n,this._cachedChanges=null,this._cachedChangesIncludeMetadataChanges=null,this.metadata=new SnapshotMetadata(n.hasPendingWrites,n.fromCache)}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._snapshot.docs.isEmpty()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t,n){var r=this;validateBetweenNumberOfArgs("QuerySnapshot.forEach",arguments,1,2),validateArgType("QuerySnapshot.forEach","function",1,t),this._snapshot.docs.forEach(function(e){t.call(n,r.convertToDocumentImpl(e))})},Object.defineProperty(t.prototype,"query",{get:function(){return new Query$1$1(this._originalQuery,this._firestore)},enumerable:!0,configurable:!0}),t.prototype.docChanges=function(e){validateOptionNames("QuerySnapshot.docChanges",e,["includeMetadataChanges"]),e&&validateNamedOptionalType("QuerySnapshot.docChanges","boolean","includeMetadataChanges",e.includeMetadataChanges);var t=e&&e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new FirestoreError(Code.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=changesFromSnapshot(this._firestore,t,this._snapshot),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges},t.prototype.isEqual=function(e){if(!(e instanceof t))throw invalidClassError("isEqual","QuerySnapshot",1,e);return this._firestore===e._firestore&&this._originalQuery.isEqual(e._originalQuery)&&this._snapshot.isEqual(e._snapshot)},t.prototype.convertToDocumentImpl=function(e){return new QueryDocumentSnapshot(this._firestore,e.key,e,this.metadata.fromCache)},t}();function throwDocChangesMethodError(){throw new FirestoreError(Code.INVALID_ARGUMENT,'QuerySnapshot.docChanges has been changed from a property into a method, so usages like "querySnapshot.docChanges" should become "querySnapshot.docChanges()"')}try{Object.defineProperty(QuerySnapshot.prototype.docChanges,"length",{get:function(){return throwDocChangesMethodError()}})}catch(e){}"undefined"!=typeof Symbol&&Object.defineProperty(QuerySnapshot.prototype.docChanges,Symbol.iterator,{get:function(){return throwDocChangesMethodError()}});var CollectionReference=function(r){function e(e,t){var n=r.call(this,Query$1.atPath(e),t)||this;if(e.length%2!=1)throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+e.canonicalString()+" has "+e.length);return n}return __extends(e,r),Object.defineProperty(e.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var e=this._query.path.popLast();return e.isEmpty()?null:new DocumentReference(new DocumentKey(e),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!0,configurable:!0}),e.prototype.doc=function(e){if(validateBetweenNumberOfArgs("CollectionReference.doc",arguments,0,1),0===arguments.length&&(e=AutoId.newId()),validateArgType("CollectionReference.doc","string",1,e),""===e)throw new FirestoreError(Code.INVALID_ARGUMENT,"Document path must be a non-empty string");var t=ResourcePath.fromString(e);return DocumentReference.forPath(this._query.path.child(t),this.firestore)},e.prototype.add=function(e){validateExactNumberOfArgs("CollectionReference.add",arguments,1),validateArgType("CollectionReference.add","object",1,e);var t=this.doc();return t.set(e).then(function(){return t})},e}(Query$1$1);function validateSetOptions(e,t){if(void 0===t)return{merge:!1};if(validateOptionNames(e,t,["merge","mergeFields"]),validateNamedOptionalType(e,"boolean","merge",t.merge),validateOptionalArrayElements(e,"mergeFields","a string or a FieldPath",t.mergeFields,function(e){return"string"==typeof e||e instanceof FieldPath$1}),void 0!==t.mergeFields&&void 0!==t.merge)throw new FirestoreError(Code.INVALID_ARGUMENT,"Invalid options passed to function "+e+'(): You cannot specify both "merge" and "mergeFields".');return t}function validateSnapshotOptions(e,t){return void 0===t?{}:(validateOptionNames(e,t,["serverTimestamps"]),validateNamedOptionalPropertyEquals(e,"options","serverTimestamps",t.serverTimestamps,["estimate","previous","none"]),t)}function validateReference(e,t,n){if(t instanceof DocumentReference){if(t.firestore!==n)throw new FirestoreError(Code.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}throw invalidClassError(e,"DocumentReference",1,t)}function changesFromSnapshot(i,t,o){if(o.oldDocs.isEmpty()){var n,r=0;return o.docChanges.map(function(e){var t=new QueryDocumentSnapshot(i,e.doc.key,e.doc,o.fromCache);return assert$1(e.type===ChangeType.Added,"Invalid event type for first snapshot"),assert$1(!n||o.query.docComparator(n,e.doc)<0,"Got added events in wrong order"),n=e.doc,{type:"added",doc:t,oldIndex:-1,newIndex:r++}})}var a=o.oldDocs;return o.docChanges.filter(function(e){return t||e.type!==ChangeType.Metadata}).map(function(e){var t=new QueryDocumentSnapshot(i,e.doc.key,e.doc,o.fromCache),n=-1,r=-1;return e.type!==ChangeType.Added&&(assert$1(0<=(n=a.indexOf(e.doc.key)),"Index for document not found"),a=a.delete(e.doc.key)),e.type!==ChangeType.Removed&&(r=(a=a.add(e.doc)).indexOf(e.doc.key)),{type:resultChangeType(e.type),doc:t,oldIndex:n,newIndex:r}})}function resultChangeType(e){switch(e){case ChangeType.Added:return"added";case ChangeType.Modified:case ChangeType.Metadata:return"modified";case ChangeType.Removed:return"removed";default:return fail("Unknown change type: "+e)}}var PublicFirestore=makeConstructorPrivate(Firestore,"Use firebase.firestore() instead."),PublicTransaction=makeConstructorPrivate(Transaction$1,"Use firebase.firestore().runTransaction() instead."),PublicWriteBatch=makeConstructorPrivate(WriteBatch,"Use firebase.firestore().batch() instead."),PublicDocumentReference=makeConstructorPrivate(DocumentReference,"Use firebase.firestore().doc() instead."),PublicDocumentSnapshot=makeConstructorPrivate(DocumentSnapshot),PublicQueryDocumentSnapshot=makeConstructorPrivate(QueryDocumentSnapshot),PublicQuery=makeConstructorPrivate(Query$1$1),PublicQuerySnapshot=makeConstructorPrivate(QuerySnapshot),PublicCollectionReference=makeConstructorPrivate(CollectionReference,"Use firebase.firestore().collection() instead."),firestoreNamespace={Firestore:PublicFirestore,GeoPoint:GeoPoint,Timestamp:Timestamp,Blob:PublicBlob,Transaction:PublicTransaction,WriteBatch:PublicWriteBatch,DocumentReference:PublicDocumentReference,DocumentSnapshot:PublicDocumentSnapshot,Query:PublicQuery,QueryDocumentSnapshot:PublicQueryDocumentSnapshot,QuerySnapshot:PublicQuerySnapshot,CollectionReference:PublicCollectionReference,FieldPath:FieldPath$1,FieldValue:PublicFieldValue,setLogLevel:Firestore.setLogLevel};function configureForFirebase(e){e.INTERNAL.registerService("firestore",function(e){return new Firestore(e)},shallowCopy(firestoreNamespace))}function registerFirestore(e){configureForFirebase(e)}registerFirestore(firebase);var extendStatics$1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};function __extends$1(e,t){function n(){this.constructor=e}extendStatics$1(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function __awaiter$1(o,a,s,u){return new(s||(s=Promise))(function(e,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function r(e){try{i(u.throw(e))}catch(e){t(e)}}function i(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(n,r)}i((u=u.apply(o,a||[])).next())})}function __generator$1(n,r){var i,o,a,e,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,o&&(a=o[2&t[0]?"return":t[0]?"throw":"next"])&&!(a=a.call(o,t[1])).done)return a;switch(o=0,a&&(t=[0,a.value]),t[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,o=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=r.call(n,s)}catch(e){t=[6,e],o=0}finally{i=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}}var errorCodeMap={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},HttpsErrorImpl=function(i){function o(e,t,n){var r=i.call(this,t)||this;return Object.setPrototypeOf(r,o.prototype),r.code=e,r.details=n,r}return __extends$1(o,i),o}(Error);function codeForHTTPStatus(e){if(200<=e&&e<300)return"ok";switch(e){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function _errorForResponse(e,t,n){var r=codeForHTTPStatus(e),i=r,o=void 0;try{var a=t.error;if(a){var s=a.status;if("string"==typeof s){if(!errorCodeMap[s])return new HttpsErrorImpl("internal","internal");r=errorCodeMap[s]}i=s;var u=a.message;"string"==typeof u&&(i=u),void 0!==(o=a.details)&&(o=n.decode(o))}}catch(e){}return"ok"===r?null:new HttpsErrorImpl(r,i,o)}var ContextProvider=function(){function e(e){this.app=e}return e.prototype.getAuthToken=function(){return __awaiter$1(this,void 0,void 0,function(){var t;return __generator$1(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.app.INTERNAL.getToken()];case 1:return(t=e.sent())?[2,t.accessToken]:[2,void 0];case 2:return e.sent(),[2,void 0];case 3:return[2]}})})},e.prototype.getInstanceIdToken=function(){return __awaiter$1(this,void 0,void 0,function(){var t;return __generator$1(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),this.app.messaging?[4,this.app.messaging().getToken()]:[2,void 0];case 1:return(t=e.sent())?[2,t]:[2,void 0];case 2:return e.sent(),[2,void 0];case 3:return[2]}})})},e.prototype.getContext=function(){return __awaiter$1(this,void 0,void 0,function(){var t,n;return __generator$1(this,function(e){switch(e.label){case 0:return[4,this.getAuthToken()];case 1:return t=e.sent(),[4,this.getInstanceIdToken()];case 2:return n=e.sent(),[2,{authToken:t,instanceIdToken:n}]}})})},e}(),LONG_TYPE="type.googleapis.com/google.protobuf.Int64Value",UNSIGNED_LONG_TYPE="type.googleapis.com/google.protobuf.UInt64Value";function mapValues(e,t){var n={};for(var r in e)e.hasOwnProperty(r)&&(n[r]=t(e[r]));return n}var Serializer=function(){function e(){}return e.prototype.encode=function(e){var t=this;if(null==e)return null;if(e instanceof Number&&(e=e.valueOf()),"number"==typeof e&&isFinite(e))return e;if(!0===e||!1===e)return e;if("[object String]"===toString.call(e))return e;if(Array.isArray(e))return e.map(function(e){return t.encode(e)});if("function"==typeof e||"object"==typeof e)return mapValues(e,function(e){return t.encode(e)});throw new Error("Data cannot be encoded in JSON: "+e)},e.prototype.decode=function(e){var t=this;if(null===e)return e;if(e["@type"])switch(e["@type"]){case LONG_TYPE:case UNSIGNED_LONG_TYPE:var n=parseFloat(e.value);if(isNaN(n))throw new Error("Data cannot be decoded from JSON: "+e);return n;default:throw new Error("Data cannot be decoded from JSON: "+e)}return Array.isArray(e)?e.map(function(e){return t.decode(e)}):"function"==typeof e||"object"==typeof e?mapValues(e,function(e){return t.decode(e)}):e},e}(),Service=function(){function e(e,t){void 0===t&&(t="us-central1"),this.app_=e,this.region_=t,this.serializer=new Serializer,this.contextProvider=new ContextProvider(e)}return Object.defineProperty(e.prototype,"app",{get:function(){return this.app_},enumerable:!0,configurable:!0}),e.prototype._url=function(e){var t=this.app_.options.projectId;return"https://"+this.region_+"-"+t+".cloudfunctions.net/"+e},e.prototype.httpsCallable=function(t){var n=this;return function(e){return n.call(t,e)}},e.prototype.postJSON=function(r,i,o){return __awaiter$1(this,void 0,void 0,function(){var t,n;return __generator$1(this,function(e){switch(e.label){case 0:o.append("Content-Type","application/json"),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,fetch(r,{method:"POST",body:JSON.stringify(i),headers:o})];case 2:return t=e.sent(),[3,4];case 3:return e.sent(),[2,{status:0,json:null}];case 4:n=null,e.label=5;case 5:return e.trys.push([5,7,,8]),[4,t.json()];case 6:return n=e.sent(),[3,8];case 7:return e.sent(),[3,8];case 8:return[2,{status:t.status,json:n}]}})})},e.prototype.call=function(u,c){return __awaiter$1(this,void 0,void 0,function(){var t,n,r,i,o,a,s;return __generator$1(this,function(e){switch(e.label){case 0:return t=this._url(u),c=this.serializer.encode(c),n={data:c},r=new Headers,[4,this.contextProvider.getContext()];case 1:return(i=e.sent()).authToken&&r.append("Authorization","Bearer "+i.authToken),i.instanceIdToken&&r.append("Firebase-Instance-ID-Token",i.instanceIdToken),[4,this.postJSON(t,n,r)];case 2:if(o=e.sent(),a=_errorForResponse(o.status,o.json,this.serializer))throw a;if(!o.json)throw new HttpsErrorImpl("internal","Response is not valid JSON object.");if(void 0===(s=o.json.data)&&(s=o.json.result),void 0===s)throw new HttpsErrorImpl("internal","Response is missing data field.");return[2,{data:this.serializer.decode(s)}]}})})},e}(),FUNCTIONS_TYPE="functions";function factory(e,t,n){return new Service(e,n)}function registerFunctions(e){var t={Functions:Service};e.INTERNAL.registerService(FUNCTIONS_TYPE,factory,t,void 0,!0)}registerFunctions(firebase);var ERROR_CODES={AVAILABLE_IN_WINDOW:"only-available-in-window",AVAILABLE_IN_SW:"only-available-in-sw",SHOULD_BE_INHERITED:"should-be-overriden",BAD_SENDER_ID:"bad-sender-id",INCORRECT_GCM_SENDER_ID:"incorrect-gcm-sender-id",PERMISSION_DEFAULT:"permission-default",PERMISSION_BLOCKED:"permission-blocked",UNSUPPORTED_BROWSER:"unsupported-browser",NOTIFICATIONS_BLOCKED:"notifications-blocked",FAILED_DEFAULT_REGISTRATION:"failed-serviceworker-registration",SW_REGISTRATION_EXPECTED:"sw-registration-expected",GET_SUBSCRIPTION_FAILED:"get-subscription-failed",INVALID_SAVED_TOKEN:"invalid-saved-token",SW_REG_REDUNDANT:"sw-reg-redundant",TOKEN_SUBSCRIBE_FAILED:"token-subscribe-failed",TOKEN_SUBSCRIBE_NO_TOKEN:"token-subscribe-no-token",TOKEN_SUBSCRIBE_NO_PUSH_SET:"token-subscribe-no-push-set",TOKEN_UNSUBSCRIBE_FAILED:"token-unsubscribe-failed",TOKEN_UPDATE_FAILED:"token-update-failed",TOKEN_UPDATE_NO_TOKEN:"token-update-no-token",USE_SW_BEFORE_GET_TOKEN:"use-sw-before-get-token",INVALID_DELETE_TOKEN:"invalid-delete-token",DELETE_TOKEN_NOT_FOUND:"delete-token-not-found",DELETE_SCOPE_NOT_FOUND:"delete-scope-not-found",BG_HANDLER_FUNCTION_EXPECTED:"bg-handler-function-expected",NO_WINDOW_CLIENT_TO_MSG:"no-window-client-to-msg",UNABLE_TO_RESUBSCRIBE:"unable-to-resubscribe",NO_FCM_TOKEN_FOR_RESUBSCRIBE:"no-fcm-token-for-resubscribe",FAILED_TO_DELETE_TOKEN:"failed-to-delete-token",NO_SW_IN_REG:"no-sw-in-reg",BAD_SCOPE:"bad-scope",BAD_VAPID_KEY:"bad-vapid-key",BAD_SUBSCRIPTION:"bad-subscription",BAD_TOKEN:"bad-token",BAD_PUSH_SET:"bad-push-set",FAILED_DELETE_VAPID_KEY:"failed-delete-vapid-key",INVALID_PUBLIC_VAPID_KEY:"invalid-public-vapid-key",USE_PUBLIC_KEY_BEFORE_GET_TOKEN:"use-public-key-before-get-token",PUBLIC_KEY_DECRYPTION_FAILED:"public-vapid-key-decryption-failed"},ERROR_MAP=(_a={},_a[ERROR_CODES.AVAILABLE_IN_WINDOW]="This method is available in a Window context.",_a[ERROR_CODES.AVAILABLE_IN_SW]="This method is available in a service worker context.",_a[ERROR_CODES.SHOULD_BE_INHERITED]="This method should be overriden by extended classes.",_a[ERROR_CODES.BAD_SENDER_ID]="Please ensure that 'messagingSenderId' is set correctly in the options passed into firebase.initializeApp().",_a[ERROR_CODES.PERMISSION_DEFAULT]="The required permissions were not granted and dismissed instead.",_a[ERROR_CODES.PERMISSION_BLOCKED]="The required permissions were not granted and blocked instead.",_a[ERROR_CODES.UNSUPPORTED_BROWSER]="This browser doesn't support the API's required to use the firebase SDK.",_a[ERROR_CODES.NOTIFICATIONS_BLOCKED]="Notifications have been blocked.",_a[ERROR_CODES.FAILED_DEFAULT_REGISTRATION]="We are unable to register the default service worker. {$browserErrorMessage}",_a[ERROR_CODES.SW_REGISTRATION_EXPECTED]="A service worker registration was the expected input.",_a[ERROR_CODES.GET_SUBSCRIPTION_FAILED]="There was an error when trying to get any existing Push Subscriptions.",_a[ERROR_CODES.INVALID_SAVED_TOKEN]="Unable to access details of the saved token.",_a[ERROR_CODES.SW_REG_REDUNDANT]="The service worker being used for push was made redundant.",_a[ERROR_CODES.TOKEN_SUBSCRIBE_FAILED]="A problem occured while subscribing the user to FCM: {$message}",_a[ERROR_CODES.TOKEN_SUBSCRIBE_NO_TOKEN]="FCM returned no token when subscribing the user to push.",_a[ERROR_CODES.TOKEN_SUBSCRIBE_NO_PUSH_SET]="FCM returned an invalid response when getting an FCM token.",_a[ERROR_CODES.TOKEN_UNSUBSCRIBE_FAILED]="A problem occured while unsubscribing the user from FCM: {$message}",_a[ERROR_CODES.TOKEN_UPDATE_FAILED]="A problem occured while updating the user from FCM: {$message}",_a[ERROR_CODES.TOKEN_UPDATE_NO_TOKEN]="FCM returned no token when updating the user to push.",_a[ERROR_CODES.USE_SW_BEFORE_GET_TOKEN]="The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",_a[ERROR_CODES.INVALID_DELETE_TOKEN]="You must pass a valid token into deleteToken(), i.e. the token from getToken().",_a[ERROR_CODES.DELETE_TOKEN_NOT_FOUND]="The deletion attempt for token could not be performed as the token was not found.",_a[ERROR_CODES.DELETE_SCOPE_NOT_FOUND]="The deletion attempt for service worker scope could not be performed as the scope was not found.",_a[ERROR_CODES.BG_HANDLER_FUNCTION_EXPECTED]="The input to setBackgroundMessageHandler() must be a function.",_a[ERROR_CODES.NO_WINDOW_CLIENT_TO_MSG]="An attempt was made to message a non-existant window client.",_a[ERROR_CODES.UNABLE_TO_RESUBSCRIBE]="There was an error while re-subscribing the FCM token for push messaging. Will have to resubscribe the user on next visit. {$message}",_a[ERROR_CODES.NO_FCM_TOKEN_FOR_RESUBSCRIBE]="Could not find an FCM token and as a result, unable to resubscribe. Will have to resubscribe the user on next visit.",_a[ERROR_CODES.FAILED_TO_DELETE_TOKEN]="Unable to delete the currently saved token.",_a[ERROR_CODES.NO_SW_IN_REG]="Even though the service worker registration was successful, there was a problem accessing the service worker itself.",_a[ERROR_CODES.INCORRECT_GCM_SENDER_ID]="Please change your web app manifest's 'gcm_sender_id' value to '103953800507' to use Firebase messaging.",_a[ERROR_CODES.BAD_SCOPE]="The service worker scope must be a string with at least one character.",_a[ERROR_CODES.BAD_VAPID_KEY]="The public VAPID key is not a Uint8Array with 65 bytes.",_a[ERROR_CODES.BAD_SUBSCRIPTION]="The subscription must be a valid PushSubscription.",_a[ERROR_CODES.BAD_TOKEN]="The FCM Token used for storage / lookup was not a valid token string.",_a[ERROR_CODES.BAD_PUSH_SET]="The FCM push set used for storage / lookup was not not a valid push set string.",_a[ERROR_CODES.FAILED_DELETE_VAPID_KEY]="The VAPID key could not be deleted.",_a[ERROR_CODES.INVALID_PUBLIC_VAPID_KEY]="The public VAPID key must be a string.",_a[ERROR_CODES.PUBLIC_KEY_DECRYPTION_FAILED]="The public VAPID key did not equal 65 bytes when decrypted.",_a),errorFactory=new ErrorFactory("messaging","Messaging",ERROR_MAP),_a,DEFAULT_PUBLIC_VAPID_KEY=new Uint8Array([4,51,148,247,223,161,235,177,220,3,162,94,21,113,219,72,211,46,237,237,178,52,219,183,71,58,12,143,196,204,225,111,60,140,132,223,171,182,102,62,242,12,212,139,254,227,249,118,47,20,28,99,8,106,111,45,177,26,149,176,206,55,192,156,110]),ENDPOINT="https://fcm.googleapis.com",MessageParameter,MessageType,bae,aae;function isArrayBufferEqual(e,t){if(null==e||null==t)return!1;if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(var n=new DataView(e),r=new DataView(t),i=0;i<e.byteLength;i++)if(n.getUint8(i)!==r.getUint8(i))return!1;return!0}function toBase64(e){var t=new Uint8Array(e);return btoa(String.fromCharCode.apply(null,t))}function arrayBufferToBase64(e){return toBase64(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}aae=MessageParameter||(MessageParameter={}),aae.TYPE_OF_MSG="firebase-messaging-msg-type",aae.DATA="firebase-messaging-msg-data",bae=MessageType||(MessageType={}),bae.PUSH_MSG_RECEIVED="push-msg-received",bae.NOTIFICATION_CLICKED="notification-clicked";var IidModel=function(){function e(){}return e.prototype.getToken=function(c,l,h){return __awaiter(this,void 0,void 0,function(){var t,n,r,i,o,a,s,u;return __generator(this,function(e){switch(e.label){case 0:t=arrayBufferToBase64(l.getKey("p256dh")),n=arrayBufferToBase64(l.getKey("auth")),r="authorized_entity="+c+"&endpoint="+l.endpoint+"&encryption_key="+t+"&encryption_auth="+n,h!==DEFAULT_PUBLIC_VAPID_KEY&&(i=arrayBufferToBase64(h),r+="&application_pub_key="+i),(o=new Headers).append("Content-Type","application/x-www-form-urlencoded"),a={method:"POST",headers:o,body:r},e.label=1;case 1:return e.trys.push([1,4,,5]),[4,fetch(ENDPOINT+"/fcm/connect/subscribe",a)];case 2:return[4,e.sent().json()];case 3:return s=e.sent(),[3,5];case 4:throw e.sent(),errorFactory.create(ERROR_CODES.TOKEN_SUBSCRIBE_FAILED);case 5:if(s.error)throw u=s.error.message,errorFactory.create(ERROR_CODES.TOKEN_SUBSCRIBE_FAILED,{message:u});if(!s.token)throw errorFactory.create(ERROR_CODES.TOKEN_SUBSCRIBE_NO_TOKEN);if(!s.pushSet)throw errorFactory.create(ERROR_CODES.TOKEN_SUBSCRIBE_NO_PUSH_SET);return[2,{token:s.token,pushSet:s.pushSet}]}})})},e.prototype.updateToken=function(c,l,h,f,d){return __awaiter(this,void 0,void 0,function(){var t,n,r,i,o,a,s,u;return __generator(this,function(e){switch(e.label){case 0:t=arrayBufferToBase64(f.getKey("p256dh")),n=arrayBufferToBase64(f.getKey("auth")),r="push_set="+h+"&token="+l+"&authorized_entity="+c+"&endpoint="+f.endpoint+"&encryption_key="+t+"&encryption_auth="+n,d!==DEFAULT_PUBLIC_VAPID_KEY&&(i=arrayBufferToBase64(d),r+="&application_pub_key="+i),(o=new Headers).append("Content-Type","application/x-www-form-urlencoded"),a={method:"POST",headers:o,body:r},e.label=1;case 1:return e.trys.push([1,4,,5]),[4,fetch(ENDPOINT+"/fcm/connect/subscribe",a)];case 2:return[4,e.sent().json()];case 3:return s=e.sent(),[3,5];case 4:throw e.sent(),errorFactory.create(ERROR_CODES.TOKEN_UPDATE_FAILED);case 5:if(s.error)throw u=s.error.message,errorFactory.create(ERROR_CODES.TOKEN_UPDATE_FAILED,{message:u});if(!s.token)throw errorFactory.create(ERROR_CODES.TOKEN_UPDATE_NO_TOKEN);return[2,s.token]}})})},e.prototype.deleteToken=function(a,s,u){return __awaiter(this,void 0,void 0,function(){var t,n,r,i,o;return __generator(this,function(e){switch(e.label){case 0:t="authorized_entity="+a+"&token="+s+"&pushSet="+u,(n=new Headers).append("Content-Type","application/x-www-form-urlencoded"),r={method:"POST",headers:n,body:t},e.label=1;case 1:return e.trys.push([1,4,,5]),[4,fetch(ENDPOINT+"/fcm/connect/unsubscribe",r)];case 2:return[4,e.sent().json()];case 3:if((i=e.sent()).error)throw o=i.error.message,errorFactory.create(ERROR_CODES.TOKEN_UNSUBSCRIBE_FAILED,{message:o});return[3,5];case 4:throw e.sent(),errorFactory.create(ERROR_CODES.TOKEN_UNSUBSCRIBE_FAILED);case 5:return[2]}})})},e}();function base64ToArrayBuffer(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(t),r=new Uint8Array(n.length),i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}var OLD_DB_NAME="undefined",OLD_OBJECT_STORE_NAME="fcm_token_object_Store";function handleDb(n){if(n.objectStoreNames.contains(OLD_OBJECT_STORE_NAME)){var e=n.transaction(OLD_OBJECT_STORE_NAME).objectStore(OLD_OBJECT_STORE_NAME),r=new IidModel,i=e.openCursor();i.onerror=function(e){console.warn("Unable to cleanup old IDB.",e)},i.onsuccess=function(){var e=i.result;if(e){var t=e.value;r.deleteToken(t.fcmSenderId,t.fcmToken,t.fcmPushSet),e.continue()}else n.close(),indexedDB.deleteDatabase(OLD_DB_NAME)}}}function cleanV1(){var t=indexedDB.open(OLD_DB_NAME);t.onerror=function(e){},t.onsuccess=function(e){handleDb(t.result)}}var DbInterface=function(){function e(){this.dbPromise=null}return e.prototype.get=function(t){return this.createTransaction(function(e){return e.get(t)})},e.prototype.getIndex=function(t,n){return this.createTransaction(function(e){return e.index(t).get(n)})},e.prototype.put=function(t){return this.createTransaction(function(e){return e.put(t)},"readwrite")},e.prototype.delete=function(t){return this.createTransaction(function(e){return e.delete(t)},"readwrite")},e.prototype.closeDatabase=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return this.dbPromise?[4,this.dbPromise]:[3,2];case 1:e.sent().close(),this.dbPromise=null,e.label=2;case 2:return[2]}})})},e.prototype.createTransaction=function(o,a){return void 0===a&&(a="readonly"),__awaiter(this,void 0,void 0,function(){var t,n,r,i;return __generator(this,function(e){switch(e.label){case 0:return[4,this.getDb()];case 1:return t=e.sent(),n=t.transaction(this.objectStoreName,a),r=n.objectStore(this.objectStoreName),[4,promisify(o(r))];case 2:return i=e.sent(),[2,new Promise(function(e,t){n.oncomplete=function(){e(i)},n.onerror=function(){t(n.error)}})]}})})},e.prototype.getDb=function(){var r=this;return this.dbPromise||(this.dbPromise=new Promise(function(e,t){var n=indexedDB.open(r.dbName,r.dbVersion);n.onsuccess=function(){e(n.result)},n.onerror=function(){r.dbPromise=null,t(n.error)},n.onupgradeneeded=function(e){return r.onDbUpgrade(n,e)}})),this.dbPromise},e}();function promisify(n){return new Promise(function(e,t){n.onsuccess=function(){e(n.result)},n.onerror=function(){t(n.error)}})}var TokenDetailsModel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dbName="fcm_token_details_db",e.dbVersion=3,e.objectStoreName="fcm_token_object_Store",e}return __extends(e,t),e.prototype.onDbUpgrade=function(e,t){var n=e.result;switch(t.oldVersion){case 0:(r=n.createObjectStore(this.objectStoreName,{keyPath:"swScope"})).createIndex("fcmSenderId","fcmSenderId",{unique:!1}),r.createIndex("fcmToken","fcmToken",{unique:!0});case 1:cleanV1();case 2:var r,i=(r=e.transaction.objectStore(this.objectStoreName)).openCursor();i.onsuccess=function(){var e=i.result;if(e){var t=e.value,n=__assign({},t);t.createTime||(n.createTime=Date.now()),"string"==typeof t.vapidKey&&(n.vapidKey=base64ToArrayBuffer(t.vapidKey)),"string"==typeof t.auth&&(n.auth=base64ToArrayBuffer(t.auth).buffer),"string"==typeof t.auth&&(n.p256dh=base64ToArrayBuffer(t.p256dh).buffer),e.update(n),e.continue()}}}},e.prototype.getTokenDetailsFromToken=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){if(!t)throw errorFactory.create(ERROR_CODES.BAD_TOKEN);return validateInputs({fcmToken:t}),[2,this.getIndex("fcmToken",t)]})})},e.prototype.getTokenDetailsFromSWScope=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){if(!t)throw errorFactory.create(ERROR_CODES.BAD_SCOPE);return validateInputs({swScope:t}),[2,this.get(t)]})})},e.prototype.saveTokenDetails=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){if(!t.swScope)throw errorFactory.create(ERROR_CODES.BAD_SCOPE);if(!t.vapidKey)throw errorFactory.create(ERROR_CODES.BAD_VAPID_KEY);if(!t.endpoint||!t.auth||!t.p256dh)throw errorFactory.create(ERROR_CODES.BAD_SUBSCRIPTION);if(!t.fcmSenderId)throw errorFactory.create(ERROR_CODES.BAD_SENDER_ID);if(!t.fcmToken)throw errorFactory.create(ERROR_CODES.BAD_TOKEN);if(!t.fcmPushSet)throw errorFactory.create(ERROR_CODES.BAD_PUSH_SET);return validateInputs(t),[2,this.put(t)]})})},e.prototype.deleteToken=function(n){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return"string"!=typeof n||0===n.length?[2,Promise.reject(errorFactory.create(ERROR_CODES.INVALID_DELETE_TOKEN))]:[4,this.getTokenDetailsFromToken(n)];case 1:if(!(t=e.sent()))throw errorFactory.create(ERROR_CODES.DELETE_TOKEN_NOT_FOUND);return[4,this.delete(t.swScope)];case 2:return e.sent(),[2,t]}})})},e}(DbInterface);function validateInputs(e){if(e.fcmToken&&("string"!=typeof e.fcmToken||0===e.fcmToken.length))throw errorFactory.create(ERROR_CODES.BAD_TOKEN);if(e.swScope&&("string"!=typeof e.swScope||0===e.swScope.length))throw errorFactory.create(ERROR_CODES.BAD_SCOPE);if(e.vapidKey&&(!(e.vapidKey instanceof Uint8Array)||65!==e.vapidKey.length))throw errorFactory.create(ERROR_CODES.BAD_VAPID_KEY);if(e.endpoint&&("string"!=typeof e.endpoint||0===e.endpoint.length))throw errorFactory.create(ERROR_CODES.BAD_SUBSCRIPTION);if(e.auth&&!(e.auth instanceof ArrayBuffer))throw errorFactory.create(ERROR_CODES.BAD_SUBSCRIPTION);if(e.p256dh&&!(e.p256dh instanceof ArrayBuffer))throw errorFactory.create(ERROR_CODES.BAD_SUBSCRIPTION);if(e.fcmSenderId&&("string"!=typeof e.fcmSenderId||0===e.fcmSenderId.length))throw errorFactory.create(ERROR_CODES.BAD_SENDER_ID);if(e.fcmPushSet&&("string"!=typeof e.fcmPushSet||0===e.fcmPushSet.length))throw errorFactory.create(ERROR_CODES.BAD_PUSH_SET)}var UNCOMPRESSED_PUBLIC_KEY_SIZE=65,VapidDetailsModel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dbName="fcm_vapid_details_db",e.dbVersion=1,e.objectStoreName="fcm_vapid_object_Store",e}return __extends(e,t),e.prototype.onDbUpgrade=function(e){e.result.createObjectStore(this.objectStoreName,{keyPath:"swScope"})},e.prototype.getVapidFromSWScope=function(n){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:if("string"!=typeof n||0===n.length)throw errorFactory.create(ERROR_CODES.BAD_SCOPE);return[4,this.get(n)];case 1:return[2,(t=e.sent())?t.vapidKey:void 0]}})})},e.prototype.saveVapidDetails=function(n,r){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){if("string"!=typeof n||0===n.length)throw errorFactory.create(ERROR_CODES.BAD_SCOPE);if(null===r||r.length!==UNCOMPRESSED_PUBLIC_KEY_SIZE)throw errorFactory.create(ERROR_CODES.BAD_VAPID_KEY);return t={swScope:n,vapidKey:r},[2,this.put(t)]})})},e.prototype.deleteVapidDetails=function(n){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return[4,this.getVapidFromSWScope(n)];case 1:if(!(t=e.sent()))throw errorFactory.create(ERROR_CODES.DELETE_SCOPE_NOT_FOUND);return[4,this.delete(n)];case 2:return e.sent(),[2,t]}})})},e}(DbInterface),SENDER_ID_OPTION_NAME="messagingSenderId",TOKEN_EXPIRATION_MILLIS=6048e5,ControllerInterface=function(){function e(e){var t=this;if(!e.options[SENDER_ID_OPTION_NAME]||"string"!=typeof e.options[SENDER_ID_OPTION_NAME])throw errorFactory.create(ERROR_CODES.BAD_SENDER_ID);this.messagingSenderId=e.options[SENDER_ID_OPTION_NAME],this.tokenDetailsModel=new TokenDetailsModel,this.vapidDetailsModel=new VapidDetailsModel,this.iidModel=new IidModel,this.app=e,this.INTERNAL={delete:function(){return t.delete()}}}return e.prototype.getToken=function(){return __awaiter(this,void 0,void 0,function(){var t,n,r,i,o;return __generator(this,function(e){switch(e.label){case 0:if("denied"===(t=this.getNotificationPermission_()))throw errorFactory.create(ERROR_CODES.NOTIFICATIONS_BLOCKED);return"granted"!==t?[2,null]:[4,this.getSWRegistration_()];case 1:return n=e.sent(),[4,this.getPublicVapidKey_()];case 2:return r=e.sent(),[4,this.getPushSubscription(n,r)];case 3:return i=e.sent(),[4,this.tokenDetailsModel.getTokenDetailsFromSWScope(n.scope)];case 4:return(o=e.sent())?[2,this.manageExistingToken(n,i,r,o)]:[2,this.getNewToken(n,i,r)]}})})},e.prototype.manageExistingToken=function(t,n,r,i){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return isTokenStillValid(n,r,i)?Date.now()<i.createTime+TOKEN_EXPIRATION_MILLIS?[2,i.fcmToken]:[2,this.updateToken(t,n,r,i)]:[4,this.deleteTokenFromDB(i.fcmToken)];case 1:return e.sent(),[2,this.getNewToken(t,n,r)]}})})},e.prototype.updateToken=function(i,o,a,s){return __awaiter(this,void 0,void 0,function(){var t,n,r;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,4,,6]),[4,this.iidModel.updateToken(this.messagingSenderId,s.fcmToken,s.fcmPushSet,o,a)];case 1:return t=e.sent(),n={swScope:i.scope,vapidKey:a,fcmSenderId:this.messagingSenderId,fcmToken:t,fcmPushSet:s.fcmPushSet,createTime:Date.now(),endpoint:o.endpoint,auth:o.getKey("auth"),p256dh:o.getKey("p256dh")},[4,this.tokenDetailsModel.saveTokenDetails(n)];case 2:return e.sent(),[4,this.vapidDetailsModel.saveVapidDetails(i.scope,a)];case 3:return e.sent(),[2,t];case 4:return r=e.sent(),[4,this.deleteToken(s.fcmToken)];case 5:throw e.sent(),r;case 6:return[2]}})})},e.prototype.getNewToken=function(r,i,o){return __awaiter(this,void 0,void 0,function(){var t,n;return __generator(this,function(e){switch(e.label){case 0:return[4,this.iidModel.getToken(this.messagingSenderId,i,o)];case 1:return t=e.sent(),n={swScope:r.scope,vapidKey:o,fcmSenderId:this.messagingSenderId,fcmToken:t.token,fcmPushSet:t.pushSet,createTime:Date.now(),endpoint:i.endpoint,auth:i.getKey("auth"),p256dh:i.getKey("p256dh")},[4,this.tokenDetailsModel.saveTokenDetails(n)];case 2:return e.sent(),[4,this.vapidDetailsModel.saveVapidDetails(r.scope,o)];case 3:return e.sent(),[2,t.token]}})})},e.prototype.deleteToken=function(r){return __awaiter(this,void 0,void 0,function(){var t,n;return __generator(this,function(e){switch(e.label){case 0:return[4,this.deleteTokenFromDB(r)];case 1:return e.sent(),[4,this.getSWRegistration_()];case 2:return(t=e.sent())?[4,t.pushManager.getSubscription()]:[3,4];case 3:if(n=e.sent())return[2,n.unsubscribe()];e.label=4;case 4:return[2,!0]}})})},e.prototype.deleteTokenFromDB=function(n){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return[4,this.tokenDetailsModel.deleteToken(n)];case 1:return t=e.sent(),[4,this.iidModel.deleteToken(t.fcmSenderId,t.fcmToken,t.fcmPushSet)];case 2:return e.sent(),[2]}})})},e.prototype.getPushSubscription=function(t,n){return t.pushManager.getSubscription().then(function(e){return e||t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:n})})},e.prototype.requestPermission=function(){throw errorFactory.create(ERROR_CODES.AVAILABLE_IN_WINDOW)},e.prototype.useServiceWorker=function(e){throw errorFactory.create(ERROR_CODES.AVAILABLE_IN_WINDOW)},e.prototype.usePublicVapidKey=function(e){throw errorFactory.create(ERROR_CODES.AVAILABLE_IN_WINDOW)},e.prototype.onMessage=function(e,t,n){throw errorFactory.create(ERROR_CODES.AVAILABLE_IN_WINDOW)},e.prototype.onTokenRefresh=function(e,t,n){throw errorFactory.create(ERROR_CODES.AVAILABLE_IN_WINDOW)},e.prototype.setBackgroundMessageHandler=function(e){throw errorFactory.create(ERROR_CODES.AVAILABLE_IN_SW)},e.prototype.delete=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,Promise.all([this.tokenDetailsModel.closeDatabase(),this.vapidDetailsModel.closeDatabase()])];case 1:return e.sent(),[2]}})})},e.prototype.getNotificationPermission_=function(){return Notification.permission},e.prototype.getTokenDetailsModel=function(){return this.tokenDetailsModel},e.prototype.getVapidDetailsModel=function(){return this.vapidDetailsModel},e.prototype.getIidModel=function(){return this.iidModel},e}();function isTokenStillValid(e,t,n){if(!n.vapidKey||!isArrayBufferEqual(t.buffer,n.vapidKey.buffer))return!1;var r=e.endpoint===n.endpoint,i=isArrayBufferEqual(e.getKey("auth"),n.auth),o=isArrayBufferEqual(e.getKey("p256dh"),n.p256dh);return r&&i&&o}var FCM_MSG="FCM_MSG",SwController=function(n){function e(e){var t=n.call(this,e)||this;return t.bgMessageHandler=null,self.addEventListener("push",function(e){t.onPush(e)}),self.addEventListener("pushsubscriptionchange",function(e){t.onSubChange(e)}),self.addEventListener("notificationclick",function(e){t.onNotificationClick(e)}),t}return __extends(e,n),e.prototype.onPush=function(e){e.waitUntil(this.onPush_(e))},e.prototype.onSubChange=function(e){e.waitUntil(this.onSubChange_(e))},e.prototype.onNotificationClick=function(e){e.waitUntil(this.onNotificationClick_(e))},e.prototype.onPush_=function(s){return __awaiter(this,void 0,void 0,function(){var t,n,r,i,o,a;return __generator(this,function(e){switch(e.label){case 0:if(!s.data)return[2];try{t=s.data.json()}catch(e){return[2]}return[4,this.hasVisibleClients_()];case 1:return e.sent()?[2,this.sendMessageToWindowClients_(t)]:(n=this.getNotificationData_(t))?(r=n.title||"",[4,this.getSWRegistration_()]):[3,3];case 2:return i=e.sent(),o=n.actions,a=Notification.maxActions,o&&a&&o.length>a&&console.warn("This browser only supports "+a+" actions.The remaining actions will not be displayed."),[2,i.showNotification(r,n)];case 3:return this.bgMessageHandler?[4,this.bgMessageHandler(t)]:[3,5];case 4:return e.sent(),[2];case 5:return[2]}})})},e.prototype.onSubChange_=function(e){return __awaiter(this,void 0,void 0,function(){var t,n,r,i;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.getSWRegistration_()];case 1:return t=e.sent(),[3,3];case 2:throw n=e.sent(),errorFactory.create(ERROR_CODES.UNABLE_TO_RESUBSCRIBE,{message:n});case 3:return e.trys.push([3,5,,8]),[4,t.pushManager.getSubscription()];case 4:return e.sent(),[3,8];case 5:return r=e.sent(),[4,this.getTokenDetailsModel().getTokenDetailsFromSWScope(t.scope)];case 6:if(!(i=e.sent()))throw r;return[4,this.deleteToken(i.fcmToken)];case 7:throw e.sent(),r;case 8:return[2]}})})},e.prototype.onNotificationClick_=function(o){return __awaiter(this,void 0,void 0,function(){var t,n,r,i;return __generator(this,function(e){switch(e.label){case 0:return o.notification&&o.notification.data&&o.notification.data[FCM_MSG]?o.action?[2]:(o.stopImmediatePropagation(),o.notification.close(),(t=o.notification.data[FCM_MSG]).notification&&(n=t.notification.click_action)?[4,this.getWindowClient_(n)]:[2]):[2];case 1:return(r=e.sent())?[3,3]:[4,self.clients.openWindow(n)];case 2:return r=e.sent(),[3,5];case 3:return[4,r.focus()];case 4:r=e.sent(),e.label=5;case 5:return r?(delete t.notification,i=createNewMsg(MessageType.NOTIFICATION_CLICKED,t),[2,this.attemptToMessageClient_(r,i)]):[2]}})})},e.prototype.getNotificationData_=function(e){if(e&&"object"==typeof e.notification){var t,n=__assign({},e.notification);return n.data=__assign({},e.notification.data,((t={})[FCM_MSG]=e,t)),n}},e.prototype.setBackgroundMessageHandler=function(e){if(!e||"function"!=typeof e)throw errorFactory.create(ERROR_CODES.BG_HANDLER_FUNCTION_EXPECTED);this.bgMessageHandler=e},e.prototype.getWindowClient_=function(o){return __awaiter(this,void 0,void 0,function(){var t,n,r,i;return __generator(this,function(e){switch(e.label){case 0:return t=new URL(o,self.location.href).href,[4,getClientList()];case 1:for(n=e.sent(),r=null,i=0;i<n.length;i++)if(new URL(n[i].url,self.location.href).href===t){r=n[i];break}return[2,r]}})})},e.prototype.attemptToMessageClient_=function(t,n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){if(!t)throw errorFactory.create(ERROR_CODES.NO_WINDOW_CLIENT_TO_MSG);return t.postMessage(n),[2]})})},e.prototype.hasVisibleClients_=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,getClientList()];case 1:return[2,e.sent().some(function(e){return"visible"===e.visibilityState})]}})})},e.prototype.sendMessageToWindowClients_=function(i){return __awaiter(this,void 0,void 0,function(){var t,n,r=this;return __generator(this,function(e){switch(e.label){case 0:return[4,getClientList()];case 1:return t=e.sent(),n=createNewMsg(MessageType.PUSH_MSG_RECEIVED,i),[4,Promise.all(t.map(function(e){return r.attemptToMessageClient_(e,n)}))];case 2:return e.sent(),[2]}})})},e.prototype.getSWRegistration_=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,self.registration]})})},e.prototype.getPublicVapidKey_=function(){return __awaiter(this,void 0,void 0,function(){var t,n;return __generator(this,function(e){switch(e.label){case 0:return[4,this.getSWRegistration_()];case 1:if(!(t=e.sent()))throw errorFactory.create(ERROR_CODES.SW_REGISTRATION_EXPECTED);return[4,this.getVapidDetailsModel().getVapidFromSWScope(t.scope)];case 2:return null==(n=e.sent())?[2,DEFAULT_PUBLIC_VAPID_KEY]:[2,n]}})})},e}(ControllerInterface);function getClientList(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function createNewMsg(e,t){return(n={})[MessageParameter.TYPE_OF_MSG]=e,n[MessageParameter.DATA]=t,n;var n}var DEFAULT_SW_PATH="/firebase-messaging-sw.js",DEFAULT_SW_SCOPE="/firebase-cloud-messaging-push-scope",WindowController=function(n){function e(e){var t=n.call(this,e)||this;return t.registrationToUse=null,t.publicVapidKeyToUse=null,t.manifestCheckPromise=null,t.messageObserver=null,t.tokenRefreshObserver=null,t.onMessageInternal=createSubscribe(function(e){t.messageObserver=e}),t.onTokenRefreshInternal=createSubscribe(function(e){t.tokenRefreshObserver=e}),t.setupSWMessageListener_(),t}return __extends(e,n),e.prototype.getToken=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return this.manifestCheckPromise||(this.manifestCheckPromise=manifestCheck()),[4,this.manifestCheckPromise];case 1:return e.sent(),[2,n.prototype.getToken.call(this)]}})})},e.prototype.requestPermission=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return"granted"===this.getNotificationPermission_()?[2]:[4,Notification.requestPermission()];case 1:if("granted"===(t=e.sent()))return[2];throw"denied"===t?errorFactory.create(ERROR_CODES.PERMISSION_BLOCKED):errorFactory.create(ERROR_CODES.PERMISSION_DEFAULT)}})})},e.prototype.useServiceWorker=function(e){if(!(e instanceof ServiceWorkerRegistration))throw errorFactory.create(ERROR_CODES.SW_REGISTRATION_EXPECTED);if(null!=this.registrationToUse)throw errorFactory.create(ERROR_CODES.USE_SW_BEFORE_GET_TOKEN);this.registrationToUse=e},e.prototype.usePublicVapidKey=function(e){if("string"!=typeof e)throw errorFactory.create(ERROR_CODES.INVALID_PUBLIC_VAPID_KEY);if(null!=this.publicVapidKeyToUse)throw errorFactory.create(ERROR_CODES.USE_PUBLIC_KEY_BEFORE_GET_TOKEN);var t=base64ToArrayBuffer(e);if(65!==t.length)throw errorFactory.create(ERROR_CODES.PUBLIC_KEY_DECRYPTION_FAILED);this.publicVapidKeyToUse=t},e.prototype.onMessage=function(e,t,n){return"function"==typeof e?this.onMessageInternal(e,t,n):this.onMessageInternal(e)},e.prototype.onTokenRefresh=function(e,t,n){return"function"==typeof e?this.onTokenRefreshInternal(e,t,n):this.onTokenRefreshInternal(e)},e.prototype.waitForRegistrationToActivate_=function(r){var i=r.installing||r.waiting||r.active;return new Promise(function(e,t){if(i)if("activated"!==i.state)if("redundant"!==i.state){var n=function(){if("activated"===i.state)e(r);else{if("redundant"!==i.state)return;t(errorFactory.create(ERROR_CODES.SW_REG_REDUNDANT))}i.removeEventListener("statechange",n)};i.addEventListener("statechange",n)}else t(errorFactory.create(ERROR_CODES.SW_REG_REDUNDANT));else e(r);else t(errorFactory.create(ERROR_CODES.NO_SW_IN_REG))})},e.prototype.getSWRegistration_=function(){var t=this;return this.registrationToUse?this.waitForRegistrationToActivate_(this.registrationToUse):(this.registrationToUse=null,navigator.serviceWorker.register(DEFAULT_SW_PATH,{scope:DEFAULT_SW_SCOPE}).catch(function(e){throw errorFactory.create(ERROR_CODES.FAILED_DEFAULT_REGISTRATION,{browserErrorMessage:e.message})}).then(function(e){return t.waitForRegistrationToActivate_(e).then(function(){return(t.registrationToUse=e).update(),e})}))},e.prototype.getPublicVapidKey_=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return this.publicVapidKeyToUse?[2,this.publicVapidKeyToUse]:[2,DEFAULT_PUBLIC_VAPID_KEY]})})},e.prototype.setupSWMessageListener_=function(){var r=this;navigator.serviceWorker.addEventListener("message",function(e){if(e.data&&e.data[MessageParameter.TYPE_OF_MSG]){var t=e.data;switch(t[MessageParameter.TYPE_OF_MSG]){case MessageType.PUSH_MSG_RECEIVED:case MessageType.NOTIFICATION_CLICKED:var n=t[MessageParameter.DATA];r.messageObserver&&r.messageObserver.next(n)}}},!1)},e}(ControllerInterface);function manifestCheck(){return __awaiter(this,void 0,void 0,function(){var t,n;return __generator(this,function(e){switch(e.label){case 0:if(!(t=document.querySelector('link[rel="manifest"]')))return[2];e.label=1;case 1:return e.trys.push([1,4,,5]),[4,fetch(t.href)];case 2:return[4,e.sent().json()];case 3:return n=e.sent(),[3,5];case 4:return e.sent(),[2];case 5:if(!n||!n.gcm_sender_id)return[2];if("103953800507"!==n.gcm_sender_id)throw errorFactory.create(ERROR_CODES.INCORRECT_GCM_SENDER_ID);return[2]}})})}function registerMessaging(e){var t=function(e){if(!isSupported())throw errorFactory.create(ERROR_CODES.UNSUPPORTED_BROWSER);return self&&"ServiceWorkerGlobalScope"in self?new SwController(e):new WindowController(e)};t.isSupported=isSupported;var n={Messaging:WindowController};e.INTERNAL.registerService("messaging",t,n)}function isSupported(){return self&&"ServiceWorkerGlobalScope"in self?isSWControllerSupported():isWindowControllerSupported()}function isWindowControllerSupported(){return"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}function isSWControllerSupported(){return"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}registerMessaging(firebase);var domainBase="https://firebasestorage.googleapis.com",downloadBase="https://firebasestorage.googleapis.com",apiBaseUrl="/v0",apiUploadBaseUrl="/v0",configOption="storageBucket",defaultMaxOperationRetryTime=12e4,defaultMaxUploadRetryTime=6e4,minSafeInteger=-9007199254740991,FirebaseStorageError=function(){function e(e,t){this.code_=prependCode(e),this.message_="Firebase Storage: "+t,this.serverResponse_=null,this.name_="FirebaseError"}return e.prototype.codeProp=function(){return this.code},e.prototype.codeEquals=function(e){return prependCode(e)===this.codeProp()},e.prototype.serverResponseProp=function(){return this.serverResponse_},e.prototype.setServerResponseProp=function(e){this.serverResponse_=e},Object.defineProperty(e.prototype,"name",{get:function(){return this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"code",{get:function(){return this.code_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"message",{get:function(){return this.message_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"serverResponse",{get:function(){return this.serverResponse_},enumerable:!0,configurable:!0}),e}(),Code$1={UNKNOWN:"unknown",OBJECT_NOT_FOUND:"object-not-found",BUCKET_NOT_FOUND:"bucket-not-found",PROJECT_NOT_FOUND:"project-not-found",QUOTA_EXCEEDED:"quota-exceeded",UNAUTHENTICATED:"unauthenticated",UNAUTHORIZED:"unauthorized",RETRY_LIMIT_EXCEEDED:"retry-limit-exceeded",INVALID_CHECKSUM:"invalid-checksum",CANCELED:"canceled",INVALID_EVENT_NAME:"invalid-event-name",INVALID_URL:"invalid-url",INVALID_DEFAULT_BUCKET:"invalid-default-bucket",NO_DEFAULT_BUCKET:"no-default-bucket",CANNOT_SLICE_BLOB:"cannot-slice-blob",SERVER_FILE_WRONG_SIZE:"server-file-wrong-size",NO_DOWNLOAD_URL:"no-download-url",INVALID_ARGUMENT:"invalid-argument",INVALID_ARGUMENT_COUNT:"invalid-argument-count",APP_DELETED:"app-deleted",INVALID_ROOT_OPERATION:"invalid-root-operation",INVALID_FORMAT:"invalid-format",INTERNAL_ERROR:"internal-error"};function prependCode(e){return"storage/"+e}function unknown(){return new FirebaseStorageError(Code$1.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function objectNotFound(e){return new FirebaseStorageError(Code$1.OBJECT_NOT_FOUND,"Object '"+e+"' does not exist.")}function quotaExceeded(e){return new FirebaseStorageError(Code$1.QUOTA_EXCEEDED,"Quota for bucket '"+e+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function unauthenticated(){return new FirebaseStorageError(Code$1.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again.")}function unauthorized(e){return new FirebaseStorageError(Code$1.UNAUTHORIZED,"User does not have permission to access '"+e+"'.")}function retryLimitExceeded(){return new FirebaseStorageError(Code$1.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function canceled(){return new FirebaseStorageError(Code$1.CANCELED,"User canceled the upload/download.")}function invalidUrl(e){return new FirebaseStorageError(Code$1.INVALID_URL,"Invalid URL '"+e+"'.")}function invalidDefaultBucket(e){return new FirebaseStorageError(Code$1.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+e+"'.")}function cannotSliceBlob(){return new FirebaseStorageError(Code$1.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function serverFileWrongSize(){return new FirebaseStorageError(Code$1.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function noDownloadURL(){return new FirebaseStorageError(Code$1.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function invalidArgument(e,t,n){return new FirebaseStorageError(Code$1.INVALID_ARGUMENT,"Invalid argument in `"+t+"` at index "+e+": "+n)}function invalidArgumentCount(e,t,n,r){var i,o;return e===t?o=1===(i=e)?"argument":"arguments":(i="between "+e+" and "+t,o="arguments"),new FirebaseStorageError(Code$1.INVALID_ARGUMENT_COUNT,"Invalid argument count in `"+n+"`: Expected "+i+" "+o+", received "+r+".")}function appDeleted(){return new FirebaseStorageError(Code$1.APP_DELETED,"The Firebase app was deleted.")}function invalidRootOperation(e){return new FirebaseStorageError(Code$1.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function invalidFormat(e,t){return new FirebaseStorageError(Code$1.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function internalError(e){throw new FirebaseStorageError(Code$1.INTERNAL_ERROR,"Internal error: "+e)}var StringFormat={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};function formatValidator(e){switch(e){case StringFormat.RAW:case StringFormat.BASE64:case StringFormat.BASE64URL:case StringFormat.DATA_URL:return;default:throw"Expected one of the event types: ["+StringFormat.RAW+", "+StringFormat.BASE64+", "+StringFormat.BASE64URL+", "+StringFormat.DATA_URL+"]."}}var StringData=function(e,t){this.data=e,this.contentType=t||null};function dataFromString(e,t){switch(e){case StringFormat.RAW:return new StringData(utf8Bytes_(t));case StringFormat.BASE64:case StringFormat.BASE64URL:return new StringData(base64Bytes_(e,t));case StringFormat.DATA_URL:return new StringData(dataURLBytes_(t),dataURLContentType_(t))}throw unknown()}function utf8Bytes_(e){for(var t=[],n=0;n<e.length;n++){var r=e.charCodeAt(n);r<=127?t.push(r):r<=2047?t.push(192|r>>6,128|63&r):55296==(64512&r)?n<e.length-1&&56320==(64512&e.charCodeAt(n+1))?(r=65536|(1023&r)<<10|1023&e.charCodeAt(++n),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)):t.push(239,191,189):56320==(64512&r)?t.push(239,191,189):t.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(t)}function percentEncodedBytes_(e){var t;try{t=decodeURIComponent(e)}catch(e){throw invalidFormat(StringFormat.DATA_URL,"Malformed data URL.")}return utf8Bytes_(t)}function base64Bytes_(e,t){switch(e){case StringFormat.BASE64:var n=-1!==t.indexOf("-"),r=-1!==t.indexOf("_");if(n||r)throw invalidFormat(e,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?");break;case StringFormat.BASE64URL:var i=-1!==t.indexOf("+"),o=-1!==t.indexOf("/");if(i||o)throw invalidFormat(e,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/")}var a;try{a=atob(t)}catch(t){throw invalidFormat(e,"Invalid character found")}for(var s=new Uint8Array(a.length),u=0;u<a.length;u++)s[u]=a.charCodeAt(u);return s}var DataURLParts=function(e){this.base64=!1,this.contentType=null;var t=e.match(/^data:([^,]+)?,/);if(null===t)throw invalidFormat(StringFormat.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");var n=t[1]||null;null!=n&&(this.base64=endsWith(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-";base64".length):n),this.rest=e.substring(e.indexOf(",")+1)};function dataURLBytes_(e){var t=new DataURLParts(e);return t.base64?base64Bytes_(StringFormat.BASE64,t.rest):percentEncodedBytes_(t.rest)}function dataURLContentType_(e){return new DataURLParts(e).contentType}function endsWith(e,t){return!!(e.length>=t.length)&&e.substring(e.length-t.length)===t}var TaskEvent={STATE_CHANGED:"state_changed"},InternalTaskState={RUNNING:"running",PAUSING:"pausing",PAUSED:"paused",SUCCESS:"success",CANCELING:"canceling",CANCELED:"canceled",ERROR:"error"},TaskState={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"},ErrorCode,rge;function taskStateFromInternalTaskState(e){switch(e){case InternalTaskState.RUNNING:case InternalTaskState.PAUSING:case InternalTaskState.CANCELING:return TaskState.RUNNING;case InternalTaskState.PAUSED:return TaskState.PAUSED;case InternalTaskState.SUCCESS:return TaskState.SUCCESS;case InternalTaskState.CANCELED:return TaskState.CANCELED;case InternalTaskState.ERROR:default:return TaskState.ERROR}}function contains$3(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function forEach$2(e,t){for(var n in e)contains$3(e,n)&&t(n,e[n])}function clone$1(e){if(null==e)return{};var n={};return forEach$2(e,function(e,t){n[e]=t}),n}function make(e){return new Promise(e)}function resolve$1(e){return Promise.resolve(e)}function reject$1(e){return Promise.reject(e)}function isDef(e){return null!=e}function isJustDef(e){return void 0!==e}function isFunction(e){return"function"==typeof e}function isObject(e){return"object"==typeof e}function isNonNullObject$1(e){return isObject(e)&&null!==e}function isNonArrayObject(e){return isObject(e)&&!Array.isArray(e)}function isString(e){return"string"==typeof e||e instanceof String}function isNumber(e){return"number"==typeof e||e instanceof Number}function isNativeBlob(e){return isNativeBlobDefined()&&e instanceof Blob}function isNativeBlobDefined(){return"undefined"!=typeof Blob}rge=ErrorCode||(ErrorCode={}),rge[rge.NO_ERROR=0]="NO_ERROR",rge[rge.NETWORK_ERROR=1]="NETWORK_ERROR",rge[rge.ABORT=2]="ABORT";var NetworkXhrIo=function(){function e(){var n=this;this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=ErrorCode.NO_ERROR,this.sendPromise_=make(function(t,e){n.xhr_.addEventListener("abort",function(e){n.errorCode_=ErrorCode.ABORT,t(n)}),n.xhr_.addEventListener("error",function(e){n.errorCode_=ErrorCode.NETWORK_ERROR,t(n)}),n.xhr_.addEventListener("load",function(e){t(n)})})}return e.prototype.send=function(e,t,n,r){var i=this;if(this.sent_)throw internalError("cannot .send() more than once");return this.sent_=!0,this.xhr_.open(t,e,!0),isDef(r)&&forEach$2(r,function(e,t){i.xhr_.setRequestHeader(e,t.toString())}),isDef(n)?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_},e.prototype.getErrorCode=function(){if(!this.sent_)throw internalError("cannot .getErrorCode() before sending");return this.errorCode_},e.prototype.getStatus=function(){if(!this.sent_)throw internalError("cannot .getStatus() before sending");try{return this.xhr_.status}catch(e){return-1}},e.prototype.getResponseText=function(){if(!this.sent_)throw internalError("cannot .getResponseText() before sending");return this.xhr_.responseText},e.prototype.abort=function(){this.xhr_.abort()},e.prototype.getResponseHeader=function(e){return this.xhr_.getResponseHeader(e)},e.prototype.addUploadProgressListener=function(e){isDef(this.xhr_.upload)&&this.xhr_.upload.addEventListener("progress",e)},e.prototype.removeUploadProgressListener=function(e){isDef(this.xhr_.upload)&&this.xhr_.upload.removeEventListener("progress",e)},e}(),XhrIoPool=function(){function e(){}return e.prototype.createXhrIo=function(){return new NetworkXhrIo},e}();function jsonObjectOrNull(e){var t;try{t=JSON.parse(e)}catch(e){return null}return isNonArrayObject(t)?t:null}var Location=function(){function u(e,t){this.bucket=e,this.path_=t}return Object.defineProperty(u.prototype,"path",{get:function(){return this.path_},enumerable:!0,configurable:!0}),u.prototype.fullServerUrl=function(){var e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)},u.prototype.bucketOnlyServerUrl=function(){return"/b/"+encodeURIComponent(this.bucket)+"/o"},u.makeFromBucketSpec=function(e){var t;try{t=u.makeFromUrl(e)}catch(t){return new u(e,"")}if(""===t.path)return t;throw invalidDefaultBucket(e)},u.makeFromUrl=function(e){for(var t=null,n=[{regex:new RegExp("^gs://([A-Za-z0-9.\\-]+)(/(.*))?$","i"),indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp("^https?://firebasestorage\\.googleapis\\.com/v[A-Za-z0-9_]+/b/([A-Za-z0-9.\\-]+)/o(/([^?#]*).*)?$","i"),indices:{bucket:1,path:3},postModify:function(e){e.path_=decodeURIComponent(e.path)}}],r=0;r<n.length;r++){var i=n[r],o=i.regex.exec(e);if(o){var a=o[i.indices.bucket],s=o[i.indices.path];s||(s=""),t=new u(a,s),i.postModify(t);break}}if(null==t)throw invalidUrl(e);return t},u}();function parent(e){if(0==e.length)return null;var t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}function child(e,t){var n=t.split("/").filter(function(e){return 0<e.length}).join("/");return 0===e.length?n:e+"/"+n}function lastComponent(e){var t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}function makeNormalUrl(e){return domainBase+apiBaseUrl+e}function makeDownloadUrl(e){return downloadBase+apiBaseUrl+e}function makeUploadUrl(e){return domainBase+apiUploadBaseUrl+e}function makeQueryString(e){var r=encodeURIComponent,i="?";return forEach$2(e,function(e,t){var n=r(e)+"="+r(t);i=i+n+"&"}),i=i.slice(0,-1)}function noXform_(e,t){return t}var Mapping=function(e,t,n,r){this.server=e,this.local=t||e,this.writable=!!n,this.xform=r||noXform_},mappings_=null;function xformPath(e){return!isString(e)||e.length<2?e:lastComponent(e=e)}function getMappings(){if(mappings_)return mappings_;var e=[];e.push(new Mapping("bucket")),e.push(new Mapping("generation")),e.push(new Mapping("metageneration")),e.push(new Mapping("name","fullPath",!0));var t=new Mapping("name");t.xform=function(e,t){return xformPath(t)},e.push(t);var n=new Mapping("size");return n.xform=function(e,t){return isDef(t)?+t:t},e.push(n),e.push(new Mapping("timeCreated")),e.push(new Mapping("updated")),e.push(new Mapping("md5Hash",null,!0)),e.push(new Mapping("cacheControl",null,!0)),e.push(new Mapping("contentDisposition",null,!0)),e.push(new Mapping("contentEncoding",null,!0)),e.push(new Mapping("contentLanguage",null,!0)),e.push(new Mapping("contentType",null,!0)),e.push(new Mapping("metadata","customMetadata",!0)),mappings_=e}function addRef(r,i){Object.defineProperty(r,"ref",{get:function(){var e=r.bucket,t=r.fullPath,n=new Location(e,t);return i.makeStorageReference(n)}})}function fromResource(e,t,n){for(var r={type:"file"},i=n.length,o=0;o<i;o++){var a=n[o];r[a.local]=a.xform(r,t[a.server])}return addRef(r,e),r}function fromResourceString(e,t,n){var r=jsonObjectOrNull(t);return null===r?null:fromResource(e,r,n)}function downloadUrlFromResourceString(r,e){var t=jsonObjectOrNull(e);if(null===t)return null;if(!isString(t.downloadTokens))return null;var n=t.downloadTokens;if(0===n.length)return null;var i=encodeURIComponent;return n.split(",").map(function(e){var t=r.bucket,n=r.fullPath;return makeDownloadUrl("/b/"+i(t)+"/o/"+i(n))+makeQueryString({alt:"media",token:e})})[0]}function toResourceString(e,t){for(var n={},r=t.length,i=0;i<r;i++){var o=t[i];o.writable&&(n[o.server]=e[o.local])}return JSON.stringify(n)}function metadataValidator(e){if(!e||!isObject(e))throw"Expected Metadata object.";for(var t in e){var n=e[t];if("customMetadata"===t){if(!isObject(n))throw"Expected object for 'customMetadata' mapping."}else if(isNonNullObject$1(n))throw"Mapping for '"+t+"' cannot be an object."}}function validate(e,t,n){for(var r=t.length,i=t.length,o=0;o<t.length;o++)if(t[o].optional){r=o;break}if(!(r<=n.length&&n.length<=i))throw invalidArgumentCount(r,i,e,n.length);for(o=0;o<n.length;o++)try{t[o].validator(n[o])}catch(t){throw t instanceof Error?invalidArgument(o,e,t.message):invalidArgument(o,e,t)}}var ArgSpec=function(t,e){var n=this;this.validator=function(e){n.optional&&!isJustDef(e)||t(e)},this.optional=!!e};function and_(t,n){return function(e){t(e),n(e)}}function stringSpec(e,t){function n(e){if(!isString(e))throw"Expected string."}var r;return r=e?and_(n,e):n,new ArgSpec(r,t)}function uploadDataSpec(){return new ArgSpec(function(e){if(!(e instanceof Uint8Array||e instanceof ArrayBuffer||isNativeBlobDefined()&&e instanceof Blob))throw"Expected Blob or File."})}function metadataSpec(e){return new ArgSpec(metadataValidator,e)}function nonNegativeNumberSpec(){return new ArgSpec(function(e){if(!(isNumber(e)&&0<=e))throw"Expected a number 0 or greater."})}function looseObjectSpec(t,e){return new ArgSpec(function(e){if(!(null===e||isDef(e)&&e instanceof Object))throw"Expected an Object.";null!=t&&t(e)},e)}function nullFunctionSpec(e){return new ArgSpec(function(e){if(null!==e&&!isFunction(e))throw"Expected a Function."},e)}function getBlobBuilder(){return"undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function getBlob(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=getBlobBuilder();if(void 0!==n){for(var r=new n,i=0;i<e.length;i++)r.append(e[i]);return r.getBlob()}if(isNativeBlobDefined())return new Blob(e);throw Error("This browser doesn't seem to support creating Blobs")}function sliceBlob(e,t,n){return e.webkitSlice?e.webkitSlice(t,n):e.mozSlice?e.mozSlice(t,n):e.slice?e.slice(t,n):null}var FbsBlob=function(){function s(e,t){var n=0,r="";isNativeBlob(e)?(n=(this.data_=e).size,r=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=r}return s.prototype.size=function(){return this.size_},s.prototype.type=function(){return this.type_},s.prototype.slice=function(e,t){if(isNativeBlob(this.data_)){var n=sliceBlob(this.data_,e,t);return null===n?null:new s(n)}return new s(new Uint8Array(this.data_.buffer,e,t-e),!0)},s.getBlob=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(isNativeBlobDefined()){var n=e.map(function(e){return e instanceof s?e.data_:e});return new s(getBlob.apply(null,n))}var r=e.map(function(e){return isString(e)?dataFromString(StringFormat.RAW,e).data:e.data_}),i=0;r.forEach(function(e){i+=e.byteLength});var o=new Uint8Array(i),a=0;return r.forEach(function(e){for(var t=0;t<e.length;t++)o[a++]=e[t]}),new s(o,!0)},s.prototype.uploadData=function(){return this.data_},s}();function contains$1$1(e,t){return-1!==e.indexOf(t)}function clone$1$1(e){return Array.prototype.slice.call(e)}function remove(e,t){var n=e.indexOf(t);-1!==n&&e.splice(n,1)}var RequestInfo=function(e,t,n,r){this.url=e,this.method=t,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]};function handlerCheck(e){if(!e)throw unknown()}function metadataHandler(r,i){return function(e,t){var n=fromResourceString(r,t,i);return handlerCheck(null!==n),n}}function downloadUrlHandler(r,i){return function(e,t){var n=fromResourceString(r,t,i);return handlerCheck(null!==n),downloadUrlFromResourceString(n,t)}}function sharedErrorHandler(r){return function(e,t){var n;return(n=401===e.getStatus()?unauthenticated():402===e.getStatus()?quotaExceeded(r.bucket):403===e.getStatus()?unauthorized(r.path):t).setServerResponseProp(t.serverResponseProp()),n}}function objectErrorHandler(r){var i=sharedErrorHandler(r);return function(e,t){var n=i(e,t);return 404===e.getStatus()&&(n=objectNotFound(r.path)),n.setServerResponseProp(t.serverResponseProp()),n}}function getMetadata(e,t,n){var r=makeNormalUrl(t.fullServerUrl()),i=e.maxOperationRetryTime(),o=new RequestInfo(r,"GET",metadataHandler(e,n),i);return o.errorHandler=objectErrorHandler(t),o}function getDownloadUrl(e,t,n){var r=makeNormalUrl(t.fullServerUrl()),i=e.maxOperationRetryTime(),o=new RequestInfo(r,"GET",downloadUrlHandler(e,n),i);return o.errorHandler=objectErrorHandler(t),o}function updateMetadata(e,t,n,r){var i=makeNormalUrl(t.fullServerUrl()),o=toResourceString(n,r),a=e.maxOperationRetryTime(),s=new RequestInfo(i,"PATCH",metadataHandler(e,r),a);return s.headers={"Content-Type":"application/json; charset=utf-8"},s.body=o,s.errorHandler=objectErrorHandler(t),s}function deleteObject(e,t){var n=makeNormalUrl(t.fullServerUrl()),r=e.maxOperationRetryTime(),i=new RequestInfo(n,"DELETE",function(e,t){},r);return i.successCodes=[200,204],i.errorHandler=objectErrorHandler(t),i}function determineContentType_(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}function metadataForUpload_(e,t,n){var r=clone$1(n);return r.fullPath=e.path,r.size=t.size(),r.contentType||(r.contentType=determineContentType_(null,t)),r}function multipartUpload(e,t,n,r,i){var o=t.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"},s=function(){for(var e="",t=0;t<2;t++)e+=Math.random().toString().slice(2);return e}();a["Content-Type"]="multipart/related; boundary="+s;var u=metadataForUpload_(t,r,i),c="--"+s+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+toResourceString(u,n)+"\r\n--"+s+"\r\nContent-Type: "+u.contentType+"\r\n\r\n",l="\r\n--"+s+"--",h=FbsBlob.getBlob(c,r,l);if(null===h)throw cannotSliceBlob();var f={name:u.fullPath},d=makeUploadUrl(o),p=e.maxUploadRetryTime(),v=new RequestInfo(d,"POST",metadataHandler(e,n),p);return v.urlParams=f,v.headers=a,v.body=h.uploadData(),v.errorHandler=sharedErrorHandler(t),v}var ResumableUploadStatus=function(e,t,n,r){this.current=e,this.total=t,this.finalized=!!n,this.metadata=r||null};function checkResumeHeader_(e,t){var n;try{n=e.getResponseHeader("X-Goog-Upload-Status")}catch(e){handlerCheck(!1)}return handlerCheck(contains$1$1(t||["active"],n)),n}function createResumableUpload(e,t,n,r,i){var o=t.bucketOnlyServerUrl(),a=metadataForUpload_(t,r,i),s={name:a.fullPath},u=makeUploadUrl(o),c={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":r.size(),"X-Goog-Upload-Header-Content-Type":a.contentType,"Content-Type":"application/json; charset=utf-8"},l=toResourceString(a,n),h=e.maxUploadRetryTime(),f=new RequestInfo(u,"POST",function(e,t){var n;checkResumeHeader_(e);try{n=e.getResponseHeader("X-Goog-Upload-URL")}catch(e){handlerCheck(!1)}return handlerCheck(isString(n)),n},h);return f.urlParams=s,f.headers=c,f.body=l,f.errorHandler=sharedErrorHandler(t),f}function getResumableUploadStatus(e,t,n,o){var r=e.maxUploadRetryTime(),i=new RequestInfo(n,"POST",function(e,t){var n,r=checkResumeHeader_(e,["active","final"]);try{n=e.getResponseHeader("X-Goog-Upload-Size-Received")}catch(e){handlerCheck(!1)}var i=parseInt(n,10);return handlerCheck(!isNaN(i)),new ResumableUploadStatus(i,o.size(),"final"===r)},r);return i.headers={"X-Goog-Upload-Command":"query"},i.errorHandler=sharedErrorHandler(t),i}var resumableUploadChunkSize=262144;function continueResumableUpload(e,a,t,s,n,u,r,i){var c=new ResumableUploadStatus(0,0);if(r?(c.current=r.current,c.total=r.total):(c.current=0,c.total=s.size()),s.size()!==c.total)throw serverFileWrongSize();var o=c.total-c.current,l=o;0<n&&(l=Math.min(l,n));var h=c.current,f=h+l,d={"X-Goog-Upload-Command":l===o?"upload, finalize":"upload","X-Goog-Upload-Offset":c.current},p=s.slice(h,f);if(null===p)throw cannotSliceBlob();var v=a.maxUploadRetryTime(),m=new RequestInfo(t,"POST",function(e,t){var n,r=checkResumeHeader_(e,["active","final"]),i=c.current+l,o=s.size();return n="final"===r?metadataHandler(a,u)(e,t):null,new ResumableUploadStatus(i,o,"final"===r,n)},v);return m.headers=d,m.body=p.uploadData(),m.progressCallback=i||null,m.errorHandler=sharedErrorHandler(e),m}var Observer=function(e,t,n){if(isFunction(e)||isDef(t)||isDef(n))this.next=e,this.error=t||null,this.complete=n||null;else{var r=e;this.next=r.next||null,this.error=r.error||null,this.complete=r.complete||null}},UploadTaskSnapshot=function(e,t,n,r,i,o){this.bytesTransferred=e,this.totalBytes=t,this.state=n,this.metadata=r,this.task=i,this.ref=o};function async$1(n){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];resolve$1(!0).then(function(){n.apply(null,e)})}}var UploadTask=function(){function e(e,t,n,r,i,o){void 0===o&&(o=null);var a=this;this.transferred_=0,this.needToFetchStatus_=!1,this.needToFetchMetadata_=!1,this.observers_=[],this.error_=null,this.uploadUrl_=null,this.request_=null,this.chunkMultiplier_=1,this.resolve_=null,this.reject_=null,this.ref_=e,this.authWrapper_=t,this.location_=n,this.blob_=i,this.metadata_=o,this.mappings_=r,this.resumable_=this.shouldDoResumable_(this.blob_),this.state_=InternalTaskState.RUNNING,this.errorHandler_=function(e){a.request_=null,a.chunkMultiplier_=1,e.codeEquals(Code$1.CANCELED)?(a.needToFetchStatus_=!0,a.completeTransitions_()):(a.error_=e,a.transition_(InternalTaskState.ERROR))},this.metadataErrorHandler_=function(e){a.request_=null,e.codeEquals(Code$1.CANCELED)?a.completeTransitions_():(a.error_=e,a.transition_(InternalTaskState.ERROR))},this.promise_=make(function(e,t){a.resolve_=e,a.reject_=t,a.start_()}),this.promise_.then(null,function(){})}return e.prototype.makeProgressCallback_=function(){var n=this,r=this.transferred_;return function(e,t){n.updateProgress_(r+e)}},e.prototype.shouldDoResumable_=function(e){return 262144<e.size()},e.prototype.start_=function(){this.state_===InternalTaskState.RUNNING&&null===this.request_&&(this.resumable_?null===this.uploadUrl_?this.createResumable_():this.needToFetchStatus_?this.fetchStatus_():this.needToFetchMetadata_?this.fetchMetadata_():this.continueUpload_():this.oneShotUpload_())},e.prototype.resolveToken_=function(t){var n=this;this.authWrapper_.getAuthToken().then(function(e){switch(n.state_){case InternalTaskState.RUNNING:t(e);break;case InternalTaskState.CANCELING:n.transition_(InternalTaskState.CANCELED);break;case InternalTaskState.PAUSING:n.transition_(InternalTaskState.PAUSED)}})},e.prototype.createResumable_=function(){var r=this;this.resolveToken_(function(e){var t=createResumableUpload(r.authWrapper_,r.location_,r.mappings_,r.blob_,r.metadata_),n=r.authWrapper_.makeRequest(t,e);(r.request_=n).getPromise().then(function(e){r.request_=null,r.uploadUrl_=e,r.needToFetchStatus_=!1,r.completeTransitions_()},r.errorHandler_)})},e.prototype.fetchStatus_=function(){var r=this,i=this.uploadUrl_;this.resolveToken_(function(e){var t=getResumableUploadStatus(r.authWrapper_,r.location_,i,r.blob_),n=r.authWrapper_.makeRequest(t,e);(r.request_=n).getPromise().then(function(e){e=e,r.request_=null,r.updateProgress_(e.current),r.needToFetchStatus_=!1,e.finalized&&(r.needToFetchMetadata_=!0),r.completeTransitions_()},r.errorHandler_)})},e.prototype.continueUpload_=function(){var r=this,i=resumableUploadChunkSize*this.chunkMultiplier_,o=new ResumableUploadStatus(this.transferred_,this.blob_.size()),a=this.uploadUrl_;this.resolveToken_(function(e){var t;try{t=continueResumableUpload(r.location_,r.authWrapper_,a,r.blob_,i,r.mappings_,o,r.makeProgressCallback_())}catch(e){return r.error_=e,void r.transition_(InternalTaskState.ERROR)}var n=r.authWrapper_.makeRequest(t,e);(r.request_=n).getPromise().then(function(e){r.increaseMultiplier_(),r.request_=null,r.updateProgress_(e.current),e.finalized?(r.metadata_=e.metadata,r.transition_(InternalTaskState.SUCCESS)):r.completeTransitions_()},r.errorHandler_)})},e.prototype.increaseMultiplier_=function(){resumableUploadChunkSize*this.chunkMultiplier_<33554432&&(this.chunkMultiplier_*=2)},e.prototype.fetchMetadata_=function(){var r=this;this.resolveToken_(function(e){var t=getMetadata(r.authWrapper_,r.location_,r.mappings_),n=r.authWrapper_.makeRequest(t,e);(r.request_=n).getPromise().then(function(e){r.request_=null,r.metadata_=e,r.transition_(InternalTaskState.SUCCESS)},r.metadataErrorHandler_)})},e.prototype.oneShotUpload_=function(){var r=this;this.resolveToken_(function(e){var t=multipartUpload(r.authWrapper_,r.location_,r.mappings_,r.blob_,r.metadata_),n=r.authWrapper_.makeRequest(t,e);(r.request_=n).getPromise().then(function(e){r.request_=null,r.metadata_=e,r.updateProgress_(r.blob_.size()),r.transition_(InternalTaskState.SUCCESS)},r.errorHandler_)})},e.prototype.updateProgress_=function(e){var t=this.transferred_;this.transferred_=e,this.transferred_!==t&&this.notifyObservers_()},e.prototype.transition_=function(e){if(this.state_!==e)switch(e){case InternalTaskState.CANCELING:case InternalTaskState.PAUSING:this.state_=e,null!==this.request_&&this.request_.cancel();break;case InternalTaskState.RUNNING:var t=this.state_===InternalTaskState.PAUSED;this.state_=e,t&&(this.notifyObservers_(),this.start_());break;case InternalTaskState.PAUSED:this.state_=e,this.notifyObservers_();break;case InternalTaskState.CANCELED:this.error_=canceled(),this.state_=e,this.notifyObservers_();break;case InternalTaskState.ERROR:case InternalTaskState.SUCCESS:this.state_=e,this.notifyObservers_()}},e.prototype.completeTransitions_=function(){switch(this.state_){case InternalTaskState.PAUSING:this.transition_(InternalTaskState.PAUSED);break;case InternalTaskState.CANCELING:this.transition_(InternalTaskState.CANCELED);break;case InternalTaskState.RUNNING:this.start_()}},Object.defineProperty(e.prototype,"snapshot",{get:function(){var e=taskStateFromInternalTaskState(this.state_);return new UploadTaskSnapshot(this.transferred_,this.blob_.size(),e,this.metadata_,this,this.ref_)},enumerable:!0,configurable:!0}),e.prototype.on=function(t,e,n,o){void 0===e&&(e=void 0),void 0===n&&(n=void 0),void 0===o&&(o=void 0);var r="Expected a function or an Object with one of `next`, `error`, `complete` properties.",i=nullFunctionSpec(!0).validator,a=looseObjectSpec(null,!0).validator;function s(e){try{return void i(e)}catch(e){}try{if(a(e),!(isJustDef(e.next)||isJustDef(e.error)||isJustDef(e.complete)))throw"";return}catch(e){throw r}}validate("on",[stringSpec(function(e){if(t!==TaskEvent.STATE_CHANGED)throw"Expected one of the event types: ["+TaskEvent.STATE_CHANGED+"]."}),looseObjectSpec(s,!0),nullFunctionSpec(!0),nullFunctionSpec(!0)],arguments);var u=this;function c(i){return function(e,t,n){null!==i&&validate("on",i,arguments);var r=new Observer(e,t,o);return u.addObserver_(r),function(){u.removeObserver_(r)}}}var l=[looseObjectSpec(function(e){if(null===e)throw r;s(e)}),nullFunctionSpec(!0),nullFunctionSpec(!0)];return isJustDef(e)||isJustDef(n)||isJustDef(o)?c(null)(e,n,o):c(l)},e.prototype.then=function(e,t){return this.promise_.then(e,t)},e.prototype.catch=function(e){return this.then(null,e)},e.prototype.addObserver_=function(e){this.observers_.push(e),this.notifyObserver_(e)},e.prototype.removeObserver_=function(e){remove(this.observers_,e)},e.prototype.notifyObservers_=function(){var t=this;this.finishPromise_(),clone$1$1(this.observers_).forEach(function(e){t.notifyObserver_(e)})},e.prototype.finishPromise_=function(){if(null!==this.resolve_){var e=!0;switch(taskStateFromInternalTaskState(this.state_)){case TaskState.SUCCESS:async$1(this.resolve_.bind(null,this.snapshot))();break;case TaskState.CANCELED:case TaskState.ERROR:async$1(this.reject_.bind(null,this.error_))();break;default:e=!1}e&&(this.resolve_=null,this.reject_=null)}},e.prototype.notifyObserver_=function(e){switch(taskStateFromInternalTaskState(this.state_)){case TaskState.RUNNING:case TaskState.PAUSED:null!==e.next&&async$1(e.next.bind(e,this.snapshot))();break;case TaskState.SUCCESS:null!==e.complete&&async$1(e.complete.bind(e))();break;case TaskState.CANCELED:case TaskState.ERROR:null!==e.error&&async$1(e.error.bind(e,this.error_))();break;default:null!==e.error&&async$1(e.error.bind(e,this.error_))()}},e.prototype.resume=function(){validate("resume",[],arguments);var e=this.state_===InternalTaskState.PAUSED||this.state_===InternalTaskState.PAUSING;return e&&this.transition_(InternalTaskState.RUNNING),e},e.prototype.pause=function(){validate("pause",[],arguments);var e=this.state_===InternalTaskState.RUNNING;return e&&this.transition_(InternalTaskState.PAUSING),e},e.prototype.cancel=function(){validate("cancel",[],arguments);var e=this.state_===InternalTaskState.RUNNING||this.state_===InternalTaskState.PAUSING;return e&&this.transition_(InternalTaskState.CANCELING),e},e}(),Reference$1=function(){function n(e,t){this.authWrapper=e,this.location=t instanceof Location?t:Location.makeFromUrl(t)}return n.prototype.toString=function(){return validate("toString",[],arguments),"gs://"+this.location.bucket+"/"+this.location.path},n.prototype.newRef=function(e,t){return new n(e,t)},n.prototype.mappings=function(){return getMappings()},n.prototype.child=function(e){validate("child",[stringSpec()],arguments);var t=child(this.location.path,e),n=new Location(this.location.bucket,t);return this.newRef(this.authWrapper,n)},Object.defineProperty(n.prototype,"parent",{get:function(){var e=parent(this.location.path);if(null===e)return null;var t=new Location(this.location.bucket,e);return this.newRef(this.authWrapper,t)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"root",{get:function(){var e=new Location(this.location.bucket,"");return this.newRef(this.authWrapper,e)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bucket",{get:function(){return this.location.bucket},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"fullPath",{get:function(){return this.location.path},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"name",{get:function(){return lastComponent(this.location.path)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"storage",{get:function(){return this.authWrapper.service()},enumerable:!0,configurable:!0}),n.prototype.put=function(e,t){return void 0===t&&(t=null),validate("put",[uploadDataSpec(),metadataSpec(!0)],arguments),this.throwIfRoot_("put"),new UploadTask(this,this.authWrapper,this.location,this.mappings(),new FbsBlob(e),t)},n.prototype.putString=function(e,t,n){void 0===t&&(t=StringFormat.RAW),validate("putString",[stringSpec(),stringSpec(formatValidator,!0),metadataSpec(!0)],arguments),this.throwIfRoot_("putString");var r=dataFromString(t,e),i=clone$1(n);return!isDef(i.contentType)&&isDef(r.contentType)&&(i.contentType=r.contentType),new UploadTask(this,this.authWrapper,this.location,this.mappings(),new FbsBlob(r.data,!0),i)},n.prototype.delete=function(){validate("delete",[],arguments),this.throwIfRoot_("delete");var n=this;return this.authWrapper.getAuthToken().then(function(e){var t=deleteObject(n.authWrapper,n.location);return n.authWrapper.makeRequest(t,e).getPromise()})},n.prototype.getMetadata=function(){validate("getMetadata",[],arguments),this.throwIfRoot_("getMetadata");var n=this;return this.authWrapper.getAuthToken().then(function(e){var t=getMetadata(n.authWrapper,n.location,n.mappings());return n.authWrapper.makeRequest(t,e).getPromise()})},n.prototype.updateMetadata=function(n){validate("updateMetadata",[metadataSpec()],arguments),this.throwIfRoot_("updateMetadata");var r=this;return this.authWrapper.getAuthToken().then(function(e){var t=updateMetadata(r.authWrapper,r.location,n,r.mappings());return r.authWrapper.makeRequest(t,e).getPromise()})},n.prototype.getDownloadURL=function(){validate("getDownloadURL",[],arguments),this.throwIfRoot_("getDownloadURL");var n=this;return this.authWrapper.getAuthToken().then(function(e){var t=getDownloadUrl(n.authWrapper,n.location,n.mappings());return n.authWrapper.makeRequest(t,e).getPromise().then(function(e){if(null===e)throw noDownloadURL();return e})})},n.prototype.throwIfRoot_=function(e){if(""===this.location.path)throw invalidRootOperation(e)},n}(),FailRequest=function(){function e(e){this.promise_=reject$1(e)}return e.prototype.getPromise=function(){return this.promise_},e.prototype.cancel=function(e){void 0===e&&(e=!1)},e}(),RequestMap=function(){function e(){this.map_={},this.id_=minSafeInteger}return e.prototype.addRequest=function(e){var t=this.id_;this.id_++,this.map_[t]=e;var n=this;function r(){delete n.map_[t]}e.getPromise().then(r,r)},e.prototype.clear=function(){forEach$2(this.map_,function(e,t){t&&t.cancel(!0)}),this.map_={}},e}(),AuthWrapper=function(){function a(e,t,n,r,i){if(this.bucket_=null,this.deleted_=!1,this.app_=e,null!==this.app_){var o=this.app_.options;isDef(o)&&(this.bucket_=a.extractBucket_(o))}this.storageRefMaker_=t,this.requestMaker_=n,this.pool_=i,this.service_=r,this.maxOperationRetryTime_=defaultMaxOperationRetryTime,this.maxUploadRetryTime_=defaultMaxUploadRetryTime,this.requestMap_=new RequestMap}return a.extractBucket_=function(e){var t=e[configOption]||null;return null==t?null:Location.makeFromBucketSpec(t).bucket},a.prototype.getAuthToken=function(){return null!==this.app_&&isDef(this.app_.INTERNAL)&&isDef(this.app_.INTERNAL.getToken)?this.app_.INTERNAL.getToken().then(function(e){return null!==e?e.accessToken:null},function(e){return null}):resolve$1(null)},a.prototype.bucket=function(){if(this.deleted_)throw appDeleted();return this.bucket_},a.prototype.service=function(){return this.service_},a.prototype.makeStorageReference=function(e){return this.storageRefMaker_(this,e)},a.prototype.makeRequest=function(e,t){if(this.deleted_)return new FailRequest(appDeleted());var n=this.requestMaker_(e,t,this.pool_);return this.requestMap_.addRequest(n),n},a.prototype.deleteApp=function(){this.deleted_=!0,this.app_=null,this.requestMap_.clear()},a.prototype.maxUploadRetryTime=function(){return this.maxUploadRetryTime_},a.prototype.setMaxUploadRetryTime=function(e){this.maxUploadRetryTime_=e},a.prototype.maxOperationRetryTime=function(){return this.maxOperationRetryTime_},a.prototype.setMaxOperationRetryTime=function(e){this.maxOperationRetryTime_=e},a}();function start(t,e,n){var i=1,r=null,o=!1,a=0;function s(){return 2===a}var u=!1;function c(){u||(u=!0,e.apply(null,arguments))}function l(e){r=setTimeout(function(){r=null,t(h,s())},e)}function h(e){for(var t,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];u||(e?c.apply(null,arguments):s()||o?c.apply(null,arguments):(i<64&&(i*=2),1===a?(a=2,t=0):t=1e3*(i+Math.random()),l(t)))}var f=!1;function d(e){f||(f=!0,u||(null!==r?(e||(a=2),clearTimeout(r),l(0)):e||(a=1)))}return l(0),setTimeout(function(){d(o=!0)},n),d}function stop(e){e(!1)}var NetworkRequest=function(){function e(e,t,n,r,i,o,a,s,u,c,l){this.pendingXhr_=null,this.backoffId_=null,this.resolve_=null,this.reject_=null,this.canceled_=!1,this.appDelete_=!1,this.url_=e,this.method_=t,this.headers_=n,this.body_=r,this.successCodes_=i.slice(),this.additionalRetryCodes_=o.slice(),this.callback_=a,this.errorCallback_=s,this.progressCallback_=c,this.timeout_=u,this.pool_=l;var h=this;this.promise_=make(function(e,t){h.resolve_=e,h.reject_=t,h.start_()})}return e.prototype.start_=function(){var s=this;function e(e,t){var n,r=s.resolve_,i=s.reject_,o=t.xhr;if(t.wasSuccessCode)try{var a=s.callback_(o,o.getResponseText());isJustDef(a)?r(a):r()}catch(e){i(e)}else null!==o?((n=unknown()).setServerResponseProp(o.getResponseText()),s.errorCallback_?i(s.errorCallback_(o,n)):i(n)):t.canceled?i(n=s.appDelete_?appDeleted():canceled()):i(n=retryLimitExceeded())}this.canceled_?e(0,new RequestEndStatus(!1,null,!0)):this.backoffId_=start(function(o,e){if(e)o(!1,new RequestEndStatus(!1,null,!0));else{var t=s.pool_.createXhrIo();s.pendingXhr_=t,null!==s.progressCallback_&&t.addUploadProgressListener(a),t.send(s.url_,s.method_,s.body_,s.headers_).then(function(e){null!==s.progressCallback_&&e.removeUploadProgressListener(a),s.pendingXhr_=null;var t=(e=e).getErrorCode()===ErrorCode.NO_ERROR,n=e.getStatus();if(t&&!s.isRetryStatusCode_(n)){var r=contains$1$1(s.successCodes_,n);o(!0,new RequestEndStatus(r,e))}else{var i=e.getErrorCode()===ErrorCode.ABORT;o(!1,new RequestEndStatus(!1,null,i))}})}function a(e){var t=e.loaded,n=e.lengthComputable?e.total:-1;null!==s.progressCallback_&&s.progressCallback_(t,n)}},e,this.timeout_)},e.prototype.getPromise=function(){return this.promise_},e.prototype.cancel=function(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&stop(this.backoffId_),null!==this.pendingXhr_&&this.pendingXhr_.abort()},e.prototype.isRetryStatusCode_=function(e){var t=500<=e&&e<600,n=contains$1$1([408,429],e),r=contains$1$1(this.additionalRetryCodes_,e);return t||n||r},e}(),RequestEndStatus=function(e,t,n){this.wasSuccessCode=e,this.xhr=t,this.canceled=!!n};function addAuthHeader_(e,t){null!==t&&0<t.length&&(e.Authorization="Firebase "+t)}function addVersionHeader_(e){var t=void 0!==firebase?firebase.SDK_VERSION:"AppManager";e["X-Firebase-Storage-Version"]="webjs/"+t}function makeRequest(e,t,n){var r=makeQueryString(e.urlParams),i=e.url+r,o=clone$1(e.headers);return addAuthHeader_(o,t),addVersionHeader_(o),new NetworkRequest(i,e.method,o,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,n)}var Service$1=function(){function e(e,t,n){if(this.bucket_=null,this.authWrapper_=new AuthWrapper(e,function(e,t){return new Reference$1(e,t)},makeRequest,this,t),this.app_=e,null!=n)this.bucket_=Location.makeFromBucketSpec(n);else{var r=this.authWrapper_.bucket();null!=r&&(this.bucket_=new Location(r,""))}this.internals_=new ServiceInternals(this)}return e.prototype.ref=function(e){if(validate("ref",[stringSpec(function(e){if(/^[A-Za-z]+:\/\//.test(e))throw"Expected child path but got a URL, use refFromURL instead."},!0)],arguments),null==this.bucket_)throw new Error("No Storage Bucket defined in Firebase Options.");var t=new Reference$1(this.authWrapper_,this.bucket_);return null!=e?t.child(e):t},e.prototype.refFromURL=function(e){return validate("refFromURL",[stringSpec(function(e){if(!/^[A-Za-z]+:\/\//.test(e))throw"Expected full URL but got a child path, use ref instead.";try{Location.makeFromUrl(e)}catch(e){throw"Expected valid full URL but got an invalid one."}},!1)],arguments),new Reference$1(this.authWrapper_,e)},Object.defineProperty(e.prototype,"maxUploadRetryTime",{get:function(){return this.authWrapper_.maxUploadRetryTime()},enumerable:!0,configurable:!0}),e.prototype.setMaxUploadRetryTime=function(e){validate("setMaxUploadRetryTime",[nonNegativeNumberSpec()],arguments),this.authWrapper_.setMaxUploadRetryTime(e)},Object.defineProperty(e.prototype,"maxOperationRetryTime",{get:function(){return this.authWrapper_.maxOperationRetryTime()},enumerable:!0,configurable:!0}),e.prototype.setMaxOperationRetryTime=function(e){validate("setMaxOperationRetryTime",[nonNegativeNumberSpec()],arguments),this.authWrapper_.setMaxOperationRetryTime(e)},Object.defineProperty(e.prototype,"app",{get:function(){return this.app_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"INTERNAL",{get:function(){return this.internals_},enumerable:!0,configurable:!0}),e}(),ServiceInternals=function(){function e(e){this.service_=e}return e.prototype.delete=function(){return this.service_.authWrapper_.deleteApp(),resolve$1(void 0)},e}(),STORAGE_TYPE="storage";function factory$1(e,t,n){return new Service$1(e,new XhrIoPool,n)}function registerStorage(e){var t={TaskState:TaskState,TaskEvent:TaskEvent,StringFormat:StringFormat,Storage:Service$1,Reference:Reference$1};e.INTERNAL.registerService(STORAGE_TYPE,factory$1,t,void 0,!0)}return registerStorage(firebase),console.warn("\nIt looks like you're using the development build of the Firebase JS SDK.\nWhen deploying Firebase apps to production, it is advisable to only import\nthe individual SDK components you intend to use.\n\nFor the CDN builds, these are available in the following manner\n(replace <PACKAGE> with the name of a component - i.e. auth, database, etc):\n\nhttps://www.gstatic.com/firebasejs/5.0.0/firebase-<PACKAGE>.js\n"),firebase}),define("firebase",["firebase/firebase"],function(e){return e}),define("babel-plugin-transform-runtime/lib/index",["require","exports","module","./definitions"],function(e,t,n){"use strict";t.__esModule=!0,t.definitions=void 0,t.default=function(e){var u=e.types;function c(e){return e.moduleName||"babel-runtime"}function l(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var r=["interopRequireWildcard","interopRequireDefault"];return{pre:function(t){var n=c(this.opts);!1!==this.opts.helpers&&t.set("helperGenerator",function(e){if(r.indexOf(e)<0)return t.addImport(n+"/helpers/"+e,"default",e)}),this.setDynamic("regeneratorIdentifier",function(){return t.addImport(n+"/regenerator","default","regeneratorRuntime")})},visitor:{ReferencedIdentifier:function(e,t){var n=e.node,r=e.parent,i=e.scope;if("regeneratorRuntime"!==n.name||!1===t.opts.regenerator){if(!1!==t.opts.polyfill&&!u.isMemberExpression(r)&&l(h.default.builtins,n.name)&&!i.getBindingIdentifier(n.name)){var o=c(t.opts);e.replaceWith(t.addImport(o+"/core-js/"+h.default.builtins[n.name],"default",n.name))}}else e.replaceWith(t.get("regeneratorIdentifier"))},CallExpression:function(e,t){if(!1!==t.opts.polyfill&&!e.node.arguments.length){var n=e.node.callee;if(u.isMemberExpression(n)&&n.computed&&e.get("callee.property").matchesPattern("Symbol.iterator")){var r=c(t.opts);e.replaceWith(u.callExpression(t.addImport(r+"/core-js/get-iterator","default","getIterator"),[n.object]))}}},BinaryExpression:function(e,t){if(!1!==t.opts.polyfill&&"in"===e.node.operator&&e.get("left").matchesPattern("Symbol.iterator")){var n=c(t.opts);e.replaceWith(u.callExpression(t.addImport(n+"/core-js/is-iterable","default","isIterable"),[e.node.right]))}},MemberExpression:{enter:function(e,t){if(!1!==t.opts.polyfill&&e.isReferenced()){var n=e.node,r=n.object,i=n.property;if(u.isReferenced(r,n)&&!n.computed&&l(h.default.methods,r.name)){var o=h.default.methods[r.name];if(l(o,i.name)&&!e.scope.getBindingIdentifier(r.name)){if("Object"===r.name&&"defineProperty"===i.name&&e.parentPath.isCallExpression()){var a=e.parentPath.node;if(3===a.arguments.length&&u.isLiteral(a.arguments[1]))return}var s=c(t.opts);e.replaceWith(t.addImport(s+"/core-js/"+o[i.name],"default",r.name+"$"+i.name))}}}},exit:function(e,t){if(!1!==t.opts.polyfill&&e.isReferenced()){var n=e.node,r=n.object;if(l(h.default.builtins,r.name)&&!e.scope.getBindingIdentifier(r.name)){var i=c(t.opts);e.replaceWith(u.memberExpression(t.addImport(i+"/core-js/"+h.default.builtins[r.name],"default",r.name),n.property,n.computed))}}}}}}};var r,i=e("./definitions"),h=(r=i)&&r.__esModule?r:{default:r};t.definitions=h.default}),define("babel-plugin-transform-runtime",["babel-plugin-transform-runtime/lib/index"],function(e){return e}),define("babel-plugin-transform-runtime/lib/definitions",["require","exports","module"],function(e,t,n){"use strict";n.exports={builtins:{Symbol:"symbol",Promise:"promise",Map:"map",WeakMap:"weak-map",Set:"set",WeakSet:"weak-set",Observable:"observable",setImmediate:"set-immediate",clearImmediate:"clear-immediate",asap:"asap"},methods:{Array:{concat:"array/concat",copyWithin:"array/copy-within",entries:"array/entries",every:"array/every",fill:"array/fill",filter:"array/filter",findIndex:"array/find-index",find:"array/find",forEach:"array/for-each",from:"array/from",includes:"array/includes",indexOf:"array/index-of",join:"array/join",keys:"array/keys",lastIndexOf:"array/last-index-of",map:"array/map",of:"array/of",pop:"array/pop",push:"array/push",reduceRight:"array/reduce-right",reduce:"array/reduce",reverse:"array/reverse",shift:"array/shift",slice:"array/slice",some:"array/some",sort:"array/sort",splice:"array/splice",unshift:"array/unshift",values:"array/values"},JSON:{stringify:"json/stringify"},Object:{assign:"object/assign",create:"object/create",defineProperties:"object/define-properties",defineProperty:"object/define-property",entries:"object/entries",freeze:"object/freeze",getOwnPropertyDescriptor:"object/get-own-property-descriptor",getOwnPropertyDescriptors:"object/get-own-property-descriptors",getOwnPropertyNames:"object/get-own-property-names",getOwnPropertySymbols:"object/get-own-property-symbols",getPrototypeOf:"object/get-prototype-of",isExtensible:"object/is-extensible",isFrozen:"object/is-frozen",isSealed:"object/is-sealed",is:"object/is",keys:"object/keys",preventExtensions:"object/prevent-extensions",seal:"object/seal",setPrototypeOf:"object/set-prototype-of",values:"object/values"},RegExp:{escape:"regexp/escape"},Math:{acosh:"math/acosh",asinh:"math/asinh",atanh:"math/atanh",cbrt:"math/cbrt",clz32:"math/clz32",cosh:"math/cosh",expm1:"math/expm1",fround:"math/fround",hypot:"math/hypot",imul:"math/imul",log10:"math/log10",log1p:"math/log1p",log2:"math/log2",sign:"math/sign",sinh:"math/sinh",tanh:"math/tanh",trunc:"math/trunc",iaddh:"math/iaddh",isubh:"math/isubh",imulh:"math/imulh",umulh:"math/umulh"},Symbol:{for:"symbol/for",hasInstance:"symbol/has-instance",isConcatSpreadable:"symbol/is-concat-spreadable",iterator:"symbol/iterator",keyFor:"symbol/key-for",match:"symbol/match",replace:"symbol/replace",search:"symbol/search",species:"symbol/species",split:"symbol/split",toPrimitive:"symbol/to-primitive",toStringTag:"symbol/to-string-tag",unscopables:"symbol/unscopables"},String:{at:"string/at",codePointAt:"string/code-point-at",endsWith:"string/ends-with",fromCodePoint:"string/from-code-point",includes:"string/includes",matchAll:"string/match-all",padLeft:"string/pad-left",padRight:"string/pad-right",padStart:"string/pad-start",padEnd:"string/pad-end",raw:"string/raw",repeat:"string/repeat",startsWith:"string/starts-with",trim:"string/trim",trimLeft:"string/trim-left",trimRight:"string/trim-right",trimStart:"string/trim-start",trimEnd:"string/trim-end"},Number:{EPSILON:"number/epsilon",isFinite:"number/is-finite",isInteger:"number/is-integer",isNaN:"number/is-nan",isSafeInteger:"number/is-safe-integer",MAX_SAFE_INTEGER:"number/max-safe-integer",MIN_SAFE_INTEGER:"number/min-safe-integer",parseFloat:"number/parse-float",parseInt:"number/parse-int"},Reflect:{apply:"reflect/apply",construct:"reflect/construct",defineProperty:"reflect/define-property",deleteProperty:"reflect/delete-property",enumerate:"reflect/enumerate",getOwnPropertyDescriptor:"reflect/get-own-property-descriptor",getPrototypeOf:"reflect/get-prototype-of",get:"reflect/get",has:"reflect/has",isExtensible:"reflect/is-extensible",ownKeys:"reflect/own-keys",preventExtensions:"reflect/prevent-extensions",setPrototypeOf:"reflect/set-prototype-of",set:"reflect/set",defineMetadata:"reflect/define-metadata",deleteMetadata:"reflect/delete-metadata",getMetadata:"reflect/get-metadata",getMetadataKeys:"reflect/get-metadata-keys",getOwnMetadata:"reflect/get-own-metadata",getOwnMetadataKeys:"reflect/get-own-metadata-keys",hasMetadata:"reflect/has-metadata",hasOwnMetadata:"reflect/has-own-metadata",metadata:"reflect/metadata"},System:{global:"system/global"},Error:{isError:"error/is-error"},Date:{},Function:{}}}}),define("aurelia-templating",["exports","aurelia-logging","aurelia-metadata","aurelia-pal","aurelia-path","aurelia-loader","aurelia-dependency-injection","aurelia-binding","aurelia-task-queue"],function(e,t,v,P,m,d,o,p,c){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TemplatingEngine=e.ElementConfigResource=e.CompositionEngine=e.SwapStrategies=e.HtmlBehaviorResource=e.BindableProperty=e.BehaviorPropertyObserver=e.Controller=e.ViewEngine=e.ModuleAnalyzer=e.ResourceDescription=e.ResourceModule=e.ViewCompiler=e.ViewFactory=e.BoundViewFactory=e.ViewSlot=e.View=e.ViewResources=e.ShadowDOM=e.ShadowSlot=e.PassThroughSlot=e.SlotCustomAttribute=e.BindingLanguage=e.ViewLocator=e.InlineViewStrategy=e.TemplateRegistryViewStrategy=e.NoViewStrategy=e.ConventionalViewStrategy=e.RelativeViewStrategy=e.viewStrategy=e.TargetInstruction=e.BehaviorInstruction=e.ViewCompileInstruction=e.ResourceLoadContext=e.ElementEvents=e.ViewEngineHooksResource=e.CompositionTransaction=e.CompositionTransactionOwnershipToken=e.CompositionTransactionNotifier=e.Animator=e.animationEvent=void 0,e._hyphenate=V,e._isAllWhitespace=j,e.viewEngineHooks=function(e){var t=function(e){v.metadata.define(v.metadata.resource,new U,e)};return e?t(e):t},e.children=function(e){return Ue(e,!0)},e.child=function(e){return Ue(e,!1)},e.resource=function(t){return function(e){v.metadata.define(v.metadata.resource,t,e)}},e.behavior=function(n){return function(e){if(n instanceof je)v.metadata.define(v.metadata.resource,n,e);else{var t=v.metadata.getOrCreateOwn(v.metadata.resource,je,e);Object.assign(t,n)}}},e.customElement=function(n){return function(e){var t=v.metadata.getOrCreateOwn(v.metadata.resource,je,e);t.elementName=Xe(n,"custom element")}},e.customAttribute=function(n,r,i){return function(e){var t=v.metadata.getOrCreateOwn(v.metadata.resource,je,e);t.attributeName=Xe(n,"custom attribute"),t.attributeDefaultBindingMode=r,t.aliases=i}},e.templateController=function(e){var t=function(e){var t=v.metadata.getOrCreateOwn(v.metadata.resource,je,e);t.liftsContent=!0};return e?t(e):t},e.bindable=function(o,e,t){var n=function(e,t,n){var r=t?e.constructor:e,i=v.metadata.getOrCreateOwn(v.metadata.resource,je,r);return t&&((o=o||{}).name=t),new Me(o).registerWith(r,i,n)};if(!o)return n;if(e){var r=o;return o=null,n(r,e,t)}return n},e.dynamicOptions=function(e){var t=function(e){var t=v.metadata.getOrCreateOwn(v.metadata.resource,je,e);t.hasDynamicOptions=!0};return e?t(e):t},e.useShadowDOM=function(e){var n="function"!=typeof e&&e?e:Je,t=function(e){var t=v.metadata.getOrCreateOwn(v.metadata.resource,je,e);t.targetShadowDOM=!0,t.shadowDOMOptions=n};return"function"==typeof e?t(e):t},e.processAttributes=function(o){return function(e){var t=v.metadata.getOrCreateOwn(v.metadata.resource,je,e);t.processAttributes=function(e,t,n,r,i){try{o(e,t,n,r,i)}catch(e){a.getLogger("templating").error(e)}}}},e.processContent=function(i){return function(e){var t=v.metadata.getOrCreateOwn(v.metadata.resource,je,e);t.processContent=i?function(e,t,n,r){try{return i(e,t,n,r)}catch(e){return a.getLogger("templating").error(e),!1}}:Ze}},e.containerless=function(e){var t=function(e){var t=v.metadata.getOrCreateOwn(v.metadata.resource,je,e);t.containerless=!0};return e?t(e):t},e.useViewStrategy=et,e.useView=function(e){return et(new z(e))},e.inlineView=function(e,t,n){return et(new J(e,t,n))},e.noView=function(e,t){var n=void 0,r=void 0;"function"==typeof e?n=e:(r=e,n=void 0);var i=function(e){v.metadata.define(Z.viewStrategyMetadataKey,new Y(r,t),e)};return n?i(n):i},e.elementConfig=function(e){var t=function(e){v.metadata.define(v.metadata.resource,new Ye,e)};return e?t(e):t},e.viewResources=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){v.metadata.define(ke.viewModelRequireMetadataKey,t,e)}};var a=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(t);var n,r,i,s,u,l,h,f,g,y,b,_,w,E,S,C,T,O,R,A,I=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},k=(e.animationEvent={enterBegin:"animation:enter:begin",enterActive:"animation:enter:active",enterDone:"animation:enter:done",enterTimeout:"animation:enter:timeout",leaveBegin:"animation:leave:begin",leaveActive:"animation:leave:active",leaveDone:"animation:leave:done",leaveTimeout:"animation:leave:timeout",staggerNext:"animation:stagger:next",removeClassBegin:"animation:remove-class:begin",removeClassActive:"animation:remove-class:active",removeClassDone:"animation:remove-class:done",removeClassTimeout:"animation:remove-class:timeout",addClassBegin:"animation:add-class:begin",addClassActive:"animation:add-class:active",addClassDone:"animation:add-class:done",addClassTimeout:"animation:add-class:timeout",animateBegin:"animation:animate:begin",animateActive:"animation:animate:active",animateDone:"animation:animate:done",animateTimeout:"animation:animate:timeout",sequenceBegin:"animation:sequence:begin",sequenceDone:"animation:sequence:done"},e.Animator=function(){function e(){}return e.prototype.enter=function(e){return Promise.resolve(!1)},e.prototype.leave=function(e){return Promise.resolve(!1)},e.prototype.removeClass=function(e,t){return e.classList.remove(t),Promise.resolve(!1)},e.prototype.addClass=function(e,t){return e.classList.add(t),Promise.resolve(!1)},e.prototype.animate=function(e,t){return Promise.resolve(!1)},e.prototype.runSequence=function(e){},e.prototype.registerEffect=function(e,t){},e.prototype.unregisterEffect=function(e){},e}()),x=e.CompositionTransactionNotifier=function(){function e(e){this.owner=e,this.owner._compositionCount++}return e.prototype.done=function(){this.owner._compositionCount--,this.owner._tryCompleteTransaction()},e}(),D=e.CompositionTransactionOwnershipToken=function(){function e(e){this.owner=e,(this.owner._ownershipToken=this).thenable=this._createThenable()}return e.prototype.waitForCompositionComplete=function(){return this.owner._tryCompleteTransaction(),this.thenable},e.prototype.resolve=function(){this._resolveCallback()},e.prototype._createThenable=function(){var n=this;return new Promise(function(e,t){n._resolveCallback=e})},e}(),M=e.CompositionTransaction=function(){function e(){this._ownershipToken=null,this._compositionCount=0}return e.prototype.tryCapture=function(){return null===this._ownershipToken?new D(this):null},e.prototype.enlist=function(){return new x(this)},e.prototype._tryCompleteTransaction=function(){if(this._compositionCount<=0&&(this._compositionCount=0,null!==this._ownershipToken)){var e=this._ownershipToken;this._ownershipToken=null,e.resolve()}},e}(),L=/([A-Z])/g;function F(e){return"-"+e.toLowerCase()}function V(e){return(e.charAt(0).toLowerCase()+e.slice(1)).replace(L,F)}function j(e){return!(e.auInterpolationTarget||/[^\t\n\r ]/.test(e.textContent))}var U=e.ViewEngineHooksResource=function(){function t(){}return t.prototype.initialize=function(e,t){this.instance=e.get(t)},t.prototype.register=function(e,t){e.registerViewEngineHooks(this.instance)},t.prototype.load=function(e,t){},t.convention=function(e){if(e.endsWith("ViewEngineHooks"))return new t},t}();var B=e.ElementEvents=function(){function e(e){this.element=e,this.subscriptions={}}return e.prototype._enqueueHandler=function(e){this.subscriptions[e.eventName]=this.subscriptions[e.eventName]||[],this.subscriptions[e.eventName].push(e)},e.prototype._dequeueHandler=function(e){var t=void 0,n=this.subscriptions[e.eventName];return n&&-1<(t=n.indexOf(e))&&n.splice(t,1),e},e.prototype.publish=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],r=!(3<arguments.length&&void 0!==arguments[3])||arguments[3],i=P.DOM.createCustomEvent(e,{cancelable:r,bubbles:n,detail:t});this.element.dispatchEvent(i)},e.prototype.subscribe=function(e,t){var n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];if("function"==typeof t)return new q(this,e,t,n,!1)},e.prototype.subscribeOnce=function(e,t){var n=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];if("function"==typeof t)return new q(this,e,t,n,!0)},e.prototype.dispose=function(e){if(e&&"string"==typeof e){var t=this.subscriptions[e];if(t)for(;t.length;){var n=t.pop();n&&n.dispose()}}else this.disposeAll()},e.prototype.disposeAll=function(){for(var e in this.subscriptions)this.dispose(e)},e}(),q=function(){function e(e,t,n,r,i){this.owner=e,this.eventName=t,this.handler=n,this.capture="boolean"==typeof r?r:r.capture,this.bubbles=!this.capture,this.captureOrOptions=r,this.once=i,e.element.addEventListener(t,this,r),e._enqueueHandler(this)}return e.prototype.handleEvent=function(e){(0,this.handler)(e),this.once&&this.dispose()},e.prototype.dispose=function(){this.owner.element.removeEventListener(this.eventName,this,this.captureOrOptions),this.owner._dequeueHandler(this),this.owner=this.handler=null},e}(),W=e.ResourceLoadContext=function(){function e(){this.dependencies={}}return e.prototype.addDependency=function(e){this.dependencies[e]=!0},e.prototype.hasDependency=function(e){return e in this.dependencies},e}(),H=e.ViewCompileInstruction=function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];this.targetShadowDOM=e,this.compileSurrogate=t,this.associatedModuleId=null};H.normal=new H;var G=e.BehaviorInstruction=function(){function i(){this.initiatedByBehavior=!1,this.enhance=!1,this.partReplacements=null,this.viewFactory=null,this.originalAttrName=null,this.skipContentProcessing=!1,this.contentFactory=null,this.viewModel=null,this.anchorIsContainer=!1,this.host=null,this.attributes=null,this.type=null,this.attrName=null,this.inheritBindingContext=!1}return i.enhance=function(){var e=new i;return e.enhance=!0,e},i.unitTest=function(e,t){var n=new i;return n.type=e,n.attributes=t||{},n},i.element=function(e,t){var n=new i;return n.type=t,n.attributes={},n.anchorIsContainer=!(e.hasAttribute("containerless")||t.containerless),n.initiatedByBehavior=!0,n},i.attribute=function(e,t){var n=new i;return n.attrName=e,n.type=t||null,n.attributes={},n},i.dynamic=function(e,t,n){var r=new i;return r.host=e,r.viewModel=t,r.viewFactory=n,r.inheritBindingContext=!0,r},i}();G.normal=new G;var K=e.TargetInstruction=(r=n=function(){function s(){this.injectorId=null,this.parentInjectorId=null,this.shadowSlot=!1,this.slotName=null,this.slotFallbackFactory=null,this.contentExpression=null,this.expressions=null,this.behaviorInstructions=null,this.providers=null,this.viewFactory=null,this.anchorIsContainer=!1,this.elementInstruction=null,this.lifting=!1,this.values=null}return s.shadowSlot=function(e){var t=new s;return t.parentInjectorId=e,t.shadowSlot=!0,t},s.contentExpression=function(e){var t=new s;return t.contentExpression=e,t},s.lifting=function(e,t){var n=new s;return n.parentInjectorId=e,n.expressions=s.noExpressions,n.behaviorInstructions=[t],n.viewFactory=t.viewFactory,n.providers=[t.type.target],n.lifting=!0,n},s.normal=function(e,t,n,r,i,o){var a=new s;return a.injectorId=e,a.parentInjectorId=t,a.providers=n,a.behaviorInstructions=r,a.expressions=i,a.anchorIsContainer=!o||o.anchorIsContainer,a.elementInstruction=o,a},s.surrogate=function(e,t,n,r){var i=new s;return i.expressions=n,i.behaviorInstructions=t,i.providers=e,i.values=r,i},s}(),n.noExpressions=Object.freeze([]),r),$=e.viewStrategy=v.protocol.create("aurelia:view-strategy",{validate:function(e){return"function"==typeof e.loadViewFactory||"View strategies must implement: loadViewFactory(viewEngine: ViewEngine, compileInstruction: ViewCompileInstruction, loadContext?: ResourceLoadContext): Promise<ViewFactory>"},compose:function(e){"function"!=typeof e.makeRelativeTo&&(e.makeRelativeTo=P.PLATFORM.noop)}}),z=e.RelativeViewStrategy=$()(i=function(){function e(e){this.path=e,this.absolutePath=null}return e.prototype.loadViewFactory=function(e,t,n,r){return null===this.absolutePath&&this.moduleId&&(this.absolutePath=(0,m.relativeToFile)(this.path,this.moduleId)),t.associatedModuleId=this.moduleId,e.loadViewFactory(this.absolutePath||this.path,t,n,r)},e.prototype.makeRelativeTo=function(e){null===this.absolutePath&&(this.absolutePath=(0,m.relativeToFile)(this.path,e))},e}())||i,Q=e.ConventionalViewStrategy=$()(s=function(){function e(e,t){this.moduleId=t.moduleId,this.viewUrl=e.convertOriginToViewUrl(t)}return e.prototype.loadViewFactory=function(e,t,n,r){return t.associatedModuleId=this.moduleId,e.loadViewFactory(this.viewUrl,t,n,r)},e}())||s,Y=e.NoViewStrategy=$()(u=function(){function e(e,t){this.dependencies=e||null,this.dependencyBaseUrl=t||""}return e.prototype.loadViewFactory=function(e,t,n,r){var i=this.entry,o=this.dependencies;if(i&&i.factoryIsReady)return Promise.resolve(null);if(this.entry=i=new d.TemplateRegistryEntry(this.moduleId||this.dependencyBaseUrl),i.dependencies=[],i.templateIsLoaded=!0,null!==o)for(var a=0,s=o.length;a<s;++a){var u=o[a];"string"==typeof u||"function"==typeof u?i.addDependency(u):i.addDependency(u.from,u.as)}return t.associatedModuleId=this.moduleId,e.loadViewFactory(i,t,n,r)},e}())||u,X=e.TemplateRegistryViewStrategy=$()(l=function(){function e(e,t){this.moduleId=e,this.entry=t}return e.prototype.loadViewFactory=function(e,t,n,r){var i=this.entry;return i.factoryIsReady?Promise.resolve(i.factory):(t.associatedModuleId=this.moduleId,e.loadViewFactory(i,t,n,r))},e}())||l,J=e.InlineViewStrategy=$()(h=function(){function e(e,t,n){this.markup=e,this.dependencies=t||null,this.dependencyBaseUrl=n||""}return e.prototype.loadViewFactory=function(e,t,n,r){var i=this.entry,o=this.dependencies;if(i&&i.factoryIsReady)return Promise.resolve(i.factory);if(this.entry=i=new d.TemplateRegistryEntry(this.moduleId||this.dependencyBaseUrl),i.template=P.DOM.createTemplateFromMarkup(this.markup),null!==o)for(var a=0,s=o.length;a<s;++a){var u=o[a];"string"==typeof u||"function"==typeof u?i.addDependency(u):i.addDependency(u.from,u.as)}return t.associatedModuleId=this.moduleId,e.loadViewFactory(i,t,n,r)},e}())||h,Z=e.ViewLocator=(g=f=function(){function i(){}return i.prototype.getViewStrategy=function(e){if(!e)return null;if("object"===(void 0===e?"undefined":N(e))&&"getViewStrategy"in e){var t=v.Origin.get(e.constructor);return"string"==typeof(e=e.getViewStrategy())&&(e=new z(e)),$.assert(e),t.moduleId&&e.makeRelativeTo(t.moduleId),e}if("string"==typeof e&&(e=new z(e)),$.validate(e))return e;"function"!=typeof e&&(e=e.constructor);var n=v.Origin.get(e),r=v.metadata.get(i.viewStrategyMetadataKey,e);if(r)n.moduleId&&(r.moduleId=n.moduleId);else{if(!n.moduleId)throw new Error("Cannot determine default view strategy for object.",e);r=this.createFallbackViewStrategy(n)}return r},i.prototype.createFallbackViewStrategy=function(e){return new Q(this,e)},i.prototype.convertOriginToViewUrl=function(e){var t=e.moduleId;return(t.endsWith(".js")||t.endsWith(".ts")?t.substring(0,t.length-3):t)+".html"},i}(),f.viewStrategyMetadataKey="aurelia:view-strategy",g);function ee(e){throw new Error("BindingLanguage must implement "+e+"().")}var te=e.BindingLanguage=function(){function e(){}return e.prototype.inspectAttribute=function(e,t,n,r){ee("inspectAttribute")},e.prototype.createAttributeInstruction=function(e,t,n,r){ee("createAttributeInstruction")},e.prototype.inspectTextContent=function(e,t){ee("inspectTextContent")},e}(),ne=Object.freeze([]),re=e.SlotCustomAttribute=(0,o.inject)(P.DOM.Element)(y=function(){function e(e){this.element=e,this.element.auSlotAttribute=this}return e.prototype.valueChanged=function(e,t){},e}())||y,ie=e.PassThroughSlot=function(){function i(e,t,n,r){this.anchor=e,(this.anchor.viewSlot=this).name=t,this.destinationName=n,this.fallbackFactory=r,this.destinationSlot=null,this.projections=0,this.contentView=null,new re(this.anchor).value=this.destinationName}return i.prototype.renderFallbackContent=function(e,t,n,r){if(null===this.contentView){this.contentView=this.fallbackFactory.create(this.ownerView.container),this.contentView.bind(this.ownerView.bindingContext,this.ownerView.overrideContext);var i=Object.create(null);i[this.destinationSlot.name]=this.destinationSlot,ae.distributeView(this.contentView,i,n,r,this.destinationSlot.name)}},i.prototype.passThroughTo=function(e){this.destinationSlot=e},i.prototype.addNode=function(e,t,n,r){null!==this.contentView&&(this.contentView.removeNodes(),this.contentView.detached(),this.contentView.unbind(),this.contentView=null),t.viewSlot instanceof i?t.viewSlot.passThroughTo(this):(this.projections++,this.destinationSlot.addNode(e,t,n,r))},i.prototype.removeView=function(e,t){this.projections--,this.destinationSlot.removeView(e,t),this.needsFallbackRendering&&this.renderFallbackContent(null,ne,t)},i.prototype.removeAll=function(e){this.projections=0,this.destinationSlot.removeAll(e),this.needsFallbackRendering&&this.renderFallbackContent(null,ne,e)},i.prototype.projectFrom=function(e,t){this.destinationSlot.projectFrom(e,t)},i.prototype.created=function(e){this.ownerView=e},i.prototype.bind=function(e){this.contentView&&this.contentView.bind(e.bindingContext,e.overrideContext)},i.prototype.attached=function(){this.contentView&&this.contentView.attached()},i.prototype.detached=function(){this.contentView&&this.contentView.detached()},i.prototype.unbind=function(){this.contentView&&this.contentView.unbind()},I(i,[{key:"needsFallbackRendering",get:function(){return this.fallbackFactory&&0===this.projections}}]),i}(),oe=e.ShadowSlot=function(){function e(e,t,n){this.anchor=e,this.anchor.isContentProjectionSource=!0,(this.anchor.viewSlot=this).name=t,this.fallbackFactory=n,this.contentView=null,this.projections=0,this.children=[],this.projectFromAnchors=null,this.destinationSlots=null}return e.prototype.addNode=function(e,t,n,r,i){if(null!==this.contentView&&(this.contentView.removeNodes(),this.contentView.detached(),this.contentView.unbind(),this.contentView=null),t.viewSlot instanceof ie)t.viewSlot.passThroughTo(this);else if(null!==this.destinationSlots)ae.distributeNodes(e,[t],this.destinationSlots,this,r);else{t.auOwnerView=e,t.auProjectionSource=n;var o=(t.auAssignedSlot=this)._findAnchor(e,t,n,r);o.parentNode.insertBefore(t,o),this.children.push(t),this.projections++}},e.prototype.removeView=function(e,t){if(null!==this.destinationSlots)ae.undistributeView(e,this.destinationSlots,this);else if(this.contentView&&this.contentView.hasSlots)ae.undistributeView(e,this.contentView.slots,t);else{var n=this.children.find(function(e){return e.auSlotProjectFrom===t});if(n){for(var r=n.auProjectionChildren,i=0,o=r.length;i<o;++i){var a=r[i];a.auOwnerView===e&&(r.splice(i,1),e.fragment.appendChild(a),i--,o--,this.projections--)}this.needsFallbackRendering&&this.renderFallbackContent(e,ne,t)}}},e.prototype.removeAll=function(t){if(null!==this.destinationSlots)ae.undistributeAll(this.destinationSlots,this);else if(this.contentView&&this.contentView.hasSlots)ae.undistributeAll(this.contentView.slots,t);else{var e=this.children.find(function(e){return e.auSlotProjectFrom===t});if(e){for(var n=e.auProjectionChildren,r=0,i=n.length;r<i;++r){var o=n[r];o.auOwnerView.fragment.appendChild(o),this.projections--}e.auProjectionChildren=[],this.needsFallbackRendering&&this.renderFallbackContent(null,ne,t)}}},e.prototype._findAnchor=function(e,t,n,r){if(n){var i=this.children.find(function(e){return e.auSlotProjectFrom===n});if(i){if(void 0!==r)for(var o=i.auProjectionChildren,a=-1,s=void 0,u=0,c=o.length;u<c;++u){var l=o[u];if(l.auOwnerView!==s&&(a++,s=l.auOwnerView,r<=a&&s!==e))return o.splice(u,0,t),l}return i.auProjectionChildren.push(t),i}}return this.anchor},e.prototype.projectTo=function(e){this.destinationSlots=e},e.prototype.projectFrom=function(e,t){var n=P.DOM.createComment("anchor"),r=this.anchor.parentNode;n.auSlotProjectFrom=t,n.auOwnerView=e,n.auProjectionChildren=[],r.insertBefore(n,this.anchor),this.children.push(n),null===this.projectFromAnchors&&(this.projectFromAnchors=[]),this.projectFromAnchors.push(n)},e.prototype.renderFallbackContent=function(e,t,n,r){if(null===this.contentView&&(this.contentView=this.fallbackFactory.create(this.ownerView.container),this.contentView.bind(this.ownerView.bindingContext,this.ownerView.overrideContext),this.contentView.insertNodesBefore(this.anchor)),this.contentView.hasSlots){var i=this.contentView.slots,o=this.projectFromAnchors;if(null!==o)for(var a in i)for(var s=i[a],u=0,c=o.length;u<c;++u){var l=o[u];s.projectFrom(l.auOwnerView,l.auSlotProjectFrom)}this.fallbackSlots=i,ae.distributeNodes(e,t,i,n,r)}},e.prototype.created=function(e){this.ownerView=e},e.prototype.bind=function(e){this.contentView&&this.contentView.bind(e.bindingContext,e.overrideContext)},e.prototype.attached=function(){this.contentView&&this.contentView.attached()},e.prototype.detached=function(){this.contentView&&this.contentView.detached()},e.prototype.unbind=function(){this.contentView&&this.contentView.unbind()},I(e,[{key:"needsFallbackRendering",get:function(){return this.fallbackFactory&&0===this.projections}}]),e}(),ae=e.ShadowDOM=(_=b=function(){function p(){}return p.getSlotName=function(e){return void 0===e.auSlotAttribute?p.defaultSlotKey:e.auSlotAttribute.value},p.distributeView=function(e,t,n,r,i){var o=void 0;if(null===e)o=ne;else{var a=e.fragment.childNodes,s=a.length;o=new Array(s);for(var u=0;u<s;++u)o[u]=a[u]}p.distributeNodes(e,o,t,n,r,i)},p.undistributeView=function(e,t,n){for(var r in t)t[r].removeView(e,n)},p.undistributeAll=function(e,t){for(var n in e)e[n].removeAll(t)},p.distributeNodes=function(e,t,n,r,i,o){for(var a=0,s=t.length;a<s;++a){var u=t[a],c=u.nodeType;if(u.isContentProjectionSource){for(var l in u.viewSlot.projectTo(n),n)n[l].projectFrom(e,u.viewSlot);t.splice(a,1),s--,a--}else if(1===c||3===c||u.viewSlot instanceof ie)if(3===c&&j(u))t.splice(a,1),s--,a--;else{var h=n[o||p.getSlotName(u)];h&&(h.addNode(e,u,r,i),t.splice(a,1),s--,a--)}else t.splice(a,1),s--,a--}for(var f in n){var d=n[f];d.needsFallbackRendering&&d.renderFallbackContent(e,t,r,i)}},p}(),b.defaultSlotKey="__au-default-slot-key__",_);function se(e,t,n,r){if(t){var i=e[t];if(i){if(i!==n)throw new Error("Attempted to register "+r+" when one with the same name already exists. Name: "+t+".")}else e[t]=n}}var ue=e.ViewResources=function(){function e(e,t){this.bindingLanguage=null,this.parent=e||null,this.hasParent=null!==this.parent,this.viewUrl=t||"",this.lookupFunctions={valueConverters:this.getValueConverter.bind(this),bindingBehaviors:this.getBindingBehavior.bind(this)},this.attributes=Object.create(null),this.elements=Object.create(null),this.valueConverters=Object.create(null),this.bindingBehaviors=Object.create(null),this.attributeMap=Object.create(null),this.values=Object.create(null),this.beforeCompile=this.afterCompile=this.beforeCreate=this.afterCreate=this.beforeBind=this.beforeUnbind=!1}return e.prototype._tryAddHook=function(e,t){if("function"==typeof e[t]){for(var n=e[t].bind(e),r=1,i=void 0;void 0!==this[i=t+r.toString()];)r++;this[t]=!0,this[i]=n}},e.prototype._invokeHook=function(e,t,n,r,i){if(this.hasParent&&this.parent._invokeHook(e,t,n,r,i),this[e]){this[e+"1"](t,n,r,i);var o=e+"2";if(this[o]&&(this[o](t,n,r,i),this[o=e+"3"])){this[o](t,n,r,i);for(var a=4;void 0!==this[o=e+a.toString()];)this[o](t,n,r,i),a++}}},e.prototype.registerViewEngineHooks=function(e){this._tryAddHook(e,"beforeCompile"),this._tryAddHook(e,"afterCompile"),this._tryAddHook(e,"beforeCreate"),this._tryAddHook(e,"afterCreate"),this._tryAddHook(e,"beforeBind"),this._tryAddHook(e,"beforeUnbind")},e.prototype.getBindingLanguage=function(e){return this.bindingLanguage||(this.bindingLanguage=e)},e.prototype.patchInParent=function(e){var t=this.parent;this.parent=e||null,this.hasParent=null!==this.parent,null===e.parent&&(e.parent=t,e.hasParent=null!==t)},e.prototype.relativeToView=function(e){return(0,m.relativeToFile)(e,this.viewUrl)},e.prototype.registerElement=function(e,t){se(this.elements,e,t,"an Element")},e.prototype.getElement=function(e){return this.elements[e]||(this.hasParent?this.parent.getElement(e):null)},e.prototype.mapAttribute=function(e){return this.attributeMap[e]||(this.hasParent?this.parent.mapAttribute(e):null)},e.prototype.registerAttribute=function(e,t,n){this.attributeMap[e]=n,se(this.attributes,e,t,"an Attribute")},e.prototype.getAttribute=function(e){return this.attributes[e]||(this.hasParent?this.parent.getAttribute(e):null)},e.prototype.registerValueConverter=function(e,t){se(this.valueConverters,e,t,"a ValueConverter")},e.prototype.getValueConverter=function(e){return this.valueConverters[e]||(this.hasParent?this.parent.getValueConverter(e):null)},e.prototype.registerBindingBehavior=function(e,t){se(this.bindingBehaviors,e,t,"a BindingBehavior")},e.prototype.getBindingBehavior=function(e){return this.bindingBehaviors[e]||(this.hasParent?this.parent.getBindingBehavior(e):null)},e.prototype.registerValue=function(e,t){se(this.values,e,t,"a value")},e.prototype.getValue=function(e){return this.values[e]||(this.hasParent?this.parent.getValue(e):null)},e}(),ce=e.View=function(){function e(e,t,n,r,i,o,a){for(var s in this.container=e,this.viewFactory=t,this.resources=t.resources,this.fragment=n,this.firstChild=n.firstChild,this.lastChild=n.lastChild,this.controllers=r,this.bindings=i,this.children=o,this.slots=a,this.hasSlots=!1,this.fromCache=!1,this.isBound=!1,this.isAttached=!1,this.bindingContext=null,this.overrideContext=null,this.controller=null,this.viewModelScope=null,this.animatableElement=void 0,this._isUserControlled=!1,this.contentView=null,a){this.hasSlots=!0;break}}return e.prototype.returnToCache=function(){this.viewFactory.returnViewToCache(this)},e.prototype.created=function(){var e,t=void 0,n=this.controllers;for(t=0,e=n.length;t<e;++t)n[t].created(this)},e.prototype.bind=function(e,t,n){var r=void 0,i=void 0,o=void 0,a=void 0,s=void 0;if(!n||!this._isUserControlled){if(this.isBound){if(this.bindingContext===e)return;this.unbind()}for(this.isBound=!0,this.bindingContext=e,this.overrideContext=t||(0,p.createOverrideContext)(e),this.resources._invokeHook("beforeBind",this),a=0,s=(i=this.bindings).length;a<s;++a)i[a].bind(this);for(null!==this.viewModelScope&&(e.bind(this.viewModelScope.bindingContext,this.viewModelScope.overrideContext),this.viewModelScope=null),a=0,s=(r=this.controllers).length;a<s;++a)r[a].bind(this);for(a=0,s=(o=this.children).length;a<s;++a)o[a].bind(e,t,!0);this.hasSlots&&ae.distributeView(this.contentView,this.slots)}},e.prototype.addBinding=function(e){this.bindings.push(e),this.isBound&&e.bind(this)},e.prototype.unbind=function(){var e=void 0,t=void 0,n=void 0,r=void 0,i=void 0;if(this.isBound){for(this.isBound=!1,this.resources._invokeHook("beforeUnbind",this),null!==this.controller&&this.controller.unbind(),r=0,i=(t=this.bindings).length;r<i;++r)t[r].unbind();for(r=0,i=(e=this.controllers).length;r<i;++r)e[r].unbind();for(r=0,i=(n=this.children).length;r<i;++r)n[r].unbind();this.bindingContext=null,this.overrideContext=null}},e.prototype.insertNodesBefore=function(e){e.parentNode.insertBefore(this.fragment,e)},e.prototype.appendNodesTo=function(e){e.appendChild(this.fragment)},e.prototype.removeNodes=function(){for(var e=this.fragment,t=this.firstChild,n=this.lastChild,r=void 0;t&&(r=t.nextSibling,e.appendChild(t),t!==n);)t=r},e.prototype.attached=function(){var e=void 0,t=void 0,n=void 0,r=void 0;if(!this.isAttached){for(this.isAttached=!0,null!==this.controller&&this.controller.attached(),n=0,r=(e=this.controllers).length;n<r;++n)e[n].attached();for(n=0,r=(t=this.children).length;n<r;++n)t[n].attached()}},e.prototype.detached=function(){var e=void 0,t=void 0,n=void 0,r=void 0;if(this.isAttached){for(this.isAttached=!1,null!==this.controller&&this.controller.detached(),n=0,r=(e=this.controllers).length;n<r;++n)e[n].detached();for(n=0,r=(t=this.children).length;n<r;++n)t[n].detached()}},e}();var le=e.ViewSlot=function(){function e(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:k.instance;this.anchor=e,this.anchorIsContainer=t,this.bindingContext=null,this.overrideContext=null,this.animator=n,this.children=[],this.isBound=!1,this.isAttached=!1,this.contentSelectors=null,e.viewSlot=this,e.isContentProjectionSource=!1}return e.prototype.animateView=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"enter",n=function(e){if(void 0!==e.animatableElement)return e.animatableElement;for(var t=e.firstChild;t&&1!==t.nodeType;)t=t.nextSibling;return t&&1===t.nodeType?e.animatableElement=t.classList.contains("au-animate")?t:null:e.animatableElement=null}(e);if(null!==n)switch(t){case"enter":return this.animator.enter(n);case"leave":return this.animator.leave(n);default:throw new Error("Invalid animation direction: "+t)}},e.prototype.transformChildNodesIntoView=function(){var t=this.anchor;this.children.push({fragment:t,firstChild:t.firstChild,lastChild:t.lastChild,returnToCache:function(){},removeNodes:function(){for(var e=void 0;e=t.lastChild;)t.removeChild(e)},created:function(){},bind:function(){},unbind:function(){},attached:function(){},detached:function(){}})},e.prototype.bind=function(e,t){var n,r=void 0,i=void 0;if(this.isBound){if(this.bindingContext===e)return;this.unbind()}for(this.isBound=!0,this.bindingContext=e=e||this.bindingContext,this.overrideContext=t=t||this.overrideContext,r=0,n=(i=this.children).length;r<n;++r)i[r].bind(e,t,!0)},e.prototype.unbind=function(){if(this.isBound){var e,t=void 0,n=this.children;for(this.isBound=!1,this.bindingContext=null,this.overrideContext=null,t=0,e=n.length;t<e;++t)n[t].unbind()}},e.prototype.add=function(e){if(this.anchorIsContainer?e.appendNodesTo(this.anchor):e.insertNodesBefore(this.anchor),this.children.push(e),this.isAttached)return e.attached(),this.animateView(e,"enter")},e.prototype.insert=function(e,t){var n=this.children,r=n.length;return 0===e&&0===r||r<=e?this.add(t):(t.insertNodesBefore(n[e].firstChild),n.splice(e,0,t),this.isAttached?(t.attached(),this.animateView(t,"enter")):void 0)},e.prototype.move=function(e,t){if(e!==t){var n=this.children,r=n[e];r.removeNodes(),r.insertNodesBefore(n[t].firstChild),n.splice(e,1),n.splice(t,0,r)}},e.prototype.remove=function(e,t,n){return this.removeAt(this.children.indexOf(e),t,n)},e.prototype.removeMany=function(t,n,r){var i=this,o=this.children,a=t.length,s=void 0,u=[];t.forEach(function(e){if(r)e.removeNodes();else{var t=i.animateView(e,"leave");t?u.push(t.then(function(){return e.removeNodes()})):e.removeNodes()}});var e=function(){if(i.isAttached)for(s=0;s<a;++s)t[s].detached();if(n)for(s=0;s<a;++s)t[s].returnToCache();for(s=0;s<a;++s){var e=o.indexOf(t[s]);0<=e&&o.splice(e,1)}};return 0<u.length?Promise.all(u).then(function(){return e()}):e()},e.prototype.removeAt=function(e,t,n){var r=this,i=this.children[e],o=function(){return e=r.children.indexOf(i),i.removeNodes(),r.children.splice(e,1),r.isAttached&&i.detached(),t&&i.returnToCache(),i};if(!n){var a=this.animateView(i,"leave");if(a)return a.then(function(){return o()})}return o()},e.prototype.removeAll=function(t,n){var r=this,i=this.children,o=i.length,a=void 0,s=[];i.forEach(function(e){if(n)e.removeNodes();else{var t=r.animateView(e,"leave");t?s.push(t.then(function(){return e.removeNodes()})):e.removeNodes()}});var e=function(){if(r.isAttached)for(a=0;a<o;++a)i[a].detached();if(t)for(a=0;a<o;++a){var e=i[a];e&&e.returnToCache()}r.children=[]};return 0<s.length?Promise.all(s).then(function(){return e()}):e()},e.prototype.attached=function(){var e,t,n=void 0,r=void 0;if(!this.isAttached)for(this.isAttached=!0,n=0,e=(t=this.children).length;n<e;++n)(r=t[n]).attached(),this.animateView(r,"enter")},e.prototype.detached=function(){var e=void 0,t=void 0,n=void 0;if(this.isAttached)for(this.isAttached=!1,e=0,t=(n=this.children).length;e<t;++e)n[e].detached()},e.prototype.projectTo=function(t){var n=this;this.projectToSlots=t,this.add=this._projectionAdd,this.insert=this._projectionInsert,this.move=this._projectionMove,this.remove=this._projectionRemove,this.removeAt=this._projectionRemoveAt,this.removeMany=this._projectionRemoveMany,this.removeAll=this._projectionRemoveAll,this.children.forEach(function(e){return ae.distributeView(e,t,n)})},e.prototype._projectionAdd=function(e){ae.distributeView(e,this.projectToSlots,this),this.children.push(e),this.isAttached&&e.attached()},e.prototype._projectionInsert=function(e,t){0===e&&!this.children.length||e>=this.children.length?this.add(t):(ae.distributeView(t,this.projectToSlots,this,e),this.children.splice(e,0,t),this.isAttached&&t.attached())},e.prototype._projectionMove=function(e,t){if(e!==t){var n=this.children,r=n[e];ae.undistributeView(r,this.projectToSlots,this),ae.distributeView(r,this.projectToSlots,this,t),n.splice(e,1),n.splice(t,0,r)}},e.prototype._projectionRemove=function(e,t){ae.undistributeView(e,this.projectToSlots,this),this.children.splice(this.children.indexOf(e),1),this.isAttached&&e.detached()},e.prototype._projectionRemoveAt=function(e,t){var n=this.children[e];ae.undistributeView(n,this.projectToSlots,this),this.children.splice(e,1),this.isAttached&&n.detached()},e.prototype._projectionRemoveMany=function(e,t){var n=this;e.forEach(function(e){return n.remove(e,t)})},e.prototype._projectionRemoveAll=function(e){ae.undistributeAll(this.projectToSlots,this);var t=this.children;if(this.isAttached)for(var n=0,r=t.length;n<r;++n)t[n].detached();this.children=[]},e}(),he=new((0,o.resolver)(w=function(){function e(){}return e.prototype.get=function(e,t){var n=t.__providerId__;return n in e?e[n]:e[n]=e.invoke(t)},e}())||w);function fe(e){if(e===P.DOM.Element)return this.element;if(e===be){if(this.boundViewFactory)return this.boundViewFactory;var t=this.instruction.viewFactory,n=this.partReplacements;return n&&(t=n[t.part]||t),this.boundViewFactory=new be(this,t,n),this.boundViewFactory}return e===le?(void 0===this.viewSlot&&(this.viewSlot=new le(this.element,this.instruction.anchorIsContainer),this.element.isContentProjectionSource=this.instruction.lifting,this.children.push(this.viewSlot)),this.viewSlot):e===B?this.elementEvents||(this.elementEvents=new B(this.element)):e===M?this.compositionTransaction||(this.compositionTransaction=this.parent.get(e)):e===ue?this.viewResources:e===K?this.instruction:this.superGet(e)}function de(e){return this._element.hasAttribute(e)}function pe(e){return this._element.getAttribute(e)}function ve(e,t){this._element.setAttribute(e,t)}function me(e,t,n,r,i,o,a,s,u){var c=n.behaviorInstructions,l=n.expressions,h=void 0,f=void 0,d=void 0,p=void 0,v=void 0;if(n.contentExpression)return i.push(n.contentExpression.createBinding(t.nextSibling)),t.nextSibling.auInterpolationTarget=!0,void t.parentNode.removeChild(t);if(n.shadowSlot){var m=P.DOM.createComment("slot"),g=void 0;return g=n.slotDestination?new ie(m,n.slotName,n.slotDestination,n.slotFallbackFactory):new oe(m,n.slotName,n.slotFallbackFactory),P.DOM.replaceNode(m,t),a[n.slotName]=g,void r.push(g)}if(c.length)for(n.anchorIsContainer||(t=function(e,t){var n=P.DOM.createComment("anchor");if(t){var r=e.firstChild;r&&"AU-CONTENT"===r.tagName&&(n.contentElement=r),n._element=e,n.hasAttribute=de,n.getAttribute=pe,n.setAttribute=ve}return P.DOM.replaceNode(n,e),n}(t,n.elementInstruction)),e[n.injectorId]=h=function(e,t,n,r,i,o){var a,s=e.createChild(),u=void 0;for(s.element=t,s.instruction=n,s.children=r,s.viewResources=o,s.partReplacements=i,u=(a=n.providers).length;u--;)s._resolvers.set(a[u],he);return s.superGet=s.get,s.get=fe,s}(e[n.parentInjectorId],t,n,o,s,u),f=0,d=c.length;f<d;++f)v=(p=c[f]).type.create(h,p,t,i),r.push(v);for(f=0,d=l.length;f<d;++f)i.push(l[f].createBinding(t))}function ge(e,t){var n=e.split(";"),r=void 0,i=void 0,o=void 0,a=void 0,s=void 0;for(t=t||{},i=0;i<n.length;i++)r=(o=n[i]).indexOf(":"),a=o.substring(0,r).trim(),s=o.substring(r+1).trim(),t[a]=s;return t}function ye(e){var t="";for(var n in e)t+=n+":"+e[n]+";";return t}var be=e.BoundViewFactory=function(){function e(e,t,n){this.parentContainer=e,this.viewFactory=t,this.factoryCreateInstruction={partReplacements:n}}return e.prototype.create=function(){var e=this.viewFactory.create(this.parentContainer.createChild(),this.factoryCreateInstruction);return e._isUserControlled=!0,e},e.prototype.setCacheSize=function(e,t){this.viewFactory.setCacheSize(e,t)},e.prototype.getCachedView=function(){return this.viewFactory.getCachedView()},e.prototype.returnViewToCache=function(e){this.viewFactory.returnViewToCache(e)},I(e,[{key:"isCaching",get:function(){return this.viewFactory.isCaching}}]),e}(),_e=e.ViewFactory=function(){function e(e,t,n){this.isCaching=!1,this.template=e,this.instructions=t,this.resources=n,this.cacheSize=-1,this.cache=null}return e.prototype.setCacheSize=function(e,t){e&&("*"===e?e=Number.MAX_VALUE:"string"==typeof e&&(e=parseInt(e,10))),-1!==this.cacheSize&&t||(this.cacheSize=e),0<this.cacheSize?this.cache=[]:this.cache=null,this.isCaching=0<this.cacheSize},e.prototype.getCachedView=function(){return null!==this.cache&&this.cache.pop()||null},e.prototype.returnViewToCache=function(e){e.isAttached&&e.detached(),e.isBound&&e.unbind(),null!==this.cache&&this.cache.length<this.cacheSize&&(e.fromCache=!0,this.cache.push(e))},e.prototype.create=function(e,t,n){t=t||G.normal;var r=this.getCachedView();if(null!==r)return r;var i,o=t.enhance?this.template:this.template.cloneNode(!0),a=o.querySelectorAll(".au-target"),s=this.instructions,u=this.resources,c=[],l=[],h=[],f=Object.create(null),d={root:e},p=t.partReplacements,v=void 0,m=void 0,g=void 0;for(this.resources._invokeHook("beforeCreate",this,e,o,t),n&&null!==this.surrogateInstruction&&function(e,t,n,r,i,o){var a=n.behaviorInstructions,s=n.expressions,u=n.providers,c=n.values,l=void 0,h=void 0,f=void 0,d=void 0,p=void 0;for(l=u.length;l--;)e._resolvers.set(u[l],he);for(var v in c)if(p=t.getAttribute(v)){if("class"===v)t.setAttribute("class",p+" "+c[v]);else if("style"===v){var m=ge(c[v]);ge(p,m),t.setAttribute("style",ye(m))}}else t.setAttribute(v,c[v]);if(a.length)for(l=0,h=a.length;l<h;++l)(d=(f=a[l]).type.create(e,f,t,i)).contentView&&o.push(d.contentView),r.push(d);for(l=0,h=s.length;l<h;++l)i.push(s[l].createBinding(t))}(e,n,this.surrogateInstruction,c,l,h),t.enhance&&o.hasAttribute("au-target-id")&&me(d,g=o,s[g.getAttribute("au-target-id")],c,l,h,f,p,u),v=0,i=a.length;v<i;++v)me(d,g=a[v],s[g.getAttribute("au-target-id")],c,l,h,f,p,u);return m=new ce(e,this,o,c,l,h,f),t.initiatedByBehavior||m.created(),this.resources._invokeHook("afterCreate",m),m},e}(),we=0;var Ee=0;function Se(e){var t=e.getAttribute("class"),n=(++Ee).toString();return e.setAttribute("class",t?t+" au-target":"au-target"),e.setAttribute("au-target-id",n),n}var Ce=e.ViewCompiler=(0,o.inject)(te,ue)(E=function(){function e(e,t){this.bindingLanguage=e,this.resources=t}return e.prototype.compile=function(e,t,n){t=t||this.resources,n=n||H.normal;var r=void 0,i=void 0,o=void 0;(e="string"==typeof e?P.DOM.createTemplateFromMarkup(e):e).content?(i=e.getAttribute("part"),o=e.getAttribute("view-cache"),r=P.DOM.adoptNode(e.content)):r=e,n.targetShadowDOM=n.targetShadowDOM&&P.FEATURE.shadowDOM,t._invokeHook("beforeCompile",r,t,n);var a={};this._compileNode(r,t,a,e,"root",!n.targetShadowDOM);var s=r.firstChild;if(s&&1===s.nodeType){var u=s.getAttribute("au-target-id");if(u){var c=a[u];(c.shadowSlot||c.lifting||c.elementInstruction&&!c.elementInstruction.anchorIsContainer)&&r.insertBefore(P.DOM.createComment("view"),s)}}var l=new _e(r,a,t);return l.surrogateInstruction=n.compileSurrogate?this._compileSurrogate(e,t):null,l.part=i,o&&l.setCacheSize(o),t._invokeHook("afterCompile",l),l},e.prototype._compileNode=function(e,t,n,r,i,o){switch(e.nodeType){case 1:return this._compileElement(e,t,n,r,i,o);case 3:var a=t.getBindingLanguage(this.bindingLanguage).inspectTextContent(t,e.wholeText);if(a){var s=P.DOM.createElement("au-marker"),u=Se(s);for((e.parentNode||r).insertBefore(s,e),e.textContent=" ",n[u]=K.contentExpression(a);e.nextSibling&&3===e.nextSibling.nodeType;)(e.parentNode||r).removeChild(e.nextSibling)}else for(;e.nextSibling&&3===e.nextSibling.nodeType;)e=e.nextSibling;return e.nextSibling;case 11:for(var c=e.firstChild;c;)c=this._compileNode(c,t,n,e,i,o)}return e.nextSibling},e.prototype._compileSurrogate=function(e,t){var n=e.tagName.toLowerCase(),r=e.attributes,i=t.getBindingLanguage(this.bindingLanguage),o=void 0,a=void 0,s=void 0,u=void 0,c=void 0,l=void 0,h=void 0,f=void 0,d=void 0,p=void 0,v=[],m=void 0,g=[],y={},b=!1,_=[];for(u=0,c=r.length;u<c;++u){if(h=(l=r[u]).name,f=l.value,d=i.inspectAttribute(t,n,h,f),(p=t.getAttribute(d.attrName))&&(o=t.mapAttribute(d.attrName))&&(a=p.attributes[o])&&(d.defaultBindingMode=a.defaultBindingMode,d.command||d.expression||(d.command=a.hasOptions?"options":null),d.command&&"options"!==d.command&&p.primaryProperty)){var w=p.primaryProperty;h=d.attrName=w.attribute,d.defaultBindingMode=w.defaultBindingMode}if(s=i.createAttributeInstruction(t,e,d,void 0,p))if(s.alteredAttr&&(p=t.getAttribute(s.attrName)),s.discrete)v.push(s);else if(p){if(s.type=p,this._configureProperties(s,t),p.liftsContent)throw new Error("You cannot place a template controller on a surrogate element.");g.push(s)}else v.push(s.attributes[s.attrName]);else if(p){if((s=G.attribute(h,p)).attributes[t.mapAttribute(h)]=f,p.liftsContent)throw new Error("You cannot place a template controller on a surrogate element.");g.push(s)}else"id"!==h&&"part"!==h&&"replace-part"!==h&&(b=!0,y[h]=f)}if(v.length||g.length||b){for(u=0,c=g.length;u<c;++u)(s=g[u]).type.compile(this,t,e,s),_.push(s.type.target);for(u=0,c=v.length;u<c;++u)void 0!==(m=v[u]).attrToRemove&&e.removeAttribute(m.attrToRemove);return K.surrogate(_,g,v,y)}return null},e.prototype._compileElement=function(e,t,n,r,i,o){var a=e.tagName.toLowerCase(),s=e.attributes,u=[],c=void 0,l=[],h=[],f=t.getBindingLanguage(this.bindingLanguage),d=void 0,p=void 0,v=void 0,m=void 0,g=void 0,y=void 0,b=void 0,_=void 0,w=void 0,E=void 0,S=void 0,C=void 0,T=void 0,O=void 0,R=void 0,A=void 0;if("slot"===a)return o&&(e=function(e,t,n,r,i){var o=P.DOM.createElement("au-shadow-slot");P.DOM.replaceNode(o,n);var a=Se(o),s=K.shadowSlot(i);if(s.slotName=n.getAttribute("name")||ae.defaultSlotKey,s.slotDestination=n.getAttribute("slot"),n.innerHTML.trim()){for(var u=P.DOM.createDocumentFragment(),c=void 0;c=n.firstChild;)u.appendChild(c);s.slotFallbackFactory=e.compile(u,t)}return r[a]=s,o}(this,t,e,n,i)),e.nextSibling;if("template"===a){if(!("content"in e))throw new Error("You cannot place a template element within "+e.namespaceURI+" namespace");(p=this.compile(e,t)).part=e.getAttribute("part")}else(v=t.getElement(e.getAttribute("as-element")||a))&&(m=G.element(e,v),v.processAttributes(this,t,e,s,m),l.push(m));for(y=0,b=s.length;y<b;++y){if(S=w=(_=s[y]).name,E=_.value,T=f.inspectAttribute(t,a,w,E),o&&"slot"===T.attrName&&(T.attrName=w="au-slot"),g=null,v=t.getAttribute(T.attrName)){if((R=t.mapAttribute(T.attrName))&&(O=v.attributes[R])&&(T.defaultBindingMode=O.defaultBindingMode,T.command||T.expression||(T.command=O.hasOptions?"options":null),T.command&&"options"!==T.command&&v.primaryProperty)){var I=v.primaryProperty;w=T.attrName=I.attribute,T.defaultBindingMode=I.defaultBindingMode}}else m&&(g=m.type.attributes[T.attrName])&&(T.defaultBindingMode=g.defaultBindingMode);if(C=g?f.createAttributeInstruction(t,e,T,m):f.createAttributeInstruction(t,e,T,void 0,v))if(C.alteredAttr&&(v=t.getAttribute(C.attrName)),C.discrete)u.push(C);else if(v){if(C.type=v,this._configureProperties(C,t),v.liftsContent){C.originalAttrName=S,d=C;break}l.push(C)}else g?m.attributes[T.attrName].targetProperty=g.name:u.push(C.attributes[C.attrName]);else if(v){if((C=G.attribute(w,v)).attributes[t.mapAttribute(w)]=E,v.liftsContent){C.originalAttrName=S,d=C;break}l.push(C)}else g&&(m.attributes[w]=E)}if(d)d.viewFactory=p,n[Se(e=d.type.compile(this,t,e,d,r))]=K.lifting(i,d);else{var N=!1;if(u.length||l.length){for(A=!!l.length&&++we,y=0,b=l.length;y<b;++y)(C=l[y]).type.compile(this,t,e,C,r),h.push(C.type.target),N=N||C.skipContentProcessing;for(y=0,b=u.length;y<b;++y)void 0!==(c=u[y]).attrToRemove&&e.removeAttribute(c.attrToRemove);n[Se(e)]=K.normal(A,i,h,l,u,m)}if(N)return e.nextSibling;for(var k=e.firstChild;k;)k=this._compileNode(k,t,n,e,A||i,o)}return e.nextSibling},e.prototype._configureProperties=function(e,t){var n=e.type,r=e.attrName,i=e.attributes,o=void 0,a=void 0,s=void 0,u=t.mapAttribute(r);for(a in u&&r in i&&u!==r&&(i[u]=i[r],delete i[r]),i)null!==(s=i[a])&&"object"===(void 0===s?"undefined":N(s))&&(o=n.attributes[a],s.targetProperty=void 0!==o?o.name:a)},e}())||E,Te=e.ResourceModule=function(){function e(e){this.id=e,this.moduleInstance=null,this.mainResource=null,this.resources=null,this.viewStrategy=null,this.isInitialized=!1,this.onLoaded=null,this.loadContext=null}return e.prototype.initialize=function(e){var t=this.mainResource,n=this.resources,r=this.viewStrategy;if(!this.isInitialized){this.isInitialized=!0,void 0!==t&&(t.metadata.viewStrategy=r,t.initialize(e));for(var i=0,o=n.length;i<o;++i)(t=n[i]).metadata.viewStrategy=r,t.initialize(e)}},e.prototype.register=function(e,t){var n=this.mainResource,r=this.resources;void 0!==n&&(n.register(e,t),t=null);for(var i=0,o=r.length;i<o;++i)r[i].register(e,t),t=null},e.prototype.load=function(e,t){if(null!==this.onLoaded)return this.loadContext===t?Promise.resolve():this.onLoaded;var n=this.mainResource,r=this.resources,i=void 0;if(void 0!==n){(i=new Array(r.length+1))[0]=n.load(e,t);for(var o=0,a=r.length;o<a;++o)i[o+1]=r[o].load(e,t)}else{i=new Array(r.length);for(var s=0,u=r.length;s<u;++s)i[s]=r[s].load(e,t)}return this.loadContext=t,this.onLoaded=Promise.all(i),this.onLoaded},e}(),Oe=e.ResourceDescription=function(){function e(e,t,n){n||(n=v.metadata.get(v.metadata.resource,t))||((n=new je).elementName=V(e),v.metadata.define(v.metadata.resource,n,t)),n instanceof je?void 0===n.elementName?n.elementName=V(e):void 0===n.attributeName?n.attributeName=V(e):null===n.attributeName&&null===n.elementName&&je.convention(e,n):n.name||(n.name=V(e)),this.metadata=n,this.value=t}return e.prototype.initialize=function(e){this.metadata.initialize(e,this.value)},e.prototype.register=function(e,t){this.metadata.register(e,t)},e.prototype.load=function(e,t){return this.metadata.load(e,this.value,t)},e}(),Re=e.ModuleAnalyzer=function(){function e(){this.cache=Object.create(null)}return e.prototype.getAnalysis=function(e){return this.cache[e]},e.prototype.analyze=function(e,t,n){var r=void 0,i=void 0,o=void 0,a=void 0,s=void 0,u=void 0,c=[],l=void 0,h=void 0,f=void 0;if(f=this.cache[e])return f;for(s in f=new Te(e),this.cache[e]=f,"function"==typeof t&&(t={default:t}),n&&(r=new Oe(n,t[n])),t)u=t[s],s!==n&&"function"==typeof u&&((a=v.metadata.get(v.metadata.resource,u))?(null===a.attributeName&&null===a.elementName&&je.convention(s,a),null===a.attributeName&&null===a.elementName&&(a.elementName=V(s)),!r&&a instanceof je&&null!==a.elementName?r=new Oe(s,u,a):c.push(new Oe(s,u,a))):$.decorates(u)?h=u:u instanceof d.TemplateRegistryEntry?h=new X(e,u):(l=je.convention(s))?(null===l.elementName||r?c.push(new Oe(s,u,l)):r=new Oe(s,u,l),v.metadata.define(v.metadata.resource,l,u)):(l=p.ValueConverterResource.convention(s)||p.BindingBehaviorResource.convention(s)||U.convention(s))?(c.push(new Oe(s,u,l)),v.metadata.define(v.metadata.resource,l,u)):i||(i=u,o=s));return!r&&i&&(r=new Oe(o,i)),f.moduleInstance=t,f.mainResource=r,f.resources=c,f.viewStrategy=h,f},e}(),Ae=a.getLogger("templating");var Ie=function(){function e(e){var t=this;e.then(function(e){return t.viewFactory=e})}return e.prototype.create=function(e,t,n,r){return this.viewFactory.create(e,t,n,r)},e.prototype.setCacheSize=function(e,t){this.viewFactory.setCacheSize(e,t)},e.prototype.getCachedView=function(){return this.viewFactory.getCachedView()},e.prototype.returnViewToCache=function(e){this.viewFactory.returnViewToCache(e)},I(e,[{key:"isCaching",get:function(){return this.viewFactory.isCaching}}]),e}(),Ne=null,ke=e.ViewEngine=(0,o.inject)(d.Loader,o.Container,Ce,Re,ue)((T=C=function(){function p(e,t,n,r,i){this.loader=e,this.container=t,this.viewCompiler=n,this.moduleAnalyzer=r,this.appResources=i,this._pluginMap={},null===Ne&&((Ne=new je).attributeName="au-slot",v.metadata.define(v.metadata.resource,Ne,re)),Ne.initialize(t,re),Ne.register(i)}return p.prototype.addResourcePlugin=function(e,t){var n=e.replace(".","")+"-resource-plugin";this._pluginMap[e]=n,this.loader.addPlugin(n,t)},p.prototype.loadViewFactory=function(e,r,t,i){var n,o,a=this;return t=t||new W,(n=this.loader,o=e,o instanceof d.TemplateRegistryEntry?Promise.resolve(o):n.loadTemplate(o)).then(function(n){var e=n.address;return n.onReady?t.hasDependency(e)?null===n.template?n.onReady:Promise.resolve(new Ie(n.onReady)):(t.addDependency(e),n.onReady):(t.addDependency(e),n.onReady=a.loadTemplateResources(n,r,t,i).then(function(e){if(n.resources=e,null===n.template)return n.factory=null;var t=a.viewCompiler.compile(n.template,e,r);return n.factory=t}),n.onReady)})},p.prototype.loadTemplateResources=function(e,t,n,r){var i=new ue(this.appResources,e.address),o=e.dependencies,a=void 0,s=void 0;if(t=t||H.normal,0===o.length&&!t.associatedModuleId)return Promise.resolve(i);if(a=o.map(function(e){return e.src}),s=o.map(function(e){return e.name}),Ae.debug("importing resources for "+e.address,a),r){var u=v.metadata.get(p.viewModelRequireMetadataKey,r);if(u){for(var c=a.length,l=0,h=u.length;l<h;++l){var f=u[l],d="function"==typeof f?v.Origin.get(f).moduleId:(0,m.relativeToFile)(f.src||f,e.address);-1===a.indexOf(d)&&(a.push(d),s.push(f.as))}Ae.debug("importing ViewModel resources for "+t.associatedModuleId,a.slice(c))}}return this.importViewResources(a,s,i,t,n)},p.prototype.importViewModelResource=function(r,i){var o=this;return this.loader.loadModule(r).then(function(e){var t=v.Origin.get(e).moduleId,n=o.moduleAnalyzer.analyze(t,e,i);if(!n.mainResource)throw new Error('No view model found in module "'+r+'".');return n.initialize(o.container),n.mainResource})},p.prototype.importViewResources=function(e,l,h,f,d){var p=this;return d=d||new W,f=f||H.normal,e=e.map(function(e){return p._applyLoaderPlugin(e)}),this.loader.loadAllModules(e).then(function(e){var t=void 0,n=void 0,r=void 0,i=void 0,o=void 0,a=void 0,s=p.container,u=p.moduleAnalyzer,c=new Array(e.length);for(t=0,n=e.length;t<n;++t)o=e[t],i=v.Origin.get(o).moduleId,(r=u.analyze(i,o)).initialize(s),r.register(h,l[t]),c[t]=r;for(f.associatedModuleId&&(a=u.getAnalysis(f.associatedModuleId))&&a.register(h),t=0,n=c.length;t<n;++t)c[t]=c[t].load(s,d);return Promise.all(c).then(function(){return h})})},p.prototype._applyLoaderPlugin=function(e){var t=e.lastIndexOf(".");if(-1!==t){var n=e.substring(t),r=this._pluginMap[n];return void 0===r?e:this.loader.applyPluginToUrl(e,r)}return e},p}(),C.viewModelRequireMetadataKey="aurelia:view-model-require",S=T))||S,Pe=e.Controller=function(){function e(e,t,n,r){this.behavior=e,this.instruction=t,this.viewModel=n,this.isAttached=!1,this.view=null,this.isBound=!1,this.scope=null,this.container=r,this.elementEvents=r.elementEvents||null;var i,o=e.observerLocator.getOrCreateObserversLookup(n),a=e.handlesBind,s=t.attributes,u=this.boundProperties=[],c=e.properties,l=void 0;for(e._ensurePropertiesDefined(n,o),l=0,i=c.length;l<i;++l)c[l]._initialize(n,o,s,a,u)}return e.prototype.created=function(e){this.behavior.handlesCreated&&this.viewModel.created(e,this.view)},e.prototype.automate=function(e,t){this.view.bindingContext=this.viewModel,this.view.overrideContext=e||(0,p.createOverrideContext)(this.viewModel),this.view._isUserControlled=!0,this.behavior.handlesCreated&&this.viewModel.created(t||null,this.view),this.bind(this.view)},e.prototype.bind=function(e){var t,n=this.behavior.handlesBind,r=this.boundProperties,i=void 0,o=void 0,a=void 0,s=void 0;if(this.isBound){if(this.scope===e)return;this.unbind()}for(this.isBound=!0,this.scope=e,i=0,t=r.length;i<t;++i)s=(a=(o=r[i]).observer).selfSubscriber,a.publishing=!1,n&&(a.selfSubscriber=null),o.binding.bind(e),a.call(),a.publishing=!0,a.selfSubscriber=s;var u=void 0;null!==this.view?(n&&(this.view.viewModelScope=e),this.viewModel===e.overrideContext.bindingContext?u=e.overrideContext:this.instruction.inheritBindingContext?u=(0,p.createOverrideContext)(this.viewModel,e.overrideContext):(u=(0,p.createOverrideContext)(this.viewModel)).__parentOverrideContext=e.overrideContext,this.view.bind(this.viewModel,u)):n&&(u=e.overrideContext,void 0!==e.overrideContext.__parentOverrideContext&&this.viewModel.viewFactory&&this.viewModel.viewFactory.factoryCreateInstruction.partReplacements&&((u=Object.assign({},e.overrideContext)).parentOverrideContext=e.overrideContext.__parentOverrideContext),this.viewModel.bind(e.bindingContext,u))},e.prototype.unbind=function(){if(this.isBound){var e,t=this.boundProperties,n=void 0;for(this.isBound=!1,(this.scope=null)!==this.view&&this.view.unbind(),this.behavior.handlesUnbind&&this.viewModel.unbind(),null!==this.elementEvents&&this.elementEvents.disposeAll(),n=0,e=t.length;n<e;++n)t[n].binding.unbind()}},e.prototype.attached=function(){this.isAttached||(this.isAttached=!0,this.behavior.handlesAttached&&this.viewModel.attached(),null!==this.view&&this.view.attached())},e.prototype.detached=function(){this.isAttached&&(this.isAttached=!1,null!==this.view&&this.view.detached(),this.behavior.handlesDetached&&this.viewModel.detached())},e}(),xe=e.BehaviorPropertyObserver=(0,p.subscriberCollection)()(O=function(){function e(e,t,n,r,i){this.taskQueue=e,this.obj=t,this.propertyName=n,this.notqueued=!0,this.publishing=!1,this.selfSubscriber=r,this.currentValue=this.oldValue=i}return e.prototype.getValue=function(){return this.currentValue},e.prototype.setValue=function(e){var t=this.currentValue;t!==e&&(this.oldValue=t,this.currentValue=e,this.publishing&&this.notqueued&&(this.taskQueue.flushing?this.call():(this.notqueued=!1,this.taskQueue.queueMicroTask(this))))},e.prototype.call=function(){var e=this.oldValue,t=this.currentValue;this.notqueued=!0,t!==e&&(this.selfSubscriber&&this.selfSubscriber(t,e),this.callSubscribers(t,e),this.oldValue=t)},e.prototype.subscribe=function(e,t){this.addSubscriber(e,t)},e.prototype.unsubscribe=function(e,t){this.removeSubscriber(e,t)},e}())||O;function De(e,t){var n=e.__observers__;if(void 0===n){var r=Object.getPrototypeOf(e).constructor,i=v.metadata.get(v.metadata.resource,r);i.isInitialized||i.initialize(o.Container.instance||new o.Container,e.constructor),n=i.observerLocator.getOrCreateObserversLookup(e),i._ensurePropertiesDefined(e,n)}return n[t]}var Me=e.BindableProperty=function(){function e(e){"string"==typeof e?this.name=e:Object.assign(this,e),this.attribute=this.attribute||V(this.name),null!==this.defaultBindingMode&&void 0!==this.defaultBindingMode||(this.defaultBindingMode=p.bindingMode.oneWay),this.changeHandler=this.changeHandler||null,this.owner=null,this.descriptor=null}return e.prototype.registerWith=function(e,t,n){if(t.properties.push(this),(t.attributes[this.attribute]=this).owner=t,n)return this.descriptor=n,this._configureDescriptor(n)},e.prototype._configureDescriptor=function(e){var t=this.name;return e.configurable=!0,e.enumerable=!0,"initializer"in e&&(this.defaultValue=e.initializer,delete e.initializer,delete e.writable),"value"in e&&(this.defaultValue=e.value,delete e.value,delete e.writable),e.get=function(){return De(this,t).getValue()},e.set=function(e){De(this,t).setValue(e)},e.get.getObserver=function(e){return De(e,t)},e},e.prototype.defineOn=function(e,t){var n=this.name,r=void 0;null===this.changeHandler&&(r=n+"Changed")in e.prototype&&(this.changeHandler=r),null===this.descriptor&&Object.defineProperty(e.prototype,n,this._configureDescriptor(t,{}))},e.prototype.createObserver=function(n){var e=null,t=this.defaultValue,r=this.changeHandler,i=this.name,o=void 0;if(!this.hasOptions){if(r in n)e="propertyChanged"in n?function(e,t){n[r](e,t),n.propertyChanged(i,e,t)}:function(e,t){return n[r](e,t)};else if("propertyChanged"in n)e=function(e,t){return n.propertyChanged(i,e,t)};else if(null!==r)throw new Error("Change handler "+r+" was specified but not declared on the class.");return void 0!==t&&(o="function"==typeof t?t.call(n):t),new xe(this.owner.taskQueue,n,this.name,e,o)}},e.prototype._initialize=function(e,t,n,r,i){var o=void 0,a=void 0,s=void 0,u=this.defaultValue;if(this.isDynamic)for(var c in n)this._createDynamicProperty(e,t,r,c,n[c],i);else this.hasOptions||(a=t[this.name],null!==n&&(o=a.selfSubscriber,s=n[this.attribute],r&&(a.selfSubscriber=null),"string"==typeof s?(e[this.name]=s,a.call()):s?i.push({observer:a,binding:s.createBinding(e)}):void 0!==u&&a.call(),a.selfSubscriber=o),a.publishing=!0)},e.prototype._createDynamicProperty=function(n,e,t,r,i,o){var a=r+"Changed",s=null,u=void 0,c=void 0;a in n?s="propertyChanged"in n?function(e,t){n[a](e,t),n.propertyChanged(r,e,t)}:function(e,t){return n[a](e,t)}:"propertyChanged"in n&&(s=function(e,t){return n.propertyChanged(r,e,t)}),u=e[r]=new xe(this.owner.taskQueue,n,r,s),Object.defineProperty(n,r,{configurable:!0,enumerable:!0,get:u.getValue.bind(u),set:u.setValue.bind(u)}),t&&(u.selfSubscriber=null),"string"==typeof i?(n[r]=i,u.call()):i&&(c={observer:u,binding:i.createBinding(n)},o.push(c)),u.publishing=!0,u.selfSubscriber=s},e}(),Le=0;function Fe(){return!0}function Ve(){}var je=e.HtmlBehaviorResource=function(){function r(){this.elementName=null,this.attributeName=null,this.attributeDefaultBindingMode=void 0,this.liftsContent=!1,this.targetShadowDOM=!1,this.shadowDOMOptions=null,this.processAttributes=Ve,this.processContent=Fe,this.usesShadowDOM=!1,this.childBindings=null,this.hasDynamicOptions=!1,this.containerless=!1,this.properties=[],this.attributes={},this.isInitialized=!1,this.primaryProperty=null}return r.convention=function(e,t){var n=void 0;return e.endsWith("CustomAttribute")&&((n=t||new r).attributeName=V(e.substring(0,e.length-15))),e.endsWith("CustomElement")&&((n=t||new r).elementName=V(e.substring(0,e.length-13))),n},r.prototype.addChildBinding=function(e){null===this.childBindings&&(this.childBindings=[]),this.childBindings.push(e)},r.prototype.initialize=function(e,t){var n=t.prototype,r=this.properties,i=this.attributeName,o=this.attributeDefaultBindingMode,a=void 0,s=void 0,u=void 0;if(!this.isInitialized)if(this.isInitialized=!0,t.__providerId__=++Le,this.observerLocator=e.get(p.ObserverLocator),this.taskQueue=e.get(c.TaskQueue),this.target=t,this.usesShadowDOM=this.targetShadowDOM&&P.FEATURE.shadowDOM,this.handlesCreated="created"in n,this.handlesBind="bind"in n,this.handlesUnbind="unbind"in n,this.handlesAttached="attached"in n,this.handlesDetached="detached"in n,this.htmlName=this.elementName||this.attributeName,null!==i)if(0===r.length&&new Me({name:"value",changeHandler:"valueChanged"in n?"valueChanged":null,attribute:i,defaultBindingMode:o}).registerWith(t,this),u=r[0],1===r.length&&"value"===u.name)u.isDynamic=u.hasOptions=this.hasDynamicOptions,u.defineOn(t,this);else{for(a=0,s=r.length;a<s;++a)if(r[a].defineOn(t,this),r[a].primaryProperty){if(this.primaryProperty)throw new Error("Only one bindable property on a custom element can be defined as the default");this.primaryProperty=r[a]}(u=new Me({name:"value",changeHandler:"valueChanged"in n?"valueChanged":null,attribute:i,defaultBindingMode:o})).hasOptions=!0,u.registerWith(t,this)}else{for(a=0,s=r.length;a<s;++a)r[a].defineOn(t,this);this._copyInheritedProperties(e,t)}},r.prototype.register=function(t,e){var n=this;null!==this.attributeName&&(t.registerAttribute(e||this.attributeName,this,this.attributeName),Array.isArray(this.aliases)&&this.aliases.forEach(function(e){t.registerAttribute(e,n,n.attributeName)})),null!==this.elementName&&t.registerElement(e||this.elementName,this)},r.prototype.load=function(e,t,n,r,i){var o=this,a=void 0;return null!==this.elementName?(r=e.get(Z).getViewStrategy(r||this.viewStrategy||t),a=new H(this.targetShadowDOM,!0),r.moduleId||(r.moduleId=v.Origin.get(t).moduleId),r.loadViewFactory(e.get(ke),a,n,t).then(function(e){return i&&o.viewFactory||(o.viewFactory=e),e})):Promise.resolve(this)},r.prototype.compile=function(e,t,n,r,i){if(this.liftsContent){if(!r.viewFactory){var o=P.DOM.createElement("template"),a=P.DOM.createDocumentFragment(),s=n.getAttribute("view-cache"),u=n.getAttribute("part");n.removeAttribute(r.originalAttrName),P.DOM.replaceNode(o,n,i),a.appendChild(n),r.viewFactory=e.compile(a,t),u&&(r.viewFactory.part=u,n.removeAttribute("part")),s&&(r.viewFactory.setCacheSize(s),n.removeAttribute("view-cache")),n=o}}else if(null!==this.elementName){var c={};if(this.processContent(e,t,n,r)&&n.hasChildNodes()){for(var l=n.firstChild,h=this.usesShadowDOM?null:P.DOM.createElement("au-content"),f=void 0,d=void 0;l;)f=l.nextSibling,"TEMPLATE"===l.tagName&&(d=l.getAttribute("replace-part"))?(c[d]=e.compile(l,t),P.DOM.removeNode(l,i),r.partReplacements=c):null!==h&&(3===l.nodeType&&j(l)?P.DOM.removeNode(l,i):h.appendChild(l)),l=f;null!==h&&h.hasChildNodes()&&n.appendChild(h),r.skipContentProcessing=!1}else r.skipContentProcessing=!0}else this.processContent(e,t,n,r)||(r.skipContentProcessing=!0);return n},r.prototype.create=function(e,t,n,r){var i=void 0,o=null;t=t||G.normal,n=n||null,r=r||null,null!==this.elementName&&n&&(this.usesShadowDOM?(i=n.attachShadow(this.shadowDOMOptions),e.registerInstance(P.DOM.boundary,i)):(i=n,this.targetShadowDOM&&e.registerInstance(P.DOM.boundary,i))),null!==n&&(n.au=o=n.au||{});var a=t.viewModel||e.get(this.target),s=new Pe(this,t,a,e),u=this.childBindings,c=void 0;if(this.liftsContent)o.controller=s;else if(null!==this.elementName){if(c=t.viewFactory||this.viewFactory,e.viewModel=a,c&&(s.view=c.create(e,t,n)),null!==n){if((o.controller=s).view){if(!this.usesShadowDOM&&(1===n.childNodes.length||n.contentElement)){var l=n.childNodes[0]||n.contentElement;s.view.contentView={fragment:l},l.parentNode&&P.DOM.removeNode(l)}if(t.anchorIsContainer){if(null!==u)for(var h=0,f=u.length;h<f;++h)s.view.addBinding(u[h].create(n,a,s));s.view.appendNodesTo(i)}else s.view.insertNodesBefore(i)}else if(null!==u)for(var d=0,p=u.length;d<p;++d)r.push(u[d].create(n,a,s))}else if(s.view){if(s.view.controller=s,null!==u)for(var v=0,m=u.length;v<m;++v)s.view.addBinding(u[v].create(t.host,a,s))}else if(null!==u)for(var g=0,y=u.length;g<y;++g)r.push(u[g].create(t.host,a,s))}else if(null!==u)for(var b=0,_=u.length;b<_;++b)r.push(u[b].create(n,a,s));return null!==o&&(o[this.htmlName]=s),t.initiatedByBehavior&&c&&s.view.created(),s},r.prototype._ensurePropertiesDefined=function(e,t){var n,r=void 0,i=void 0,o=void 0;if(!("__propertiesDefined__"in t))for(t.__propertiesDefined__=!0,i=0,n=(r=this.properties).length;i<n;++i)void 0!==(o=r[i].createObserver(e))&&(t[o.propertyName]=o)},r.prototype._copyInheritedProperties=function(e,t){for(var r=this,i=void 0,o=t;;){var n=Object.getPrototypeOf(t.prototype);if(!(t=n&&n.constructor))return;if(i=v.metadata.getOwn(v.metadata.resource,t))break}i.initialize(e,t);for(var a=function(e,t){var n=i.properties[e];if(r.properties.some(function(e){return e.name===n.name}))return"continue";new Me(n).registerWith(o,r)},s=0,u=i.properties.length;s<u;++s)a(s)},r}();function Ue(o,a){return function(e,t,n){var r="string"==typeof t?e.constructor:e,i=v.metadata.getOrCreateOwn(v.metadata.resource,je,r);"string"==typeof o&&(o={selector:o,name:t}),n&&(n.writable=!0,n.configurable=!0),o.all=a,i.addChildBinding(new Be(o))}}var Be=function(){function e(e){this.name=e.name,this.changeHandler=e.changeHandler||this.name+"Changed",this.selector=e.selector,this.all=e.all}return e.prototype.create=function(e,t,n){return new Ge(this.selector,e,this.name,t,n,this.changeHandler,this.all)},e}(),qe=[];function We(e,t,n){var r=e.get(t);r||(r=[],e.set(t,r)),r.push(n)}function He(e,t){for(var n=t.binders,r=n.length,i=new Map,o=0,a=e.length;o<a;++o){for(var s=e[o],u=s.addedNodes,c=s.removedNodes,l=0,h=c.length;l<h;++l){var f=c[l];if(1===f.nodeType)for(var d=0;d<r;++d){var p=n[d];p.onRemove(f)&&We(i,p,s)}}for(var v=0,m=u.length;v<m;++v){var g=u[v];if(1===g.nodeType)for(var y=0;y<r;++y){var b=n[y];b.onAdd(g)&&We(i,b,s)}}}i.forEach(function(e,t){null!==t.changeHandler&&t.viewModel[t.changeHandler](e)})}var Ge=function(){function e(e,t,n,r,i,o,a){this.selector=e,this.viewHost=t,this.property=n,this.viewModel=r,this.controller=i,this.changeHandler=o in r?o:null,this.usesShadowDOM=i.behavior.usesShadowDOM,this.all=a,!this.usesShadowDOM&&i.view&&i.view.contentView?this.contentView=i.view.contentView:this.contentView=null}return e.prototype.matches=function(e){if(e.matches(this.selector)){if(null===this.contentView)return!0;var t=this.contentView,n=e.auAssignedSlot;if(n&&n.projectFromAnchors){for(var r=n.projectFromAnchors,i=0,o=r.length;i<o;++i)if(r[i].auOwnerView===t)return!0;return!1}return e.auOwnerView===t}return!1},e.prototype.bind=function(e){var t=this.viewHost,n=this.viewModel,r=t.__childObserver__;if(!r){r=t.__childObserver__=P.DOM.createMutationObserver(He);var i={childList:!0,subtree:!this.usesShadowDOM};r.observe(t,i),r.binders=[]}if(r.binders.push(this),this.usesShadowDOM){var o=t.firstElementChild;if(this.all){var a=n[this.property];for(a?a.length=0:a=n[this.property]=[];o;)this.matches(o)&&a.push(o.au&&o.au.controller?o.au.controller.viewModel:o),o=o.nextElementSibling;null!==this.changeHandler&&this.viewModel[this.changeHandler](qe)}else for(;o;){if(this.matches(o)){var s=o.au&&o.au.controller?o.au.controller.viewModel:o;this.viewModel[this.property]=s,null!==this.changeHandler&&this.viewModel[this.changeHandler](s);break}o=o.nextElementSibling}}},e.prototype.onRemove=function(e){if(this.matches(e)){var t=e.au&&e.au.controller?e.au.controller.viewModel:e;if(this.all){var n=this.viewModel[this.property]||(this.viewModel[this.property]=[]),r=n.indexOf(t);return-1!==r&&n.splice(r,1),!0}return!1}return!1},e.prototype.onAdd=function(e){if(this.matches(e)){var t=e.au&&e.au.controller?e.au.controller.viewModel:e;if(this.all){var n=this.viewModel[this.property]||(this.viewModel[this.property]=[]);if("*"===this.selector)return n.push(t),!0;for(var r=0,i=e.previousElementSibling;i;)this.matches(i)&&r++,i=i.previousElementSibling;return n.splice(r,0,t),!0}this.viewModel[this.property]=t,null!==this.changeHandler&&this.viewModel[this.changeHandler](t)}return!1},e.prototype.unbind=function(){this.viewHost.__childObserver__&&(this.viewHost.__childObserver__.disconnect(),this.viewHost.__childObserver__=null)},e}();function Ke(e,t){return Array.isArray(t)?e.removeMany(t,!0):e.remove(t,!0)}var $e=e.SwapStrategies={before:function(e,t,n){return void 0===t?n():n().then(function(){return Ke(e,t)})},with:function(e,t,n){return void 0===t?n():Promise.all([Ke(e,t),n()])},after:function(e,t,n){return Promise.resolve(e.removeAll(!0)).then(n)}};function ze(e){return e.skipActivation||"function"!=typeof e.viewModel.activate?Promise.resolve():e.viewModel.activate(e.model)||Promise.resolve()}var Qe=e.CompositionEngine=(0,o.inject)(ke,Z)(R=function(){function e(e,t){this.viewEngine=e,this.viewLocator=t}return e.prototype._swap=function(e,t){var n=$e[e.swapOrder]||$e.after,r=e.viewSlot.children.slice();return n(e.viewSlot,r,function(){return Promise.resolve(e.viewSlot.add(t)).then(function(){e.currentController&&e.currentController.unbind()})}).then(function(){e.compositionTransactionNotifier&&e.compositionTransactionNotifier.done()})},e.prototype._createControllerAndSwap=function(t){var n=this;return this.createController(t).then(function(e){return e.automate(t.overrideContext,t.owningView),t.compositionTransactionOwnershipToken?t.compositionTransactionOwnershipToken.waitForCompositionComplete().then(function(){return n._swap(t,e.view)}).then(function(){return e}):n._swap(t,e.view).then(function(){return e})})},e.prototype.createController=function(t){var n=this,r=void 0,i=void 0,o=void 0,a=void 0;return this.ensureViewModel(t).then(ze).then(function(){r=t.childContainer,i=t.viewModel,o=t.viewModelResource,a=o.metadata;var e=n.viewLocator.getViewStrategy(t.view||i);return t.viewResources&&e.makeRelativeTo(t.viewResources.viewUrl),a.load(r,o.value,null,e,!0)}).then(function(e){return a.create(r,G.dynamic(t.host,i,e))})},e.prototype.ensureViewModel=function(t){var n=t.childContainer=t.childContainer||t.container.createChild();if("string"==typeof t.viewModel)return t.viewModel=t.viewResources?t.viewResources.relativeToView(t.viewModel):t.viewModel,this.viewEngine.importViewModelResource(t.viewModel).then(function(e){return n.autoRegister(e.value),t.host&&n.registerInstance(P.DOM.Element,t.host),t.viewModel=n.viewModel=n.get(e.value),t.viewModelResource=e,t});var e=v.metadata.getOrCreateOwn(v.metadata.resource,je,t.viewModel.constructor);return e.elementName=e.elementName||"dynamic-element",e.initialize(t.container||n,t.viewModel.constructor),t.viewModelResource={metadata:e,value:t.viewModel.constructor},n.viewModel=t.viewModel,Promise.resolve(t)},e.prototype.compose=function(n){var r=this;n.childContainer=n.childContainer||n.container.createChild(),n.view=this.viewLocator.getViewStrategy(n.view);var e=n.childContainer.get(M),t=e.tryCapture();return t?n.compositionTransactionOwnershipToken=t:n.compositionTransactionNotifier=e.enlist(),n.viewModel?this._createControllerAndSwap(n):n.view?(n.viewResources&&n.view.makeRelativeTo(n.viewResources.viewUrl),n.view.loadViewFactory(this.viewEngine,new H).then(function(e){var t=e.create(n.childContainer);return t.bind(n.bindingContext,n.overrideContext),n.compositionTransactionOwnershipToken?n.compositionTransactionOwnershipToken.waitForCompositionComplete().then(function(){return r._swap(n,t)}).then(function(){return t}):r._swap(n,t).then(function(){return t})})):(n.viewSlot&&(n.viewSlot.removeAll(),n.compositionTransactionNotifier&&n.compositionTransactionNotifier.done()),Promise.resolve(null))},e}())||R,Ye=e.ElementConfigResource=function(){function e(){}return e.prototype.initialize=function(e,t){},e.prototype.register=function(e,t){},e.prototype.load=function(e,t){var n=new t;e.get(p.EventManager).registerElementConfig(n)},e}();function Xe(e,t){if(/[A-Z]/.test(e)){var n=V(e);return a.getLogger("templating").warn("'"+e+"' is not a valid "+t+" name and has been converted to '"+n+"'. Upper-case letters are not allowed because the DOM is not case-sensitive."),n}return e}var Je={mode:"open"};function Ze(){return!1}function et(t){return function(e){v.metadata.define(Z.viewStrategyMetadataKey,t,e)}}e.TemplatingEngine=(0,o.inject)(o.Container,Re,Ce,Qe)(A=function(){function e(e,t,n,r){this._container=e,this._moduleAnalyzer=t,this._viewCompiler=n,this._compositionEngine=r,e.registerInstance(k,k.instance=new k)}return e.prototype.configureAnimator=function(e){this._container.unregister(k),this._container.registerInstance(k,k.instance=e)},e.prototype.compose=function(e){return this._compositionEngine.compose(e)},e.prototype.enhance=function(e){e instanceof P.DOM.Element&&(e={element:e});var t={},n=e.resources||this._container.get(ue);this._viewCompiler._compileNode(e.element,n,t,e.element.parentNode,"root",!0);var r=new _e(e.element,t,n),i=e.container||this._container.createChild(),o=r.create(i,G.enhance());return o.bind(e.bindingContext||{},e.overrideContext),o.firstChild=o.lastChild=o.fragment,o.fragment=P.DOM.createDocumentFragment(),o.attached(),o},e}())||A}),define("aurelia-templating-router/router-view",["exports","aurelia-dependency-injection","aurelia-binding","aurelia-templating","aurelia-router","aurelia-metadata","aurelia-pal"],function(e,t,s,f,n,d,r){"use strict";function u(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function i(n,r,e,t,i){var o={};return Object.keys(t).forEach(function(e){o[e]=t[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=e.slice().reverse().reduce(function(e,t){return t(n,r,e)||e},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(n,r,o),o=null),o}var o,a,c,l,h,p,v,m;Object.defineProperty(e,"__esModule",{value:!0}),e.RouterViewLocator=e.RouterView=void 0;e.RouterView=(o=(0,f.customElement)("router-view"),a=(0,t.inject)(r.DOM.Element,t.Container,f.ViewSlot,n.Router,f.ViewLocator,f.CompositionTransaction,f.CompositionEngine),o(c=(0,f.noView)(c=a((l=function(){function e(e,t,n,r,i,o,a){u(this,"swapOrder",h,this),u(this,"layoutView",p,this),u(this,"layoutViewModel",v,this),u(this,"layoutModel",m,this),this.element=e,this.container=t,this.viewSlot=n,this.router=r,this.viewLocator=i,this.compositionTransaction=o,this.compositionEngine=a,this.router.registerViewPort(this,this.element.getAttribute("name")),"initialComposition"in o||(o.initialComposition=!0,this.compositionTransactionNotifier=o.enlist())}return e.prototype.created=function(e){this.owningView=e},e.prototype.bind=function(e,t){this.container.viewModel=e,this.overrideContext=t},e.prototype.process=function(t,n){var r=this,e=t.component,i=e.childContainer,o=e.viewModel,a=e.viewModelResource,s=a.metadata,u=e.router.currentInstruction.config,c=u.viewPorts&&u.viewPorts[t.name]||{};i.get(g)._notify(this);var l={viewModel:c.layoutViewModel||u.layoutViewModel||this.layoutViewModel,view:c.layoutView||u.layoutView||this.layoutView,model:c.layoutModel||u.layoutModel||this.layoutModel,router:t.component.router,childContainer:i,viewSlot:this.viewSlot},h=this.viewLocator.getViewStrategy(e.view||o);return h&&e.view&&h.makeRelativeTo(d.Origin.get(e.router.container.viewModel.constructor).moduleId),s.load(i,a.value,null,h,!0).then(function(e){if(r.compositionTransactionNotifier||(r.compositionTransactionOwnershipToken=r.compositionTransaction.tryCapture()),(l.viewModel||l.view)&&(t.layoutInstruction=l),t.controller=s.create(i,f.BehaviorInstruction.dynamic(r.element,o,e)),n)return null;r.swap(t)})},e.prototype.swap=function(t){var n=this,r=t.layoutInstruction,i=this.view,o=function(){var e=f.SwapStrategies[n.swapOrder]||f.SwapStrategies.after,t=n.viewSlot;e(t,i,function(){return Promise.resolve(t.add(n.view))}).then(function(){n._notify()})},a=function(e){return t.controller.automate(n.overrideContext,e),n.compositionTransactionOwnershipToken?n.compositionTransactionOwnershipToken.waitForCompositionComplete().then(function(){return n.compositionTransactionOwnershipToken=null,o()}):o()};return r?(r.viewModel||(r.viewModel={}),this.compositionEngine.createController(r).then(function(e){return f.ShadowDOM.distributeView(t.controller.view,e.slots||e.view.slots),e.automate((0,s.createOverrideContext)(r.viewModel),n.owningView),e.view.children.push(t.controller.view),e.view||e}).then(function(e){return n.view=e,a(e)})):(this.view=t.controller.view,a(this.owningView))},e.prototype._notify=function(){this.compositionTransactionNotifier&&(this.compositionTransactionNotifier.done(),this.compositionTransactionNotifier=null)},e}(),h=i(l.prototype,"swapOrder",[f.bindable],{enumerable:!0,initializer:null}),p=i(l.prototype,"layoutView",[f.bindable],{enumerable:!0,initializer:null}),v=i(l.prototype,"layoutViewModel",[f.bindable],{enumerable:!0,initializer:null}),m=i(l.prototype,"layoutModel",[f.bindable],{enumerable:!0,initializer:null}),c=l))||c)||c)||c);var g=e.RouterViewLocator=function(){function e(){var t=this;this.promise=new Promise(function(e){return t.resolve=e})}return e.prototype.findNearest=function(){return this.promise},e.prototype._notify=function(e){this.resolve(e)},e}()}),define("aurelia-templating-router/route-loader",["exports","aurelia-dependency-injection","aurelia-templating","aurelia-router","aurelia-path","aurelia-metadata","./router-view"],function(e,t,l,h,f,d,p){"use strict";var n,r;Object.defineProperty(e,"__esModule",{value:!0}),e.TemplatingRouteLoader=void 0;var v=(0,l.inlineView)("<template></template>")(n=function(){})||n;e.TemplatingRouteLoader=(0,t.inject)(l.CompositionEngine)(r=function(n){function e(e){var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,n.call(this));return t.compositionEngine=e,t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(e,n),e.prototype.loadRoute=function(n,e){var t,r,i,o,a,s=n.container.createChild(),u=void 0;null===e.moduleId?u=v:/\.html/i.test(e.moduleId)?(t=e.moduleId,a=/([^\/^\?]+)\.html/i.exec(t)[1],r=(0,l.customElement)(a),i=(0,l.useView)(t),u=r(o=i(o=function(){function e(){}return e.prototype.bind=function(e){this.$parent=e},e}())||o)||o):u=(0,f.relativeToFile)(e.moduleId,d.Origin.get(n.container.viewModel.constructor).moduleId);var c={viewModel:u,childContainer:s,view:(e=e||{}).view||e.viewStrategy,router:n};return s.registerSingleton(p.RouterViewLocator),s.getChildRouter=function(){var t=void 0;return s.registerHandler(h.Router,function(e){return t||(t=n.createChild(s))}),s.get(h.Router)},this.compositionEngine.ensureViewModel(c)},e}(h.RouteLoader))||r}),define("aurelia-templating-router/route-href",["exports","aurelia-templating","aurelia-dependency-injection","aurelia-router","aurelia-pal","aurelia-logging"],function(e,t,n,r,i,o){"use strict";var a;Object.defineProperty(e,"__esModule",{value:!0}),e.RouteHref=void 0;var s=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(o).getLogger("route-href");e.RouteHref=(0,t.customAttribute)("route-href")(a=(0,t.bindable)({name:"route",changeHandler:"processChange",primaryProperty:!0})(a=(0,t.bindable)({name:"params",changeHandler:"processChange"})(a=(0,t.bindable)({name:"attribute",defaultValue:"href"})(a=(0,n.inject)(r.Router,i.DOM.Element)(a=function(){function e(e,t){this.router=e,this.element=t}return e.prototype.bind=function(){this.isActive=!0,this.processChange()},e.prototype.unbind=function(){this.isActive=!1},e.prototype.attributeChanged=function(e,t){t&&this.element.removeAttribute(t),this.processChange()},e.prototype.processChange=function(){var t=this;return this.router.ensureConfigured().then(function(){if(!t.isActive)return null;var e=t.router.generate(t.route,t.params);return t.element.au.controller?t.element.au.controller.viewModel[t.attribute]=e:t.element.setAttribute(t.attribute,e),null}).catch(function(e){s.error(e)})},e}())||a)||a)||a)||a)||a}),define("aurelia-templating-router/aurelia-templating-router",["exports","aurelia-pal","aurelia-router","./route-loader","./router-view","./route-href"],function(e,t,n,r,i,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.configure=e.RouteHref=e.RouterView=e.TemplatingRouteLoader=void 0,e.TemplatingRouteLoader=r.TemplatingRouteLoader,e.RouterView=i.RouterView,e.RouteHref=o.RouteHref,e.configure=function(e){e.singleton(n.RouteLoader,r.TemplatingRouteLoader).singleton(n.Router,n.AppRouter).globalResources(t.PLATFORM.moduleName("./router-view"),t.PLATFORM.moduleName("./route-href")),e.container.registerAlias(n.Router,n.AppRouter)}}),define("aurelia-templating-router",["aurelia-templating-router/aurelia-templating-router"],function(e){return e}),define("aurelia-templating-resources/with",["exports","aurelia-dependency-injection","aurelia-templating","aurelia-binding"],function(e,t,n,r){"use strict";var i,o,a;Object.defineProperty(e,"__esModule",{value:!0}),e.With=void 0;e.With=(i=(0,n.customAttribute)("with"),o=(0,t.inject)(n.BoundViewFactory,n.ViewSlot),i(a=(0,n.templateController)(a=o(a=function(){function e(e,t){this.viewFactory=e,this.viewSlot=t,this.parentOverrideContext=null,this.view=null}return e.prototype.bind=function(e,t){this.parentOverrideContext=t,this.valueChanged(this.value)},e.prototype.valueChanged=function(e){var t=(0,r.createOverrideContext)(e,this.parentOverrideContext);this.view?this.view.bind(e,t):(this.view=this.viewFactory.create(),this.view.bind(e,t),this.viewSlot.add(this.view))},e.prototype.unbind=function(){this.parentOverrideContext=null,this.view&&this.view.unbind()},e}())||a)||a)||a)}),define("aurelia-templating-resources/update-trigger-binding-behavior",["exports","aurelia-binding"],function(e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.UpdateTriggerBindingBehavior=void 0;var u="The updateTrigger binding behavior can only be applied to two-way/ from-view bindings on input/select elements.";e.UpdateTriggerBindingBehavior=function(){function e(){}return e.prototype.bind=function(e,t){for(var n=arguments.length,r=Array(2<n?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(0===r.length)throw new Error("The updateTrigger binding behavior requires at least one event name argument: eg <input value.bind=\"firstName & updateTrigger:'blur'\">");if(e.mode!==s.bindingMode.twoWay&&e.mode!==s.bindingMode.fromView)throw new Error(u);var o=e.observerLocator.getObserver(e.target,e.targetProperty);if(!o.handler)throw new Error(u);(e.targetObserver=o).originalHandler=e.targetObserver.handler;var a=new s.EventSubscriber(r);o.handler=a},e.prototype.unbind=function(e,t){e.targetObserver.handler.dispose(),e.targetObserver.handler=e.targetObserver.originalHandler,e.targetObserver.originalHandler=null},e}()}),define("aurelia-templating-resources/throttle-binding-behavior",["exports","aurelia-binding"],function(e,i){"use strict";function o(e){var t=this,n=this.throttleState,r=+new Date-n.last;if(r>=n.delay)return clearTimeout(n.timeoutId),n.timeoutId=null,n.last=+new Date,void this.throttledMethod(e);n.newValue=e,null===n.timeoutId&&(n.timeoutId=setTimeout(function(){n.timeoutId=null,n.last=+new Date,t.throttledMethod(n.newValue)},n.delay-r))}Object.defineProperty(e,"__esModule",{value:!0}),e.ThrottleBindingBehavior=void 0;e.ThrottleBindingBehavior=function(){function e(){}return e.prototype.bind=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:200,r="updateTarget";e.callSource?r="callSource":e.updateSource&&e.mode===i.bindingMode.twoWay&&(r="updateSource"),e.throttledMethod=e[r],e.throttledMethod.originalName=r,e[r]=o,e.throttleState={delay:n,last:0,timeoutId:null}},e.prototype.unbind=function(e,t){e[e.throttledMethod.originalName]=e.throttledMethod,e.throttledMethod=null,clearTimeout(e.throttleState.timeoutId),e.throttleState=null},e}()}),define("aurelia-templating-resources/signal-binding-behavior",["exports","./binding-signaler"],function(e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SignalBindingBehavior=void 0;e.SignalBindingBehavior=function(){function e(e){this.signals=e.signals}return e.inject=function(){return[t.BindingSignaler]},e.prototype.bind=function(e,t){if(!e.updateTarget)throw new Error("Only property bindings and string interpolation bindings can be signaled.  Trigger, delegate and call bindings cannot be signaled.");if(3===arguments.length){var n=arguments[2];(this.signals[n]||(this.signals[n]=[])).push(e),e.signalName=n}else{if(!(3<arguments.length))throw new Error("Signal name is required.");for(var r=Array.prototype.slice.call(arguments,2),i=r.length;i--;){var o=r[i];(this.signals[o]||(this.signals[o]=[])).push(e)}e.signalName=r}},e.prototype.unbind=function(e,t){var n=e.signalName;if(e.signalName=null,Array.isArray(n))for(var r=n,i=r.length;i--;){var o=r[i],a=this.signals[o];a.splice(a.indexOf(e),1)}else{var s=this.signals[n];s.splice(s.indexOf(e),1)}},e}()}),define("aurelia-templating-resources/show",["exports","aurelia-dependency-injection","aurelia-templating","aurelia-pal","./aurelia-hide-style"],function(e,t,n,r,i){"use strict";var o;Object.defineProperty(e,"__esModule",{value:!0}),e.Show=void 0;e.Show=(0,n.customAttribute)("show")(o=(0,t.inject)(r.DOM.Element,n.Animator,t.Optional.of(r.DOM.boundary,!0))(o=function(){function e(e,t,n){this.element=e,this.animator=t,this.domBoundary=n}return e.prototype.created=function(){(0,i.injectAureliaHideStyleAtBoundary)(this.domBoundary)},e.prototype.valueChanged=function(e){e?this.animator.removeClass(this.element,i.aureliaHideClassName):this.animator.addClass(this.element,i.aureliaHideClassName)},e.prototype.bind=function(e){this.valueChanged(this.value)},e}())||o)||o}),define("aurelia-templating-resources/set-repeat-strategy",["exports","./repeat-utilities"],function(e,f){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SetRepeatStrategy=void 0;e.SetRepeatStrategy=function(){function e(){}return e.prototype.getCollectionObserver=function(e,t){return e.getSetObserver(t)},e.prototype.instanceChanged=function(e,t){var n=this,r=e.removeAllViews(!0,!e.viewsRequireLifecycle);r instanceof Promise?r.then(function(){return n._standardProcessItems(e,t)}):this._standardProcessItems(e,t)},e.prototype._standardProcessItems=function(t,n){var r=0,i=void 0;n.forEach(function(e){i=(0,f.createFullOverrideContext)(t,e,r,n.size),t.addView(i.bindingContext,i),++r})},e.prototype.instanceMutated=function(e,t,n){var r,i=void 0,o=void 0,a=void 0,s=void 0,u=void 0,c=[],l=void 0;for(o=0,r=n.length;o<r;++o)switch(i=(u=n[o]).value,u.type){case"add":var h=Math.max(t.size-1,0);a=(0,f.createFullOverrideContext)(e,i,h,t.size),e.insertView(h,a.bindingContext,a);break;case"delete":s=this._getViewIndexByValue(e,i),(l=e.removeView(s,!0,!e.viewsRequireLifecycle))instanceof Promise&&c.push(l);break;case"clear":e.removeAllViews(!0,!e.viewsRequireLifecycle);break;default:continue}0<c.length?Promise.all(c).then(function(){(0,f.updateOverrideContexts)(e.views(),0)}):(0,f.updateOverrideContexts)(e.views(),0)},e.prototype._getViewIndexByValue=function(e,t){var n,r=void 0;for(r=0,n=e.viewCount();r<n;++r)if(e.view(r).bindingContext[e.local]===t)return r},e}()}),define("aurelia-templating-resources/self-binding-behavior",["exports"],function(e){"use strict";function n(e){var t,n=(t=e).path&&t.path[0]||t.deepPath&&t.deepPath[0]||t.target;this.target===n&&this.selfEventCallSource(e)}Object.defineProperty(e,"__esModule",{value:!0});e.SelfBindingBehavior=function(){function e(){}return e.prototype.bind=function(e,t){if(!e.callSource||!e.targetEvent)throw new Error("Self binding behavior only supports event.");e.selfEventCallSource=e.callSource,e.callSource=n},e.prototype.unbind=function(e,t){e.callSource=e.selfEventCallSource,e.selfEventCallSource=null},e}()}),define("aurelia-templating-resources/sanitize-html",["exports","aurelia-binding","aurelia-dependency-injection","./html-sanitizer"],function(e,t,n,r){"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),e.SanitizeHTMLValueConverter=void 0;e.SanitizeHTMLValueConverter=(0,t.valueConverter)("sanitizeHTML")(i=(0,n.inject)(r.HTMLSanitizer)(i=function(){function e(e){this.sanitizer=e}return e.prototype.toView=function(e){return null==e?null:this.sanitizer.sanitize(e)},e}())||i)||i}),define("aurelia-templating-resources/replaceable",["exports","aurelia-dependency-injection","aurelia-templating"],function(e,t,n){"use strict";var r,i,o;Object.defineProperty(e,"__esModule",{value:!0}),e.Replaceable=void 0;e.Replaceable=(r=(0,n.customAttribute)("replaceable"),i=(0,t.inject)(n.BoundViewFactory,n.ViewSlot),r(o=(0,n.templateController)(o=i(o=function(){function e(e,t){this.viewFactory=e,this.viewSlot=t,this.view=null}return e.prototype.bind=function(e,t){null===this.view&&(this.view=this.viewFactory.create(),this.viewSlot.add(this.view)),this.view.bind(e,t)},e.prototype.unbind=function(){this.view.unbind()},e}())||o)||o)||o)}),define("aurelia-templating-resources/repeat",["exports","aurelia-dependency-injection","aurelia-binding","aurelia-templating","./repeat-strategy-locator","./repeat-utilities","./analyze-view-factory","./abstract-repeater"],function(e,t,n,r,i,u,c,o){"use strict";function l(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function a(n,r,e,t,i){var o={};return Object.keys(t).forEach(function(e){o[e]=t[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=e.slice().reverse().reduce(function(e,t){return t(n,r,e)||e},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(n,r,o),o=null),o}var s,h,f,d,p,v,m,g;Object.defineProperty(e,"__esModule",{value:!0}),e.Repeat=void 0;e.Repeat=(s=(0,r.customAttribute)("repeat"),h=(0,t.inject)(r.BoundViewFactory,r.TargetInstruction,r.ViewSlot,r.ViewResources,n.ObserverLocator,i.RepeatStrategyLocator),s(f=(0,r.templateController)(f=h((d=function(s){function e(e,t,n,r,i,o){var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,s.call(this,{local:"item",viewsRequireLifecycle:(0,c.viewsRequireLifecycle)(e)}));return l(a,"items",p,a),l(a,"local",v,a),l(a,"key",m,a),l(a,"value",g,a),a.viewFactory=e,a.instruction=t,a.viewSlot=n,a.lookupFunctions=r.lookupFunctions,a.observerLocator=i,a.key="key",a.value="value",a.strategyLocator=o,a.ignoreMutation=!1,a.sourceExpression=(0,u.getItemsSourceExpression)(a.instruction,"repeat.for"),a.isOneTime=(0,u.isOneTime)(a.sourceExpression),a.viewsRequireLifecycle=(0,c.viewsRequireLifecycle)(e),a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(e,s),e.prototype.call=function(e,t){this[e](this.items,t)},e.prototype.bind=function(e,t){this.scope={bindingContext:e,overrideContext:t},this.matcherBinding=this._captureAndRemoveMatcherBinding(),this.itemsChanged()},e.prototype.unbind=function(){this.scope=null,this.items=null,this.matcherBinding=null,this.viewSlot.removeAll(!0,!0),this._unsubscribeCollection()},e.prototype._unsubscribeCollection=function(){this.collectionObserver&&(this.collectionObserver.unsubscribe(this.callContext,this),this.collectionObserver=null,this.callContext=null)},e.prototype.itemsChanged=function(){if(this._unsubscribeCollection(),this.scope){var e=this.items;if(this.strategy=this.strategyLocator.getStrategy(e),!this.strategy)throw new Error("Value for '"+this.sourceExpression+"' is non-repeatable");this.isOneTime||this._observeInnerCollection()||this._observeCollection(),this.strategy.instanceChanged(this,e)}},e.prototype._getInnerCollection=function(){var e=(0,u.unwrapExpression)(this.sourceExpression);return e?e.evaluate(this.scope,null):null},e.prototype.handleCollectionMutated=function(e,t){this.collectionObserver&&this.strategy.instanceMutated(this,e,t)},e.prototype.handleInnerCollectionMutated=function(e,t){var n=this;if(this.collectionObserver&&!this.ignoreMutation){this.ignoreMutation=!0;var r=this.sourceExpression.evaluate(this.scope,this.lookupFunctions);this.observerLocator.taskQueue.queueMicroTask(function(){return n.ignoreMutation=!1}),r===this.items?this.itemsChanged():this.items=r}},e.prototype._observeInnerCollection=function(){var e=this._getInnerCollection(),t=this.strategyLocator.getStrategy(e);return!!t&&(this.collectionObserver=t.getCollectionObserver(this.observerLocator,e),!!this.collectionObserver&&(this.callContext="handleInnerCollectionMutated",this.collectionObserver.subscribe(this.callContext,this),!0))},e.prototype._observeCollection=function(){var e=this.items;this.collectionObserver=this.strategy.getCollectionObserver(this.observerLocator,e),this.collectionObserver&&(this.callContext="handleCollectionMutated",this.collectionObserver.subscribe(this.callContext,this))},e.prototype._captureAndRemoveMatcherBinding=function(){if(this.viewFactory.viewFactory)for(var e=this.viewFactory.viewFactory.instructions,t=Object.keys(e),n=0;n<t.length;n++){var r=e[t[n]].expressions;if(r)for(;n<r.length;n++)if("matcher"===r[0].targetProperty){var i=r[0];return r.splice(0,1),i}}},e.prototype.viewCount=function(){return this.viewSlot.children.length},e.prototype.views=function(){return this.viewSlot.children},e.prototype.view=function(e){return this.viewSlot.children[e]},e.prototype.matcher=function(){return this.matcherBinding?this.matcherBinding.sourceExpression.evaluate(this.scope,this.matcherBinding.lookupFunctions):null},e.prototype.addView=function(e,t){var n=this.viewFactory.create();n.bind(e,t),this.viewSlot.add(n)},e.prototype.insertView=function(e,t,n){var r=this.viewFactory.create();r.bind(t,n),this.viewSlot.insert(e,r)},e.prototype.moveView=function(e,t){this.viewSlot.move(e,t)},e.prototype.removeAllViews=function(e,t){return this.viewSlot.removeAll(e,t)},e.prototype.removeViews=function(e,t,n){return this.viewSlot.removeMany(e,t,n)},e.prototype.removeView=function(e,t,n){return this.viewSlot.removeAt(e,t,n)},e.prototype.updateBindings=function(e){for(var t=e.bindings.length;t--;)(0,u.updateOneTimeBinding)(e.bindings[t]);for(t=e.controllers.length;t--;)for(var n=e.controllers[t].boundProperties.length;n--;){var r=e.controllers[t].boundProperties[n].binding;(0,u.updateOneTimeBinding)(r)}},e}(o.AbstractRepeater),p=a(d.prototype,"items",[r.bindable],{enumerable:!0,initializer:null}),v=a(d.prototype,"local",[r.bindable],{enumerable:!0,initializer:null}),m=a(d.prototype,"key",[r.bindable],{enumerable:!0,initializer:null}),g=a(d.prototype,"value",[r.bindable],{enumerable:!0,initializer:null}),f=d))||f)||f)||f)}),define("aurelia-templating-resources/repeat-utilities",["exports","aurelia-binding"],function(e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.updateOverrideContexts=function(e,t){var n=e.length;0<t&&(t-=1);for(;t<n;++t)u(e[t].overrideContext,t,n)},e.createFullOverrideContext=function(e,t,n,r,i){var o={},a=(0,s.createOverrideContext)(o,e.scope.overrideContext);void 0!==i?(o[e.key]=i,o[e.value]=t):o[e.local]=t;return u(a,n,r),a},e.updateOverrideContext=u,e.getItemsSourceExpression=function(e,t){return e.behaviorInstructions.filter(function(e){return e.originalAttrName===t})[0].attributes.items.sourceExpression},e.unwrapExpression=function(e){var t=!1;for(;e instanceof s.BindingBehavior;)e=e.expression;for(;e instanceof s.ValueConverter;)e=e.expression,t=!0;return t?e:null},e.isOneTime=function(e){for(;e instanceof s.BindingBehavior;){if("oneTime"===e.name)return!0;e=e.expression}return!1},e.updateOneTimeBinding=function(e){e.call&&e.mode===t?e.call(s.sourceContext):e.updateOneTimeBindings&&e.updateOneTimeBindings()},e.indexOf=function(e,t,n,r){if(!n)return e.indexOf(t);for(var i=e.length,o=r||0;o<i;o++)if(n(e[o],t))return o;return-1};var t=s.bindingMode.oneTime;function u(e,t,n){var r=0===t,i=t===n-1,o=t%2==0;e.$index=t,e.$first=r,e.$last=i,e.$middle=!(r||i),e.$odd=!o,e.$even=o}}),define("aurelia-templating-resources/repeat-strategy-locator",["exports","./null-repeat-strategy","./array-repeat-strategy","./map-repeat-strategy","./set-repeat-strategy","./number-repeat-strategy"],function(e,t,n,r,i,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RepeatStrategyLocator=void 0;e.RepeatStrategyLocator=function(){function e(){this.matchers=[],this.strategies=[],this.addStrategy(function(e){return null==e},new t.NullRepeatStrategy),this.addStrategy(function(e){return e instanceof Array},new n.ArrayRepeatStrategy),this.addStrategy(function(e){return e instanceof Map},new r.MapRepeatStrategy),this.addStrategy(function(e){return e instanceof Set},new i.SetRepeatStrategy),this.addStrategy(function(e){return"number"==typeof e},new o.NumberRepeatStrategy)}return e.prototype.addStrategy=function(e,t){this.matchers.push(e),this.strategies.push(t)},e.prototype.getStrategy=function(e){for(var t=this.matchers,n=0,r=t.length;n<r;++n)if(t[n](e))return this.strategies[n];return null},e}()}),define("aurelia-templating-resources/number-repeat-strategy",["exports","./repeat-utilities"],function(e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NumberRepeatStrategy=void 0;e.NumberRepeatStrategy=function(){function e(){}return e.prototype.getCollectionObserver=function(){return null},e.prototype.instanceChanged=function(e,t){var n=this,r=e.removeAllViews(!0,!e.viewsRequireLifecycle);r instanceof Promise?r.then(function(){return n._standardProcessItems(e,t)}):this._standardProcessItems(e,t)},e.prototype._standardProcessItems=function(e,t){var n=e.viewCount(),r=void 0,i=void 0,o=void 0,a=void 0;if(0<(a=n-(t=Math.floor(t))))for(n<a&&(a=n),r=0,i=a;r<i;++r)e.removeView(n-(r+1),!0,!e.viewsRequireLifecycle);else{for(r=n,i=t;r<i;++r)o=(0,s.createFullOverrideContext)(e,r,r,i),e.addView(o.bindingContext,o);(0,s.updateOverrideContexts)(e.views(),0)}},e}()}),define("aurelia-templating-resources/null-repeat-strategy",["exports"],function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.NullRepeatStrategy=function(){function e(){}return e.prototype.instanceChanged=function(e,t){e.removeAllViews(!0)},e.prototype.getCollectionObserver=function(e,t){},e}()}),define("aurelia-templating-resources/map-repeat-strategy",["exports","./repeat-utilities"],function(e,f){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MapRepeatStrategy=void 0;e.MapRepeatStrategy=function(){function e(){}return e.prototype.getCollectionObserver=function(e,t){return e.getMapObserver(t)},e.prototype.instanceChanged=function(e,t){var n=this,r=e.removeAllViews(!0,!e.viewsRequireLifecycle);r instanceof Promise?r.then(function(){return n._standardProcessItems(e,t)}):this._standardProcessItems(e,t)},e.prototype._standardProcessItems=function(n,r){var i=0,o=void 0;r.forEach(function(e,t){o=(0,f.createFullOverrideContext)(n,e,i,r.size,t),n.addView(o.bindingContext,o),++i})},e.prototype.instanceMutated=function(e,t,n){var r,i=void 0,o=void 0,a=void 0,s=void 0,u=void 0,c=void 0,l=[],h=void 0;for(o=0,r=n.length;o<r;++o)switch(i=(c=n[o]).key,c.type){case"update":s=this._getViewIndexByKey(e,i),(h=e.removeView(s,!0,!e.viewsRequireLifecycle))instanceof Promise&&l.push(h),a=(0,f.createFullOverrideContext)(e,t.get(i),s,t.size,i),e.insertView(s,a.bindingContext,a);break;case"add":u=e.viewCount()<=t.size-1?e.viewCount():t.size-1,a=(0,f.createFullOverrideContext)(e,t.get(i),u,t.size,i),e.insertView(t.size-1,a.bindingContext,a);break;case"delete":if(void 0===c.oldValue)return;s=this._getViewIndexByKey(e,i),(h=e.removeView(s,!0,!e.viewsRequireLifecycle))instanceof Promise&&l.push(h);break;case"clear":e.removeAllViews(!0,!e.viewsRequireLifecycle);break;default:continue}0<l.length?Promise.all(l).then(function(){(0,f.updateOverrideContexts)(e.views(),0)}):(0,f.updateOverrideContexts)(e.views(),0)},e.prototype._getViewIndexByKey=function(e,t){var n,r=void 0;for(r=0,n=e.viewCount();r<n;++r)if(e.view(r).bindingContext[e.key]===t)return r},e}()}),define("aurelia-templating-resources/if",["exports","aurelia-templating","aurelia-dependency-injection","./if-core"],function(e,t,n,r){"use strict";function a(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(n,r,e,t,i){var o={};return Object.keys(t).forEach(function(e){o[e]=t[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=e.slice().reverse().reduce(function(e,t){return t(n,r,e)||e},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(n,r,o),o=null),o}var o,u,c,l,h,f,d;Object.defineProperty(e,"__esModule",{value:!0}),e.If=void 0;e.If=(o=(0,t.customAttribute)("if"),u=(0,n.inject)(t.BoundViewFactory,t.ViewSlot),c=(0,t.bindable)({primaryProperty:!0}),o(l=(0,t.templateController)(l=u((h=function(o){function e(){for(var e,t,n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return a(e=t=s(this,o.call.apply(o,[this].concat(r))),"condition",f,t),a(t,"swapOrder",d,t),s(t,e)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(e,o),e.prototype.bind=function(e,t){o.prototype.bind.call(this,e,t),this.condition?this._show():this._hide()},e.prototype.conditionChanged=function(e){this._update(e)},e.prototype._update=function(e){var t=this;if(!this.animating){var n=void 0;(n=this.elseVm?e?this._swap(this.elseVm,this):this._swap(this,this.elseVm):e?this._show():this._hide())&&(this.animating=!0,n.then(function(){t.animating=!1,t.condition!==t.showing&&t._update(t.condition)}))}},e.prototype._swap=function(e,t){switch(this.swapOrder){case"before":return Promise.resolve(t._show()).then(function(){return e._hide()});case"with":return Promise.all([e._hide(),t._show()]);default:var n=e._hide();return n?n.then(function(){return t._show()}):t._show()}},e}(r.IfCore),f=i(h.prototype,"condition",[c],{enumerable:!0,initializer:null}),d=i(h.prototype,"swapOrder",[t.bindable],{enumerable:!0,initializer:null}),l=h))||l)||l)||l)}),define("aurelia-templating-resources/if-core",["exports"],function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.IfCore=function(){function e(e,t){this.viewFactory=e,this.viewSlot=t,this.view=null,this.bindingContext=null,this.overrideContext=null,this.showing=!1}return e.prototype.bind=function(e,t){this.bindingContext=e,this.overrideContext=t},e.prototype.unbind=function(){null!==this.view&&(this.view.unbind(),this.viewFactory.isCaching&&(this.showing?(this.showing=!1,this.viewSlot.remove(this.view,!0,!0)):this.view.returnToCache(),this.view=null))},e.prototype._show=function(){if(!this.showing)return null===this.view&&(this.view=this.viewFactory.create()),this.view.isBound||this.view.bind(this.bindingContext,this.overrideContext),this.showing=!0,this.viewSlot.add(this.view);this.view.isBound||this.view.bind(this.bindingContext,this.overrideContext)},e.prototype._hide=function(){var e=this;if(this.showing){this.showing=!1;var t=this.viewSlot.remove(this.view);if(t instanceof Promise)return t.then(function(){return e.view.unbind()});this.view.unbind()}},e}()}),define("aurelia-templating-resources/html-sanitizer",["exports"],function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var t=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi;e.HTMLSanitizer=function(){function e(){}return e.prototype.sanitize=function(e){return e.replace(t,"")},e}()}),define("aurelia-templating-resources/html-resource-plugin",["exports","aurelia-templating","./dynamic-element"],function(e,r,o){"use strict";function a(e){return/([^\/^\?]+)\.html/i.exec(e)[1].toLowerCase()}Object.defineProperty(e,"__esModule",{value:!0}),e.getElementName=a,e.configure=function(e){var t=e.container.get(r.ViewEngine),n=e.aurelia.loader;t.addResourcePlugin(".html",{fetch:function(i){return n.loadTemplate(i).then(function(e){var t,n=e.template.getAttribute("bindable"),r=a(i);return n?(n=n.split(",").map(function(e){return e.trim()}),e.template.removeAttribute("bindable")):n=[],(t={})[r]=(0,o._createDynamicElement)(r,i,n),t})}})}}),define("aurelia-templating-resources/hide",["exports","aurelia-dependency-injection","aurelia-templating","aurelia-pal","./aurelia-hide-style"],function(e,t,n,r,i){"use strict";var o;Object.defineProperty(e,"__esModule",{value:!0}),e.Hide=void 0;e.Hide=(0,n.customAttribute)("hide")(o=(0,t.inject)(r.DOM.Element,n.Animator,t.Optional.of(r.DOM.boundary,!0))(o=function(){function e(e,t,n){this.element=e,this.animator=t,this.domBoundary=n}return e.prototype.created=function(){(0,i.injectAureliaHideStyleAtBoundary)(this.domBoundary)},e.prototype.valueChanged=function(e){e?this.animator.addClass(this.element,i.aureliaHideClassName):this.animator.removeClass(this.element,i.aureliaHideClassName)},e.prototype.bind=function(e){this.valueChanged(this.value)},e}())||o)||o}),define("aurelia-templating-resources/focus",["exports","aurelia-templating","aurelia-binding","aurelia-dependency-injection","aurelia-task-queue","aurelia-pal"],function(e,t,n,r,i,o){"use strict";var a;Object.defineProperty(e,"__esModule",{value:!0}),e.Focus=void 0;e.Focus=(0,t.customAttribute)("focus",n.bindingMode.twoWay)(a=(0,r.inject)(o.DOM.Element,i.TaskQueue)(a=function(){function e(e,t){this.element=e,this.taskQueue=t,this.isAttached=!1,this.needsApply=!1}return e.prototype.valueChanged=function(e){this.isAttached?this._apply():this.needsApply=!0},e.prototype._apply=function(){var e=this;this.value?this.taskQueue.queueMicroTask(function(){e.value&&e.element.focus()}):this.element.blur()},e.prototype.attached=function(){this.isAttached=!0,this.needsApply&&(this.needsApply=!1,this._apply()),this.element.addEventListener("focus",this),this.element.addEventListener("blur",this)},e.prototype.detached=function(){this.isAttached=!1,this.element.removeEventListener("focus",this),this.element.removeEventListener("blur",this)},e.prototype.handleEvent=function(e){"focus"===e.type?this.value=!0:o.DOM.activeElement!==this.element&&(this.value=!1)},e}())||a)||a}),define("aurelia-templating-resources/else",["exports","aurelia-templating","aurelia-dependency-injection","./if-core"],function(e,t,n,r){"use strict";var i,o,a;Object.defineProperty(e,"__esModule",{value:!0}),e.Else=void 0;e.Else=(i=(0,t.customAttribute)("else"),o=(0,n.inject)(t.BoundViewFactory,t.ViewSlot),i(a=(0,t.templateController)(a=o(a=function(r){function e(e,t){var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,r.call(this,e,t));return n._registerInIf(),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(e,r),e.prototype.bind=function(e,t){r.prototype.bind.call(this,e,t),this.ifVm.condition?this._hide():this._show()},e.prototype._registerInIf=function(){for(var e=this.viewSlot.anchor.previousSibling;e&&!e.au;)e=e.previousSibling;if(!e||!e.au.if)throw new Error("Can't find matching If for Else custom attribute.");this.ifVm=e.au.if.viewModel,this.ifVm.elseVm=this},e}(r.IfCore))||a)||a)||a)}),define("aurelia-templating-resources/dynamic-element",["exports","aurelia-templating"],function(e,c){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e._createDynamicElement=function(e,t,n){for(var r,i,o,a=(r=(0,c.customElement)(e),i=(0,c.useView)(t),r(o=i(o=function(){function e(){}return e.prototype.bind=function(e){this.$parent=e},e}())||o)||o),s=0,u=n.length;s<u;++s)(0,c.bindable)(n[s])(a);return a}}),define("aurelia-templating-resources/debounce-binding-behavior",["exports","aurelia-binding"],function(e,u){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DebounceBindingBehavior=void 0;var c={};function l(e){var t=this,n=this.debounceState;clearTimeout(n.timeoutId),n.timeoutId=setTimeout(function(){return t.debouncedMethod(e)},n.delay)}function h(t,n,e){var r=this,i=this.debounceState;if(clearTimeout(i.timeoutId),t!==i.callContextToDebounce)return i.oldValue=c,void this.debouncedMethod(t,n,e);i.oldValue===c&&(i.oldValue=e),i.timeoutId=setTimeout(function(){var e=i.oldValue;i.oldValue=c,r.debouncedMethod(t,n,e)},i.delay)}e.DebounceBindingBehavior=function(){function e(){}return e.prototype.bind=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:200,r=void 0!==e.callSource,i=r?"callSource":"call",o=r?l:h,a=e.mode,s=a===u.bindingMode.twoWay||a===u.bindingMode.fromView?u.targetContext:u.sourceContext;e.debouncedMethod=e[i],e.debouncedMethod.originalName=i,e[i]=o,e.debounceState={callContextToDebounce:s,delay:n,timeoutId:0,oldValue:c}},e.prototype.unbind=function(e,t){e[e.debouncedMethod.originalName]=e.debouncedMethod,e.debouncedMethod=null,clearTimeout(e.debounceState.timeoutId),e.debounceState=null},e}()}),define("aurelia-templating-resources/css-resource",["exports","aurelia-templating","aurelia-loader","aurelia-dependency-injection","aurelia-path","aurelia-pal"],function(e,n,r,t,i,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e._createCSSResource=function(e){var t;return(0,n.resource)(new s(e))(t=function(e){function t(){return function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(u))||t};var a=/url\((?!['"]data)([^)]+)\)/gi;var s=function(){function e(e){this.address=e,this._scoped=null,this._global=!1,this._alreadyGloballyInjected=!1}return e.prototype.initialize=function(e,t){this._scoped=new t(this)},e.prototype.register=function(e,t){"scoped"===t?e.registerViewEngineHooks(this._scoped):this._global=!0},e.prototype.load=function(e){var t=this;return e.get(r.Loader).loadText(this.address).catch(function(e){return null}).then(function(e){e=function(r,e){if("string"!=typeof e)throw new Error("Failed loading required CSS file: "+r);return e.replace(a,function(e,t){var n=t.charAt(0);return"'"!==n&&'"'!==n||(t=t.substr(1,t.length-2)),"url('"+(0,i.relativeToFile)(t,r)+"')"})}(t.address,e),t._scoped.css=e,t._global&&(t._alreadyGloballyInjected=!0,o.DOM.injectStyles(e))})},e}(),u=function(){function e(e){this.owner=e,this.css=null}return e.prototype.beforeCompile=function(e,t,n){if(n.targetShadowDOM)o.DOM.injectStyles(this.css,e,!0);else if(o.FEATURE.scopedCSS){o.DOM.injectStyles(this.css,e,!0).setAttribute("scoped","scoped")}else this._global&&!this.owner._alreadyGloballyInjected&&(o.DOM.injectStyles(this.css),this.owner._alreadyGloballyInjected=!0)},e}()}),define("aurelia-templating-resources/compose",["exports","aurelia-dependency-injection","aurelia-logging","aurelia-task-queue","aurelia-templating","aurelia-pal"],function(e,t,n,r,i,o){"use strict";var a,s,u,c,l,h,f,d;function p(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function v(n,r,e,t,i){var o={};return Object.keys(t).forEach(function(e){o[e]=t[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=e.slice().reverse().reduce(function(e,t){return t(n,r,e)||e},o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(n,r,o),o=null),o}Object.defineProperty(e,"__esModule",{value:!0}),e.Compose=void 0;var m=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(n).getLogger("templating-resources");e.Compose=(a=(0,i.customElement)("compose"),s=(0,t.inject)(o.DOM.Element,t.Container,i.CompositionEngine,i.ViewSlot,i.ViewResources,r.TaskQueue),a(u=(0,i.noView)(u=s((c=function(){function e(e,t,n,r,i,o){p(this,"model",l,this),p(this,"view",h,this),p(this,"viewModel",f,this),p(this,"swapOrder",d,this),this.element=e,this.container=t,this.compositionEngine=n,this.viewSlot=r,this.viewResources=i,this.taskQueue=o,this.currentController=null,this.currentViewModel=null,this.changes=Object.create(null)}return e.prototype.created=function(e){this.owningView=e},e.prototype.bind=function(e,t){this.bindingContext=e,this.overrideContext=t,this.changes.view=this.view,this.changes.viewModel=this.viewModel,this.changes.model=this.model,g(this)},e.prototype.unbind=function(){this.changes=Object.create(null),this.pendingTask=null,this.bindingContext=null;this.overrideContext=null;this.viewSlot.removeAll(!0,!0)},e.prototype.modelChanged=function(e,t){this.changes.model=e,y(this)},e.prototype.viewChanged=function(e,t){this.changes.view=e,y(this)},e.prototype.viewModelChanged=function(e,t){this.changes.viewModel=e,y(this)},e}(),l=v(c.prototype,"model",[i.bindable],{enumerable:!0,initializer:null}),h=v(c.prototype,"view",[i.bindable],{enumerable:!0,initializer:null}),f=v(c.prototype,"viewModel",[i.bindable],{enumerable:!0,initializer:null}),d=v(c.prototype,"swapOrder",[i.bindable],{enumerable:!0,initializer:null}),u=c))||u)||u)||u);function g(t){var e,n,r=t.changes;if(t.changes=Object.create(null),"view"in r||"viewModel"in r||!("model"in r)){var i={view:t.view,viewModel:t.currentViewModel||t.viewModel,model:t.model};i=Object.assign(i,r),e=t,n=i,i=Object.assign(n,{bindingContext:e.bindingContext,overrideContext:e.overrideContext,owningView:e.owningView,container:e.container,viewSlot:e.viewSlot,viewResources:e.viewResources,currentController:e.currentController,host:e.element,swapOrder:e.swapOrder}),t.pendingTask=t.compositionEngine.compose(i).then(function(e){t.currentController=e,t.currentViewModel=e?e.viewModel:null})}else if(t.pendingTask=function(e,t){if(e&&"function"==typeof e.activate)return Promise.resolve(e.activate(t))}(t.currentViewModel,r.model),!t.pendingTask)return;t.pendingTask=t.pendingTask.catch(function(e){m.error(e)}).then(function(){t.pendingTask&&(t.pendingTask=null,function(e){for(var t in e)return!1;return!0}(t.changes)||g(t))})}function y(e){e.pendingTask||e.updateRequested||(e.updateRequested=!0,e.taskQueue.queueMicroTask(function(){e.updateRequested=!1,g(e)}))}}),define("aurelia-templating-resources/binding-signaler",["exports","aurelia-binding"],function(e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BindingSignaler=void 0;e.BindingSignaler=function(){function e(){this.signals={}}return e.prototype.signal=function(e){var t=this.signals[e];if(t)for(var n=t.length;n--;)t[n].call(r.sourceContext)},e}()}),define("aurelia-templating-resources/binding-mode-behaviors",["exports","aurelia-binding","aurelia-metadata"],function(e,t,n){"use strict";var r,i,o;Object.defineProperty(e,"__esModule",{value:!0}),e.TwoWayBindingBehavior=e.OneWayBindingBehavior=e.OneTimeBindingBehavior=void 0;var a={bind:function(e,t,n){e.originalMode=e.mode,e.mode=this.mode},unbind:function(e,t){e.mode=e.originalMode,e.originalMode=null}};e.OneTimeBindingBehavior=(0,n.mixin)(a)(r=function(){this.mode=t.bindingMode.oneTime})||r,e.OneWayBindingBehavior=(0,n.mixin)(a)(i=function(){this.mode=t.bindingMode.oneWay})||i,e.TwoWayBindingBehavior=(0,n.mixin)(a)(o=function(){this.mode=t.bindingMode.twoWay})||o}),define("aurelia-templating-resources/aurelia-templating-resources",["exports","aurelia-pal","./compose","./if","./else","./with","./repeat","./show","./hide","./sanitize-html","./replaceable","./focus","aurelia-templating","./css-resource","./html-sanitizer","./attr-binding-behavior","./binding-mode-behaviors","./throttle-binding-behavior","./debounce-binding-behavior","./self-binding-behavior","./signal-binding-behavior","./binding-signaler","./update-trigger-binding-behavior","./abstract-repeater","./repeat-strategy-locator","./html-resource-plugin","./null-repeat-strategy","./array-repeat-strategy","./map-repeat-strategy","./set-repeat-strategy","./number-repeat-strategy","./repeat-utilities","./analyze-view-factory","./aurelia-hide-style"],function(e,r,t,n,i,o,a,s,u,c,l,h,f,d,p,v,m,g,y,b,_,w,E,S,C,T,O,R,A,I,N,k,P,x){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.viewsRequireLifecycle=e.unwrapExpression=e.updateOneTimeBinding=e.isOneTime=e.getItemsSourceExpression=e.updateOverrideContext=e.createFullOverrideContext=e.NumberRepeatStrategy=e.SetRepeatStrategy=e.MapRepeatStrategy=e.ArrayRepeatStrategy=e.NullRepeatStrategy=e.RepeatStrategyLocator=e.AbstractRepeater=e.UpdateTriggerBindingBehavior=e.BindingSignaler=e.SignalBindingBehavior=e.SelfBindingBehavior=e.DebounceBindingBehavior=e.ThrottleBindingBehavior=e.TwoWayBindingBehavior=e.OneWayBindingBehavior=e.OneTimeBindingBehavior=e.AttrBindingBehavior=e.configure=e.Focus=e.Replaceable=e.SanitizeHTMLValueConverter=e.HTMLSanitizer=e.Hide=e.Show=e.Repeat=e.With=e.Else=e.If=e.Compose=void 0,e.Compose=t.Compose,e.If=n.If,e.Else=i.Else,e.With=o.With,e.Repeat=a.Repeat,e.Show=s.Show,e.Hide=u.Hide,e.HTMLSanitizer=p.HTMLSanitizer,e.SanitizeHTMLValueConverter=c.SanitizeHTMLValueConverter,e.Replaceable=l.Replaceable,e.Focus=h.Focus,e.configure=function(e){(0,x.injectAureliaHideStyleAtHead)(),e.globalResources(r.PLATFORM.moduleName("./compose"),r.PLATFORM.moduleName("./if"),r.PLATFORM.moduleName("./else"),r.PLATFORM.moduleName("./with"),r.PLATFORM.moduleName("./repeat"),r.PLATFORM.moduleName("./show"),r.PLATFORM.moduleName("./hide"),r.PLATFORM.moduleName("./replaceable"),r.PLATFORM.moduleName("./sanitize-html"),r.PLATFORM.moduleName("./focus"),r.PLATFORM.moduleName("./binding-mode-behaviors"),r.PLATFORM.moduleName("./self-binding-behavior"),r.PLATFORM.moduleName("./throttle-binding-behavior"),r.PLATFORM.moduleName("./debounce-binding-behavior"),r.PLATFORM.moduleName("./signal-binding-behavior"),r.PLATFORM.moduleName("./update-trigger-binding-behavior"),r.PLATFORM.moduleName("./attr-binding-behavior")),(0,T.configure)(e);var t=e.container.get(f.ViewEngine),n={fetch:function(e){var t;return(t={})[e]=(0,d._createCSSResource)(e),t}};[".css",".less",".sass",".scss",".styl"].forEach(function(e){return t.addResourcePlugin(e,n)})},e.AttrBindingBehavior=v.AttrBindingBehavior,e.OneTimeBindingBehavior=m.OneTimeBindingBehavior,e.OneWayBindingBehavior=m.OneWayBindingBehavior,e.TwoWayBindingBehavior=m.TwoWayBindingBehavior,e.ThrottleBindingBehavior=g.ThrottleBindingBehavior,e.DebounceBindingBehavior=y.DebounceBindingBehavior,e.SelfBindingBehavior=b.SelfBindingBehavior,e.SignalBindingBehavior=_.SignalBindingBehavior,e.BindingSignaler=w.BindingSignaler,e.UpdateTriggerBindingBehavior=E.UpdateTriggerBindingBehavior,e.AbstractRepeater=S.AbstractRepeater,e.RepeatStrategyLocator=C.RepeatStrategyLocator,e.NullRepeatStrategy=O.NullRepeatStrategy,e.ArrayRepeatStrategy=R.ArrayRepeatStrategy,e.MapRepeatStrategy=A.MapRepeatStrategy,e.SetRepeatStrategy=I.SetRepeatStrategy,e.NumberRepeatStrategy=N.NumberRepeatStrategy,e.createFullOverrideContext=k.createFullOverrideContext,e.updateOverrideContext=k.updateOverrideContext,e.getItemsSourceExpression=k.getItemsSourceExpression,e.isOneTime=k.isOneTime,e.updateOneTimeBinding=k.updateOneTimeBinding,e.unwrapExpression=k.unwrapExpression,e.viewsRequireLifecycle=P.viewsRequireLifecycle}),define("aurelia-templating-resources",["aurelia-templating-resources/aurelia-templating-resources"],function(e){return e}),define("aurelia-templating-resources/aurelia-hide-style",["exports","aurelia-pal"],function(e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.aureliaHideClassName=void 0,e.injectAureliaHideStyleAtHead=function(){t.DOM.injectStyles(n)},e.injectAureliaHideStyleAtBoundary=function(e){t.FEATURE.shadowDOM&&e&&!e.hasAureliaHideStyle&&(e.hasAureliaHideStyle=!0,t.DOM.injectStyles(n,e))};var n="."+(e.aureliaHideClassName="aurelia-hide")+" { display:none !important; }"}),define("aurelia-templating-resources/attr-binding-behavior",["exports","aurelia-binding"],function(e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AttrBindingBehavior=void 0;e.AttrBindingBehavior=function(){function e(){}return e.prototype.bind=function(e,t){e.targetObserver=new n.DataAttributeObserver(e.target,e.targetProperty)},e.prototype.unbind=function(e,t){},e}()}),define("aurelia-templating-resources/array-repeat-strategy",["exports","./repeat-utilities","aurelia-binding"],function(e,m,f){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ArrayRepeatStrategy=void 0;e.ArrayRepeatStrategy=function(){function e(){}return e.prototype.getCollectionObserver=function(e,t){return e.getArrayObserver(t)},e.prototype.instanceChanged=function(o,a){var s=this,u=a.length;if(a&&0!==u){var c=o.views(),e=c.length;if(0!==e)if(o.viewsRequireLifecycle){for(var t=c.slice(0),n=o.local,l=o.matcher(),h=[],r=[],i=0;i<e;i++){var f=t[i],d=f.bindingContext[n];-1===(0,m.indexOf)(a,d,l)?r.push(f):h.push(d)}var p=void 0,v=void 0;0<h.length?(v=o.removeViews(r,!0,!o.viewsRequireLifecycle),p=function(){for(var e=0;e<u;e++){var t=a[e],n=(0,m.indexOf)(h,t,l,e),r=void 0;if(-1===n){var i=(0,m.createFullOverrideContext)(o,a[e],e,u);o.insertView(e,i.bindingContext,i),h.splice(e,0,void 0)}else n===e?(r=c[n],h[n]=void 0):(r=c[n],o.moveView(n,e),h.splice(n,1),h.splice(e,0,void 0));r&&(0,m.updateOverrideContext)(r.overrideContext,e,u)}s._inPlaceProcessItems(o,a)}):(v=o.removeAllViews(!0,!o.viewsRequireLifecycle),p=function(){return s._standardProcessInstanceChanged(o,a)}),v instanceof Promise?v.then(p):p()}else this._inPlaceProcessItems(o,a);else this._standardProcessInstanceChanged(o,a)}else o.removeAllViews(!0,!o.viewsRequireLifecycle)},e.prototype._standardProcessInstanceChanged=function(e,t){for(var n=0,r=t.length;n<r;n++){var i=(0,m.createFullOverrideContext)(e,t[n],n,r);e.addView(i.bindingContext,i)}},e.prototype._inPlaceProcessItems=function(e,t){for(var n=t.length,r=e.viewCount();n<r;)r--,e.removeView(r,!0,!e.viewsRequireLifecycle);for(var i=e.local,o=0;o<r;o++){var a=e.view(o),s=o===n-1,u=0!==o&&!s;a.bindingContext[i]===t[o]&&a.overrideContext.$middle===u&&a.overrideContext.$last===s||(a.bindingContext[i]=t[o],a.overrideContext.$middle=u,a.overrideContext.$last=s,e.updateBindings(a))}for(var c=r;c<n;c++){var l=(0,m.createFullOverrideContext)(e,t[c],c,n);e.addView(l.bindingContext,l)}},e.prototype.instanceMutated=function(n,e,t){var r=this;if(n.__queuedSplices){for(var i=0,o=t.length;i<o;++i){var a=t[i],s=a.index,u=a.removed,c=a.addedCount;(0,f.mergeSplice)(n.__queuedSplices,s,u,c)}n.__array=e.slice(0)}else{var l=this._runSplices(n,e.slice(0),t);if(l instanceof Promise){var h=n.__queuedSplices=[];l.then(function e(){if(!h.length)return n.__queuedSplices=void 0,void(n.__array=void 0);var t=r._runSplices(n,n.__array,h)||Promise.resolve();h=n.__queuedSplices=[],t.then(e)})}}},e.prototype._runSplices=function(t,n,r){for(var i=this,e=0,o=[],a=0,s=r.length;a<s;++a){for(var u=r[a],c=0,l=u.removed.length;c<l;++c){var h=t.removeView(u.index+e+o.length,!0);h instanceof Promise&&o.push(h)}e-=u.addedCount}if(0<o.length)return Promise.all(o).then(function(){var e=i._handleAddedSplices(t,n,r);(0,m.updateOverrideContexts)(t.views(),e)});var f=this._handleAddedSplices(t,n,r);(0,m.updateOverrideContexts)(t.views(),f)},e.prototype._handleAddedSplices=function(e,t,n){for(var r=void 0,i=void 0,o=t.length,a=0,s=n.length;a<s;++a){var u=n[a],c=r=u.index,l=u.index+u.addedCount;for((null==i||i>u.index)&&(i=r);c<l;++c){var h=(0,m.createFullOverrideContext)(e,t[c],c,o);e.insertView(c,h.bindingContext,h)}}return i},e}()}),define("aurelia-templating-resources/analyze-view-factory",["exports"],function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.viewsRequireLifecycle=s;var a=e.lifecycleOptionalBehaviors=["focus","if","else","repeat","show","hide","with"];function n(e){var t,n,r,i=e.behaviorInstructions;if(i)for(var o=i.length;o--;)if(t=i[o],void 0,n=t.type,r=null!==n.elementName?n.elementName:n.attributeName,-1===a.indexOf(r)&&(n.handlesAttached||n.handlesBind||n.handlesCreated||n.handlesDetached||n.handlesUnbind)||n.viewFactory&&s(n.viewFactory)||t.viewFactory&&s(t.viewFactory))return!0;return e.viewFactory&&s(e.viewFactory)}function s(e){if("_viewsRequireLifecycle"in e)return e._viewsRequireLifecycle;if(e._viewsRequireLifecycle=!1,e.viewFactory)return e._viewsRequireLifecycle=s(e.viewFactory),e._viewsRequireLifecycle;if(e.template.querySelector(".au-animate"))return e._viewsRequireLifecycle=!0;for(var t in e.instructions)if(n(e.instructions[t]))return e._viewsRequireLifecycle=!0;return e._viewsRequireLifecycle=!1}}),define("aurelia-templating-resources/abstract-repeater",["exports"],function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.AbstractRepeater=function(){function e(e){Object.assign(this,{local:"items",viewsRequireLifecycle:!0},e)}return e.prototype.viewCount=function(){throw new Error("subclass must implement `viewCount`")},e.prototype.views=function(){throw new Error("subclass must implement `views`")},e.prototype.view=function(e){throw new Error("subclass must implement `view`")},e.prototype.matcher=function(){throw new Error("subclass must implement `matcher`")},e.prototype.addView=function(e,t){throw new Error("subclass must implement `addView`")},e.prototype.insertView=function(e,t,n){throw new Error("subclass must implement `insertView`")},e.prototype.moveView=function(e,t){throw new Error("subclass must implement `moveView`")},e.prototype.removeAllViews=function(e,t){throw new Error("subclass must implement `removeAllViews`")},e.prototype.removeViews=function(e,t,n){throw new Error("subclass must implement `removeView`")},e.prototype.removeView=function(e,t,n){throw new Error("subclass must implement `removeView`")},e.prototype.updateBindings=function(e){throw new Error("subclass must implement `updateBindings`")},e}()}),define("aurelia-templating-binding",["exports","aurelia-logging","aurelia-binding","aurelia-templating"],function(e,t,c,m){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TemplatingBindingLanguage=e.SyntaxInterpreter=e.ChildInterpolationBinding=e.InterpolationBinding=e.InterpolationBindingExpression=e.AttributeMap=void 0,e.configure=function(e){e.container.registerSingleton(m.BindingLanguage,b),e.container.registerAlias(m.BindingLanguage,b)};var n,r,i,o,a,s,u,l=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(t);var h=e.AttributeMap=(r=n=function(){function e(e){this.elements=Object.create(null),this.allElements=Object.create(null),this.svg=e,this.registerUniversal("accesskey","accessKey"),this.registerUniversal("contenteditable","contentEditable"),this.registerUniversal("tabindex","tabIndex"),this.registerUniversal("textcontent","textContent"),this.registerUniversal("innerhtml","innerHTML"),this.registerUniversal("scrolltop","scrollTop"),this.registerUniversal("scrollleft","scrollLeft"),this.registerUniversal("readonly","readOnly"),this.register("label","for","htmlFor"),this.register("img","usemap","useMap"),this.register("input","maxlength","maxLength"),this.register("input","minlength","minLength"),this.register("input","formaction","formAction"),this.register("input","formenctype","formEncType"),this.register("input","formmethod","formMethod"),this.register("input","formnovalidate","formNoValidate"),this.register("input","formtarget","formTarget"),this.register("textarea","maxlength","maxLength"),this.register("td","rowspan","rowSpan"),this.register("td","colspan","colSpan"),this.register("th","rowspan","rowSpan"),this.register("th","colspan","colSpan")}return e.prototype.register=function(e,t,n){e=e.toLowerCase(),t=t.toLowerCase(),(this.elements[e]=this.elements[e]||Object.create(null))[t]=n},e.prototype.registerUniversal=function(e,t){e=e.toLowerCase(),this.allElements[e]=t},e.prototype.map=function(e,t){if(this.svg.isStandardSvgAttribute(e,t))return t;e=e.toLowerCase(),t=t.toLowerCase();var n=this.elements[e];return void 0!==n&&t in n?n[t]:t in this.allElements?this.allElements[t]:/(?:^data-)|(?:^aria-)|:/.test(t)?t:(0,c.camelCase)(t)},e}(),n.inject=[c.SVGAnalyzer],r),f=e.InterpolationBindingExpression=function(){function e(e,t,n,r,i,o){this.observerLocator=e,this.targetProperty=t,this.parts=n,this.mode=r,this.lookupFunctions=i,this.attribute=this.attrToRemove=o,this.discrete=!1}return e.prototype.createBinding=function(e){return 3===this.parts.length?new v(e,this.observerLocator,this.parts[1],this.mode,this.lookupFunctions,this.targetProperty,this.parts[0],this.parts[2]):new p(this.observerLocator,this.parts,e,this.targetProperty,this.mode,this.lookupFunctions)},e}();function d(e,t){if("style"===t)l.getLogger("templating-binding").info('Internet Explorer does not support interpolation in "style" attributes.  Use the style attribute\'s alias, "css" instead.');else if(e.parentElement&&"TEXTAREA"===e.parentElement.nodeName&&"textContent"===t)throw new Error('Interpolation binding cannot be used in the content of a textarea element.  Use <textarea value.bind="expression"></textarea> instead.')}var p=e.InterpolationBinding=function(){function e(e,t,n,r,i,o){d(n,r),this.observerLocator=e,this.parts=t,this.target=n,this.targetProperty=r,this.targetAccessor=e.getAccessor(n,r),this.mode=i,this.lookupFunctions=o}return e.prototype.interpolate=function(){if(this.isBound){for(var e="",t=this.parts,n=0,r=t.length;n<r;n++)e+=n%2==0?t[n]:this["childBinding"+n].value;this.targetAccessor.setValue(e,this.target,this.targetProperty)}},e.prototype.updateOneTimeBindings=function(){for(var e=1,t=this.parts.length;e<t;e+=2){var n=this["childBinding"+e];n.mode===c.bindingMode.oneTime&&n.call()}},e.prototype.bind=function(e){if(this.isBound){if(this.source===e)return;this.unbind()}this.source=e;for(var t=this.parts,n=1,r=t.length;n<r;n+=2){var i=new v(this,this.observerLocator,t[n],this.mode,this.lookupFunctions);i.bind(e),this["childBinding"+n]=i}this.isBound=!0,this.interpolate()},e.prototype.unbind=function(){if(this.isBound){this.isBound=!1,this.source=null;for(var e=1,t=this.parts.length;e<t;e+=2){this["childBinding"+e].unbind()}}},e}(),v=e.ChildInterpolationBinding=(0,c.connectable)()(i=function(){function e(e,t,n,r,i,o,a,s){e instanceof p?this.parent=e:(d(e,o),this.target=e,this.targetProperty=o,this.targetAccessor=t.getAccessor(e,o)),this.observerLocator=t,this.sourceExpression=n,this.mode=r,this.lookupFunctions=i,this.left=a,this.right=s}return e.prototype.updateTarget=function(e){(e=null==e?"":e.toString())!==this.value&&(this.value=e,this.parent?this.parent.interpolate():this.targetAccessor.setValue(this.left+e+this.right,this.target,this.targetProperty))},e.prototype.call=function(){this.isBound&&(this.rawValue=this.sourceExpression.evaluate(this.source,this.lookupFunctions),this.updateTarget(this.rawValue),this.mode!==c.bindingMode.oneTime&&(this._version++,this.sourceExpression.connect(this,this.source),this.rawValue instanceof Array&&this.observeArray(this.rawValue),this.unobserve(!1)))},e.prototype.bind=function(e){if(this.isBound){if(this.source===e)return;this.unbind()}this.isBound=!0,this.source=e;var t=this.sourceExpression;t.bind&&t.bind(this,e,this.lookupFunctions),this.rawValue=t.evaluate(e,this.lookupFunctions),this.updateTarget(this.rawValue),this.mode===c.bindingMode.oneWay&&(0,c.enqueueBindingConnect)(this)},e.prototype.unbind=function(){if(this.isBound){this.isBound=!1;var e=this.sourceExpression;e.unbind&&e.unbind(this,this.source),this.source=null,this.value=null,this.rawValue=null,this.unobserve(!0)}},e.prototype.connect=function(e){this.isBound&&(e&&(this.rawValue=this.sourceExpression.evaluate(this.source,this.lookupFunctions),this.updateTarget(this.rawValue)),this.sourceExpression.connect(this,this.source),this.rawValue instanceof Array&&this.observeArray(this.rawValue))},e}())||i,g=e.SyntaxInterpreter=(a=o=function(){function e(e,t,n,r){this.parser=e,this.observerLocator=t,this.eventManager=n,this.attributeMap=r}return e.prototype.interpret=function(e,t,n,r,i){return n.command in this?this[n.command](e,t,n,r,i):this.handleUnknownCommand(e,t,n,r,i)},e.prototype.handleUnknownCommand=function(e,t,n,r,i){return l.getLogger("templating-binding").warn("Unknown binding command.",n),r},e.prototype.determineDefaultBindingMode=function(e,t,n){var r=e.tagName.toLowerCase();return"input"===r&&("value"===t||"files"===t)&&"checkbox"!==e.type&&"radio"!==e.type||"input"===r&&"checked"===t&&("checkbox"===e.type||"radio"===e.type)||("textarea"===r||"select"===r)&&"value"===t||("textcontent"===t||"innerhtml"===t)&&"true"===e.contentEditable||"scrolltop"===t||"scrollleft"===t?c.bindingMode.twoWay:n&&t in n.attributes&&n.attributes[t]&&n.attributes[t].defaultBindingMode>=c.bindingMode.oneTime?n.attributes[t].defaultBindingMode:c.bindingMode.oneWay},e.prototype.bind=function(e,t,n,r,i){var o=r||m.BehaviorInstruction.attribute(n.attrName);return o.attributes[n.attrName]=new c.BindingExpression(this.observerLocator,this.attributeMap.map(t.tagName,n.attrName),this.parser.parse(n.attrValue),void 0===n.defaultBindingMode||null===n.defaultBindingMode?this.determineDefaultBindingMode(t,n.attrName,i):n.defaultBindingMode,e.lookupFunctions),o},e.prototype.trigger=function(e,t,n){return new c.ListenerExpression(this.eventManager,n.attrName,this.parser.parse(n.attrValue),c.delegationStrategy.none,!0,e.lookupFunctions)},e.prototype.capture=function(e,t,n){return new c.ListenerExpression(this.eventManager,n.attrName,this.parser.parse(n.attrValue),c.delegationStrategy.capturing,!0,e.lookupFunctions)},e.prototype.delegate=function(e,t,n){return new c.ListenerExpression(this.eventManager,n.attrName,this.parser.parse(n.attrValue),c.delegationStrategy.bubbling,!0,e.lookupFunctions)},e.prototype.call=function(e,t,n,r){var i=r||m.BehaviorInstruction.attribute(n.attrName);return i.attributes[n.attrName]=new c.CallExpression(this.observerLocator,n.attrName,this.parser.parse(n.attrValue),e.lookupFunctions),i},e.prototype.options=function(e,t,n,r,i){var o,a=r||m.BehaviorInstruction.attribute(n.attrName),s=n.attrValue,u=this.language,c=null,l="",h=void 0,f=void 0,d=!1,p=!1,v=!1;for(f=0,o=s.length;f<o;++f){if(";"!==(h=s[f])||d)if(":"===h&&null===c)v=!0,c=l.trim(),l="";else{if("\\"===h){l+=h,p=!0;continue}l+=h,null!==c&&!1===p&&"'"===h&&(d=!d)}else v||(c=this._getPrimaryPropertyName(e,i)),n=u.inspectAttribute(e,"?",c,l.trim()),u.createAttributeInstruction(e,t,n,a,i),a.attributes[n.attrName]||(a.attributes[n.attrName]=n.attrValue),l="",c=null;p=!1}return v||(c=this._getPrimaryPropertyName(e,i)),null!==c&&(n=u.inspectAttribute(e,"?",c,l.trim()),u.createAttributeInstruction(e,t,n,a,i),a.attributes[n.attrName]||(a.attributes[n.attrName]=n.attrValue)),a},e.prototype._getPrimaryPropertyName=function(e,t){var n=e.getAttribute(t.attributeName);return n&&n.primaryProperty?n.primaryProperty.attribute:null},e.prototype.for=function(e,t,n,r){var i,o=void 0,a=void 0,s=void 0,u=void 0;if(2!==(o=(i=(u=n.attrValue).match(/^ *[[].+[\]]/))?u.split("of "):u.split(" of ")).length)throw new Error('Incorrect syntax for "for". The form is: "$local of $items" or "[$key, $value] of $items".');return s=r||m.BehaviorInstruction.attribute(n.attrName),i?(a=o[0].replace(/[[\]]/g,"").replace(/,/g," ").replace(/\s+/g," ").trim().split(" "),s.attributes.key=a[0],s.attributes.value=a[1]):s.attributes.local=o[0],s.attributes.items=new c.BindingExpression(this.observerLocator,"items",this.parser.parse(o[1]),c.bindingMode.oneWay,e.lookupFunctions),s},e.prototype["two-way"]=function(e,t,n,r){var i=r||m.BehaviorInstruction.attribute(n.attrName);return i.attributes[n.attrName]=new c.BindingExpression(this.observerLocator,this.attributeMap.map(t.tagName,n.attrName),this.parser.parse(n.attrValue),c.bindingMode.twoWay,e.lookupFunctions),i},e.prototype["to-view"]=function(e,t,n,r){var i=r||m.BehaviorInstruction.attribute(n.attrName);return i.attributes[n.attrName]=new c.BindingExpression(this.observerLocator,this.attributeMap.map(t.tagName,n.attrName),this.parser.parse(n.attrValue),c.bindingMode.toView,e.lookupFunctions),i},e.prototype["from-view"]=function(e,t,n,r){var i=r||m.BehaviorInstruction.attribute(n.attrName);return i.attributes[n.attrName]=new c.BindingExpression(this.observerLocator,this.attributeMap.map(t.tagName,n.attrName),this.parser.parse(n.attrValue),c.bindingMode.fromView,e.lookupFunctions),i},e.prototype["one-time"]=function(e,t,n,r){var i=r||m.BehaviorInstruction.attribute(n.attrName);return i.attributes[n.attrName]=new c.BindingExpression(this.observerLocator,this.attributeMap.map(t.tagName,n.attrName),this.parser.parse(n.attrValue),c.bindingMode.oneTime,e.lookupFunctions),i},e}(),o.inject=[c.Parser,c.ObserverLocator,c.EventManager,h],a);g.prototype["one-way"]=g.prototype["to-view"];var y={},b=e.TemplatingBindingLanguage=(u=s=function(o){function e(e,t,n,r){var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,o.call(this));return i.parser=e,i.observerLocator=t,i.syntaxInterpreter=n,i.emptyStringExpression=i.parser.parse("''"),(n.language=i).attributeMap=r,i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(e,o),e.prototype.inspectAttribute=function(e,t,n,r){var i=n.split(".");if(y.defaultBindingMode=null,2===i.length)y.attrName=i[0].trim(),y.attrValue=r,y.command=i[1].trim(),"ref"===y.command?(y.expression=new c.NameExpression(this.parser.parse(r),y.attrName,e.lookupFunctions),y.command=null,y.attrName="ref"):y.expression=null;else if("ref"===n)y.attrName=n,y.attrValue=r,y.command=null,y.expression=new c.NameExpression(this.parser.parse(r),"element",e.lookupFunctions);else{y.attrName=n,y.attrValue=r,y.command=null;var o=this.parseInterpolation(e,r);y.expression=null===o?null:new f(this.observerLocator,this.attributeMap.map(t,n),o,c.bindingMode.oneWay,e.lookupFunctions,n)}return y},e.prototype.createAttributeInstruction=function(e,t,n,r,i){var o=void 0;if(n.expression){if("ref"===n.attrName)return n.expression;(o=r||m.BehaviorInstruction.attribute(n.attrName)).attributes[n.attrName]=n.expression}else n.command&&(o=this.syntaxInterpreter.interpret(e,t,n,r,i));return o},e.prototype.inspectTextContent=function(e,t){var n=this.parseInterpolation(e,t);return null===n?null:new f(this.observerLocator,"textContent",n,c.bindingMode.oneWay,e.lookupFunctions,"textContent")},e.prototype.parseInterpolation=function(e,t){for(var n=t.indexOf("${",0),r=t.length,i=void 0,o=0,a=0,s=null,u=void 0,c=void 0,l=0;0<=n&&n<r-2;){for(a=1,u=n,n+=2;i=t[n],n++,"'"!==i&&'"'!==i?"\\"!==i?null===s&&("{"===i?a++:"}"===i&&a--):n++:null===s?s=i:s===i&&(s=null),0<a&&n<r;);if(0!==a)break;c=c||[],"\\"===t[u-1]&&"\\"!==t[u-2]?(c[l]=t.substring(o,u-1)+t.substring(u,n),c[++l]=this.emptyStringExpression):(c[l]=t.substring(o,u),c[++l]=this.parser.parse(t.substring(u+2,n-1))),l++,o=n,n=t.indexOf("${",n)}return 0===l?null:(c[l]=t.substr(o),c)},e}(m.BindingLanguage),s.inject=[c.Parser,c.ObserverLocator,g,h],u)}),define("aurelia-task-queue",["exports","aurelia-pal"],function(e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TaskQueue=void 0;var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function a(r){return function(){var e=setTimeout(n,0),t=setInterval(n,50);function n(){clearTimeout(e),clearInterval(t),r()}}}e.TaskQueue=function(){function e(){var e,t,n,r,i=this;this.flushing=!1,this.longStacks=!1,this.microTaskQueue=[],this.microTaskQueueCapacity=1024,this.taskQueue=[],o.FEATURE.mutationObserver?this.requestFlushMicroTaskQueue=(e=function(){return i.flushMicroTaskQueue()},t=1,n=o.DOM.createMutationObserver(e),r=o.DOM.createTextNode(""),n.observe(r,{characterData:!0}),function(){t=-t,r.data=t}):this.requestFlushMicroTaskQueue=a(function(){return i.flushMicroTaskQueue()}),this.requestFlushTaskQueue=a(function(){return i.flushTaskQueue()})}return e.prototype._flushQueue=function(e,t){var n,r,i=0,o=void 0;try{for(this.flushing=!0;i<e.length;)if(o=e[i],this.longStacks&&(this.stack="string"==typeof o.stack?o.stack:void 0),o.call(),t<++i){for(var a=0,s=e.length-i;a<s;a++)e[a]=e[a+i];e.length-=i,i=0}}catch(e){n=e,r=o,this.longStacks&&r.stack&&"object"===(void 0===n?"undefined":u(n))&&null!==n&&(n.stack=c(n.stack)+r.stack),"onError"in r?r.onError(n):setTimeout(function(){throw n},0)}finally{this.flushing=!1}},e.prototype.queueMicroTask=function(e){this.microTaskQueue.length<1&&this.requestFlushMicroTaskQueue(),this.longStacks&&(e.stack=this.prepareQueueStack("\nEnqueued in MicroTaskQueue by:\n")),this.microTaskQueue.push(e)},e.prototype.queueTask=function(e){this.taskQueue.length<1&&this.requestFlushTaskQueue(),this.longStacks&&(e.stack=this.prepareQueueStack("\nEnqueued in TaskQueue by:\n")),this.taskQueue.push(e)},e.prototype.flushTaskQueue=function(){var e=this.taskQueue;this.taskQueue=[],this._flushQueue(e,Number.MAX_VALUE)},e.prototype.flushMicroTaskQueue=function(){var e=this.microTaskQueue;this._flushQueue(e,this.microTaskQueueCapacity),e.length=0},e.prototype.prepareQueueStack=function(e){var t=e+function(){var e=new Error;if(e.stack)return e.stack;try{throw e}catch(e){return e.stack}}().replace(/^[\s\S]*?\bqueue(Micro)?Task\b[^\n]*\n/,"");return"string"==typeof this.stack&&(t=c(t)+this.stack),t},e}();function c(e){var t=e.lastIndexOf("flushMicroTaskQueue");return t<0&&(t=e.lastIndexOf("flushTaskQueue"))<0?e:(t=e.lastIndexOf("\n",t))<0?e:e.substr(0,t)}}),define("aurelia-router",["exports","aurelia-logging","aurelia-route-recognizer","aurelia-dependency-injection","aurelia-history","aurelia-event-aggregator"],function(e,t,r,n,i,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AppRouter=e.PipelineProvider=e.LoadRouteStep=e.RouteLoader=e.ActivateNextStep=e.DeactivatePreviousStep=e.CanActivateNextStep=e.CanDeactivatePreviousStep=e.Router=e.BuildNavigationPlanStep=e.activationStrategy=e.RouterConfiguration=e.RedirectToRoute=e.Redirect=e.NavModel=e.NavigationInstruction=e.CommitChangesStep=e.Pipeline=e.pipelineStatus=void 0,e._normalizeAbsolutePath=c,e._createRootedPath=l,e._resolveUrl=v,e.isNavigationCommand=_,e._buildNavigationPlan=T;var o=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(t);var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();function c(e,t){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2];return t||"#"===e[0]||(e="#"+e),t&&n&&(e=e.substring(1,e.length)),e}function l(e,t,n,r){if(f.test(e))return e;var i="";return t.length&&"/"!==t[0]&&(i+="/"),(i+=t).length&&"/"===i[i.length-1]||"/"===e[0]||(i+="/"),i.length&&"/"===i[i.length-1]&&"/"===e[0]&&(i=i.substring(0,i.length-1)),c(i+e,n,r)}function v(e,t,n){return h.test(e)?c(e,n):l(e,t,n)}var h=/^#?\//,f=/^([a-z][a-z0-9+\-.]*:)?\/\//i,d=e.pipelineStatus={completed:"completed",canceled:"canceled",rejected:"rejected",running:"running"},p=e.Pipeline=function(){function e(){this.steps=[]}return e.prototype.addStep=function(e){var t=void 0;if("function"==typeof e)t=e;else{if("function"==typeof e.getSteps){for(var n=e.getSteps(),r=0,i=n.length;r<i;r++)this.addStep(n[r]);return this}t=e.run.bind(e)}return this.steps.push(t),this},e.prototype.run=function(t){var n=-1,r=this.steps;function i(){if(!(++n<r.length))return i.complete();var e=r[n];try{return e(t,i)}catch(e){return i.reject(e)}}return i.complete=m(i,d.completed),i.cancel=m(i,d.canceled),i.reject=m(i,d.rejected),i()},e}();function m(e,t){return function(e){return Promise.resolve({status:t,output:e,completed:t===d.completed})}}var g=e.CommitChangesStep=function(){function e(){}return e.prototype.run=function(e,t){return e._commitChanges(!0).then(function(){return e._updateTitle(),t()})},e}(),y=e.NavigationInstruction=function(){function e(e){this.plan=null,this.options={},Object.assign(this,e),this.params=this.params||{},this.viewPortInstructions={};var t=[],n=this;do{var r=Object.assign({},n.params);n.config&&n.config.hasChildRouter&&delete r[n.getWildCardName()],t.unshift(r),n=n.parentInstruction}while(n);var i=Object.assign.apply(Object,[{},this.queryParams].concat(t));this.lifecycleArgs=[i,this.config,this]}return e.prototype.getAllInstructions=function(){var e=[this];for(var t in this.viewPortInstructions){var n=this.viewPortInstructions[t].childNavigationInstruction;n&&e.push.apply(e,n.getAllInstructions())}return e},e.prototype.getAllPreviousInstructions=function(){return this.getAllInstructions().map(function(e){return e.previousInstruction}).filter(function(e){return e})},e.prototype.addViewPortInstruction=function(e,t,n,r){var i=Object.assign({},this.lifecycleArgs[1],{currentViewPort:e});return this.viewPortInstructions[e]={name:e,strategy:t,moduleId:n,component:r,childRouter:r.childRouter,lifecycleArgs:[].concat(this.lifecycleArgs[0],i,this.lifecycleArgs[2])}},e.prototype.getWildCardName=function(){var e=this.config.route.lastIndexOf("*");return this.config.route.substr(e+1)},e.prototype.getWildcardPath=function(){var e=this.getWildCardName(),t=this.params[e]||"";return this.queryString&&(t+="?"+this.queryString),t},e.prototype.getBaseUrl=function(){var t=this,e=decodeURI(this.fragment);if(""===e){var n=this.router.routes.find(function(e){return e.name===t.config.name&&""!==e.route});n&&(e=n.route)}if(!this.params)return encodeURI(e);var r=this.getWildCardName(),i=this.params[r]||"";return i?encodeURI(e.substr(0,e.lastIndexOf(i))):encodeURI(e)},e.prototype._commitChanges=function(r){var i=this,o=this.router;(o.currentInstruction=this).previousInstruction&&(this.previousInstruction.config.navModel.isActive=!1),this.config.navModel.isActive=!0,o._refreshBaseUrl(),o.refreshNavigation();var a=[],s=[],e=function(e){var t=i.viewPortInstructions[e],n=o.viewPorts[e];if(!n)throw new Error("There was no router-view found in the view for "+t.moduleId+".");t.strategy===S.replace?t.childNavigationInstruction&&t.childNavigationInstruction.parentCatchHandler?a.push(t.childNavigationInstruction._commitChanges(r)):(r&&s.push({viewPort:n,viewPortInstruction:t}),a.push(n.process(t,r).then(function(e){if(t.childNavigationInstruction)return t.childNavigationInstruction._commitChanges(r)}))):t.childNavigationInstruction&&a.push(t.childNavigationInstruction._commitChanges(r))};for(var t in this.viewPortInstructions)e(t);return Promise.all(a).then(function(){return s.forEach(function(e){return e.viewPort.swap(e.viewPortInstruction)}),null}).then(function(){return(e=i).previousInstruction=null,void(e.plan=null);var e})},e.prototype._updateTitle=function(){var e=this._buildTitle();e&&this.router.history.setTitle(e)},e.prototype._buildTitle=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:" | ",t="",n=[];for(var r in this.config.navModel.title&&(t=this.router.transformTitle(this.config.navModel.title)),this.viewPortInstructions){var i=this.viewPortInstructions[r];if(i.childNavigationInstruction){var o=i.childNavigationInstruction._buildTitle(e);o&&n.push(o)}}return n.length&&(t=n.join(e)+(t?e:"")+t),this.router.title&&(t+=(t?e:"")+this.router.transformTitle(this.router.title)),t},e}();var b=e.NavModel=function(){function e(e,t){this.isActive=!1,this.title=null,this.href=null,this.relativeHref=null,this.settings={},this.config=null,this.router=e,this.relativeHref=t}return e.prototype.setTitle=function(e){this.title=e,this.isActive&&this.router.updateTitle()},e}();function _(e){return e&&"function"==typeof e.navigate}var w=e.Redirect=function(){function e(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.url=e,this.options=Object.assign({trigger:!0,replace:!0},t),this.shouldContinueProcessing=!1}return e.prototype.setRouter=function(e){this.router=e},e.prototype.navigate=function(e){(this.options.useAppRouter?e:this.router||e).navigate(this.url,this.options)},e}(),E=(e.RedirectToRoute=function(){function e(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};this.route=e,this.params=t,this.options=Object.assign({trigger:!0,replace:!0},n),this.shouldContinueProcessing=!1}return e.prototype.setRouter=function(e){this.router=e},e.prototype.navigate=function(e){(this.options.useAppRouter?e:this.router||e).navigateToRoute(this.route,this.params,this.options)},e}(),e.RouterConfiguration=function(){function e(){this.instructions=[],this.options={},this.pipelineSteps=[]}return e.prototype.addPipelineStep=function(e,t){return this.pipelineSteps.push({name:e,step:t}),this},e.prototype.addAuthorizeStep=function(e){return this.addPipelineStep("authorize",e)},e.prototype.addPreActivateStep=function(e){return this.addPipelineStep("preActivate",e)},e.prototype.addPreRenderStep=function(e){return this.addPipelineStep("preRender",e)},e.prototype.addPostRenderStep=function(e){return this.addPipelineStep("postRender",e)},e.prototype.fallbackRoute=function(e){return this._fallbackRoute=e,this},e.prototype.map=function(e){return Array.isArray(e)?(e.forEach(this.map.bind(this)),this):this.mapRoute(e)},e.prototype.useViewPortDefaults=function(e){return this.viewPortDefaults=e,this},e.prototype.mapRoute=function(c){return this.instructions.push(function(e){var t=[];if(Array.isArray(c.route))for(var n=0,r=c.route.length;n<r;++n){var i=Object.assign({},c);i.route=c.route[n],t.push(i)}else t.push(Object.assign({},c));for(var o=void 0,a=0,s=t.length;a<s;++a){var u=t[a];u.settings=u.settings||{},o||(o=e.createNavModel(u)),e.addRoute(u,o)}}),this},e.prototype.mapUnknownRoutes=function(e){return this.unknownRouteConfig=e,this},e.prototype.exportToRouter=function(e){for(var t=this.instructions,n=0,r=t.length;n<r;++n)t[n](e);this.title&&(e.title=this.title),this.unknownRouteConfig&&e.handleUnknownRoutes(this.unknownRouteConfig),this._fallbackRoute&&(e.fallbackRoute=this._fallbackRoute),this.viewPortDefaults&&e.useViewPortDefaults(this.viewPortDefaults),e.options=this.options;var i=this.pipelineSteps;if(i.length){if(!e.isRoot)throw new Error("Pipeline steps can only be added to the root router");for(var o=e.pipelineProvider,a=0,s=i.length;a<s;++a){var u=i[a],c=u.name,l=u.step;o.addStep(c,l)}}},e}()),S=e.activationStrategy={noChange:"no-change",invokeLifecycle:"invoke-lifecycle",replace:"replace"},C=e.BuildNavigationPlanStep=function(){function e(){}return e.prototype.run=function(t,n){return T(t).then(function(e){return t.plan=e,n()}).catch(n.cancel)},e}();function T(s,u){var c=s.config;if("redirect"in c){var e=v(c.redirect,function(e){var t=[];e=e.parentInstruction;for(;e;)t.unshift(e.getBaseUrl()),e=e.parentInstruction;return t.unshift("/"),t.join("")}(s));return s.queryString&&(e+="?"+s.queryString),Promise.reject(new w(e))}var l=s.previousInstruction,h={},f=s.router.viewPortDefaults;if(l){var d=function(e,t){var n=e.params,r=t.params,i=t.config.hasChildRouter?t.getWildCardName():null;for(var o in r)if(o!==i&&n[o]!==r[o])return!0;for(var a in n)if(a!==i&&n[a]!==r[a])return!0;if(!t.options.compareQueryParams)return!1;var s=e.queryParams,u=t.queryParams;for(var c in u)if(s[c]!==u[c])return!0;for(var l in s)if(s[l]!==u[l])return!0;return!1}(l,s),p=[],t=function(e){var t=l.viewPortInstructions[e],n=e in c.viewPorts?c.viewPorts[e]:t;null===n.moduleId&&e in s.router.viewPortDefaults&&(n=f[e]);var r=h[e]={name:e,config:n,prevComponent:t.component,prevModuleId:t.moduleId};if(t.moduleId!==n.moduleId)r.strategy=S.replace;else if("determineActivationStrategy"in t.component.viewModel){var i;r.strategy=(i=t.component.viewModel).determineActivationStrategy.apply(i,s.lifecycleArgs)}else c.activationStrategy?r.strategy=c.activationStrategy:r.strategy=d||u?S.invokeLifecycle:S.noChange;if(r.strategy!==S.replace&&t.childRouter){var o=s.getWildcardPath(),a=t.childRouter._createNavigationInstruction(o,s).then(function(t){return T(r.childNavigationInstruction=t,r.strategy===S.invokeLifecycle).then(function(e){t.plan=e})});p.push(a)}};for(var n in l.viewPortInstructions)t(n);return Promise.all(p).then(function(){return h})}for(var n in c.viewPorts){var r=c.viewPorts[n];null===r.moduleId&&n in s.router.viewPortDefaults&&(r=f[n]),h[n]={name:n,strategy:S.replace,config:r}}return Promise.resolve(h)}var O=e.Router=function(){function n(e,t){var n=this;this.parent=null,this.options={},this.viewPortDefaults={},this.transformTitle=function(e){return n.parent?n.parent.transformTitle(e):e},this.container=e,this.history=t,this.reset()}return n.prototype.reset=function(){var t=this;this.viewPorts={},this.routes=[],this.baseUrl="",this.isConfigured=!1,this.isNavigating=!1,this.isExplicitNavigation=!1,this.isExplicitNavigationBack=!1,this.isNavigatingFirst=!1,this.isNavigatingNew=!1,this.isNavigatingRefresh=!1,this.isNavigatingForward=!1,this.isNavigatingBack=!1,this.navigation=[],this.currentInstruction=null,this.viewPortDefaults={},this._fallbackOrder=100,this._recognizer=new r.RouteRecognizer,this._childRecognizer=new r.RouteRecognizer,this._configuredPromise=new Promise(function(e){t._resolveConfiguredPromise=e})},n.prototype.registerViewPort=function(e,t){t=t||"default",this.viewPorts[t]=e},n.prototype.ensureConfigured=function(){return this._configuredPromise},n.prototype.configure=function(e){var t=this;this.isConfigured=!0;var n=e,r=void 0;return"function"==typeof e&&(n=e(r=new E)),Promise.resolve(n).then(function(e){e&&e.exportToRouter&&(r=e),r.exportToRouter(t),t.isConfigured=!0,t._resolveConfiguredPromise()})},n.prototype.navigate=function(e,t){return!this.isConfigured&&this.parent?this.parent.navigate(e,t):(this.isExplicitNavigation=!0,this.history.navigate(v(e,this.baseUrl,this.history._hasPushState),t))},n.prototype.navigateToRoute=function(e,t,n){var r=this.generate(e,t);return this.navigate(r,n)},n.prototype.navigateBack=function(){this.isExplicitNavigationBack=!0,this.history.navigateBack()},n.prototype.createChild=function(e){var t=new n(e||this.container.createChild(),this.history);return t.parent=this,t},n.prototype.generate=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r=this._recognizer.hasRoute(e);if((!this.isConfigured||!r)&&this.parent)return this.parent.generate(e,t);if(!r)throw new Error("A route with name '"+e+"' could not be found. Check that `name: '"+e+"'` was specified in the route's config.");var i=l(this._recognizer.generate(e,t),this.baseUrl,this.history._hasPushState,n.absolute);return n.absolute?""+this.history.getAbsoluteRoot()+i:i},n.prototype.createNavModel=function(e){var t=new b(this,"href"in e?e.href:e.route);return t.title=e.title,t.order=e.nav,t.href=e.href,t.settings=e.settings,t.config=e,t},n.prototype.addRoute=function(e,t){R(e,this.routes),"viewPorts"in e||e.navigationStrategy||(e.viewPorts={default:{moduleId:e.moduleId,view:e.view}}),t||(t=this.createNavModel(e)),this.routes.push(e);var n=e.route;"/"===n.charAt(0)&&(n=n.substr(1));var r=!0===e.caseSensitive,i=this._recognizer.add({path:n,handler:e,caseSensitive:r});if(n){var o=e.settings;delete e.settings;var a=JSON.parse(JSON.stringify(e));e.settings=o,a.route=n+"/*childRoute",a.hasChildRouter=!0,this._childRecognizer.add({path:a.route,handler:a,caseSensitive:r}),a.navModel=t,a.settings=e.settings,a.navigationStrategy=e.navigationStrategy}if(((e.navModel=t).order||0===t.order)&&-1===this.navigation.indexOf(t)){if(!t.href&&""!==t.href&&(i.types.dynamics||i.types.stars))throw new Error('Invalid route config for "'+e.route+'" : dynamic routes must specify an "href:" to be included in the navigation model.');"number"!=typeof t.order&&(t.order=++this._fallbackOrder),this.navigation.push(t),this.navigation=this.navigation.sort(function(e,t){return e.order-t.order})}},n.prototype.hasRoute=function(e){return!!(this._recognizer.hasRoute(e)||this.parent&&this.parent.hasRoute(e))},n.prototype.hasOwnRoute=function(e){return this._recognizer.hasRoute(e)},n.prototype.handleUnknownRoutes=function(e){var n=this;if(!e)throw new Error("Invalid unknown route handler");this.catchAllHandler=function(t){return n._createRouteConfig(e,t).then(function(e){return t.config=e,t})}},n.prototype.updateTitle=function(){if(this.parent)return this.parent.updateTitle();this.currentInstruction&&this.currentInstruction._updateTitle()},n.prototype.refreshNavigation=function(){for(var e=this.navigation,t=0,n=e.length;t<n;t++){var r=e[t];r.config.href?r.href=c(r.config.href,this.history._hasPushState):r.href=l(r.relativeHref,this.baseUrl,this.history._hasPushState)}},n.prototype.useViewPortDefaults=function(e){for(var t in e){var n=e[t];this.viewPortDefaults[t]={moduleId:n.moduleId}}},n.prototype._refreshBaseUrl=function(){if(this.parent){var e=this.parent.currentInstruction.getBaseUrl();this.baseUrl=this.parent.baseUrl+e}},n.prototype._createNavigationInstruction=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,n=e,r="",i=e.indexOf("?");-1!==i&&(n=e.substr(0,i),r=e.substr(i+1));var o=this._recognizer.recognize(e);o&&o.length||(o=this._childRecognizer.recognize(e));var a={fragment:n,queryString:r,config:null,parentInstruction:t,previousInstruction:this.currentInstruction,router:this,options:{compareQueryParams:this.options.compareQueryParams}};if(o&&o.length){var s=o[0],u=new y(Object.assign({},a,{params:s.params,queryParams:s.queryParams||o.queryParams,config:s.config||s.handler}));return"function"==typeof s.handler?A(u,s.handler,s):s.handler&&"function"==typeof s.handler.navigationStrategy?A(u,s.handler.navigationStrategy,s.handler):Promise.resolve(u)}if(this.catchAllHandler)return A(new y(Object.assign({},a,{params:{path:n},queryParams:o?o.queryParams:{},config:null})),this.catchAllHandler);if(this.parent){var c=this._parentCatchAllHandler(this.parent);if(c){var l=this._findParentInstructionFromRouter(c,t);return A(new y(Object.assign({},a,{params:{path:n},queryParams:o?o.queryParams:{},router:c,parentInstruction:l,parentCatchHandler:!0,config:null})),c.catchAllHandler)}}return Promise.reject(new Error("Route not found: "+e))},n.prototype._findParentInstructionFromRouter=function(e,t){return t.router===e?(t.fragment=e.baseUrl,t):t.parentInstruction?this._findParentInstructionFromRouter(e,t.parentInstruction):void 0},n.prototype._parentCatchAllHandler=function(e){return e.catchAllHandler?e:!!e.parent&&this._parentCatchAllHandler(e.parent)},n.prototype._createRouteConfig=function(e,t){var n=this;return Promise.resolve(e).then(function(e){return"string"==typeof e?{moduleId:e}:"function"==typeof e?e(t):e}).then(function(e){return"string"==typeof e?{moduleId:e}:e}).then(function(e){return e.route=t.params.path,R(e,n.routes),e.navModel||(e.navModel=n.createNavModel(e)),e})},u(n,[{key:"isRoot",get:function(){return!this.parent}}]),n}();function R(e,t){if("object"!==(void 0===e?"undefined":s(e)))throw new Error("Invalid Route Config");if("string"!=typeof e.route){var n=e.name||"(no name)";throw new Error('Invalid Route Config for "'+n+'": You must specify a "route:" pattern.')}if(!("redirect"in e||e.moduleId||e.navigationStrategy||e.viewPorts))throw new Error('Invalid Route Config for "'+e.route+'": You must specify a "moduleId:", "redirect:", "navigationStrategy:", or "viewPorts:".')}function A(e,t,n){return Promise.resolve(t.call(n,e)).then(function(){return"viewPorts"in e.config||(e.config.viewPorts={default:{moduleId:e.config.moduleId}}),e})}var I=e.CanDeactivatePreviousStep=function(){function e(){}return e.prototype.run=function(e,t){return x(e,"canDeactivate",t)},e}(),N=e.CanActivateNextStep=function(){function e(){}return e.prototype.run=function(e,t){return M(e,"canActivate",t)},e}(),k=e.DeactivatePreviousStep=function(){function e(){}return e.prototype.run=function(e,t){return x(e,"deactivate",t,!0)},e}(),P=e.ActivateNextStep=function(){function e(){}return e.prototype.run=function(e,t){return M(e,"activate",t,!0)},e}();function x(e,t,n,r){var i=function e(t,n){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[];for(var i in t){var o=t[i],a=o.prevComponent;if((o.strategy===S.invokeLifecycle||o.strategy===S.replace)&&a){var s=a.viewModel;n in s&&r.push(s)}o.strategy===S.replace&&a?D(a,n,r):o.childNavigationInstruction&&e(o.childNavigationInstruction.plan,n,r)}return r}(e.plan,t),o=i.length;function a(e){return r||L(e)?s():n.cancel(e)}function s(){if(o--)try{return V(i[o][t](e),a,n.cancel)}catch(e){return n.cancel(e)}return n()}return s()}function D(e,t,n){var r=e.childRouter;if(r&&r.currentInstruction){var i=r.currentInstruction.viewPortInstructions;for(var o in i){var a=i[o].component,s=a.viewModel;t in s&&n.push(s),D(a,t,n)}}}function M(e,t,i,o){var n=function i(o,a){var s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[];var u=arguments[3];var c=o.plan;Object.keys(c).filter(function(e){var t=c[e],n=o.viewPortInstructions[e],r=n.component.viewModel;(t.strategy===S.invokeLifecycle||t.strategy===S.replace)&&a in r&&s.push({viewModel:r,lifecycleArgs:n.lifecycleArgs,router:u}),t.childNavigationInstruction&&i(t.childNavigationInstruction,a,s,n.component.childRouter||u)});return s}(e,t),a=n.length,s=-1;function u(){if(++s<a)try{var e,r=n[s];return V((e=r.viewModel)[t].apply(e,r.lifecycleArgs),function(e){return t=e,n=r.router,o||L(t,n)?u():i.cancel(t);var t,n},i.cancel)}catch(e){return i.cancel(e)}return i()}return u()}function L(e,t){return!(e instanceof Error)&&(_(e)?("function"==typeof e.setRouter&&e.setRouter(t),!!e.shouldContinueProcessing):void 0===e||e)}var F=function(){function e(e){this._subscribed=!0,this._subscription=e(this),this._subscribed||this.unsubscribe()}return e.prototype.unsubscribe=function(){this._subscribed&&this._subscription&&this._subscription.unsubscribe(),this._subscribed=!1},u(e,[{key:"subscribed",get:function(){return this._subscribed}}]),e}();function V(e,n,r){if(e&&"function"==typeof e.then)return Promise.resolve(e).then(n).catch(r);if(e&&"function"==typeof e.subscribe){var i=e;return new F(function(t){return i.subscribe({next:function(){t.subscribed&&(t.unsubscribe(),n(e))},error:function(e){t.subscribed&&(t.unsubscribe(),r(e))},complete:function(){t.subscribed&&(t.unsubscribe(),n(e))}})})}try{return n(e)}catch(e){return r(e)}}var j=e.RouteLoader=function(){function e(){}return e.prototype.loadRoute=function(e,t,n){throw Error('Route loaders must implement "loadRoute(router, config, navigationInstruction)".')},e}(),U=e.LoadRouteStep=function(){function e(e){this.routeLoader=e}return e.inject=function(){return[j]},e.prototype.run=function(e,t){return B(this.routeLoader,e).then(t).catch(t.cancel)},e}();function B(r,e){var t=function e(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];var r=t.plan;for(var i in r){var o=r[i];if(o.strategy===S.replace)n.push({viewPortPlan:o,navigationInstruction:t}),o.childNavigationInstruction&&e(o.childNavigationInstruction,n);else{var a=t.addViewPortInstruction(i,o.strategy,o.prevModuleId,o.prevComponent);o.childNavigationInstruction&&(a.childNavigationInstruction=o.childNavigationInstruction,e(o.childNavigationInstruction,n))}}return n}(e).map(function(e){return i=r,o=e.navigationInstruction,a=e.viewPortPlan,s=a.config?a.config.moduleId:null,(t=i,n=o,u=a.config,c=n.router,l=n.lifecycleArgs,t.loadRoute(c,u,n).then(function(e){var t=e.viewModel,n=e.childContainer;if(e.router=c,e.config=u,"configureRouter"in t){var r=n.getChildRouter();return(e.childRouter=r).configure(function(e){return t.configureRouter.apply(t,[e,r].concat(l))}).then(function(){return e})}return e})).then(function(e){var n=o.addViewPortInstruction(a.name,a.strategy,s,e),t=e.childRouter;if(t){var r=o.getWildcardPath();return t._createNavigationInstruction(r,o).then(function(t){return T(a.childNavigationInstruction=t).then(function(e){return t.plan=e,n.childNavigationInstruction=t,B(i,t)})})}});var i,o,a,s,t,n,u,c,l});return Promise.all(t)}var q=function(){function e(e,t,n){this.steps=[],this.container=e,this.slotName=t,this.slotAlias=n}return e.prototype.getSteps=function(){var t=this;return this.steps.map(function(e){return t.container.get(e)})},e}(),W=e.PipelineProvider=function(){function e(e){this.container=e,this.steps=[C,I,U,this._createPipelineSlot("authorize"),N,this._createPipelineSlot("preActivate","modelbind"),k,P,this._createPipelineSlot("preRender","precommit"),g,this._createPipelineSlot("postRender","postcomplete")]}return e.inject=function(){return[n.Container]},e.prototype.createPipeline=function(){var t=this,n=new p;return this.steps.forEach(function(e){return n.addStep(t.container.get(e))}),n},e.prototype._findStep=function(t){return this.steps.find(function(e){return e.slotName===t||e.slotAlias===t})},e.prototype.addStep=function(e,t){var n=this._findStep(e);if(!n)throw new Error("Invalid pipeline slot name: "+e+".");n.steps.includes(t)||n.steps.push(t)},e.prototype.removeStep=function(e,t){var n=this._findStep(e);n&&n.steps.splice(n.steps.indexOf(t),1)},e.prototype._clearSteps=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=this._findStep(e);t&&(t.steps=[])},e.prototype.reset=function(){this._clearSteps("authorize"),this._clearSteps("preActivate"),this._clearSteps("preRender"),this._clearSteps("postRender")},e.prototype._createPipelineSlot=function(e,t){return new q(this.container,e,t)},e}(),H=o.getLogger("app-router");e.AppRouter=function(o){function e(e,t,n,r){var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,o.call(this,e,t));return i.pipelineProvider=n,i.events=r,i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(e,o),e.inject=function(){return[n.Container,i.History,W,a.EventAggregator]},e.prototype.reset=function(){o.prototype.reset.call(this),this.maxInstructionCount=10,this._queue?this._queue.length=0:this._queue=[]},e.prototype.loadUrl=function(e){var t=this;return this._createNavigationInstruction(e).then(function(e){return t._queueInstruction(e)}).catch(function(e){H.error(e),G(t)})},e.prototype.registerViewPort=function(e,t){var n=this;if(o.prototype.registerViewPort.call(this,e,t),this.isActive)this._dequeueInstruction();else{var r=this._findViewModel(e);if("configureRouter"in r){if(!this.isConfigured){var i=this._resolveConfiguredPromise;return this._resolveConfiguredPromise=function(){},this.configure(function(e){return r.configureRouter(e,n)}).then(function(){n.activate(),i()})}}else this.activate()}return Promise.resolve()},e.prototype.activate=function(e){this.isActive||(this.isActive=!0,this.options=Object.assign({routeHandler:this.loadUrl.bind(this)},this.options,e),this.history.activate(this.options),this._dequeueInstruction())},e.prototype.deactivate=function(){this.isActive=!1,this.history.deactivate()},e.prototype._queueInstruction=function(t){var n=this;return new Promise(function(e){t.resolve=e,n._queue.unshift(t),n._dequeueInstruction()})},e.prototype._dequeueInstruction=function(){var n=this,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;return Promise.resolve().then(function(){if(!n.isNavigating||r){var t=n._queue.shift();if(n._queue.length=0,t){n.isNavigating=!0;var e=n.history.getState("NavigationTracker");if(e||n.currentNavigationTracker?e?n.currentNavigationTracker?n.currentNavigationTracker<e?n.isNavigatingForward=!0:n.currentNavigationTracker>e&&(n.isNavigatingBack=!0):n.isNavigatingRefresh=!0:n.isNavigatingNew=!0:(n.isNavigatingFirst=!0,n.isNavigatingNew=!0),e||(e=Date.now(),n.history.setState("NavigationTracker",e)),n.currentNavigationTracker=e,t.previousInstruction=n.currentInstruction,r){if(r===n.maxInstructionCount-1)return H.error(r+1+" navigation instructions have been attempted without success. Restoring last known good location."),G(n),n._dequeueInstruction(r+1);if(r>n.maxInstructionCount)throw new Error("Maximum navigation attempts exceeded. Giving up.")}else n.events.publish("router:navigation:processing",{instruction:t});return n.pipelineProvider.createPipeline().run(t).then(function(e){return function(e,t,n,r){t&&"completed"in t&&"output"in t||((t=t||{}).output=new Error("Expected router pipeline to return a navigation result, but got ["+JSON.stringify(t)+"] instead."));var i=null;_(t.output)?t.output.navigate(r):(i=t).completed||(t.output instanceof Error&&H.error(t.output),G(r));return r._dequeueInstruction(n+1).then(function(e){return i||e||t})}(0,e,r,n)}).catch(function(e){return{output:e instanceof Error?e:new Error(e)}}).then(function(e){return function(e,t,n,r){e.resolve(t);var i={instruction:e,result:t};if(n)r.events.publish("router:navigation:child:complete",i);else{r.isNavigating=!1,r.isExplicitNavigation=!1,r.isExplicitNavigationBack=!1,r.isNavigatingFirst=!1,r.isNavigatingNew=!1,r.isNavigatingRefresh=!1,r.isNavigatingForward=!1,r.isNavigatingBack=!1;var o=void 0;if(t.output instanceof Error)o="error";else if(t.completed){var a=e.queryString?"?"+e.queryString:"";r.history.previousLocation=e.fragment+a,o="success"}else o="canceled";r.events.publish("router:navigation:"+o,i),r.events.publish("router:navigation:complete",i)}return t}(t,e,!!r,n)})}}})},e.prototype._findViewModel=function(e){if(this.container.viewModel)return this.container.viewModel;if(e.container)for(var t=e.container;t;){if(t.viewModel)return this.container.viewModel=t.viewModel,t.viewModel;t=t.parent}},e}(O);function G(e){e.history.previousLocation?e.navigate(e.history.previousLocation,{trigger:!1,replace:!0}):e.fallbackRoute?e.navigate(e.fallbackRoute,{trigger:!0,replace:!0}):H.error("Router navigation failed, and no previous location or fallbackRoute could be restored.")}}),define("aurelia-route-recognizer",["exports","aurelia-path"],function(e,p){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RouteRecognizer=e.EpsilonSegment=e.StarSegment=e.DynamicSegment=e.StaticSegment=e.State=void 0;var t=e.State=function(){function n(e){this.charSpec=e,this.nextStates=[]}return n.prototype.get=function(e){var t=this.nextStates,n=Array.isArray(t),r=0;for(t=n?t:t[Symbol.iterator]();;){var i;if(n){if(r>=t.length)break;i=t[r++]}else{if((r=t.next()).done)break;i=r.value}var o=i;if(o.charSpec.validChars===e.validChars&&o.charSpec.invalidChars===e.invalidChars)return o}},n.prototype.put=function(e){var t=this.get(e);return t||(t=new n(e),this.nextStates.push(t),e.repeat&&t.nextStates.push(t),t)},n.prototype.match=function(e){for(var t=this.nextStates,n=[],r=0,i=t.length;r<i;r++){var o=t[r],a=o.charSpec;void 0!==a.validChars?-1!==a.validChars.indexOf(e)&&n.push(o):void 0!==a.invalidChars&&-1===a.invalidChars.indexOf(e)&&n.push(o)}return n},n}(),n=new RegExp("(\\"+["/",".","*","+","?","|","(",")","[","]","{","}","\\"].join("|\\")+")","g"),g=e.StaticSegment=function(){function e(e,t){this.string=e,this.caseSensitive=t}return e.prototype.eachChar=function(e){for(var t=this.string,n=0,r=t.length;n<r;++n){var i=t[n];e({validChars:this.caseSensitive?i:i.toUpperCase()+i.toLowerCase()})}},e.prototype.regex=function(){return this.string.replace(n,"\\$1")},e.prototype.generate=function(){return this.string},e}(),y=e.DynamicSegment=function(){function e(e,t){this.name=e,this.optional=t}return e.prototype.eachChar=function(e){e({invalidChars:"/",repeat:!0})},e.prototype.regex=function(){return this.optional?"([^/]+)?":"([^/]+)"},e.prototype.generate=function(e,t){return t[this.name]=!0,e[this.name]},e}(),b=e.StarSegment=function(){function e(e){this.name=e}return e.prototype.eachChar=function(e){e({invalidChars:"",repeat:!0})},e.prototype.regex=function(){return"(.+)"},e.prototype.generate=function(e,t){return t[this.name]=!0,e[this.name]},e}(),_=e.EpsilonSegment=function(){function e(){}return e.prototype.eachChar=function(){},e.prototype.regex=function(){return""},e.prototype.generate=function(){return""},e}(),v=(e.RouteRecognizer=function(){function e(){this.rootState=new t,this.names={}}return e.prototype.add=function(e){var t=this;if(!Array.isArray(e)){for(var n=this.rootState,r="^",i={statics:0,dynamics:0,stars:0},o=[],a=e.handler.name,s=!0,u=!0,c=function(e,t,n,r){var i=e;"/"===e.charAt(0)&&(i=e.substr(1));for(var o=[],a=i.split("/"),s=0,u=a.length;s<u;++s){var c=a[s],l=c.match(/^:([^?]+)(\?)?$/);if(l){var h=l,f=h[1],d=h[2];if(-1!==f.indexOf("="))throw new Error("Parameter "+f+" in route "+e+" has a default value, which is not supported.");o.push(new y(f,!!d)),t.push(f),n.dynamics++}else(l=c.match(/^\*(.+)$/))?(o.push(new b(l[1])),t.push(l[1]),n.stars++):""===c?o.push(new _):(o.push(new g(c,r)),n.statics++)}return o}(e.path,o,i,e.caseSensitive),l=0,h=c.length;l<h;l++){var f=c[l];f instanceof _||(s=!1,u=u&&f.optional,n=w(n,f),r+=f.optional?"/?":"/",r+=f.regex())}if(u)if(s)n=n.put({validChars:"/"}),r+="/";else{var d=this.rootState.put({validChars:"/"});n.epsilon=[d],n=d}var p=[{handler:e.handler,names:o}];if(a)for(var v=Array.isArray(a)?a:[a],m=0;m<v.length;m++)this.names[v[m]]={segments:c,handlers:p};return n.handlers=p,n.regex=new RegExp(r+"$",e.caseSensitive?"":"i"),n.types=i,n}e.forEach(function(e){return t.add(e)})},e.prototype.handlersFor=function(e){var t=this.names[e];if(!t)throw new Error("There is no route named "+e);return[].concat(t.handlers)},e.prototype.hasRoute=function(e){return!!this.names[e]},e.prototype.generate=function(e,t){var n=this.names[e];if(!n)throw new Error("There is no route named "+e);var r=n.handlers[0].handler;if(r.generationUsesHref)return r.href;for(var i=Object.assign({},t),o=n.segments,a={},s="",u=0,c=o.length;u<c;u++){var l=o[u];if(!(l instanceof _)){var h=l.generate(i,a);if(null==h){if(!l.optional)throw new Error("A value is required for route parameter '"+l.name+"' in route '"+e+"'.")}else s+="/",s+=h}}for(var f in"/"!==s.charAt(0)&&(s="/"+s),a)delete i[f];var d=(0,p.buildQueryString)(i);return s+=d?"?"+d:""},e.prototype.recognize=function(e){var t=[this.rootState],n={},r=!1,i=e,o=i.indexOf("?");if(-1!==o){var a=i.substr(o+1,i.length);i=i.substr(0,o),n=(0,p.parseQueryString)(a)}"/"!==(i=decodeURI(i)).charAt(0)&&(i="/"+i);var s=i.length;1<s&&"/"===i.charAt(s-1)&&(i=i.substr(0,s-1),r=!0);for(var u=0,c=i.length;u<c&&(t=m(t,i.charAt(u))).length;u++);for(var l=[],h=0,f=t.length;h<f;h++)t[h].handlers&&l.push(t[h]);t=l.sort(function(e,t){if(e.types.stars!==t.types.stars)return e.types.stars-t.types.stars;if(e.types.stars){if(e.types.statics!==t.types.statics)return t.types.statics-e.types.statics;if(e.types.dynamics!==t.types.dynamics)return t.types.dynamics-e.types.dynamics}return e.types.dynamics!==t.types.dynamics?e.types.dynamics-t.types.dynamics:e.types.statics!==t.types.statics?t.types.statics-e.types.statics:0});var d=l[0];if(d&&d.handlers)return r&&"(.+)$"===d.regex.source.slice(-5)&&(i+="/"),function(e,t,n){for(var r=e.handlers,i=e.regex,o=t.match(i),a=1,s=new v(n),u=0,c=r.length;u<c;u++){for(var l=r[u],h=l.names,f={},d=0,p=h.length;d<p;d++)f[h[d]]=o[a++];s.push({handler:l.handler,params:f,isDynamic:!!h.length})}return s}(d,i,n)},e}(),function(e){this.splice=Array.prototype.splice,this.slice=Array.prototype.slice,this.push=Array.prototype.push,this.length=0,this.queryParams=e||{}});function m(e,t){for(var n=[],r=0,i=e.length;r<i;r++){var o=e[r];n.push.apply(n,o.match(t))}for(var a=n.filter(function(e){return e.epsilon}),s=function(){var t=[];a.forEach(function(e){n.push.apply(n,e.epsilon),t.push.apply(t,e.epsilon)}),a=t.filter(function(e){return e.epsilon})};0<a.length;)s();return n}function w(e,t){var n=e.put({validChars:"/"});return t.eachChar(function(e){n=n.put(e)}),t.optional&&(e.epsilon=e.epsilon||[],e.epsilon.push(n)),n}}),define("aurelia-polyfills",["aurelia-pal"],function(j){"use strict";var t,n,r,i,o,a,f,d,s,u,c,l,h,p,v,U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};"undefined"==typeof FEATURE_NO_ES2015&&(function(n,e){if(!(e in n)){var o,t=j.PLATFORM.global,r=0,i=""+Math.random(),a="__symbol:",s=a.length,u="__symbol@@"+i,c="defineProperty",l="defineProperties",h="getOwnPropertyNames",f="getOwnPropertyDescriptor",d="propertyIsEnumerable",p=n[h],v=n[f],m=n.create,g=n.keys,y=n[c],b=n[l],_=v(n,h),w=n.prototype,E=w.hasOwnProperty,S=w[d],C=w.toString,T=(Array.prototype.indexOf,function(e,t,n){E.call(e,u)||y(e,u,{enumerable:!1,configurable:!1,writable:!1,value:{}}),e[u]["@@"+t]=n}),O=function(){},R=function(e){return e!=u&&!E.call(P,e)},A=function(e){return e!=u&&E.call(P,e)},I=function(e){var t=""+e;return A(t)?E.call(this,t)&&this[u]&&this[u]["@@"+t]:S.call(this,e)},N=function(t){return y(w,t,{enumerable:!1,configurable:!0,get:O,set:function(e){o(this,t,{enumerable:!1,configurable:!0,writable:!0,value:e}),T(this,t,!0)}}),P[t]=y(n(t),"constructor",x)},k=function(e){if(this&&this!==t)throw new TypeError("Symbol is not a constructor");return N(a.concat(e||"",i,++r))},P=m(null),x={value:k},D=function(e){return P[e]},M=function(e,t,n){var r,i=""+t;return A(i)?(o(e,i,n.enumerable?((r=m(n)).enumerable=!1,r):n),T(e,i,!!n.enumerable)):y(e,t,n),e},L=function(e){return e="[object String]"===C.call(e)?e.split(""):n(e),p(e).filter(A).map(D)};_.value=M,y(n,c,_),_.value=L,y(n,e,_);var F="object"===("undefined"==typeof window?"undefined":U(window))?n.getOwnPropertyNames(window):[],V=n.getOwnPropertyNames;_.value=function(e){if("[object Window]"===C.call(e))try{return V(e)}catch(e){return[].concat([],F)}return p(e).filter(R)},y(n,h,_),_.value=function(t,n){var e=L(n);return e.length?g(n).concat(e).forEach(function(e){I.call(n,e)&&M(t,e,n[e])}):b(t,n),t},y(n,l,_),_.value=I,y(w,d,_),_.value=k,y(t,"Symbol",_),_.value=function(e){var t=a.concat(a,e,i);return t in w?P[t]:N(t)},y(k,"for",_),_.value=function(e){return E.call(P,e)?e.slice(2*s,-i.length):void 0},y(k,"keyFor",_),_.value=function(e,t){var n=v(e,t);return n&&A(t)&&(n.enumerable=I.call(e,t)),n},y(n,f,_),_.value=function(e,t){return 1===arguments.length?m(e):(n=t,r=m(e),null!==n&&"object"===(void 0===n?"undefined":U(n))&&p(n).forEach(function(e){I.call(n,e)&&M(r,e,n[e])}),r);var n,r},y(n,"create",_),_.value=function(){var e=C.call(this);return"[object String]"===e&&A(this)?"[object Symbol]":e},y(w,"toString",_);try{o=m(y({},a,{get:function(){return y(this,a,{value:!1})[a]}}))[a]||y}catch(e){o=function(e,t,n){var r=v(w,t);delete w[t],y(e,t,n),y(w,t,r)}}}}(Object,"getOwnPropertySymbols"),t=Object,Symbol,r=t.defineProperty,i=t.prototype,o=i.toString,["iterator","match","replace","search","split","hasInstance","isConcatSpreadable","unscopables","species","toPrimitive",a="toStringTag"].forEach(function(e){if(!(e in Symbol))switch(r(Symbol,e,{value:Symbol(e)}),e){case a:(n=t.getOwnPropertyDescriptor(i,"toString")).value=function(){var e=o.call(this),t=null==this?void 0:this[Symbol.toStringTag];return void 0===t?e:"[object "+t+"]"},r(i,"toString",n)}}),function(a,e,t){function s(){return this}e[a]||(e[a]=function(){var t=0,n=this,e={next:function(){var e=n.length<=t;return e?{done:e}:{done:e,value:n[t++]}}};return e[a]=s,e}),t[a]||(t[a]=function(){var n=String.fromCodePoint,r=this,i=0,o=r.length,e={next:function(){var e=o<=i,t=e?"":n(r.codePointAt(i));return i+=t.length,e?{done:e}:{done:e,value:t}}};return e[a]=s,e})}(Symbol.iterator,Array.prototype,String.prototype)),"undefined"==typeof FEATURE_NO_ES2015&&(Number.isNaN=Number.isNaN||function(e){return e!=e},Number.isFinite=Number.isFinite||function(e){return"number"==typeof e&&isFinite(e)}),String.prototype.endsWith&&!function(){try{return!"ab".endsWith("a",1)}catch(e){return!0}}()||(String.prototype.endsWith=function(e,t){var n=this.toString();("number"!=typeof t||!isFinite(t)||Math.floor(t)!==t||t>n.length)&&(t=n.length),t-=e.length;var r=n.indexOf(e,t);return-1!==r&&r===t}),String.prototype.startsWith&&!function(){try{return!"ab".startsWith("b",1)}catch(e){return!0}}()||(String.prototype.startsWith=function(e,t){return t=t||0,this.substr(t,e.length)===e}),"undefined"==typeof FEATURE_NO_ES2015&&(Array.from||(Array.from=(f=function(e){return 0<e?Math.min((t=e,isNaN(t=+t)?0:(0<t?Math.floor:Math.ceil)(t)),9007199254740991):0;var t},d=function(t,e,n,r){try{return e(n,r)}catch(e){throw"function"==typeof t.return&&t.return(),e}},function(e){var t,n,r,i,o=Object(e),a="function"==typeof this?this:Array,s=arguments.length,u=1<s?arguments[1]:void 0,c=void 0!==u,l=0,h=o[Symbol.iterator];if(c&&(u=u.bind(2<s?arguments[2]:void 0)),null==h||Array.isArray(e))for(n=new a(t=f(o.length));l<t;l++)n[l]=c?u(o[l],l):o[l];else for(i=h.call(o),n=new a;!(r=i.next()).done;l++)n[l]=c?d(i,u,r.value,l):r.value;return n.length=l,n})),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{configurable:!0,writable:!0,enumerable:!1,value:function(e){if(null===this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var t,n=Object(this),r=n.length>>>0,i=arguments[1],o=0;o<r;o++)if(t=n[o],e.call(i,t,o,n))return t}}),Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{configurable:!0,writable:!0,enumerable:!1,value:function(e){if(null===this)throw new TypeError("Array.prototype.findIndex called on null or undefined");if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var t,n=Object(this),r=n.length>>>0,i=arguments[1],o=0;o<r;o++)if(t=n[o],e.call(i,t,o,n))return o;return-1}})),"undefined"!=typeof FEATURE_NO_ES2016||Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{configurable:!0,writable:!0,enumerable:!1,value:function(e){var t=Object(this),n=parseInt(t.length)||0;if(0===n)return!1;var r,i,o=parseInt(arguments[1])||0;for(0<=o?r=o:(r=n+o)<0&&(r=0);r<n;){if(e===(i=t[r])||e!=e&&i!=i)return!0;r++}return!1}}),"undefined"==typeof FEATURE_NO_ES2015&&(!function(){var i,o,a,s,t=!1;try{var e=Object.keys("a");t=1!==e.length||"0"!==e[0]}catch(e){t=!0}t&&(Object.keys=(i=Object.prototype.hasOwnProperty,o=!{toString:null}.propertyIsEnumerable("toString"),s=(a=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"]).length,function(e){if(null==e)throw TypeError("Cannot convert undefined or null to object");e=Object(e);var t,n,r=[];for(t in e)i.call(e,t)&&r.push(t);if(o)for(n=0;n<s;n++)i.call(e,a[n])&&r.push(a[n]);return r}))}(),"assign"in(s=Object)||s.defineProperty(s,"assign",{configurable:!0,writable:!0,value:(u=s.getOwnPropertySymbols,c=s.propertyIsEnumerable,l=u?function(e){return u(e).filter(c,e)}:function(){return Array.prototype},function(t){function e(e){t[e]=i[e]}!u||t instanceof s||console.warn("problematic Symbols",t);for(var n=1,r=arguments.length;n<r;++n){var i=arguments[n];null!=i&&s.keys(i).concat(l(i)).forEach(e)}return t})}),Object.is||(Object.is=function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t})),"undefined"==typeof FEATURE_NO_ES2015&&function(e){var n,t,r,i=Object.defineProperty,o=function(e,t){return e===t||e!=e&&t!=t};("undefined"==typeof WeakMap&&(e.WeakMap=a({delete:s,clear:p,get:u,has:h,set:f},!0)),"undefined"!=typeof Map&&"function"==typeof(new Map).values&&(new Map).values().next)||(e.Map=a(((t={delete:s,has:h,get:u,set:f,keys:function(){return g(this._itp,this._keys)},values:v,entries:m,forEach:b,clear:p})[Symbol.iterator]=m,t)));"undefined"!=typeof Set&&"function"==typeof(new Set).values&&(new Set).values().next||(e.Set=a(((r={has:l,add:d,delete:s,clear:p,keys:v,values:v,entries:function(){return g(this._itp,this._values,this._values)},forEach:b})[Symbol.iterator]=v,r)));function a(e,t){function n(e){if(!this||this.constructor!==n)return new n(e);this._keys=[],this._values=[],this._itp=[],this.objectOnly=t,e&&function(e){this.add?e.forEach(this.add,this):e.forEach(function(e){this.set(e[0],e[1])},this)}.call(this,e)}return t||i(e,"size",{get:y}),(e.constructor=n).prototype=e,n}function s(e){return this.has(e)&&(this._keys.splice(n,1),this._values.splice(n,1),this._itp.forEach(function(e){n<e[0]&&e[0]--})),-1<n}function u(e){return this.has(e)?this._values[n]:void 0}function c(e,t){if(this.objectOnly&&t!==Object(t))throw new TypeError("Invalid value used as weak collection key");if(t!=t||0===t)for(n=e.length;n--&&!o(e[n],t););else n=e.indexOf(t);return-1<n}function l(e){return c.call(this,this._values,e)}function h(e){return c.call(this,this._keys,e)}function f(e,t){return this.has(e)?this._values[n]=t:this._values[this._keys.push(e)-1]=t,this}function d(e){return this.has(e)||this._values.push(e),this}function p(){(this._keys||0).length=this._values.length=0}function v(){return g(this._itp,this._values)}function m(){return g(this._itp,this._keys,this._values)}function g(n,r,i){var e,o=[0],a=!1;return n.push(o),(e={})[Symbol.iterator]=function(){return this},e.next=function(){var e,t=o[0];return!a&&t<r.length?(e=i?[r[t],i[t]]:r[t],o[0]++):(a=!0,n.splice(n.indexOf(o),1)),{done:a,value:e}},e}function y(){return this._values.length}function b(e,t){for(var n=this.entries();;){var r=n.next();if(r.done)break;e.call(t,r.value[1],r.value[0],this)}}"undefined"==typeof WeakSet&&(e.WeakSet=a({delete:s,add:d,clear:p,has:l},!0))}(j.PLATFORM.global),"undefined"==typeof FEATURE_NO_ES2015&&(h=Function.prototype.bind,void 0===j.PLATFORM.global.Reflect&&(j.PLATFORM.global.Reflect={}),"function"!=typeof Reflect.defineProperty&&(Reflect.defineProperty=function(e,t,n){if("object"===(void 0===e?"undefined":U(e))?null===e:"function"!=typeof e)throw new TypeError("Reflect.defineProperty called on non-object");try{return Object.defineProperty(e,t,n),!0}catch(e){return!1}}),"function"!=typeof Reflect.construct&&(Reflect.construct=function(e,t){if(t)switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var n=[null];return n.push.apply(n,t),new(h.apply(e,n))}),"function"!=typeof Reflect.ownKeys&&(Reflect.ownKeys=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))})),"undefined"==typeof FEATURE_NO_ESNEXT&&(p=Object.freeze({}),v="__metadata__","function"!=typeof Reflect.getOwnMetadata&&(Reflect.getOwnMetadata=function(e,t,n){if(t.hasOwnProperty(v))return(t[v][n]||p)[e]}),"function"!=typeof Reflect.defineMetadata&&(Reflect.defineMetadata=function(e,t,n,r){var i=n.hasOwnProperty(v)?n[v]:n[v]={};(i[r]||(i[r]={}))[e]=t}),"function"!=typeof Reflect.metadata&&(Reflect.metadata=function(n,r){return function(e,t){Reflect.defineMetadata(n,r,e,t)}}))}),define("aurelia-path",["exports"],function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.relativeToFile=function(e,t){var n=t&&t.split("/"),r=e.trim().split("/");if("."===r[0].charAt(0)&&n){var i=n.slice(0,n.length-1);r.unshift.apply(r,i)}return function(e){for(var t=0;t<e.length;++t){var n=e[t];if("."===n)e.splice(t,1),t-=1;else if(".."===n){if(0===t||1===t&&".."===e[2]||".."===e[t-1])continue;0<t&&(e.splice(t-1,2),t-=2)}}}(r),r.join("/")},e.join=function(e,t){if(!e)return t;if(!t)return e;var n=e.match(/^([^/]*?:)\//),r=n&&0<n.length?n[1]:"";e=e.substr(r.length);var i=void 0;i=0===e.indexOf("///")&&"file:"===r?"///":0===e.indexOf("//")?"//":0===e.indexOf("/")?"/":"";for(var o="/"===t.slice(-1)?"/":"",a=e.split("/"),s=t.split("/"),u=[],c=0,l=a.length;c<l;++c)if(".."===a[c])u.pop();else{if("."===a[c]||""===a[c])continue;u.push(a[c])}for(var h=0,f=s.length;h<f;++h)if(".."===s[h])u.pop();else{if("."===s[h]||""===s[h])continue;u.push(s[h])}return r+i+u.join("/")+o},e.buildQueryString=function(e,t){for(var n=[],r=Object.keys(e||{}).sort(),i=0,o=r.length;i<o;i++){var a=r[i];n=n.concat(h(a,e[a],t))}if(0===n.length)return"";return n.join("&")},e.parseQueryString=function(e){var t={};if(!e||"string"!=typeof e)return t;var n=e;"?"===n.charAt(0)&&(n=n.substr(1));for(var r=n.replace(/\+/g," ").split("&"),i=0;i<r.length;i++){var o=r[i].split("="),a=decodeURIComponent(o[0]);if(a){var s=a.split("]["),u=s.length-1;if(/\[/.test(s[0])&&/\]$/.test(s[u])?(s[u]=s[u].replace(/\]$/,""),s=s.shift().split("[").concat(s),u=s.length-1):u=0,2<=o.length){var c=o[1]?decodeURIComponent(o[1]):"";u?d(t,s,c):t[a]=f(t[a],c)}else t[a]=!0}}return t};var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};var c=encodeURIComponent,l=function(e){return c(e).replace("%24","$")};function h(e,t,n){var r=[];if(null==t)return r;if(Array.isArray(t))for(var i=0,o=t.length;i<o;i++)if(n)r.push(l(e)+"="+c(t[i]));else{var a=e+"["+("object"===u(t[i])&&null!==t[i]?i:"")+"]";r=r.concat(h(a,t[i]))}else if("object"!==(void 0===t?"undefined":u(t))||n)r.push(l(e)+"="+c(t));else for(var s in t)r=r.concat(h(e+"["+s+"]",t[s]));return r}function f(e,t){return Array.isArray(e)?(e.push(t),e):void 0!==e?[e,t]:t}function d(e,t,n){for(var r=e,i=t.length-1,o=0;o<=i;o++){var a=""===t[o]?r.length:t[o];if(o<i){var s=r[a]&&"object"!==u(r[a])?[r[a]]:r[a];r=r[a]=s||(isNaN(t[o+1])?{}:[])}else r=r[a]=n}}}),define("aurelia-pal",["exports"],function(t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AggregateError=function(e,t,n){if(t){if(t.innerError&&n)return t;var r="\n------------------------------------------------\n";e+=r+"Inner Error:\n","string"==typeof t?e+="Message: "+t:(t.message?e+="Message: "+t.message:e+="Unknown Inner Error Type. Displaying Inner Error as JSON:\n "+JSON.stringify(t,null,"  "),t.stack&&(e+="\nInner Error Stack:\n"+t.stack,e+="\nEnd Inner Error Stack")),e+=r}var i=new Error(e);t&&(i.innerError=t);return i},t.initializePAL=function(e){if(o)return;t.isInitialized=o=!0,"function"!=typeof Object.getPropertyDescriptor&&(Object.getPropertyDescriptor=function(e,t){for(var n=Object.getOwnPropertyDescriptor(e,t),r=Object.getPrototypeOf(e);void 0===n&&null!==r;)n=Object.getOwnPropertyDescriptor(r,t),r=Object.getPrototypeOf(r);return n});e(r,n,i)},t.reset=function(){t.isInitialized=o=!1};var n=t.FEATURE={},r=t.PLATFORM={noop:function(){},eachModule:function(){},moduleName:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(e){return e})};r.global="undefined"!=typeof self?self:"undefined"!=typeof global?global:new Function("return this")();var i=t.DOM={},o=t.isInitialized=!1}),define("aurelia-pal-browser",["exports","aurelia-pal"],function(e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e._DOM=e._FEATURE=e._PLATFORM=void 0,e.initialize=function(){if(t.isInitialized)return;(0,t.initializePAL)(function(e,t,n){Object.assign(e,r),Object.assign(t,T),Object.assign(n,I),Object.defineProperty(n,"title",{get:function(){return document.title},set:function(e){document.title=e}}),Object.defineProperty(n,"activeElement",{get:function(){return document.activeElement}}),Object.defineProperty(e,"XMLHttpRequest",{get:function(){return e.global.XMLHttpRequest}})})};var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=e._PLATFORM={location:window.location,history:window.history,addEventListener:function(e,t,n){this.global.addEventListener(e,t,n)},removeEventListener:function(e,t,n){this.global.removeEventListener(e,t,n)},performance:window.performance,requestAnimationFrame:function(e){return this.global.requestAnimationFrame(e)}};if("undefined"==typeof FEATURE_NO_IE){void 0===function(){}.name&&Object.defineProperty(Function.prototype,"name",{get:function(){var e=this.toString().match(/^\s*function\s*(\S*)\s*\(/)[1];return Object.defineProperty(this,"name",{value:e}),e}})}if("undefined"==typeof FEATURE_NO_IE)if("classList"in document.createElement("_")&&(!document.createElementNS||"classList"in document.createElementNS("http://www.w3.org/2000/svg","g"))){var i=document.createElement("_");if(i.classList.add("c1","c2"),!i.classList.contains("c2")){var o=function(e){var r=DOMTokenList.prototype[e];DOMTokenList.prototype[e]=function(e){for(var t=0,n=arguments.length;t<n;++t)e=arguments[t],r.call(this,e)}};o("add"),o("remove")}if(i.classList.toggle("c3",!1),i.classList.contains("c3")){var a=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(e,t){return 1 in arguments&&!this.contains(e)==!t?t:a.call(this,e)}}i=null}else{var s="prototype",u=String.prototype.trim,c=Array.prototype.indexOf,l=[],h=function(e,t){this.name=e,this.code=DOMException[e],this.message=t},f=function(e,t){if(""===t)throw new h("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(t))throw new h("INVALID_CHARACTER_ERR","String contains an invalid character");return c.call(e,t)},d=function(e){for(var t=u.call(e.getAttribute("class")||""),n=t?t.split(/\s+/):l,r=0,i=n.length;r<i;++r)this.push(n[r]);this._updateClassName=function(){e.setAttribute("class",this.toString())}},p=d[s]=[];h[s]=Error[s],p.item=function(e){return this[e]||null},p.contains=function(e){return-1!==f(this,e+="")},p.add=function(){for(var e=arguments,t=0,n=e.length,r=void 0,i=!1;r=e[t]+"",-1===f(this,r)&&(this.push(r),i=!0),++t<n;);i&&this._updateClassName()},p.remove=function(){var e=arguments,t=0,n=e.length,r=void 0,i=!1,o=void 0;do{for(r=e[t]+"",o=f(this,r);-1!==o;)this.splice(o,1),i=!0,o=f(this,r)}while(++t<n);i&&this._updateClassName()},p.toggle=function(e,t){e+="";var n=this.contains(e),r=n?!0!==t&&"remove":!1!==t&&"add";return r&&this[r](e),!0===t||!1===t?t:!n},p.toString=function(){return this.join(" ")},Object.defineProperty(Element.prototype,"classList",{get:function(){return new d(this)},enumerable:!0,configurable:!0})}if("undefined"==typeof FEATURE_NO_IE){var v=function(e,t){for(var n=0,r=y.length,i=[];n<r;n++)y[n][e]==t&&i.push(y[n]);return i},m=function(e,t){for(var n,r=y.length;r--;)(n=y[r]).entryType!=e||void 0!==t&&n.name!=t||y.splice(r,1)};if("performance"in window==!1&&(window.performance={}),"now"in window.performance==!1){var g=Date.now();performance.timing&&performance.timing.navigationStart&&(g=performance.timing.navigationStart),window.performance.now=function(){return Date.now()-g}}Date.now?Date.now():new Date;var y=[],b={};window.performance.mark||(window.performance.mark=window.performance.webkitMark||function(e){var t={name:e,entryType:"mark",startTime:window.performance.now(),duration:0};y.push(t),b[e]=t}),window.performance.measure||(window.performance.measure=window.performance.webkitMeasure||function(e,t,n){t=b[t].startTime,n=b[n].startTime,y.push({name:e,entryType:"measure",startTime:t,duration:n-t})}),window.performance.getEntriesByType||(window.performance.getEntriesByType=window.performance.webkitGetEntriesByType||function(e){return v("entryType",e)}),window.performance.getEntriesByName||(window.performance.getEntriesByName=window.performance.webkitGetEntriesByName||function(e){return v("name",e)}),window.performance.clearMarks||(window.performance.clearMarks=window.performance.webkitClearMarks||function(e){m("mark",e)}),window.performance.clearMeasures||(window.performance.clearMeasures=window.performance.webkitClearMeasures||function(e){m("measure",e)}),r.performance=window.performance}if("undefined"==typeof FEATURE_NO_IE){var _=window.console=window.console||{},w=function(){};_.memory||(_.memory={}),"assert,clear,count,debug,dir,dirxml,error,exception,group,groupCollapsed,groupEnd,info,log,markTimeline,profile,profiles,profileEnd,show,table,time,timeEnd,timeline,timelineEnd,timeStamp,trace,warn".split(",").forEach(function(e){_[e]||(_[e]=w)}),"object"===n(_.log)&&"log,info,warn,error,assert,dir,clear,profile,profileEnd".split(",").forEach(function(e){console[e]=this.bind(console[e],console)},Function.prototype.call)}if("undefined"==typeof FEATURE_NO_IE&&(!window.CustomEvent||"function"!=typeof window.CustomEvent)){var E=function(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n};E.prototype=window.Event.prototype,window.CustomEvent=E}if(Element&&!Element.prototype.matches){var S=Element.prototype;S.matches=S.matchesSelector||S.mozMatchesSelector||S.msMatchesSelector||S.oMatchesSelector||S.webkitMatchesSelector}var C,T=e._FEATURE={shadowDOM:!!HTMLElement.prototype.attachShadow,scopedCSS:"scoped"in document.createElement("style"),htmlTemplateElement:(C=document.createElement("div"),C.innerHTML="<template></template>","content"in C.children[0]),mutationObserver:!(!window.MutationObserver&&!window.WebKitMutationObserver),ensureHTMLTemplateElement:function(e){return e}};if("undefined"==typeof FEATURE_NO_IE){var O=function(e){var t=e.ownerDocument.createElement("template"),n=e.attributes,r=n.length,i=void 0;for(e.parentNode.insertBefore(t,e);0<r--;)i=n[r],t.setAttribute(i.name,i.value),e.removeAttribute(i.name);return e.parentNode.removeChild(e),R(t)},R=function(e){for(var t=e.content=document.createDocumentFragment(),n=void 0;n=e.firstChild;)t.appendChild(n);return e};T.htmlTemplateElement||(T.ensureHTMLTemplateElement=function(e){for(var t,n=R(e).content.querySelectorAll("template"),r=0,i=n.length;r<i;++r){var o=n[r];"template"===(t=o).tagName&&"http://www.w3.org/2000/svg"===t.namespaceURI?O(o):R(o)}return e})}var A=window.ShadowDOMPolyfill||null,I=e._DOM={Element:Element,NodeList:NodeList,SVGElement:SVGElement,boundary:"aurelia-dom-boundary",addEventListener:function(e,t,n){document.addEventListener(e,t,n)},removeEventListener:function(e,t,n){document.removeEventListener(e,t,n)},adoptNode:function(e){return document.adoptNode(e)},createAttribute:function(e){return document.createAttribute(e)},createElement:function(e){return document.createElement(e)},createTextNode:function(e){return document.createTextNode(e)},createComment:function(e){return document.createComment(e)},createDocumentFragment:function(){return document.createDocumentFragment()},createTemplateElement:function(){var e=document.createElement("template");return T.ensureHTMLTemplateElement(e)},createMutationObserver:function(e){return new(window.MutationObserver||window.WebKitMutationObserver)(e)},createCustomEvent:function(e,t){return new window.CustomEvent(e,t)},dispatchEvent:function(e){document.dispatchEvent(e)},getComputedStyle:function(e){return window.getComputedStyle(e)},getElementById:function(e){return document.getElementById(e)},querySelector:function(e){return document.querySelector(e)},querySelectorAll:function(e){return document.querySelectorAll(e)},nextElementSibling:function(e){if(e.nextElementSibling)return e.nextElementSibling;for(;(e=e.nextSibling)&&1!==e.nodeType;);return e},createTemplateFromMarkup:function(e){var t=document.createElement("div");t.innerHTML=e;var n=t.firstElementChild;if(!n||"TEMPLATE"!==n.nodeName)throw new Error("Template markup must be wrapped in a <template> element e.g. <template> \x3c!-- markup here --\x3e </template>");return T.ensureHTMLTemplateElement(n)},appendNode:function(e,t){(t||document.body).appendChild(e)},replaceNode:function(e,t,n){t.parentNode?t.parentNode.replaceChild(e,t):null!==A?A.unwrap(n).replaceChild(A.unwrap(e),A.unwrap(t)):n.replaceChild(e,t)},removeNode:function(e,t){e.parentNode?e.parentNode.removeChild(e):t&&(null!==A?A.unwrap(t).removeChild(A.unwrap(e)):t.removeChild(e))},injectStyles:function(e,t,n,r){if(r){var i=document.getElementById(r);if(i){if("style"===i.tagName.toLowerCase())return void(i.innerHTML=e);throw new Error("The provided id does not indicate a style tag.")}}var o=document.createElement("style");return o.innerHTML=e,o.type="text/css",r&&(o.id=r),t=t||document.head,n&&0<t.childNodes.length?t.insertBefore(o,t.childNodes[0]):t.appendChild(o),o}}}),define("aurelia-metadata",["exports","aurelia-pal"],function(e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Origin=e.metadata=void 0,e.decorators=function(){for(var e=arguments.length,i=Array(e),t=0;t<e;t++)i[t]=arguments[t];var n=function(e,t,n){var r=i.length;if(t){for(n=n||{value:e[t],writable:!0,configurable:!0,enumerable:!0};r--;)n=i[r](e,t,n)||n;Object.defineProperty(e,t,n)}else for(;r--;)e=i[r](e)||e;return e};return n.on=n},e.deprecated=function(a,s,e){function t(e,t,n){var r=e.constructor.name+"#"+t,i=s?{}:a||{},o="DEPRECATION - "+r;if("function"!=typeof n.value)throw new SyntaxError("Only methods can be marked as deprecated.");return i.message&&(o+=" - "+i.message),u({},n,{value:function(){if(i.error)throw new Error(o);return console.warn(o),n.value.apply(this,arguments)}})}return s?t(a,s,e):t},e.mixin=function(i){var o=Object.keys(i);return function(e){var t=function(e){for(var t="function"==typeof e?e.prototype:e,n=o.length;n--;){var r=o[n];Object.defineProperty(t,r,{value:i[r],writable:!0})}};return e?t(e):t}},e.protocol=d;var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function i(e){return e&&("function"==typeof e||"object"===(void 0===e?"undefined":a(e)))}var o=e.metadata={resource:"aurelia:resource",paramTypes:"design:paramtypes",propertyType:"design:type",properties:"design:properties",get:function(e,t,n){if(i(t)){var r=o.getOwn(e,t,n);return void 0===r?o.get(e,Object.getPrototypeOf(t),n):r}},getOwn:function(e,t,n){if(i(t))return Reflect.getOwnMetadata(e,t,n)},define:function(e,t,n,r){Reflect.defineMetadata(e,t,n,r)},getOrCreateOwn:function(e,t,n,r){var i=o.getOwn(e,n,r);return void 0===i&&(i=new t,Reflect.defineMetadata(e,i,n,r)),i}},s=new Map,n=Object.freeze({moduleId:void 0,moduleMember:void 0});e.Origin=function(){function o(e,t){this.moduleId=e,this.moduleMember=t}return o.get=function(r){var i=s.get(r);return void 0===i&&t.PLATFORM.eachModule(function(e,t){if("object"===(void 0===t?"undefined":a(t)))for(var n in t){if(t[n]===r)return s.set(r,i=new o(e,n)),!0}return t===r&&(s.set(r,i=new o(e,"default")),!0)}),i||n},o.set=function(e,t){s.set(e,t)},o}();function r(){return!0}function c(){}function l(e){return void 0===e?e={}:"function"==typeof e&&(e={validate:e}),e.validate||(e.validate=r),e.compose||(e.compose=c),e}function h(t){return function(e){return!0===t(e)}}function f(n,r){return function(e){var t=r(e);if(!0!==t)throw new Error(t||n+" was not correctly implemented.")}}function d(r,i){i=l(i);var e=function e(t){var n="function"==typeof t?t.prototype:t;i.compose(n),e.assert(n),Object.defineProperty(n,"protocol:"+r,{enumerable:!1,configurable:!1,writable:!1,value:!0})};return e.validate=h(i.validate),e.assert=f(r,i.validate),e}d.create=function(n,r){r=l(r);var t="protocol:"+n,e=function(e){var t=d(n,r);return e?t(e):t};return e.decorates=function(e){return!0===e[t]},e.validate=h(r.validate),e.assert=f(n,r.validate),e}}),define("aurelia-logging",["exports"],function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getLogger=function(e){return r[e]||new f(e)},e.addAppender=function(e){1===o.push(e)&&h()},e.removeAppender=function(t){o=o.filter(function(e){return e!==t})},e.getAppenders=function(){return[].concat(o)},e.clearAppenders=function(){o=[],function(){var e=f.prototype;for(var t in n)"none"!==t&&(e[t]=function(){})}()},e.addCustomLevel=function(e,t){if(void 0!==n[e])throw Error('Log level "'+e+'" already exists.');if(isNaN(t))throw Error("Value must be a number.");n[e]=t,0<o.length?h():f.prototype[e]=function(){}},e.removeCustomLevel=function(e){if(void 0===n[e])return;if(s(e))throw Error('Built-in log level "'+e+'" cannot be removed.');delete n[e],delete f.prototype[e]},e.setLevel=function(e){for(var t in i=e,r)r[t].setLevel(e)},e.getLevel=function(){return i};var n=e.logLevel={none:0,error:10,warn:20,info:30,debug:40},r={},o=[],i=n.none,a=["none","error","warn","info","debug"];function s(t){return 0<a.filter(function(e){return e===t}).length}function u(){return[this].concat(Array.prototype.slice.call(arguments))}function c(r){var i=n[r];return function(){if(!(this.level<i))for(var e=u.apply(this,arguments),t=o.length;t--;){var n;(n=o[t])[r].apply(n,e)}}}function l(r){var i=n[r];return function(){if(!(this.level<i))for(var e=u.apply(this,arguments),t=o.length;t--;){var n=o[t];void 0!==n[r]&&n[r].apply(n,e)}}}function h(){var e=f.prototype;for(var t in n)s(t)?"none"!==t&&(e[t]=c(t)):e[t]=l(t)}var f=e.Logger=function(){function e(e){var t=r[e];if(t)return t;(r[e]=this).id=e,this.level=i}return e.prototype.debug=function(e){},e.prototype.info=function(e){},e.prototype.warn=function(e){},e.prototype.error=function(e){},e.prototype.setLevel=function(e){this.level=e},e}()}),define("aurelia-logging-console",["exports","aurelia-logging"],function(e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ConsoleAppender=void 0;e.ConsoleAppender=function(){function e(){}return e.prototype.debug=function(e){for(var t,n=arguments.length,r=Array(1<n?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(t=console).debug.apply(t,["DEBUG ["+e.id+"]"].concat(r))},e.prototype.info=function(e){for(var t,n=arguments.length,r=Array(1<n?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(t=console).info.apply(t,["INFO ["+e.id+"]"].concat(r))},e.prototype.warn=function(e){for(var t,n=arguments.length,r=Array(1<n?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(t=console).warn.apply(t,["WARN ["+e.id+"]"].concat(r))},e.prototype.error=function(e){for(var t,n=arguments.length,r=Array(1<n?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(t=console).error.apply(t,["ERROR ["+e.id+"]"].concat(r))},e}()}),define("aurelia-loader",["exports","aurelia-path","aurelia-metadata"],function(e,u,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Loader=e.TemplateRegistryEntry=e.TemplateDependency=void 0;var t=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),c=e.TemplateDependency=function(e,t){this.src=e,this.name=t},n=e.TemplateRegistryEntry=function(){function e(e){this.templateIsLoaded=!1,this.factoryIsReady=!1,this.resources=null,this.dependencies=null,this.address=e,this.onReady=null,this._template=null,this._factory=null}return e.prototype.addDependency=function(e,t){var n="string"==typeof e?(0,u.relativeToFile)(e,this.address):r.Origin.get(e).moduleId;this.dependencies.push(new c(n,t))},t(e,[{key:"template",get:function(){return this._template},set:function(e){var t,n=this.address,r=void 0,i=void 0,o=void 0;this._template=e,this.templateIsLoaded=!0,t=e.content.querySelectorAll("require"),o=this.dependencies=new Array(t.length);for(var a=0,s=t.length;a<s;++a){if(!(i=(r=t[a]).getAttribute("from")))throw new Error("<require> element in "+n+' has no "from" attribute.');o[a]=new c((0,u.relativeToFile)(i,n),r.getAttribute("as")),r.parentNode&&r.parentNode.removeChild(r)}}},{key:"factory",get:function(){return this._factory},set:function(e){this._factory=e,this.factoryIsReady=!0}}]),e}();e.Loader=function(){function e(){this.templateRegistry={}}return e.prototype.map=function(e,t){throw new Error("Loaders must implement map(id, source).")},e.prototype.normalizeSync=function(e,t){throw new Error("Loaders must implement normalizeSync(moduleId, relativeTo).")},e.prototype.normalize=function(e,t){throw new Error("Loaders must implement normalize(moduleId: string, relativeTo: string): Promise<string>.")},e.prototype.loadModule=function(e){throw new Error("Loaders must implement loadModule(id).")},e.prototype.loadAllModules=function(e){throw new Error("Loader must implement loadAllModules(ids).")},e.prototype.loadTemplate=function(e){throw new Error("Loader must implement loadTemplate(url).")},e.prototype.loadText=function(e){throw new Error("Loader must implement loadText(url).")},e.prototype.applyPluginToUrl=function(e,t){throw new Error("Loader must implement applyPluginToUrl(url, pluginName).")},e.prototype.addPlugin=function(e,t){throw new Error("Loader must implement addPlugin(pluginName, implementation).")},e.prototype.getOrCreateTemplateRegistryEntry=function(e){return this.templateRegistry[e]||(this.templateRegistry[e]=new n(e))},e}()}),define("aurelia-loader-default",["exports","aurelia-loader","aurelia-pal","aurelia-metadata"],function(e,t,i,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DefaultLoader=e.TextTemplateLoader=void 0;var r=e.TextTemplateLoader=function(){function e(){}return e.prototype.loadTemplate=function(e,t){return e.loadText(t.address).then(function(e){t.template=i.DOM.createTemplateFromMarkup(e)})},e}();function a(e,t){var n=e,r=void 0,i=void 0;for(r in n.__useDefault&&(n=n.default),o.Origin.set(n,new o.Origin(t,"default")),n)"function"==typeof(i=n[r])&&o.Origin.set(i,new o.Origin(t,r));return e}var n=e.DefaultLoader=function(t){function e(){var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,t.call(this));e.textPluginName="text",e.moduleRegistry=Object.create(null),e.useTemplateLoader(new r);var n=e;return e.addPlugin("template-registry-entry",{fetch:function(e){var t=n.getOrCreateTemplateRegistryEntry(e);return t.templateIsLoaded?t:n.templateLoader.loadTemplate(n,t).then(function(e){return t})}}),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(e,t),e.prototype.useTemplateLoader=function(e){this.templateLoader=e},e.prototype.loadAllModules=function(e){for(var t=[],n=0,r=e.length;n<r;++n)t.push(this.loadModule(e[n]));return Promise.all(t)},e.prototype.loadTemplate=function(e){return this._import(this.applyPluginToUrl(e,"template-registry-entry"))},e.prototype.loadText=function(e){return this._import(this.applyPluginToUrl(e,this.textPluginName)).then(function(e){return"string"==typeof e?e:e.default})},e}(t.Loader);i.PLATFORM.Loader=n,i.PLATFORM.global.System&&i.PLATFORM.global.System.import?(i.PLATFORM.eachModule=function(e){if(System.registry)for(var t=Array.from(System.registry.keys()),n=0;n<t.length;n++)try{var r=t[n];if(e(r,System.registry.get(r)))return}catch(e){}else{var i=System._loader.modules;for(var o in i)try{if(e(o,i[o].module))return}catch(e){}}},System.set("text",System.newModule({translate:function(e){return'module.exports = "'+e.source.replace(/(["\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")+'";'}})),n.prototype._import=function(e){return System.import(e)},n.prototype.loadModule=function(e){var n=this;return System.normalize(e).then(function(t){var e=n.moduleRegistry[t];return void 0!==e?Promise.resolve(e):System.import(t).then(function(e){return a(n.moduleRegistry[t]=e,t)})})},n.prototype.map=function(e,t){var n;System.config({map:(n={},n[e]=t,n)})},n.prototype.normalizeSync=function(e,t){return System.normalizeSync(e,t)},n.prototype.normalize=function(e,t){return System.normalize(e,t)},n.prototype.applyPluginToUrl=function(e,t){return e+"!"+t},n.prototype.addPlugin=function(e,r){System.set(e,System.newModule({fetch:function(t,e){var n=r.fetch(t.address);return Promise.resolve(n).then(function(e){return t.metadata.result=e,""})},instantiate:function(e){return e.metadata.result}}))}):(i.PLATFORM.global.requirejs&&requirejs.s&&requirejs.s.contexts&&requirejs.s.contexts._&&requirejs.s.contexts._.defined?i.PLATFORM.eachModule=function(e){var t=requirejs.s.contexts._.defined;for(var n in t)try{if(e(n,t[n]))return}catch(e){}}:i.PLATFORM.eachModule=function(e){},n.prototype._import=function(n){return new Promise(function(e,t){i.PLATFORM.global.require([n],e,t)})},n.prototype.loadModule=function(n){var r=this,e=this.moduleRegistry[n];return void 0!==e?Promise.resolve(e):new Promise(function(t,e){i.PLATFORM.global.require([n],function(e){r.moduleRegistry[n]=e,t(a(e,n))},e)})},n.prototype.map=function(e,t){},n.prototype.normalize=function(e,t){return Promise.resolve(e)},n.prototype.normalizeSync=function(e,t){return e},n.prototype.applyPluginToUrl=function(e,t){return t+"!"+e},n.prototype.addPlugin=function(e,i){define(e,[],{load:function(e,t,n){var r=i.fetch(e);Promise.resolve(r).then(n)}})})}),define("aurelia-history",["exports"],function(e){"use strict";function n(e){throw new Error("History must implement "+e+"().")}Object.defineProperty(e,"__esModule",{value:!0});e.History=function(){function e(){}return e.prototype.activate=function(e){n("activate")},e.prototype.deactivate=function(){n("deactivate")},e.prototype.getAbsoluteRoot=function(){n("getAbsoluteRoot")},e.prototype.navigate=function(e,t){n("navigate")},e.prototype.navigateBack=function(){n("navigateBack")},e.prototype.setTitle=function(e){n("setTitle")},e.prototype.setState=function(e,t){n("setState")},e.prototype.getState=function(e){n("getState")},e}()}),define("aurelia-history-browser",["exports","aurelia-pal","aurelia-history"],function(e,s,t){"use strict";var n,r;function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(e,"__esModule",{value:!0}),e.BrowserHistory=e.DefaultLinkHandler=e.LinkHandler=void 0,e.configure=function(e){e.singleton(t.History,c),e.transient(a,u)};var a=e.LinkHandler=function(){function e(){}return e.prototype.activate=function(e){},e.prototype.deactivate=function(){},e}(),u=e.DefaultLinkHandler=function(e){function a(){var i=o(this,e.call(this));return i.handler=function(e){var t=a.getEventInfo(e),n=t.shouldHandleEvent,r=t.href;n&&(e.preventDefault(),i.history.navigate(r))},i}return i(a,e),a.prototype.activate=function(e){e._hasPushState&&(this.history=e,s.DOM.addEventListener("click",this.handler,!0))},a.prototype.deactivate=function(){s.DOM.removeEventListener("click",this.handler)},a.getEventInfo=function(e){var t={shouldHandleEvent:!1,href:null,anchor:null},n=a.findClosestAnchor(e.target);if(!n||!a.targetIsThisWindow(n))return t;if(e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)return t;var r=n.getAttribute("href");t.anchor=n,t.href=r;var i=1===e.which,o=r&&!("#"===r.charAt(0)||/^[a-z]+:/i.test(r));return t.shouldHandleEvent=i&&o,t},a.findClosestAnchor=function(e){for(;e;){if("A"===e.tagName)return e;e=e.parentNode}},a.targetIsThisWindow=function(e){var t=e.getAttribute("target"),n=s.PLATFORM.global;return!t||t===n.name||"_self"===t||"top"===t&&n===n.top},a}(a);var c=e.BrowserHistory=(r=n=function(n){function e(e){var t=o(this,n.call(this));return t._isActive=!1,t._checkUrlCallback=t._checkUrl.bind(t),t.location=s.PLATFORM.location,t.history=s.PLATFORM.history,t.linkHandler=e,t}return i(e,n),e.prototype.activate=function(e){if(this._isActive)throw new Error("History has already been activated.");var t=!!e.pushState;this._isActive=!0,this.options=Object.assign({},{root:"/"},this.options,e),this.root=("/"+this.options.root+"/").replace(h,"/"),this._wantsHashChange=!1!==this.options.hashChange,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var n=void 0;if(this._hasPushState?n="popstate":this._wantsHashChange&&(n="hashchange"),s.PLATFORM.addEventListener(n,this._checkUrlCallback),this._wantsHashChange&&t){var r=this.location,i=r.pathname.replace(/[^\/]$/,"$&/")===this.root;if(!this._hasPushState&&!i)return this.fragment=this._getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0;this._hasPushState&&i&&r.hash&&(this.fragment=this._getHash().replace(l,""),this.history.replaceState({},s.DOM.title,this.root+this.fragment+r.search))}if(this.fragment||(this.fragment=this._getFragment()),this.linkHandler.activate(this),!this.options.silent)return this._loadUrl()},e.prototype.deactivate=function(){s.PLATFORM.removeEventListener("popstate",this._checkUrlCallback),s.PLATFORM.removeEventListener("hashchange",this._checkUrlCallback),this._isActive=!1,this.linkHandler.deactivate()},e.prototype.getAbsoluteRoot=function(){var e,t,n;return""+(e=this.location.protocol,t=this.location.hostname,n=this.location.port,e+"//"+t+(n?":"+n:""))+this.root},e.prototype.navigate=function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=t.trigger,r=void 0===n||n,i=t.replace,o=void 0!==i&&i;if(e&&d.test(e))return this.location.href=e,!0;if(!this._isActive)return!1;if(e=this._getFragment(e||""),this.fragment===e&&!o)return!1;this.fragment=e;var a=this.root+e;if(""===e&&"/"!==a&&(a=a.slice(0,-1)),this._hasPushState)a=a.replace("//","/"),this.history[o?"replaceState":"pushState"]({},s.DOM.title,a);else{if(!this._wantsHashChange)return this.location.assign(a);!function(e,t,n){if(n){var r=e.href.replace(/(javascript:|#).*$/,"");e.replace(r+"#"+t)}else e.hash="#"+t}(this.location,e,o)}return r?this._loadUrl(e):void 0},e.prototype.navigateBack=function(){this.history.back()},e.prototype.setTitle=function(e){s.DOM.title=e},e.prototype.setState=function(e,t){var n=Object.assign({},this.history.state),r=this.location,i=r.pathname,o=r.search,a=r.hash;n[e]=t,this.history.replaceState(n,null,""+i+o+a)},e.prototype.getState=function(e){return Object.assign({},this.history.state)[e]},e.prototype._getHash=function(){return this.location.hash.substr(1)},e.prototype._getFragment=function(e,t){var n=void 0;return e||(this._hasPushState||!this._wantsHashChange||t?(e=this.location.pathname+this.location.search,n=this.root.replace(f,""),e.indexOf(n)||(e=e.substr(n.length))):e=this._getHash()),"/"+e.replace(l,"")},e.prototype._checkUrl=function(){this._getFragment()!==this.fragment&&this._loadUrl()},e.prototype._loadUrl=function(e){var t=this.fragment=this._getFragment(e);return!!this.options.routeHandler&&this.options.routeHandler(t)},e}(t.History),n.inject=[a],r),l=/^#?\/*|\s+$/g,h=/^\/+|\/+$/g,f=/\/$/,d=/^([a-z][a-z0-9+\-.]*:)?\/\//i}),define("aurelia-framework",["exports","aurelia-dependency-injection","aurelia-binding","aurelia-metadata","aurelia-templating","aurelia-loader","aurelia-task-queue","aurelia-path","aurelia-pal","aurelia-logging"],function(t,i,n,r,s,o,a,c,u,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LogManager=t.FrameworkConfiguration=t.Aurelia=void 0,Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})}),Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})}),Object.keys(r).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})}),Object.keys(s).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}})}),Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})}),Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})}),Object.keys(c).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return c[e]}})}),Object.keys(u).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return u[e]}})});var l=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(e);t.Aurelia=function(){function r(e,t,n){this.loader=e||new u.PLATFORM.Loader,this.container=t||(new i.Container).makeGlobal(),this.resources=n||new s.ViewResources,this.use=new g(this),this.logger=l.getLogger("aurelia"),this.hostConfigured=!1,this.host=null,this.use.instance(r,this),this.use.instance(o.Loader,this.loader),this.use.instance(s.ViewResources,this.resources)}return r.prototype.start=function(){var n=this;return this._started?this._started:(this.logger.info("Aurelia Starting"),this._started=this.use.apply().then(function(){if(u.DOM.addEventListener("submit",function(e){var t=e.target,n=t.action;"form"!==t.tagName.toLowerCase()||n||e.preventDefault()}),!n.container.hasResolver(s.BindingLanguage)){var e="You must configure Aurelia with a BindingLanguage implementation.";throw n.logger.error(e),new Error(e)}n.logger.info("Aurelia Started");var t=u.DOM.createCustomEvent("aurelia-started",{bubbles:!0,cancelable:!0});return u.DOM.dispatchEvent(t),n}))},r.prototype.enhance=function(){var n=this,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return this._configureHost(e||u.DOM.querySelectorAll("body")[0]),new Promise(function(e){var t=n.container.get(s.TemplatingEngine);n.root=t.enhance({container:n.container,element:n.host,resources:n.resources,bindingContext:r}),n.root.attached(),n._onAureliaComposed(),e(n)})},r.prototype.setRoot=function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,r={};this.root&&this.root.viewModel&&this.root.viewModel.router&&(this.root.viewModel.router.deactivate(),this.root.viewModel.router.reset()),this._configureHost(n);var i=this.container.get(s.TemplatingEngine);return delete this.container.get(s.CompositionTransaction).initialComposition,e||(e=this.configModuleId?(0,c.relativeToFile)("./app",this.configModuleId):"app"),r.viewModel=e,r.container=r.childContainer=this.container,r.viewSlot=this.hostSlot,r.host=this.host,i.compose(r).then(function(e){return t.root=e,r.viewSlot.attached(),t._onAureliaComposed(),t})},r.prototype._configureHost=function(e){if(!this.hostConfigured){if(e=e||this.host,this.host=e&&"string"!=typeof e?e:u.DOM.getElementById(e||"applicationHost"),!this.host)throw new Error("No applicationHost was specified.");this.hostConfigured=!0,(this.host.aurelia=this).hostSlot=new s.ViewSlot(this.host,!0),this.hostSlot.transformChildNodesIntoView(),this.container.registerInstance(u.DOM.boundary,this.host)}},r.prototype._onAureliaComposed=function(){var e=u.DOM.createCustomEvent("aurelia-composed",{bubbles:!0,cancelable:!0});setTimeout(function(){return u.DOM.dispatchEvent(e)},1)},r}();var h=l.getLogger("aurelia"),f=/\.[^/.]+$/;function d(t,n){var r=void 0;return function e(){return(r=n.shift())?Promise.resolve(r(t)).then(e):Promise.resolve()}()}function p(t,n,r){var i=t.container.get(s.ViewEngine);return Promise.all(Object.keys(n).map(function(e){return function(r){var e=r.moduleId,i=v(e);o(e)&&(e=a(e));return t.loader.normalize(e,r.relativeTo).then(function(e){return{name:r.moduleId,importId:o(r.moduleId)?(t=e,n=i,a(t)+"."+n):e};var t,n})}(n[e])})).then(function(e){var t=[],n=[];return e.forEach(function(e){t.push(void 0),n.push(e.importId)}),i.importViewResources(n,t,r)});function o(e){var t=v(e);return!!t&&(""!==t&&(".js"!==t&&".ts"!==t))}function a(e){return e.replace(f,"")}}function v(e){var t=e.match(f);if(t&&0<t.length)return t[0].split(".")[1]}function m(e){if(e.processed)throw new Error("This config instance has already been applied. To load more plugins or global resources, create a new FrameworkConfiguration instance.")}var g=function(){function e(e){var t=this;this.aurelia=e,this.container=e.container,this.info=[],this.processed=!1,this.preTasks=[],this.postTasks=[],this.resourcesToLoad={},this.preTask(function(){return e.loader.normalize("aurelia-bootstrapper").then(function(e){return t.bootstrapperName=e})}),this.postTask(function(){return p(e,t.resourcesToLoad,e.resources)})}return e.prototype.instance=function(e,t){return this.container.registerInstance(e,t),this},e.prototype.singleton=function(e,t){return this.container.registerSingleton(e,t),this},e.prototype.transient=function(e,t){return this.container.registerTransient(e,t),this},e.prototype.preTask=function(e){return m(this),this.preTasks.push(e),this},e.prototype.postTask=function(e){return m(this),this.postTasks.push(e),this},e.prototype.feature=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=/\/index$/i.test(e),r=n||v(e)?e:e+"/index",i=n?e.substr(0,e.length-6):e;return this.plugin({moduleId:r,resourcesRelativeTo:[i,""],config:t})},e.prototype.globalResources=function(e){m(this);for(var t=Array.isArray(e)?e:arguments,n=void 0,r=this.resourcesRelativeTo||["",""],i=0,o=t.length;i<o;++i){if("string"!=typeof(n=t[i]))throw new Error("Invalid resource path ["+n+"]. Resources must be specified as relative module IDs.");var a=r[0],s=r[1],u=n;(n.startsWith("./")||n.startsWith("../"))&&""!==a&&(u=(0,c.join)(a,n)),this.resourcesToLoad[u]={moduleId:u,relativeTo:s}}return this},e.prototype.globalName=function(e,t){return m(this),this.resourcesToLoad[e]={moduleId:t,relativeTo:""},this},e.prototype.plugin=function(e,t){return m(this),"string"==typeof e?this.plugin({moduleId:e,resourcesRelativeTo:[e,""],config:t||{}}):(this.info.push(e),this)},e.prototype._addNormalizedPlugin=function(t,e){var n=this,r={moduleId:t,resourcesRelativeTo:[t,""],config:e||{}};return this.plugin(r),this.preTask(function(){var e=[t,n.bootstrapperName];return r.moduleId=t,r.resourcesRelativeTo=e,Promise.resolve()}),this},e.prototype.defaultBindingLanguage=function(){return this._addNormalizedPlugin("aurelia-templating-binding")},e.prototype.router=function(){return this._addNormalizedPlugin("aurelia-templating-router")},e.prototype.history=function(){return this._addNormalizedPlugin("aurelia-history-browser")},e.prototype.defaultResources=function(){return this._addNormalizedPlugin("aurelia-templating-resources")},e.prototype.eventAggregator=function(){return this._addNormalizedPlugin("aurelia-event-aggregator")},e.prototype.basicConfiguration=function(){return this.defaultBindingLanguage().defaultResources().eventAggregator()},e.prototype.standardConfiguration=function(){return this.basicConfiguration().history().router()},e.prototype.developmentLogging=function(e){var t=this,n=e?l.logLevel[e]:void 0;return void 0===n&&(n=l.logLevel.debug),this.preTask(function(){return t.aurelia.loader.normalize("aurelia-logging-console",t.bootstrapperName).then(function(e){return t.aurelia.loader.loadModule(e).then(function(e){l.addAppender(new e.ConsoleAppender),l.setLevel(n)})})}),this},e.prototype.apply=function(){var i=this;return this.processed?Promise.resolve():d(this,this.preTasks).then(function(){var t=i.aurelia.loader,n=i.info,r=void 0;return function e(){return(r=n.shift())?function(t,n,r){h.debug("Loading plugin "+r.moduleId+"."),t.resourcesRelativeTo=r.resourcesRelativeTo;var e=r.moduleId;return 1<r.resourcesRelativeTo.length?n.normalize(r.moduleId,r.resourcesRelativeTo[1]).then(function(e){return i(e)}):i(e);function i(e){return n.loadModule(e).then(function(e){if("configure"in e)return Promise.resolve(e.configure(t,r.config||{})).then(function(){t.resourcesRelativeTo=null,h.debug("Configured plugin "+r.moduleId+".")});t.resourcesRelativeTo=null,h.debug("Loaded plugin "+r.moduleId+".")})}}(i,t,r).then(e):(i.processed=!0,Promise.resolve())}().then(function(){return d(i,i.postTasks)})})},e}();t.FrameworkConfiguration=g;t.LogManager=l}),define("aurelia-fetch-client",["exports"],function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.json=function(e,t){return JSON.stringify(void 0!==e?e:{},t)};var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};var o=e.HttpClientConfiguration=function(){function e(){this.baseUrl="",this.defaults={},this.interceptors=[]}return e.prototype.withBaseUrl=function(e){return this.baseUrl=e,this},e.prototype.withDefaults=function(e){return this.defaults=e,this},e.prototype.withInterceptor=function(e){return this.interceptors.push(e),this},e.prototype.useStandardConfiguration=function(){return Object.assign(this.defaults,{credentials:"same-origin"},this.defaults),this.rejectErrorResponses()},e.prototype.rejectErrorResponses=function(){return this.withInterceptor({response:t})},e}();function t(e){if(!e.ok)throw e;return e}e.HttpClient=function(){function e(){if(this.activeRequestCount=0,this.isRequesting=!1,this.isConfigured=!1,this.baseUrl="",this.defaults=null,this.interceptors=[],"undefined"==typeof fetch)throw new Error("HttpClient requires a Fetch API implementation, but the current environment doesn't support it. You may need to load a polyfill such as https://github.com/github/fetch")}return e.prototype.configure=function(e){var t=void 0;if("object"===(void 0===e?"undefined":i(e)))t={defaults:e};else{if("function"!=typeof e)throw new Error("invalid config");(t=new o).baseUrl=this.baseUrl,t.defaults=Object.assign({},this.defaults),t.interceptors=this.interceptors;var n=e(t);o.prototype.isPrototypeOf(n)&&(t=n)}var r=t.defaults;if(r&&Headers.prototype.isPrototypeOf(r.headers))throw new Error("Default headers must be a plain object.");return this.baseUrl=t.baseUrl,this.defaults=r,this.interceptors=t.interceptors||[],this.isConfigured=!0,this},e.prototype.fetch=function(n){function e(e,t){return n.apply(this,arguments)}return e.toString=function(){return n.toString()},e}(function(e,t){var i=this;(function(){this.isRequesting=!!++this.activeRequestCount}).call(this);var n,r,o=Promise.resolve().then(function(){return function(e,t){var n=this.defaults||{},r=void 0,i=void 0,o=void 0,a=function(e){var t={};for(var n in e||{})e.hasOwnProperty(n)&&(t[n]="function"==typeof e[n]?e[n]():e[n]);return t}(n.headers);if(Request.prototype.isPrototypeOf(e))r=e,o=new Headers(r.headers).get("Content-Type");else{t||(t={});var s=(i=t.body)?{body:i}:null,u=Object.assign({},n,{headers:{}},t,s);o=new Headers(u.headers).get("Content-Type"),r=new Request(function(e,t){if(c.test(t))return t;return(e||"")+t}(this.baseUrl,e),u)}o||(new Headers(a).has("content-type")?r.headers.set("Content-Type",new Headers(a).get("content-type")):i&&function(e){try{JSON.parse(e)}catch(e){return!1}return!0}(i)&&r.headers.set("Content-Type","application/json"));(function(e,t){for(var n in t||{})t.hasOwnProperty(n)&&!e.has(n)&&e.set(n,t[n])})(r.headers,a),i&&Blob.prototype.isPrototypeOf(i)&&i.type&&r.headers.set("Content-Type",i.type);return r}.call(i,e,t,i.defaults)}),a=(n=o,r=this.interceptors,s(n,r,"request","requestError")).then(function(e){var r=null;if(Response.prototype.isPrototypeOf(e))r=e;else{if(!Request.prototype.isPrototypeOf(e))throw new Error("An invalid result was returned by the interceptor chain. Expected a Request or Response instance, but got ["+e+"]");o=Promise.resolve(e),r=fetch(e)}return o.then(function(e){return t=r,n=i.interceptors,s(t,n,"response","responseError",e);var t,n})});return function(e){var t=function(){this.isRequesting=!!--this.activeRequestCount}.bind(this);return e.then(t,t),e}.call(this,a)}),e}();var c=/^([a-z][a-z0-9+\-.]*:)?\/\//i;function s(e,t,i,o){for(var n=arguments.length,a=Array(4<n?n-4:0),r=4;r<n;r++)a[r-4]=arguments[r];return(t||[]).reduce(function(e,t){var n=t[i],r=t[o];return e.then(n&&function(e){return n.call.apply(n,[t,e].concat(a))}||u,r&&function(e){return r.call.apply(r,[t,e].concat(a))}||l)},Promise.resolve(e))}function u(e){return e}function l(e){throw e}}),define("aurelia-event-aggregator",["exports","aurelia-logging"],function(e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EventAggregator=void 0,e.includeEventsIn=n,e.configure=function(e){e.instance(s,n(e.aurelia))};var r=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(t).getLogger("event-aggregator"),i=function(){function e(e,t){this.messageType=e,this.callback=t}return e.prototype.handle=function(e){e instanceof this.messageType&&this.callback.call(null,e)},e}();function o(e,t,n){try{e(t,n)}catch(e){r.error(e)}}function a(e,t){try{e.handle(t)}catch(e){r.error(e)}}var s=e.EventAggregator=function(){function e(){this.eventLookup={},this.messageHandlers=[]}return e.prototype.publish=function(e,t){var n=void 0,r=void 0;if(!e)throw new Error("Event was invalid.");if("string"==typeof e){if(n=this.eventLookup[e])for(r=(n=n.slice()).length;r--;)o(n[r],t,e)}else for(r=(n=this.messageHandlers.slice()).length;r--;)a(n[r],e)},e.prototype.subscribe=function(e,t){var n=void 0,r=void 0;if(!e)throw new Error("Event channel/type was invalid.");return"string"==typeof e?(n=t,r=this.eventLookup[e]||(this.eventLookup[e]=[])):(n=new i(e,t),r=this.messageHandlers),r.push(n),{dispose:function(){var e=r.indexOf(n);-1!==e&&r.splice(e,1)}}},e.prototype.subscribeOnce=function(e,n){var r=this.subscribe(e,function(e,t){return r.dispose(),n(e,t)});return r},e}();function n(e){var n=new s;return e.subscribeOnce=function(e,t){return n.subscribeOnce(e,t)},e.subscribe=function(e,t){return n.subscribe(e,t)},e.publish=function(e,t){n.publish(e,t)},n}});var __decorate=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;0<=s;s--)(i=e[s])&&(a=(o<3?i(a):3<o?i(t,n,a):i(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a};define("aurelia-dialog/ux-dialog",["require","exports","aurelia-templating"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e=__decorate([n.customElement("ux-dialog"),n.inlineView("\n  <template>\n    <slot></slot>\n  </template>\n")],e)}();t.UxDialog=r});var __decorate=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;0<=s;s--)(i=e[s])&&(a=(o<3?i(a):3<o?i(t,n,a):i(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a};define("aurelia-dialog/ux-dialog-header",["require","exports","aurelia-templating","./dialog-controller"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this.controller=e}return e.prototype.bind=function(){"boolean"!=typeof this.showCloseButton&&(this.showCloseButton=!this.controller.settings.lock)},e.inject=[r.DialogController],__decorate([n.bindable()],e.prototype,"showCloseButton",void 0),e=__decorate([n.customElement("ux-dialog-header"),n.inlineView('\n  <template>\n    <button\n      type="button"\n      class="dialog-close"\n      aria-label="Close"\n      if.bind="showCloseButton"\n      click.trigger="controller.cancel()">\n      <span aria-hidden="true">&times;</span>\n    </button>\n\n    <div class="dialog-header-content">\n      <slot></slot>\n    </div>\n  </template>\n')],e)}();t.UxDialogHeader=i});var __decorate=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;0<=s;s--)(i=e[s])&&(a=(o<3?i(a):3<o?i(t,n,a):i(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a};define("aurelia-dialog/ux-dialog-footer",["require","exports","aurelia-templating","./dialog-controller"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this.controller=e,this.buttons=[],this.useDefaultButtons=!1}return(t=e).isCancelButton=function(e){return"Cancel"===e},e.prototype.close=function(e){t.isCancelButton(e)?this.controller.cancel(e):this.controller.ok(e)},e.prototype.useDefaultButtonsChanged=function(e){e&&(this.buttons=["Cancel","Ok"])},e.inject=[r.DialogController],__decorate([n.bindable],e.prototype,"buttons",void 0),__decorate([n.bindable],e.prototype,"useDefaultButtons",void 0),e=t=__decorate([n.customElement("ux-dialog-footer"),n.inlineView('\n  <template>\n    <slot></slot>\n    <template if.bind="buttons.length > 0">\n      <button type="button"\n        class="btn btn-default"\n        repeat.for="button of buttons"\n        click.trigger="close(button)">\n        ${button}\n      </button>\n    </template>\n  </template>\n')],e);var t}();t.UxDialogFooter=i});var __decorate=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;0<=s;s--)(i=e[s])&&(a=(o<3?i(a):3<o?i(t,n,a):i(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a};define("aurelia-dialog/ux-dialog-body",["require","exports","aurelia-templating"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e=__decorate([n.customElement("ux-dialog-body"),n.inlineView("\n  <template>\n    <slot></slot>\n  </template>\n")],e)}();t.UxDialogBody=r}),define("aurelia-dialog/renderer",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.getDialogContainer=function(){throw new Error("DialogRenderer must implement getDialogContainer().")},e.prototype.showDialog=function(e){throw new Error("DialogRenderer must implement showDialog().")},e.prototype.hideDialog=function(e){throw new Error("DialogRenderer must implement hideDialog().")},e}();t.Renderer=n}),define("aurelia-dialog/lifecycle",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.invokeLifecycle=function(t,n,r){return"function"==typeof t[n]?new Promise(function(e){e(t[n](r))}).then(function(e){return null==e||e}):Promise.resolve(!0)}}),define("aurelia-dialog/dialog-settings",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){this.lock=!0,this.startingZIndex=1e3,this.centerHorizontalOnly=!1,this.rejectOnCancel=!1,this.ignoreTransitions=!1};t.DefaultDialogSettings=n}),define("aurelia-dialog/dialog-service",["require","exports","aurelia-dependency-injection","aurelia-metadata","aurelia-templating","./dialog-settings","./dialog-cancel-error","./lifecycle","./dialog-controller"],function(e,t,n,r,i,o,a,l,h){"use strict";function f(e,t){return this.then(function(e){return e.wasCancelled?e:e.closeResult}).then(e,t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t,n){this.controllers=[],this.hasOpenDialog=!1,this.hasActiveDialog=!1,this.container=e,this.compositionEngine=t,this.defaultSettings=n}return e.prototype.validateSettings=function(e){if(!e.viewModel&&!e.view)throw new Error('Invalid Dialog Settings. You must provide "viewModel", "view" or both.')},e.prototype.createCompositionContext=function(e,t,n){return{container:e.parent,childContainer:e,bindingContext:null,viewResources:null,model:n.model,view:n.view,viewModel:n.viewModel,viewSlot:new i.ViewSlot(t,!0),host:t}},e.prototype.ensureViewModel=function(e){if("function"==typeof e.viewModel){var t=r.Origin.get(e.viewModel).moduleId;if(!t)return Promise.reject(new Error('Can not resolve "moduleId" of "'+e.viewModel.name+'".'));e.viewModel=t}return"string"==typeof e.viewModel?this.compositionEngine.ensureViewModel(e):Promise.resolve(e)},e.prototype._cancelOperation=function(e){if(!e)return{wasCancelled:!0};throw a.createDialogCancelError()},e.prototype.composeAndShowDialog=function(e,n){var r=this;return e.viewModel||(e.bindingContext={controller:n}),this.compositionEngine.compose(e).then(function(t){return n.controller=t,n.renderer.showDialog(n).then(function(){r.controllers.push(n),r.hasActiveDialog=r.hasOpenDialog=!!r.controllers.length},function(e){return t.viewModel&&l.invokeLifecycle(t.viewModel,"deactivate"),Promise.reject(e)})})},e.prototype.createSettings=function(e){return"boolean"==typeof(e=Object.assign({},this.defaultSettings,e)).keyboard||e.keyboard||(e.keyboard=!e.lock),"boolean"!=typeof e.overlayDismiss&&(e.overlayDismiss=!e.lock),Object.defineProperty(e,"rejectOnCancel",{writable:!1,configurable:!0,enumerable:!0}),this.validateSettings(e),e},e.prototype.open=function(e){var t=this;void 0===e&&(e={});var n,r,i=(e=this.createSettings(e)).childContainer||this.container.createChild(),o=new Promise(function(e,t){n=e,r=t}),a=i.invoke(h.DialogController,[e,n,r]);i.registerInstance(h.DialogController,a),o.then(function(){d(t,a)},function(){d(t,a)});var s,u=this.createCompositionContext(i,a.renderer.getDialogContainer(),a.settings),c=this.ensureViewModel(u).then(function(e){return!e.viewModel||l.invokeLifecycle(e.viewModel,"canActivate",a.settings.model)}).then(function(e){return e?t.composeAndShowDialog(u,a).then(function(){return{controller:a,closeResult:o,wasCancelled:!1}}):t._cancelOperation(a.settings.rejectOnCancel)});return(s=c).whenClosed=f,s},e.prototype.closeAll=function(){return Promise.all(this.controllers.slice(0).map(function(t){return t.settings.rejectOnCancel?t.cancel().then(function(){return null}).catch(function(e){if(e.wasCancelled)return t;throw e}):t.cancel().then(function(e){return e.wasCancelled?t:null})})).then(function(e){return e.filter(function(e){return!!e})})},e.inject=[n.Container,i.CompositionEngine,o.DefaultDialogSettings],e}();function d(e,t){var n=e.controllers.indexOf(t);-1!==n&&(e.controllers.splice(n,1),e.hasActiveDialog=e.hasOpenDialog=!!e.controllers.length)}t.DialogService=s});var __decorate=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;0<=s;s--)(i=e[s])&&(a=(o<3?i(a):3<o?i(t,n,a):i(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a};define("aurelia-dialog/dialog-renderer",["require","exports","aurelia-pal","aurelia-dependency-injection"],function(e,a,i,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r,n,o,s,u,c,l="ux-dialog-container";a.transitionEvent=function(){if(r)return r;var e=i.DOM.createElement("fakeelement"),t={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(var n in t)if(void 0!==e.style[n])return r=t[n];return""},a.hasTransition=(s="transitionDuration",u=["webkitTransitionDuration","oTransitionDuration"],function(e){return n||(n=i.DOM.createElement("fakeelement"),o=s in n.style?s:u.find(function(e){return e in n.style})),!!o&&!!i.DOM.getComputedStyle(e)[o].split(",").find(function(e){return!!parseFloat(e)})});var h=function(){function e(){}return(o=e).keyboardEventHandler=function(e){var t,n="Escape"===((t=e).code||t.key)||27===t.keyCode?"Escape":"Enter"===(t.code||t.key)||13===t.keyCode?"Enter":void 0;if(n){var r=o.dialogControllers[o.dialogControllers.length-1];if(r&&r.settings.keyboard){var i=r.settings.keyboard;"Escape"===n&&(!0===i||i===n||Array.isArray(i)&&-1<i.indexOf(n))?r.cancel():"Enter"===n&&(i===n||Array.isArray(i)&&-1<i.indexOf(n))&&r.ok()}}},e.trackController=function(e){o.dialogControllers.length||i.DOM.addEventListener("keyup",o.keyboardEventHandler,!1),o.dialogControllers.push(e)},e.untrackController=function(e){var t=o.dialogControllers.indexOf(e);-1!==t&&o.dialogControllers.splice(t,1),o.dialogControllers.length||i.DOM.removeEventListener("keyup",o.keyboardEventHandler,!1)},e.prototype.getOwnElements=function(e,t){for(var n=e.querySelectorAll(t),r=[],i=0;i<n.length;i++)n[i].parentElement===e&&r.push(n[i]);return r},e.prototype.attach=function(e){var t=i.DOM.createElement("div");t.appendChild(this.anchor),this.dialogContainer=i.DOM.createElement(l),this.dialogContainer.appendChild(t),this.dialogOverlay=i.DOM.createElement("ux-dialog-overlay");var n="number"==typeof e.settings.startingZIndex?e.settings.startingZIndex+"":null;this.dialogOverlay.style.zIndex=n,this.dialogContainer.style.zIndex=n;var r=this.getOwnElements(this.host,l).pop();r&&r.parentElement?(this.host.insertBefore(this.dialogContainer,r.nextSibling),this.host.insertBefore(this.dialogOverlay,r.nextSibling)):(this.host.insertBefore(this.dialogContainer,this.host.firstChild),this.host.insertBefore(this.dialogOverlay,this.host.firstChild)),e.controller.attached(),this.host.classList.add("ux-dialog-open")},e.prototype.detach=function(e){this.host.removeChild(this.dialogOverlay),this.host.removeChild(this.dialogContainer),e.controller.detached(),o.dialogControllers.length||this.host.classList.remove("ux-dialog-open")},e.prototype.setAsActive=function(){this.dialogOverlay.classList.add("active"),this.dialogContainer.classList.add("active")},e.prototype.setAsInactive=function(){this.dialogOverlay.classList.remove("active"),this.dialogContainer.classList.remove("active")},e.prototype.setupClickHandling=function(t){this.stopPropagation=function(e){e._aureliaDialogHostClicked=!0},this.closeDialogClick=function(e){t.settings.overlayDismiss&&!e._aureliaDialogHostClicked&&t.cancel()},this.dialogContainer.addEventListener("click",this.closeDialogClick),this.anchor.addEventListener("click",this.stopPropagation)},e.prototype.clearClickHandling=function(){this.dialogContainer.removeEventListener("click",this.closeDialogClick),this.anchor.removeEventListener("click",this.stopPropagation)},e.prototype.centerDialog=function(){var e=this.dialogContainer.children[0],t=Math.max(i.DOM.querySelectorAll("html")[0].clientHeight,window.innerHeight||0);e.style.marginTop=Math.max((t-e.offsetHeight)/2,30)+"px",e.style.marginBottom=Math.max((t-e.offsetHeight)/2,30)+"px"},e.prototype.awaitTransition=function(e,t){var o=this;return new Promise(function(n){var r=o,i=a.transitionEvent();t||!a.hasTransition(o.dialogContainer)?n():o.dialogContainer.addEventListener(i,function e(t){t.target===r.dialogContainer&&(r.dialogContainer.removeEventListener(i,e),n())}),e()})},e.prototype.getDialogContainer=function(){return this.anchor||(this.anchor=i.DOM.createElement("div"))},e.prototype.showDialog=function(e){var t=this;c||(c=i.DOM.querySelectorAll("body")[0]),e.settings.host?this.host=e.settings.host:this.host=c;var n=e.settings;return this.attach(e),"function"==typeof n.position?n.position(this.dialogContainer,this.dialogOverlay):n.centerHorizontalOnly||this.centerDialog(),o.trackController(e),this.setupClickHandling(e),this.awaitTransition(function(){return t.setAsActive()},e.settings.ignoreTransitions)},e.prototype.hideDialog=function(e){var t=this;return this.clearClickHandling(),o.untrackController(e),this.awaitTransition(function(){return t.setAsInactive()},e.settings.ignoreTransitions).then(function(){t.detach(e)})},e.dialogControllers=[],e=o=__decorate([t.transient()],e);var o}();a.DialogRenderer=h}),define("aurelia-dialog/dialog-controller",["require","exports","./renderer","./lifecycle","./dialog-close-error","./dialog-cancel-error"],function(e,t,n,o,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t,n,r){this.resolve=n,this.reject=r,this.settings=t,this.renderer=e}return e.prototype.releaseResources=function(e){var t=this;return o.invokeLifecycle(this.controller.viewModel||{},"deactivate",e).then(function(){return t.renderer.hideDialog(t)}).then(function(){t.controller.unbind()})},e.prototype.cancelOperation=function(){if(!this.settings.rejectOnCancel)return{wasCancelled:!0};throw a.createDialogCancelError()},e.prototype.ok=function(e){return this.close(!0,e)},e.prototype.cancel=function(e){return this.close(!1,e)},e.prototype.error=function(e){var t=this,n=r.createDialogCloseError(e);return this.releaseResources(n).then(function(){t.reject(n)})},e.prototype.close=function(t,n){var r=this;if(this.closePromise)return this.closePromise;var i={wasCancelled:!t,output:n};return this.closePromise=o.invokeLifecycle(this.controller.viewModel||{},"canDeactivate",i).catch(function(e){return r.closePromise=void 0,Promise.reject(e)}).then(function(e){return e?r.releaseResources(i).then(function(){return!r.settings.rejectOnCancel||t?r.resolve(i):r.reject(a.createDialogCancelError(n)),{wasCancelled:!1}}).catch(function(e){return r.closePromise=void 0,Promise.reject(e)}):(r.closePromise=void 0,r.cancelOperation())})},e.inject=[n.Renderer],e}();t.DialogController=i}),define("aurelia-dialog/dialog-configuration",["require","exports","./renderer","./dialog-settings","./dialog-renderer","aurelia-pal"],function(e,t,n,r,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i.DialogRenderer,s={"ux-dialog":o.PLATFORM.moduleName("./ux-dialog"),"ux-dialog-header":o.PLATFORM.moduleName("./ux-dialog-header"),"ux-dialog-body":o.PLATFORM.moduleName("./ux-dialog-body"),"ux-dialog-footer":o.PLATFORM.moduleName("./ux-dialog-footer"),"attach-focus":o.PLATFORM.moduleName("./attach-focus")},u="ux-dialog-container,ux-dialog-overlay{position:fixed;top:0;right:0;bottom:0;left:0}ux-dialog-overlay{opacity:0}ux-dialog-overlay.active{opacity:1}ux-dialog-container{display:block;transition:opacity .2s linear;opacity:0;overflow-x:hidden;overflow-y:auto;-webkit-overflow-scrolling:touch}ux-dialog-container.active{opacity:1}ux-dialog-container>div{padding:30px}ux-dialog-container>div>div{display:block;min-width:300px;width:-moz-fit-content;width:-webkit-fit-content;width:fit-content;height:-moz-fit-content;height:-webkit-fit-content;height:fit-content;margin:auto}ux-dialog-container,ux-dialog-container>div,ux-dialog-container>div>div{outline:0}ux-dialog{display:table;box-shadow:0 5px 15px rgba(0,0,0,.5);border:1px solid rgba(0,0,0,.2);border-radius:5px;padding:3px;min-width:300px;width:-moz-fit-content;width:-webkit-fit-content;width:fit-content;height:-moz-fit-content;height:-webkit-fit-content;height:fit-content;margin:auto;border-image-source:initial;border-image-slice:initial;border-image-width:initial;border-image-outset:initial;border-image-repeat:initial;background:#fff}ux-dialog>ux-dialog-header{display:block;padding:16px;border-bottom:1px solid #e5e5e5}ux-dialog>ux-dialog-header>button{float:right;border:none;display:block;width:32px;height:32px;background:0 0;font-size:22px;line-height:16px;margin:-14px -16px 0 0;padding:0;cursor:pointer}ux-dialog>ux-dialog-body{display:block;padding:16px}ux-dialog>ux-dialog-footer{display:block;padding:6px;border-top:1px solid #e5e5e5;text-align:right}ux-dialog>ux-dialog-footer button{color:#333;background-color:#fff;padding:6px 12px;font-size:14px;text-align:center;white-space:nowrap;vertical-align:middle;-ms-touch-action:manipulation;touch-action:manipulation;cursor:pointer;background-image:none;border:1px solid #ccc;border-radius:4px;margin:5px 0 5px 5px}ux-dialog>ux-dialog-footer button:disabled{cursor:default;opacity:.45}ux-dialog>ux-dialog-footer button:hover:enabled{color:#333;background-color:#e6e6e6;border-color:#adadad}.ux-dialog-open{overflow:hidden}",c=function(){function e(e,t){var n=this;this.renderer=a,this.cssText=u,this.resources=[],this.fwConfig=e,this.settings=this.fwConfig.container.get(r.DefaultDialogSettings),t(function(){return n._apply()})}return e.prototype._apply=function(){var t=this;this.fwConfig.transient(n.Renderer,this.renderer),this.resources.forEach(function(e){return t.fwConfig.globalResources(s[e])}),this.cssText&&o.DOM.injectStyles(this.cssText)},e.prototype.useDefaults=function(){return this.useRenderer(a).useCSS(u).useStandardResources()},e.prototype.useStandardResources=function(){return this.useResource("ux-dialog").useResource("ux-dialog-header").useResource("ux-dialog-body").useResource("ux-dialog-footer").useResource("attach-focus")},e.prototype.useResource=function(e){return this.resources.push(e),this},e.prototype.useRenderer=function(e,t){return this.renderer=e,t&&Object.assign(this.settings,t),this},e.prototype.useCSS=function(e){return this.cssText=e,this},e}();t.DialogConfiguration=c}),define("aurelia-dialog/dialog-close-error",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createDialogCloseError=function(e){var t=new Error;return t.wasCancelled=!1,t.output=e,t}}),define("aurelia-dialog/dialog-cancel-error",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createDialogCancelError=function(e){var t=new Error("Operation cancelled.");return t.wasCancelled=!0,t.output=e,t}}),define("aurelia-dialog/aurelia-dialog",["require","exports","./dialog-configuration","./ux-dialog","./ux-dialog-header","./ux-dialog-body","./ux-dialog-footer","./attach-focus","./dialog-settings","./dialog-configuration","./renderer","./dialog-cancel-error","./dialog-service","./dialog-controller"],function(e,n,i,t,r,o,a,s,u,c,l,h,f,d){"use strict";function p(e){for(var t in e)n.hasOwnProperty(t)||(n[t]=e[t])}Object.defineProperty(n,"__esModule",{value:!0}),n.configure=function(e,t){var n=null,r=new i.DialogConfiguration(e,function(e){n=e});"function"==typeof t?t(r):r.useDefaults(),n()},p(t),p(r),p(o),p(a),p(s),p(u),p(c),p(l),p(h),p(f),p(d)}),define("aurelia-dialog",["aurelia-dialog/aurelia-dialog"],function(e){return e});var __decorate=this&&this.__decorate||function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;0<=s;s--)(i=e[s])&&(a=(o<3?i(a):3<o?i(t,n,a):i(t,n))||a);return 3<o&&a&&Object.defineProperty(t,n,a),a};function _aureliaConfigureModuleLoader(){window.define=SystemJS.amdDefine,window.require=window.requirejs=SystemJS.amdRequire,SystemJS.config({map:{text:"text","app-bundle":"scripts/app-bundle.js"},bundles:{"app-bundle":["app","creature","data","environment","flex","layout","main","reset","resources/index"]}})}define("aurelia-dialog/attach-focus",["require","exports","aurelia-templating","aurelia-pal"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this.element=e,this.value=!0}return e.prototype.attached=function(){this.value&&"false"!==this.value&&this.element.focus()},e.prototype.valueChanged=function(e){this.value=e},e.inject=[r.DOM.Element],e=__decorate([n.customAttribute("attach-focus")],e)}();t.AttachFocus=i}),define("aurelia-dependency-injection",["exports","aurelia-metadata","aurelia-pal"],function(e,s,i){"use strict";var t,n,r,o,a,u,c,l;Object.defineProperty(e,"__esModule",{value:!0}),e.Container=e.InvocationHandler=e._emptyParameters=e.SingletonRegistration=e.TransientRegistration=e.FactoryInvoker=e.NewInstance=e.Factory=e.StrategyResolver=e.Parent=e.Optional=e.All=e.Lazy=e.resolver=void 0,e.getDecoratorDependencies=b,e.lazy=function(i){return function(e,t,n){var r=b(e,"lazy");r[n]=f.of(i)}},e.all=function(i){return function(e,t,n){var r=b(e,"all");r[n]=d.of(i)}},e.optional=function(){var e=arguments.length<=0||void 0===arguments[0]||arguments[0],t=function(i){return function(e,t,n){var r=b(e,"optional");r[n]=p.of(r[n],i)}};if("boolean"==typeof e)return t(e);return t(!0)},e.parent=function(e,t,n){var r=b(e,"parent");r[n]=v.of(r[n])},e.factory=function(o,a){return function(e,t,n){var r=b(e,"factory"),i=g.of(o);r[n]=a?i.as(a):i}},e.newInstance=function(e){for(var t=arguments.length,o=Array(1<t?t-1:0),n=1;n<t;n++)o[n-1]=arguments[n];var r=function(i){return function(e,t,n){var r=b(e,"newInstance");r[n]=y.of.apply(y,[r[n]].concat(o)),i&&r[n].as(i)}};if(1<=arguments.length)return r(e);return r()},e.invoker=function(t){return function(e){s.metadata.define(s.metadata.invoker,t,e)}},e.invokeAsFactory=function(e){var t=function(e){s.metadata.define(s.metadata.invoker,_.instance,e)};return e?t(e):t},e.registration=w,e.transient=function(e){return w(new E(e))},e.singleton=function(e){var t=!(arguments.length<=1||void 0===arguments[1])&&arguments[1];return w(new S(e,t))},e.autoinject=function(e){var t=function(e){var t=e.inject?e.inject.slice():null,n=s.metadata.getOwn(s.metadata.paramTypes,e)||T;if(t){for(var r=0;r<n.length;r++)if(t[r]&&t[r]!==n[r]){var i=t.indexOf(n[r]);-1<i&&t.splice(i,1),t.splice(-1<i&&i<r?r-1:r,0,n[r])}else t[r]||(t[r]=n[r]);e.inject=t}else e.inject=n};return e?t(e):t},e.inject=function(){for(var e=arguments.length,o=Array(e),t=0;t<e;t++)o[t]=arguments[t];return function(e,t,n){if("number"==typeof n&&1===o.length){var r=e.inject;if("function"==typeof r)throw new Error('Decorator inject cannot be used with "inject()".  Please use an array instead.');return r||(r=s.metadata.getOwn(s.metadata.paramTypes,e).slice(),e.inject=r),void(r[n]=o[0])}if(n){var i=n.value;i.inject=o}else e.inject=o}};var h=e.resolver=s.protocol.create("aurelia:resolver",function(e){return"function"==typeof e.get||"Resolvers must implement: get(container: Container, key: any): any"}),f=e.Lazy=h()(t=function(){function t(e){this._key=e}return t.prototype.get=function(e){var t=this;return function(){return e.get(t._key)}},t.of=function(e){return new t(e)},t}())||t,d=e.All=h()(n=function(){function t(e){this._key=e}return t.prototype.get=function(e){return e.getAll(this._key)},t.of=function(e){return new t(e)},t}())||n,p=e.Optional=h()(r=function(){function t(e){var t=arguments.length<=1||void 0===arguments[1]||arguments[1];this._key=e,this._checkParent=t}return t.prototype.get=function(e){return e.hasResolver(this._key,this._checkParent)?e.get(this._key):null},t.of=function(e){return new t(e,arguments.length<=1||void 0===arguments[1]||arguments[1])},t}())||r,v=e.Parent=h()(o=function(){function t(e){this._key=e}return t.prototype.get=function(e){return e.parent?e.parent.get(this._key):null},t.of=function(e){return new t(e)},t}())||o,m=e.StrategyResolver=h()(a=function(){function e(e,t){this.strategy=e,this.state=t}return e.prototype.get=function(e,t){switch(this.strategy){case 0:return this.state;case 1:var n=e.invoke(this.state);return this.state=n,this.strategy=0,n;case 2:return e.invoke(this.state);case 3:return this.state(e,t,this);case 4:return this.state[0].get(e,t);case 5:return e.get(this.state);default:throw new Error("Invalid strategy: "+this.strategy)}},e}())||a,g=e.Factory=h()(u=function(){function t(e){this._key=e}return t.prototype.get=function(r){var i=this;return function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.invoke(i._key,t)}},t.of=function(e){return new t(e)},t}())||u,y=e.NewInstance=h()(c=function(){function i(e){this.key=e,this.asKey=e;for(var t=arguments.length,n=Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.dynamicDependencies=n}return i.prototype.get=function(t){var e=0<this.dynamicDependencies.length?this.dynamicDependencies.map(function(e){return e["protocol:aurelia:resolver"]?e.get(t):t.get(e)}):void 0,n=t.invoke(this.key,e);return t.registerInstance(this.asKey,n),n},i.prototype.as=function(e){return this.asKey=e,this},i.of=function(e){for(var t=arguments.length,n=Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return new(Function.prototype.bind.apply(i,[null].concat([e],n)))},i}())||c;function b(e,t){var n=e.inject;if("function"==typeof n)throw new Error("Decorator "+t+' cannot be used with "inject()".  Please use an array instead.');return n||(n=s.metadata.getOwn(s.metadata.paramTypes,e).slice(),e.inject=n),n}var _=e.FactoryInvoker=function(){function e(){}return e.prototype.invoke=function(e,t,n){for(var r=n.length,i=new Array(r);r--;)i[r]=e.get(n[r]);return t.apply(void 0,i)},e.prototype.invokeWithDynamicDependencies=function(e,t,n,r){for(var i=n.length,o=new Array(i);i--;)o[i]=e.get(n[i]);return void 0!==r&&(o=o.concat(r)),t.apply(void 0,o)},e}();function w(t){return function(e){s.metadata.define(s.metadata.registration,t,e)}}_.instance=new _;var E=e.TransientRegistration=function(){function e(e){this._key=e}return e.prototype.registerResolver=function(e,t,n){var r=e.getResolver(this._key||t);return void 0===r?e.registerTransient(this._key||t,n):r},e}(),S=e.SingletonRegistration=function(){function e(e){var t=!(arguments.length<=1||void 0===arguments[1])&&arguments[1];"boolean"==typeof e?this._registerInChild=e:(this._key=e,this._registerInChild=t)}return e.prototype.registerResolver=function(e,t,n){var r=this._registerInChild?e:e.root,i=r.getResolver(this._key||t);return void 0===i?r.registerSingleton(this._key||t,n):i},e}();function C(e){if(null==e)throw new Error("key/value cannot be null or undefined. Are you trying to inject/register something that doesn't exist with DI?")}var T=e._emptyParameters=Object.freeze([]);s.metadata.registration="aurelia:registration",s.metadata.invoker="aurelia:invoker";var O=h.decorates,R=e.InvocationHandler=function(){function e(e,t,n){this.fn=e,this.invoker=t,this.dependencies=n}return e.prototype.invoke=function(e,t){return void 0!==t?this.invoker.invokeWithDynamicDependencies(e,this.fn,this.dependencies,t):this.invoker.invoke(e,this.fn,this.dependencies)},e}();function A(e,t,n,r){for(var i=n.length,o=new Array(i),a=void 0;i--;){if(null==(a=n[i]))throw new Error("Constructor Parameter with index "+i+" cannot be null or undefined. Are you trying to inject/register something that doesn't exist with DI?");o[i]=e.get(a)}return void 0!==r&&(o=o.concat(r)),Reflect.construct(t,o)}var I=((l={})[0]={invoke:function(e,t){return new t},invokeWithDynamicDependencies:A},l[1]={invoke:function(e,t,n){return new t(e.get(n[0]))},invokeWithDynamicDependencies:A},l[2]={invoke:function(e,t,n){return new t(e.get(n[0]),e.get(n[1]))},invokeWithDynamicDependencies:A},l[3]={invoke:function(e,t,n){return new t(e.get(n[0]),e.get(n[1]),e.get(n[2]))},invokeWithDynamicDependencies:A},l[4]={invoke:function(e,t,n){return new t(e.get(n[0]),e.get(n[1]),e.get(n[2]),e.get(n[3]))},invokeWithDynamicDependencies:A},l[5]={invoke:function(e,t,n){return new t(e.get(n[0]),e.get(n[1]),e.get(n[2]),e.get(n[3]),e.get(n[4]))},invokeWithDynamicDependencies:A},l.fallback={invoke:A,invokeWithDynamicDependencies:A},l);e.Container=function(){function r(e){void 0===e&&(e={}),this._configuration=e,this._onHandlerCreated=e.onHandlerCreated,this._handlers=e.handlers||(e.handlers=new Map),this._resolvers=new Map,(this.root=this).parent=null}return r.prototype.makeGlobal=function(){return r.instance=this},r.prototype.setHandlerCreatedCallback=function(e){this._onHandlerCreated=e,this._configuration.onHandlerCreated=e},r.prototype.registerInstance=function(e,t){return this.registerResolver(e,new m(0,void 0===t?e:t))},r.prototype.registerSingleton=function(e,t){return this.registerResolver(e,new m(1,void 0===t?e:t))},r.prototype.registerTransient=function(e,t){return this.registerResolver(e,new m(2,void 0===t?e:t))},r.prototype.registerHandler=function(e,t){return this.registerResolver(e,new m(3,t))},r.prototype.registerAlias=function(e,t){return this.registerResolver(t,new m(5,e))},r.prototype.registerResolver=function(e,t){C(e);var n=this._resolvers,r=n.get(e);return void 0===r?n.set(e,t):4===r.strategy?r.state.push(t):n.set(e,new m(4,[r,t])),t},r.prototype.autoRegister=function(e,t){if("function"==typeof(t=void 0===t?e:t)){var n=s.metadata.get(s.metadata.registration,t);return void 0===n?this.registerResolver(e,new m(1,t)):n.registerResolver(this,e,t)}return this.registerResolver(e,new m(0,t))},r.prototype.autoRegisterAll=function(e){for(var t=e.length;t--;)this.autoRegister(e[t])},r.prototype.unregister=function(e){this._resolvers.delete(e)},r.prototype.hasResolver=function(e){var t=!(arguments.length<=1||void 0===arguments[1])&&arguments[1];return C(e),this._resolvers.has(e)||t&&null!==this.parent&&this.parent.hasResolver(e,t)},r.prototype.getResolver=function(e){return this._resolvers.get(e)},r.prototype.get=function(e){if(C(e),e===r)return this;if(O(e))return e.get(this,e);var t=this._resolvers.get(e);if(void 0===t){if(null===this.parent)return this.autoRegister(e).get(this,e);var n=s.metadata.get(s.metadata.registration,e);return void 0===n?this.parent._get(e):n.registerResolver(this,e,e).get(this,e)}return t.get(this,e)},r.prototype._get=function(e){var t=this._resolvers.get(e);return void 0===t?null===this.parent?this.autoRegister(e).get(this,e):this.parent._get(e):t.get(this,e)},r.prototype.getAll=function(e){C(e);var t=this._resolvers.get(e);if(void 0===t)return null===this.parent?T:this.parent.getAll(e);if(4===t.strategy){for(var n=t.state,r=n.length,i=new Array(r);r--;)i[r]=n[r].get(this,e);return i}return[t.get(this,e)]},r.prototype.createChild=function(){var e=new r(this._configuration);return e.root=this.root,e.parent=this,e},r.prototype.invoke=function(t,e){try{var n=this._handlers.get(t);return void 0===n&&(n=this._createInvocationHandler(t),this._handlers.set(t,n)),n.invoke(this,e)}catch(e){throw new i.AggregateError("Error invoking "+t.name+". Check the inner error for details.",e,!0)}},r.prototype._createInvocationHandler=function(e){var t,n=void 0;if(void 0===e.inject)n=s.metadata.getOwn(s.metadata.paramTypes,e)||T;else{n=[];for(var r=e;"function"==typeof r;){var i;(i=n).push.apply(i,(t=r).hasOwnProperty("inject")?"function"==typeof t.inject?t.inject():t.inject:[]),r=Object.getPrototypeOf(r)}}var o=s.metadata.getOwn(s.metadata.invoker,e)||I[n.length]||I.fallback,a=new R(e,o,n);return void 0!==this._onHandlerCreated?this._onHandlerCreated(a):a},r}()}),define("aurelia-bootstrapper",["module","exports","aurelia-pal","aurelia-polyfills"],function(n,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.starting=void 0,e.bootstrap=h;var s=[],t=void 0,r=new Promise(function(e){return t=e}),u=i.PLATFORM.global,o="undefined"!=typeof process&&!process.browser;function a(){if(i.PLATFORM.Loader)return Promise.resolve(new i.PLATFORM.Loader);if("undefined"==typeof AURELIA_WEBPACK_2_0){if("undefined"!=typeof __webpack_require__){var e=__webpack_require__(require.resolve("aurelia-loader-webpack"));return Promise.resolve(new e.WebpackLoader)}if(u.System&&"function"==typeof u.System.config)return u.System.normalize("aurelia-bootstrapper").then(function(e){return u.System.normalize("aurelia-loader-default",e)}).then(function(e){return u.System.import(e).then(function(e){return new e.DefaultLoader})});if("function"==typeof u.require&&"string"==typeof u.require.version)return new Promise(function(t,e){return u.require(["aurelia-loader-default"],function(e){return t(new e.DefaultLoader)},e)});if(o&&void 0!==n&&void 0!==n.require){var t=n.require("aurelia-loader-nodejs");return Promise.resolve(new t.NodeJsLoader)}}return Promise.reject("No PLATFORM.Loader is defined and there is neither a System API (ES6) or a Require API (AMD) globally available to load your app.")}function c(n){var r=function(t,e){return n.normalize(t,e).then(function(e){return n.map(t,e),e})};return function(e){var t=void 0,n=o&&("renderer"===process.type||process.versions["node-webkit"]);if(o&&!n)t="nodejs";else if("undefined"!=typeof window)t="browser";else{if("undefined"==typeof self)throw new Error("Could not determine platform implementation to load.");t="worker"}return e.loadModule("aurelia-pal-"+t).then(function(e){return"nodejs"===t&&!i.isInitialized&&e.globalize()||e.initialize()})}(n).then(function(){return n.normalize("aurelia-bootstrapper")}).then(function(e){var t=r(i.PLATFORM.moduleName("aurelia-framework",{exports:["Aurelia"]}),e);return Promise.all([t,t.then(function(e){return r("aurelia-dependency-injection",e)}),r("aurelia-router",e),r("aurelia-logging-console",e)])}).then(function(e){var t=e[0];return n.loadModule(t)}).then(function(e){return t(function(){return new e.Aurelia(n)})})}function l(e,t,n){return n.host=e,n.configModuleId=t||null,t?n.loader.loadModule(t).then(function(e){if(!e.configure)throw new Error("Cannot initialize module '"+t+"' without a configure function.");return e.configure(n)}):(n.use.standardConfiguration().developmentLogging(),n.start().then(function(){return n.setRoot()}))}function h(t){var e=r.then(function(e){return t(e())});return s&&s.push(e),e}e.starting=(u.document&&"complete"!==u.document.readyState?new Promise(function(e){function t(){u.document.removeEventListener("DOMContentLoaded",t),u.removeEventListener("load",t),e()}u.document.addEventListener("DOMContentLoaded",t),u.addEventListener("load",t)}):Promise.resolve()).then(a).then(c).then(function(){for(var e=u.document.querySelectorAll("[aurelia-app],[data-aurelia-app]"),t=0,n=e.length;t<n;++t){var r=e[t],i=r.getAttribute("aurelia-app")||r.getAttribute("data-aurelia-app");h(l.bind(null,r,i))}var o=console.error.bind(console),a=s.map(function(e){return e.catch(o)});return s=null,Promise.all(a)})}),define("aurelia-binding",["exports","aurelia-logging","aurelia-pal","aurelia-task-queue","aurelia-metadata"],function(e,t,s,n,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getSetObserver=e.BindingEngine=e.NameExpression=e.Listener=e.ListenerExpression=e.BindingBehaviorResource=e.ValueConverterResource=e.Call=e.CallExpression=e.Binding=e.BindingExpression=e.ObjectObservationAdapter=e.ObserverLocator=e.SVGAnalyzer=e.presentationAttributes=e.presentationElements=e.elements=e.ComputedExpression=e.ClassObserver=e.SelectValueObserver=e.CheckedObserver=e.ValueAttributeObserver=e.StyleObserver=e.DataAttributeObserver=e.dataAttributeAccessor=e.XLinkAttributeObserver=e.SetterObserver=e.PrimitiveObserver=e.propertyAccessor=e.DirtyCheckProperty=e.DirtyChecker=e.EventSubscriber=e.EventManager=e.delegationStrategy=e.getMapObserver=e.ParserImplementation=e.Parser=e.bindingMode=e.ExpressionCloner=e.Unparser=e.LiteralObject=e.LiteralArray=e.LiteralString=e.LiteralPrimitive=e.PrefixNot=e.Binary=e.CallFunction=e.CallMember=e.CallScope=e.AccessKeyed=e.AccessMember=e.AccessScope=e.AccessThis=e.Conditional=e.Assign=e.ValueConverter=e.BindingBehavior=e.Chain=e.Expression=e.getArrayObserver=e.CollectionLengthObserver=e.ModifyCollectionObserver=e.ExpressionObserver=e.sourceContext=e.targetContext=void 0,e.camelCase=O,e.createOverrideContext=R,e.getContextFor=A,e.createScopeForTest=function(e,t){if(t)return{bindingContext:e,overrideContext:R(e,R(t))};return{bindingContext:e,overrideContext:R(e)}},e.connectable=L,e.enqueueBindingConnect=G,e.subscriberCollection=ee,e.calcSplices=oe,e.mergeSplice=ae,e.projectArraySplices=se,e.getChangeRecords=ue,e.cloneExpression=function(e){var t=new qe;return e.accept(t)},e.hasDeclaredDependencies=br,e.declarePropertyDependencies=function(e,t,n){Object.getOwnPropertyDescriptor(e.prototype,t).get.dependencies=n},e.computedFrom=function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return function(e,t,n){return n.get.dependencies=r,n}},e.createComputedObserver=wr,e.valueConverter=function(t){if(void 0===t||"string"==typeof t)return function(e){r.metadata.define(r.metadata.resource,new Dr(t),e)};r.metadata.define(r.metadata.resource,new Dr,t)},e.bindingBehavior=function(t){if(void 0===t||"string"==typeof t)return function(e){r.metadata.define(r.metadata.resource,new Mr(t),e)};r.metadata.define(r.metadata.resource,new Mr,t)},e.observable=function(r,e,t){function i(e,n,t,r){var i=void 0===n;i&&(e=e.prototype,n="string"==typeof r?r:r.name);var o="_"+n,a={configurable:!0,enumerable:!1,writable:!0},s=r&&r.changeHandler||n+"Changed";if(t?"function"==typeof t.initializer&&(a.value=t.initializer()):t={},"enumerable"in t||(t.enumerable=!0),delete t.value,delete t.writable,delete t.initializer,Reflect.defineProperty(e,o,a),t.get=function(){return this[o]},t.set=function(e){var t=this[o];e!==t&&(this[o]=e,Reflect.defineProperty(this,o,{enumerable:!1}),this[s]&&this[s](e,t,n))},t.get.dependencies=[o],!i)return t;Reflect.defineProperty(e,n,t)}if(void 0===e)return function(e,t,n){return i(e,t,n,r)};return i(r,e,t)},e.connectBindingToSignal=Hr,e.signalBindings=function(e){Wr.hasOwnProperty(e)&&Wr[e]++};var o=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}}(t);var i,a,u,c,l,h,f,d,p,v,m,g,y,b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();function w(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function E(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var S=e.targetContext="Binding:target",C=e.sourceContext="Binding:source",T=Object.create(null);function O(e){if(e in T)return T[e];var t=e.charAt(0).toLowerCase()+e.slice(1).replace(/[_.-](\w|$)/g,function(e,t){return t.toUpperCase()});return T[e]=t}function R(e,t){return{bindingContext:e,parentOverrideContext:t||null}}function A(e,t,n){var r=t.overrideContext;if(n){for(;n&&r;)n--,r=r.parentOverrideContext;if(n||!r)return;return e in r?r:r.bindingContext}for(;r&&!(e in r)&&!(r.bindingContext&&e in r.bindingContext);)r=r.parentOverrideContext;return r?e in r?r:r.bindingContext:t.bindingContext||t.overrideContext}for(var I=[],N=[],k=0;k<100;k++)I.push("_observer"+k),N.push("_observerVersion"+k);function P(e){for(var t=void 0===this._observerSlots?0:this._observerSlots,n=t;n--&&this[I[n]]!==e;);if(-1===n){for(n=0;this[I[n]];)n++;(this[I[n]]=e).subscribe(C,this),n===t&&(this._observerSlots=n+1)}void 0===this._version&&(this._version=0),this[N[n]]=this._version}function x(e,t){var n=this.observerLocator.getObserver(e,t);P.call(this,n)}function D(e){var t=this.observerLocator.getArrayObserver(e);P.call(this,t)}function M(e){for(var t=this._observerSlots;t--;)if(e||this[N[t]]!==this._version){var n=this[I[t]];this[I[t]]=null,n&&n.unsubscribe(C,this)}}function L(){return function(e){e.prototype.observeProperty=x,e.prototype.observeArray=D,e.prototype.unobserve=M,e.prototype.addObserver=P}}var F=[],V={},j=0,U=100,B=15,q=!1,W=0;function H(e){for(var t=F.length,n=0;n<t;){var r=F[n];if(V[r.__connectQueueId]=!1,r.connect(!0),++n%100==0&&s.PLATFORM.performance.now()-e>B)break}F.splice(0,n),F.length?s.PLATFORM.requestAnimationFrame(H):(q=!1,W=0)}function G(e){if(W<U)W++,e.connect(!1);else{var t=e.__connectQueueId;void 0===t&&(t=j,j++,e.__connectQueueId=t),V[t]||(F.push(e),V[t]=!0)}q||(q=!0,s.PLATFORM.requestAnimationFrame(H))}function K(e,t){return!this.hasSubscriber(e,t)&&(this._context0?this._context1?this._context2?this._contextsRest?(this._contextsRest.push(e),this._callablesRest.push(t)):(this._contextsRest=[e],this._callablesRest=[t]):(this._context2=e,this._callable2=t):(this._context1=e,this._callable1=t):(this._context0=e,this._callable0=t),!0)}function $(e,t){if(this._context0===e&&this._callable0===t)return this._context0=null,!(this._callable0=null);if(this._context1===e&&this._callable1===t)return this._context1=null,!(this._callable1=null);if(this._context2===e&&this._callable2===t)return this._context2=null,!(this._callable2=null);var n=this._callablesRest;if(void 0===n||0===n.length)return!1;for(var r=this._contextsRest,i=0;(n[i]!==t||r[i]!==e)&&n.length>i;)i++;return!(i>=n.length)&&(r.splice(i,1),n.splice(i,1),!0)}var z=[],Q=[],Y=[];function X(e,t){var n=this._context0,r=this._callable0,i=this._context1,o=this._callable1,a=this._context2,s=this._callable2,u=this._contextsRest?this._contextsRest.length:0,c=void 0,l=void 0,h=void 0,f=void 0;if(u){for(h=Y.length;h--&&Y[h];);for(h<0?(h=Y.length,c=[],l=[],Y.push(!0),z.push(c),Q.push(l)):(Y[h]=!0,c=z[h],l=Q[h]),f=u;f--;)c[f]=this._contextsRest[f],l[f]=this._callablesRest[f]}if(n&&(r?r.call(n,e,t):n(e,t)),i&&(o?o.call(i,e,t):i(e,t)),a&&(s?s.call(a,e,t):a(e,t)),u){for(f=0;f<u;f++){var d=l[f],p=c[f];d?d.call(p,e,t):p(e,t),c[f]=null,l[f]=null}Y[h]=!1}}function J(){return!!(this._context0||this._context1||this._context2||this._contextsRest&&this._contextsRest.length)}function Z(e,t){if(this._context0===e&&this._callable0===t||this._context1===e&&this._callable1===t||this._context2===e&&this._callable2===t)return!0;var n=void 0,r=this._contextsRest;if(!r||0===(n=r.length))return!1;for(var i=this._callablesRest;n--;)if(r[n]===e&&i[n]===t)return!0;return!1}function ee(){return function(e){e.prototype.addSubscriber=K,e.prototype.removeSubscriber=$,e.prototype.callSubscribers=X,e.prototype.hasSubscribers=J,e.prototype.hasSubscriber=Z}}var te=e.ExpressionObserver=L()(i=ee()(i=function(){function e(e,t,n,r){this.scope=e,this.expression=t,this.observerLocator=n,this.lookupFunctions=r}return e.prototype.getValue=function(){return this.expression.evaluate(this.scope,this.lookupFunctions)},e.prototype.setValue=function(e){this.expression.assign(this.scope,e)},e.prototype.subscribe=function(e,t){var n=this;if(this.hasSubscribers()||(this.oldValue=this.expression.evaluate(this.scope,this.lookupFunctions),this.expression.connect(this,this.scope)),this.addSubscriber(e,t),1===arguments.length&&e instanceof Function)return{dispose:function(){n.unsubscribe(e,t)}}},e.prototype.unsubscribe=function(e,t){this.removeSubscriber(e,t)&&!this.hasSubscribers()&&(this.unobserve(!0),this.oldValue=void 0)},e.prototype.call=function(){var e=this.expression.evaluate(this.scope,this.lookupFunctions),t=this.oldValue;e!==t&&(this.oldValue=e,this.callSubscribers(e,t)),this._version++,this.expression.connect(this,this.scope),this.unobserve(!1)},e}())||i)||i;function ne(e,t,n){return{index:e,removed:t,addedCount:n}}function re(){}re.prototype={calcEditDistances:function(e,t,n,r,i,o){for(var a=o-i+1,s=n-t+1,u=new Array(a),c=void 0,l=void 0,h=0;h<a;++h)u[h]=new Array(s),u[h][0]=h;for(var f=0;f<s;++f)u[0][f]=f;for(var d=1;d<a;++d)for(var p=1;p<s;++p)this.equals(e[t+p-1],r[i+d-1])?u[d][p]=u[d-1][p-1]:(c=u[d-1][p]+1,l=u[d][p-1]+1,u[d][p]=c<l?c:l);return u},spliceOperationsFromEditDistances:function(e){for(var t=e.length-1,n=e[0].length-1,r=e[t][n],i=[];0<t||0<n;)if(0!==t)if(0!==n){var o=e[t-1][n-1],a=e[t-1][n],s=e[t][n-1],u=void 0;(u=a<s?a<o?a:o:s<o?s:o)===o?(o===r?i.push(0):(i.push(1),r=o),t--,n--):u===a?(i.push(3),t--,r=a):(i.push(2),n--,r=s)}else i.push(3),t--;else i.push(2),n--;return i.reverse(),i},calcSplices:function(e,t,n,r,i,o){var a=0,s=0,u=Math.min(n-t,o-i);if(0===t&&0===i&&(a=this.sharedPrefix(e,r,u)),n===e.length&&o===r.length&&(s=this.sharedSuffix(e,r,u-a)),i+=a,o-=s,(n-=s)-(t+=a)==0&&o-i==0)return[];if(t===n){for(var c=ne(t,[],0);i<o;)c.removed.push(r[i++]);return[c]}if(i===o)return[ne(t,[],n-t)];for(var l=this.spliceOperationsFromEditDistances(this.calcEditDistances(e,t,n,r,i,o)),h=void 0,f=[],d=t,p=i,v=0;v<l.length;++v)switch(l[v]){case 0:h&&(f.push(h),h=void 0),d++,p++;break;case 1:h||(h=ne(d,[],0)),h.addedCount++,d++,h.removed.push(r[p]),p++;break;case 2:h||(h=ne(d,[],0)),h.addedCount++,d++;break;case 3:h||(h=ne(d,[],0)),h.removed.push(r[p]),p++}return h&&f.push(h),f},sharedPrefix:function(e,t,n){for(var r=0;r<n;++r)if(!this.equals(e[r],t[r]))return r;return n},sharedSuffix:function(e,t,n){for(var r=e.length,i=t.length,o=0;o<n&&this.equals(e[--r],t[--i]);)o++;return o},calculateSplices:function(e,t){return this.calcSplices(e,0,e.length,t,0,t.length)},equals:function(e,t){return e===t}};var ie=new re;function oe(e,t,n,r,i,o){return ie.calcSplices(e,t,n,r,i,o)}function ae(e,t,n,r){for(var i,o,a,s,u=ne(t,n,r),c=!1,l=0,h=0;h<e.length;h++){var f=e[h];if(f.index+=l,!c){var d=(i=u.index,o=u.index+u.removed.length,a=f.index,s=f.index+f.addedCount,o<a||s<i?-1:o===a||s===i?0:i<a?o<s?o-a:s-a:s<o?s-i:o-i);if(0<=d){e.splice(h,1),h--,l-=f.addedCount-f.removed.length,u.addedCount+=f.addedCount-d;var p=u.removed.length+f.removed.length-d;if(u.addedCount||p){var v=f.removed;if(u.index<f.index){var m=u.removed.slice(0,f.index-u.index);Array.prototype.push.apply(m,v),v=m}if(u.index+u.removed.length>f.index+f.addedCount){var g=u.removed.slice(f.index+f.addedCount-u.index);Array.prototype.push.apply(v,g)}u.removed=v,f.index<u.index&&(u.index=f.index)}else c=!0}else if(u.index<f.index){c=!0,e.splice(h,0,u),h++;var y=u.addedCount-u.removed.length;f.index+=y,l+=y}}}c||e.push(u)}function se(t,e){var n=[];return function(e,t){for(var n,r=[],i=0;i<t.length;i++){var o=t[i];switch(o.type){case"splice":ae(r,o.index,o.removed.slice(),o.addedCount);break;case"add":case"update":case"delete":if(+(n=o.name)!=n>>>0)continue;var a=+o.name;if(a<0)continue;ae(r,a,[o.oldValue],"delete"===o.type?0:1);break;default:console.error("Unexpected record type: "+JSON.stringify(o))}}return r}(0,e).forEach(function(e){1!==e.addedCount||1!==e.removed.length?n=n.concat(oe(t,e.index,e.index+e.addedCount,e.removed,0,e.removed.length)):e.removed[0]!==t[e.index]&&n.push(e)}),n}function ue(e){for(var t,n,r,i=new Array(e.size),o=e.keys(),a=0,s=void 0;(s=o.next())&&!s.done;)i[a]=(t="added",n=e,r=s.value,{type:t,object:n,key:r,oldValue:void 0}),a++;return i}var ce=e.ModifyCollectionObserver=ee()(a=function(){function e(e,t){this.taskQueue=e,this.queued=!1,this.changeRecords=null,this.oldCollection=null,this.collection=t,this.lengthPropertyName=t instanceof Map||t instanceof Set?"size":"length"}return e.prototype.subscribe=function(e,t){this.addSubscriber(e,t)},e.prototype.unsubscribe=function(e,t){this.removeSubscriber(e,t)},e.prototype.addChangeRecord=function(e){if(this.hasSubscribers()||this.lengthObserver){if("splice"===e.type){var t=e.index,n=e.object.length;n<t?t=n-e.addedCount:t<0&&(t=n+e.removed.length+t-e.addedCount),t<0&&(t=0),e.index=t}null===this.changeRecords?this.changeRecords=[e]:this.changeRecords.push(e),this.queued||(this.queued=!0,this.taskQueue.queueMicroTask(this))}},e.prototype.flushChangeRecords=function(){(this.changeRecords&&this.changeRecords.length||this.oldCollection)&&this.call()},e.prototype.reset=function(e){this.oldCollection=e,this.hasSubscribers()&&!this.queued&&(this.queued=!0,this.taskQueue.queueMicroTask(this))},e.prototype.getLengthObserver=function(){return this.lengthObserver||(this.lengthObserver=new le(this.collection))},e.prototype.call=function(){var e=this.changeRecords,t=this.oldCollection,n=void 0;this.queued=!1,this.changeRecords=[],this.oldCollection=null,this.hasSubscribers()&&(n=t?this.collection instanceof Map||this.collection instanceof Set?ue(t):oe(this.collection,0,this.collection.length,t,0,t.length):this.collection instanceof Map||this.collection instanceof Set?e:se(this.collection,e),this.callSubscribers(n)),this.lengthObserver&&this.lengthObserver.call(this.collection[this.lengthPropertyName])},e}())||a,le=e.CollectionLengthObserver=ee()(u=function(){function e(e){this.collection=e,this.lengthPropertyName=e instanceof Map||e instanceof Set?"size":"length",this.currentValue=e[this.lengthPropertyName]}return e.prototype.getValue=function(){return this.collection[this.lengthPropertyName]},e.prototype.setValue=function(e){this.collection[this.lengthPropertyName]=e},e.prototype.subscribe=function(e,t){this.addSubscriber(e,t)},e.prototype.unsubscribe=function(e,t){this.removeSubscriber(e,t)},e.prototype.call=function(e){var t=this.currentValue;this.callSubscribers(e,t),this.currentValue=e},e}())||u,he=Array.prototype.pop,fe=Array.prototype.push,de=Array.prototype.reverse,pe=Array.prototype.shift,ve=Array.prototype.sort,me=Array.prototype.splice,ge=Array.prototype.unshift;function ye(e,t){return be.for(e,t)}Array.prototype.pop=function(){var e=0<this.length,t=he.apply(this,arguments);return e&&void 0!==this.__array_observer__&&this.__array_observer__.addChangeRecord({type:"delete",object:this,name:this.length,oldValue:t}),t},Array.prototype.push=function(){var e=fe.apply(this,arguments);return void 0!==this.__array_observer__&&this.__array_observer__.addChangeRecord({type:"splice",object:this,index:this.length-arguments.length,removed:[],addedCount:arguments.length}),e},Array.prototype.reverse=function(){var e=void 0;void 0!==this.__array_observer__&&(this.__array_observer__.flushChangeRecords(),e=this.slice());var t=de.apply(this,arguments);return void 0!==this.__array_observer__&&this.__array_observer__.reset(e),t},Array.prototype.shift=function(){var e=0<this.length,t=pe.apply(this,arguments);return e&&void 0!==this.__array_observer__&&this.__array_observer__.addChangeRecord({type:"delete",object:this,name:0,oldValue:t}),t},Array.prototype.sort=function(){var e=void 0;void 0!==this.__array_observer__&&(this.__array_observer__.flushChangeRecords(),e=this.slice());var t=ve.apply(this,arguments);return void 0!==this.__array_observer__&&this.__array_observer__.reset(e),t},Array.prototype.splice=function(){var e=me.apply(this,arguments);return void 0!==this.__array_observer__&&this.__array_observer__.addChangeRecord({type:"splice",object:this,index:+arguments[0],removed:e,addedCount:2<arguments.length?arguments.length-2:0}),e},Array.prototype.unshift=function(){var e=ge.apply(this,arguments);return void 0!==this.__array_observer__&&this.__array_observer__.addChangeRecord({type:"splice",object:this,index:0,removed:[],addedCount:arguments.length}),e},e.getArrayObserver=ye;var be=function(n){function r(e,t){return w(this,n.call(this,e,t))}return E(r,n),r.for=function(e,t){return"__array_observer__"in t||Reflect.defineProperty(t,"__array_observer__",{value:r.create(e,t),enumerable:!1,configurable:!1}),t.__array_observer__},r.create=function(e,t){return new r(e,t)},r}(ce),_e=e.Expression=function(){function e(){this.isChain=!1,this.isAssignable=!1}return e.prototype.evaluate=function(e,t,n){throw new Error('Binding expression "'+this+'" cannot be evaluated.')},e.prototype.assign=function(e,t,n){throw new Error('Binding expression "'+this+'" cannot be assigned to.')},e.prototype.toString=function(){return"undefined"==typeof FEATURE_NO_UNPARSER?Be.unparse(this):Function.prototype.toString.call(this)},e}(),we=e.Chain=function(n){function e(e){var t=w(this,n.call(this));return t.expressions=e,t.isChain=!0,t}return E(e,n),e.prototype.evaluate=function(e,t){for(var n=void 0,r=this.expressions,i=void 0,o=0,a=r.length;o<a;++o)null!==(i=r[o].evaluate(e,t))&&(n=i);return n},e.prototype.accept=function(e){return e.visitChain(this)},e}(_e),Ee=e.BindingBehavior=function(i){function e(e,t,n){var r=w(this,i.call(this));return r.expression=e,r.name=t,r.args=n,r}return E(e,i),e.prototype.evaluate=function(e,t){return this.expression.evaluate(e,t)},e.prototype.assign=function(e,t,n){return this.expression.assign(e,t,n)},e.prototype.accept=function(e){return e.visitBindingBehavior(this)},e.prototype.connect=function(e,t){this.expression.connect(e,t)},e.prototype.bind=function(e,t,n){this.expression.expression&&this.expression.bind&&this.expression.bind(e,t,n);var r=n.bindingBehaviors(this.name);if(!r)throw new Error('No BindingBehavior named "'+this.name+'" was found!');var i="behavior-"+this.name;if(e[i])throw new Error('A binding behavior named "'+this.name+'" has already been applied to "'+this.expression+'"');(e[i]=r).bind.apply(r,[e,t].concat(je(t,this.args,e.lookupFunctions)))},e.prototype.unbind=function(e,t){var n="behavior-"+this.name;e[n].unbind(e,t),e[n]=null,this.expression.expression&&this.expression.unbind&&this.expression.unbind(e,t)},e}(_e),Se=e.ValueConverter=function(i){function e(e,t,n){var r=w(this,i.call(this));return r.expression=e,r.name=t,r.args=n,r.allArgs=[e].concat(n),r}return E(e,i),e.prototype.evaluate=function(e,t){var n=t.valueConverters(this.name);if(!n)throw new Error('No ValueConverter named "'+this.name+'" was found!');return"toView"in n?n.toView.apply(n,je(e,this.allArgs,t)):this.allArgs[0].evaluate(e,t)},e.prototype.assign=function(e,t,n){var r=n.valueConverters(this.name);if(!r)throw new Error('No ValueConverter named "'+this.name+'" was found!');return"fromView"in r&&(t=r.fromView.apply(r,[t].concat(je(e,this.args,n)))),this.allArgs[0].assign(e,t,n)},e.prototype.accept=function(e){return e.visitValueConverter(this)},e.prototype.connect=function(e,t){for(var n=this.allArgs,r=n.length;r--;)n[r].connect(e,t);var i=e.lookupFunctions.valueConverters(this.name);if(!i)throw new Error('No ValueConverter named "'+this.name+'" was found!');var o=i.signals;if(void 0!==o)for(r=o.length;r--;)Hr(e,o[r])},e}(_e),Ce=e.Assign=function(r){function e(e,t){var n=w(this,r.call(this));return n.target=e,n.value=t,n.isAssignable=!0,n}return E(e,r),e.prototype.evaluate=function(e,t){return this.target.assign(e,this.value.evaluate(e,t))},e.prototype.accept=function(e){e.visitAssign(this)},e.prototype.connect=function(e,t){},e.prototype.assign=function(e,t){this.value.assign(e,t),this.target.assign(e,t)},e}(_e),Te=e.Conditional=function(i){function e(e,t,n){var r=w(this,i.call(this));return r.condition=e,r.yes=t,r.no=n,r}return E(e,i),e.prototype.evaluate=function(e,t){return this.condition.evaluate(e,t)?this.yes.evaluate(e,t):this.no.evaluate(e,t)},e.prototype.accept=function(e){return e.visitConditional(this)},e.prototype.connect=function(e,t){this.condition.connect(e,t),this.condition.evaluate(t)?this.yes.connect(e,t):this.no.connect(e,t)},e}(_e),Oe=e.AccessThis=function(n){function e(e){var t=w(this,n.call(this));return t.ancestor=e,t}return E(e,n),e.prototype.evaluate=function(e,t){for(var n=e.overrideContext,r=this.ancestor;r--&&n;)n=n.parentOverrideContext;return r<1&&n?n.bindingContext:void 0},e.prototype.accept=function(e){return e.visitAccessThis(this)},e.prototype.connect=function(e,t){},e}(_e),Re=e.AccessScope=function(r){function e(e,t){var n=w(this,r.call(this));return n.name=e,n.ancestor=t,n.isAssignable=!0,n}return E(e,r),e.prototype.evaluate=function(e,t){return A(this.name,e,this.ancestor)[this.name]},e.prototype.assign=function(e,t){var n=A(this.name,e,this.ancestor);return n?n[this.name]=t:void 0},e.prototype.accept=function(e){return e.visitAccessScope(this)},e.prototype.connect=function(e,t){var n=A(this.name,t,this.ancestor);e.observeProperty(n,this.name)},e}(_e),Ae=e.AccessMember=function(r){function e(e,t){var n=w(this,r.call(this));return n.object=e,n.name=t,n.isAssignable=!0,n}return E(e,r),e.prototype.evaluate=function(e,t){var n=this.object.evaluate(e,t);return null==n?n:n[this.name]},e.prototype.assign=function(e,t){var n=this.object.evaluate(e);return null==n&&(n={},this.object.assign(e,n)),n[this.name]=t},e.prototype.accept=function(e){return e.visitAccessMember(this)},e.prototype.connect=function(e,t){this.object.connect(e,t);var n=this.object.evaluate(t);n&&e.observeProperty(n,this.name)},e}(_e),Ie=e.AccessKeyed=function(r){function e(e,t){var n=w(this,r.call(this));return n.object=e,n.key=t,n.isAssignable=!0,n}return E(e,r),e.prototype.evaluate=function(e,t){return function(e,t){{if(Array.isArray(e))return e[parseInt(t,10)];if(e)return e[t];if(null==e)return}return e[t]}(this.object.evaluate(e,t),this.key.evaluate(e,t))},e.prototype.assign=function(e,t){return function(e,t,n){if(Array.isArray(e)){var r=parseInt(t,10);e.length<=r&&(e.length=r+1),e[r]=n}else e[t]=n;return n}(this.object.evaluate(e),this.key.evaluate(e),t)},e.prototype.accept=function(e){return e.visitAccessKeyed(this)},e.prototype.connect=function(e,t){this.object.connect(e,t);var n=this.object.evaluate(t);if(n instanceof Object){this.key.connect(e,t);var r=this.key.evaluate(t);null==r||Array.isArray(n)&&"number"==typeof r||e.observeProperty(n,r)}},e}(_e),Ne=e.CallScope=function(i){function e(e,t,n){var r=w(this,i.call(this));return r.name=e,r.args=t,r.ancestor=n,r}return E(e,i),e.prototype.evaluate=function(e,t,n){var r=je(e,this.args,t),i=A(this.name,e,this.ancestor),o=Ue(i,this.name,n);if(o)return o.apply(i,r)},e.prototype.accept=function(e){return e.visitCallScope(this)},e.prototype.connect=function(e,t){for(var n=this.args,r=n.length;r--;)n[r].connect(e,t)},e}(_e),ke=e.CallMember=function(i){function e(e,t,n){var r=w(this,i.call(this));return r.object=e,r.name=t,r.args=n,r}return E(e,i),e.prototype.evaluate=function(e,t,n){var r=this.object.evaluate(e,t),i=je(e,this.args,t),o=Ue(r,this.name,n);if(o)return o.apply(r,i)},e.prototype.accept=function(e){return e.visitCallMember(this)},e.prototype.connect=function(e,t){if(this.object.connect(e,t),Ue(this.object.evaluate(t),this.name,!1))for(var n=this.args,r=n.length;r--;)n[r].connect(e,t)},e}(_e),Pe=e.CallFunction=function(r){function e(e,t){var n=w(this,r.call(this));return n.func=e,n.args=t,n}return E(e,r),e.prototype.evaluate=function(e,t,n){var r=this.func.evaluate(e,t);if("function"==typeof r)return r.apply(null,je(e,this.args,t));if(n||null!=r)throw new Error(this.func+" is not a function")},e.prototype.accept=function(e){return e.visitCallFunction(this)},e.prototype.connect=function(e,t){if(this.func.connect(e,t),"function"==typeof this.func.evaluate(t))for(var n=this.args,r=n.length;r--;)n[r].connect(e,t)},e}(_e),xe=e.Binary=function(i){function e(e,t,n){var r=w(this,i.call(this));return r.operation=e,r.left=t,r.right=n,r}return E(e,i),e.prototype.evaluate=function(e,t){var n=this.left.evaluate(e,t);switch(this.operation){case"&&":return n&&this.right.evaluate(e,t);case"||":return n||this.right.evaluate(e,t)}var r=this.right.evaluate(e,t);switch(this.operation){case"==":return n==r;case"===":return n===r;case"!=":return n!=r;case"!==":return n!==r}if(null===n||null===r||void 0===n||void 0===r){switch(this.operation){case"+":return null!=n?n:null!=r?r:0;case"-":return null!=n?n:null!=r?0-r:0}return null}switch(this.operation){case"+":return function(e,t){if(null!==e&&null!==t)return"string"==typeof e&&"string"!=typeof t?e+t.toString():"string"!=typeof e&&"string"==typeof t?e.toString()+t:e+t;if(null!==e)return e;if(null!==t)return t;return 0}(n,r);case"-":return n-r;case"*":return n*r;case"/":return n/r;case"%":return n%r;case"<":return n<r;case">":return r<n;case"<=":return n<=r;case">=":return r<=n;case"^":return n^r}throw new Error("Internal error ["+this.operation+"] not handled")},e.prototype.accept=function(e){return e.visitBinary(this)},e.prototype.connect=function(e,t){this.left.connect(e,t);var n=this.left.evaluate(t);"&&"===this.operation&&!n||"||"===this.operation&&n||this.right.connect(e,t)},e}(_e),De=e.PrefixNot=function(r){function e(e,t){var n=w(this,r.call(this));return n.operation=e,n.expression=t,n}return E(e,r),e.prototype.evaluate=function(e,t){return!this.expression.evaluate(e,t)},e.prototype.accept=function(e){return e.visitPrefix(this)},e.prototype.connect=function(e,t){this.expression.connect(e,t)},e}(_e),Me=e.LiteralPrimitive=function(n){function e(e){var t=w(this,n.call(this));return t.value=e,t}return E(e,n),e.prototype.evaluate=function(e,t){return this.value},e.prototype.accept=function(e){return e.visitLiteralPrimitive(this)},e.prototype.connect=function(e,t){},e}(_e),Le=e.LiteralString=function(n){function e(e){var t=w(this,n.call(this));return t.value=e,t}return E(e,n),e.prototype.evaluate=function(e,t){return this.value},e.prototype.accept=function(e){return e.visitLiteralString(this)},e.prototype.connect=function(e,t){},e}(_e),Fe=e.LiteralArray=function(n){function e(e){var t=w(this,n.call(this));return t.elements=e,t}return E(e,n),e.prototype.evaluate=function(e,t){for(var n=this.elements,r=[],i=0,o=n.length;i<o;++i)r[i]=n[i].evaluate(e,t);return r},e.prototype.accept=function(e){return e.visitLiteralArray(this)},e.prototype.connect=function(e,t){for(var n=this.elements.length,r=0;r<n;r++)this.elements[r].connect(e,t)},e}(_e),Ve=e.LiteralObject=function(r){function e(e,t){var n=w(this,r.call(this));return n.keys=e,n.values=t,n}return E(e,r),e.prototype.evaluate=function(e,t){for(var n={},r=this.keys,i=this.values,o=0,a=r.length;o<a;++o)n[r[o]]=i[o].evaluate(e,t);return n},e.prototype.accept=function(e){return e.visitLiteralObject(this)},e.prototype.connect=function(e,t){for(var n=this.keys.length,r=0;r<n;r++)this.values[r].connect(e,t)},e}(_e);function je(e,t,n){for(var r=t.length,i=[],o=0;o<r;o++)i[o]=t[o].evaluate(e,n);return i}function Ue(e,t,n){var r=null==e?null:e[t];if("function"==typeof r)return r;if(!n&&null==r)return null;throw new Error(t+" is not a function")}var Be=null;e.Unparser=Be,"undefined"==typeof FEATURE_NO_UNPARSER&&(e.Unparser=Be=function(){function e(e){this.buffer=e}return e.unparse=function(e){var t=[],n=new Be(t);return e.accept(n),t.join("")},e.prototype.write=function(e){this.buffer.push(e)},e.prototype.writeArgs=function(e){this.write("(");for(var t=0,n=e.length;t<n;++t)0!==t&&this.write(","),e[t].accept(this);this.write(")")},e.prototype.visitChain=function(e){for(var t=e.expressions,n=0,r=t.length;n<r;++n)0!==n&&this.write(";"),t[n].accept(this)},e.prototype.visitBindingBehavior=function(e){var t=e.args;e.expression.accept(this),this.write("&"+e.name);for(var n=0,r=t.length;n<r;++n)this.write(":"),t[n].accept(this)},e.prototype.visitValueConverter=function(e){var t=e.args;e.expression.accept(this),this.write("|"+e.name);for(var n=0,r=t.length;n<r;++n)this.write(":"),t[n].accept(this)},e.prototype.visitAssign=function(e){e.target.accept(this),this.write("="),e.value.accept(this)},e.prototype.visitConditional=function(e){e.condition.accept(this),this.write("?"),e.yes.accept(this),this.write(":"),e.no.accept(this)},e.prototype.visitAccessThis=function(e){if(0!==e.ancestor){this.write("$parent");for(var t=e.ancestor-1;t--;)this.write(".$parent")}else this.write("$this")},e.prototype.visitAccessScope=function(e){for(var t=e.ancestor;t--;)this.write("$parent.");this.write(e.name)},e.prototype.visitAccessMember=function(e){e.object.accept(this),this.write("."+e.name)},e.prototype.visitAccessKeyed=function(e){e.object.accept(this),this.write("["),e.key.accept(this),this.write("]")},e.prototype.visitCallScope=function(e){for(var t=e.ancestor;t--;)this.write("$parent.");this.write(e.name),this.writeArgs(e.args)},e.prototype.visitCallFunction=function(e){e.func.accept(this),this.writeArgs(e.args)},e.prototype.visitCallMember=function(e){e.object.accept(this),this.write("."+e.name),this.writeArgs(e.args)},e.prototype.visitPrefix=function(e){this.write("("+e.operation),e.expression.accept(this),this.write(")")},e.prototype.visitBinary=function(e){e.left.accept(this),this.write(e.operation),e.right.accept(this)},e.prototype.visitLiteralPrimitive=function(e){this.write(""+e.value)},e.prototype.visitLiteralArray=function(e){var t=e.elements;this.write("[");for(var n=0,r=t.length;n<r;++n)0!==n&&this.write(","),t[n].accept(this);this.write("]")},e.prototype.visitLiteralObject=function(e){var t=e.keys,n=e.values;this.write("{");for(var r=0,i=t.length;r<i;++r)0!==r&&this.write(","),this.write("'"+t[r]+"':"),n[r].accept(this);this.write("}")},e.prototype.visitLiteralString=function(e){var t=e.value.replace(/'/g,"'");this.write("'"+t+"'")},e}());var qe=e.ExpressionCloner=function(){function e(){}return e.prototype.cloneExpressionArray=function(e){for(var t=[],n=e.length;n--;)t[n]=e[n].accept(this);return t},e.prototype.visitChain=function(e){return new we(this.cloneExpressionArray(e.expressions))},e.prototype.visitBindingBehavior=function(e){return new Ee(e.expression.accept(this),e.name,this.cloneExpressionArray(e.args))},e.prototype.visitValueConverter=function(e){return new Se(e.expression.accept(this),e.name,this.cloneExpressionArray(e.args))},e.prototype.visitAssign=function(e){return new Ce(e.target.accept(this),e.value.accept(this))},e.prototype.visitConditional=function(e){return new Te(e.condition.accept(this),e.yes.accept(this),e.no.accept(this))},e.prototype.visitAccessThis=function(e){return new Oe(e.ancestor)},e.prototype.visitAccessScope=function(e){return new Re(e.name,e.ancestor)},e.prototype.visitAccessMember=function(e){return new Ae(e.object.accept(this),e.name)},e.prototype.visitAccessKeyed=function(e){return new Ie(e.object.accept(this),e.key.accept(this))},e.prototype.visitCallScope=function(e){return new Ne(e.name,this.cloneExpressionArray(e.args),e.ancestor)},e.prototype.visitCallFunction=function(e){return new Pe(e.func.accept(this),this.cloneExpressionArray(e.args))},e.prototype.visitCallMember=function(e){return new ke(e.object.accept(this),e.name,this.cloneExpressionArray(e.args))},e.prototype.visitPrefix=function(e){return new De(e.operation,e.expression.accept(this))},e.prototype.visitBinary=function(e){return new xe(e.operation,e.left.accept(this),e.right.accept(this))},e.prototype.visitLiteralPrimitive=function(e){return new Me(e)},e.prototype.visitLiteralArray=function(e){return new Fe(this.cloneExpressionArray(e.elements))},e.prototype.visitLiteralObject=function(e){return new Ve(e.keys,this.cloneExpressionArray(e.values))},e.prototype.visitLiteralString=function(e){return new Le(e.value)},e}();var We=e.bindingMode={oneTime:0,toView:1,oneWay:1,twoWay:2,fromView:3},He=e.Parser=function(){function e(){this.cache=Object.create(null)}return e.prototype.parse=function(e){return e=e||"",this.cache[e]||(this.cache[e]=new Ge(e).parseChain())},e}(),Ge=e.ParserImplementation=function(){function e(e){this.index=0,this.startIndex=0,this.lastIndex=0,this.input=e,this.length=e.length,this.currentToken=zt,this.tokenValue=void 0,this.currentChar=e.charCodeAt(0)}return _(e,[{key:"hasNext",get:function(){return this.index<this.length}},{key:"tokenRaw",get:function(){return this.input.slice(this.startIndex,this.index)}}]),e.prototype.parseChain=function(){this.nextToken();for(var e=[];this.currentToken!==zt;){this.optional(dn)&&this.error("Multiple expressions are not allowed."),(this.currentToken&Kt)===Kt&&this.error("Unconsumed token "+this.tokenRaw);var t=this.parseBindingBehavior();e.push(t),this.optional(dn)&&this.error("Multiple expressions are not allowed.")}return 1===e.length?e[0]:new we(e)},e.prototype.parseBindingBehavior=function(){for(var e=this.parseValueConverter();this.optional(bn);){var t=this.tokenValue,n=[];for(this.nextToken();this.optional(gn);)n.push(this.parseExpression());e=new Ee(e,t,n)}return e},e.prototype.parseValueConverter=function(){for(var e=this.parseExpression();this.optional(_n);){var t=this.tokenValue,n=[];for(this.nextToken();this.optional(gn);)n.push(this.parseExpression());e=new Se(e,t,n)}return e},e.prototype.parseExpression=function(){for(var e=this.parseConditional();this.currentToken===Fn;){if(!e.isAssignable){var t=this.input.slice(this.lastIndex,this.startIndex);this.error("Expression "+t+" is not assignable")}this.expect(Fn),e=new Ce(e,this.parseConditional())}return e},e.prototype.parseConditional=function(){var e=this.index,t=this.parseBinary(0);if(this.optional(yn)){var n=this.parseExpression();if(!this.optional(gn)){var r=this.index<this.length?this.index:this.length,i=this.input.slice(e,r);this.error("Conditional expression "+i+" requires all 3 expressions")}var o=this.parseExpression();t=new Te(t,n,o)}return t},e.prototype.parseBinary=function(e){var t=this.parseUnary();if((this.currentToken&Jt)!==Jt)return t;for(;(this.currentToken&Jt)===Jt;){var n=this.currentToken,r=n&Gt;if(r<e)break;this.nextToken(),t=new xe(Un[n&Ht],t,this.parseBinary(r))}return t},e.prototype.parseUnary=function(){var e=this.currentToken;if((e&Zt)===Zt)switch(this.nextToken(),e){case Pn:return this.parseUnary();case xn:return new xe("-",new Me(0),this.parseUnary());case Vn:return new De("!",this.parseUnary())}return this.parseAccessOrCallMember()},e.prototype.parseAccessOrCallMember=function(){for(var e=this.parsePrimary();;)if(this.optional(ln)){(this.currentToken^en)===en&&this.error("Unexpected token "+this.tokenRaw);var t=this.tokenValue;if(this.nextToken(),this.optional(un)){var n=this.parseExpressionList(fn);this.expect(fn),e=e instanceof Oe?new Ne(t,n,e.ancestor):new ke(e,t,n)}else e=e instanceof Oe?new Re(t,e.ancestor):new Ae(e,t)}else if(this.optional(vn)){var r=this.parseExpression();this.expect(mn),e=new Ie(e,r)}else{if(!this.optional(un))return e;var i=this.parseExpressionList(fn);this.expect(fn),e=new Pe(e,i)}},e.prototype.parsePrimary=function(){var e=this.currentToken;switch(e){case Qt:case sn:return this.parseAccessOrCallScope();case an:return this.nextToken(),new Oe(0);case un:this.nextToken();var t=this.parseExpression();return this.expect(fn),t;case vn:this.nextToken();var n=this.parseExpressionList(mn);return this.expect(mn),new Fe(n);case cn:return this.parseObject();case Xt:var r=this.tokenValue;return this.nextToken(),new Le(r);case Yt:var i=this.tokenValue;return this.nextToken(),new Me(i);case rn:case on:case nn:case tn:return this.nextToken(),new Me(Un[e&Ht]);default:if(this.index>=this.length)throw new Error("Unexpected end of expression at column "+this.index+" of "+this.input);this.error("Unexpected token "+this.tokenRaw)}},e.prototype.parseAccessOrCallScope=function(e,t){e&&t||(e=this.tokenValue,t=this.currentToken,this.nextToken());for(var n=0;t===sn;)if(n++,this.optional(ln))e=this.tokenValue,t=this.currentToken,this.nextToken();else{if((this.currentToken&$t)===$t)return new Oe(n);this.error("Unexpected token "+this.tokenRaw)}if(this.optional(un)){var r=this.parseExpressionList(fn);return this.expect(fn),new Ne(e,r,n)}return new Re(e,n)},e.prototype.parseObject=function(){var e=[],t=[];for(this.expect(cn);this.currentToken!==hn;){var n=this.currentToken,r=this.tokenValue;switch(n){case Qt:case tn:case nn:case rn:case on:case an:case sn:e.push(r),this.nextToken(),this.optional(gn)?t.push(this.parseExpression()):t.push(this.parseAccessOrCallScope(r,n));break;case Xt:case Yt:e.push(r),this.nextToken(),this.expect(gn),t.push(this.parseExpression());break;default:this.error("Unexpected token "+this.tokenRaw)}this.currentToken!==hn&&this.expect(pn)}return this.expect(hn),new Ve(e,t)},e.prototype.parseExpressionList=function(e){var t=[];if(this.currentToken!==e)for(;t.push(this.parseExpression()),this.optional(pn););return t},e.prototype.nextToken=function(){return this.currentToken=this.scanToken()},e.prototype.nextChar=function(){return this.currentChar=this.input.charCodeAt(++this.index)},e.prototype.scanToken=function(){for(;this.hasNext;){if(!(this.currentChar<=Je)){if(this.lastIndex=this.startIndex,this.startIndex=this.index,e=this.currentChar,It<=e&&e<=Ft||wt<=e&&e<=St||e===At||e===tt)return this.scanIdentifier();if(qt(this.currentChar))return this.scanNumber();switch(this.currentChar){case ht:return qt(this.input.charCodeAt(this.index+1))?this.scanNumber():(this.nextChar(),ln);case ot:return this.nextChar(),un;case at:return this.nextChar(),fn;case Vt:return this.nextChar(),cn;case Ut:return this.nextChar(),hn;case Ct:return this.nextChar(),vn;case Ot:return this.nextChar(),mn;case ct:return this.nextChar(),pn;case dt:return this.nextChar(),gn;case pt:return this.nextChar(),dn;case it:case et:return this.scanString();case ut:return this.nextChar(),Pn;case lt:return this.nextChar(),xn;case st:return this.nextChar(),Dn;case ft:return this.nextChar(),Ln;case nt:return this.nextChar(),Mn;case Rt:return this.nextChar(),Sn;case yt:return this.nextChar(),yn;case vt:return this.nextChar(),this.currentChar===mt?(this.nextChar(),Nn):An;case gt:return this.nextChar(),this.currentChar===mt?(this.nextChar(),kn):In;case Ze:return this.nextChar(),this.currentChar===mt?(this.nextChar(),this.currentChar===mt?(this.nextChar(),Rn):Tn):Vn;case mt:return this.nextChar(),this.currentChar===mt?(this.nextChar(),this.currentChar===mt?(this.nextChar(),On):Cn):Fn;case rt:return this.nextChar(),this.currentChar===rt?(this.nextChar(),En):bn;case jt:return this.nextChar(),this.currentChar===jt?(this.nextChar(),wn):_n;case Bt:this.nextChar();continue}return this.error("Unexpected character ["+String.fromCharCode(this.currentChar)+"]"),null}this.nextChar()}var e;return zt},e.prototype.scanIdentifier=function(){for(this.nextChar();e=this.currentChar,It<=e&&e<=Ft||wt<=e&&e<=St||bt<=e&&e<=_t||e===At||e===tt;)this.nextChar();var e;if(this.tokenValue=this.tokenRaw,4<=this.tokenValue.length&&this.tokenValue.length<=9){var t=jn[this.tokenValue];if(void 0!==t)return t}return Qt},e.prototype.scanNumber=function(){for(var e=!1,t=0;qt(this.currentChar);)t=10*t+(this.currentChar-bt),this.nextChar();if(this.currentChar===ht){this.nextChar();for(var n=0,r=0;qt(this.currentChar);)n=10*n+(this.currentChar-bt),r++,this.nextChar();t+=n/Math.pow(10,r)}var i=this.index;if(this.currentChar===Nt||this.currentChar===Et){e=!0;var o=this.index;for(this.nextChar(),this.currentChar!==ut&&this.currentChar!==lt||this.nextChar(),qt(this.currentChar)||(this.index=o,this.error("Invalid exponent"));qt(this.currentChar);)this.nextChar()}if(!e)return this.tokenValue=t,Yt;var a=t+this.input.slice(i,this.index);return this.tokenValue=parseFloat(a),Yt},e.prototype.scanString=function(){var e=this.currentChar;this.nextChar();for(var t=void 0,n=this.index;this.currentChar!==e;)if(this.currentChar===Tt){t||(t=[]),t.push(this.input.slice(n,this.index)),this.nextChar();var r=void 0;if(this.currentChar===Mt)if(this.nextChar(),this.index+4<this.length){var i=this.input.slice(this.index,this.index+4);/[A-Z0-9]{4}/i.test(i)||this.error("Invalid unicode escape [\\u"+i+"]"),r=parseInt(i,16),this.index+=4,this.currentChar=this.input.charCodeAt(this.index)}else this.error("Unexpected token "+this.tokenRaw);else r=Wt(this.currentChar),this.nextChar();t.push(String.fromCharCode(r)),n=this.index}else this.currentChar===Ke?this.error("Unterminated quote"):this.nextChar();var o=this.input.slice(n,this.index);this.nextChar();var a=o;return null!=t&&(t.push(o),a=t.join("")),this.tokenValue=a,Xt},e.prototype.error=function(e){throw new Error("Parser Error: "+e+" at column "+this.startIndex+" in expression ["+this.input+"]")},e.prototype.optional=function(e){return this.currentToken===e&&(this.nextToken(),!0)},e.prototype.expect=function(e){this.currentToken===e?this.nextToken():this.error("Missing expected token "+Un[e&Ht])},e}(),Ke=0,$e=9,ze=10,Qe=11,Ye=12,Xe=13,Je=32,Ze=33,et=34,tt=36,nt=37,rt=38,it=39,ot=40,at=41,st=42,ut=43,ct=44,lt=45,ht=46,ft=47,dt=58,pt=59,vt=60,mt=61,gt=62,yt=63,bt=48,_t=57,wt=65,Et=69,St=90,Ct=91,Tt=92,Ot=93,Rt=94,At=95,It=97,Nt=101,kt=102,Pt=110,xt=114,Dt=116,Mt=117,Lt=118,Ft=122,Vt=123,jt=124,Ut=125,Bt=160;function qt(e){return bt<=e&&e<=_t}function Wt(e){switch(e){case Pt:return ze;case kt:return Ye;case xt:return Xe;case Dt:return $e;case Lt:return Qe;default:return e}}var Ht=63,Gt=448,Kt=512,$t=1024,zt=2048|$t,Qt=4096|en,Yt=8192,Xt=16384,Jt=32768,Zt=65536,en=1<<17,tn=0|en,nn=1|en,rn=2|en,on=3|en,an=4|en,sn=5|en,un=6|$t,cn=7,ln=8,hn=9|$t|Kt,fn=10|$t|Kt,dn=11,pn=12|$t,vn=13|$t,mn=14|Kt,gn=15,yn=16,bn=19|$t,_n=20|$t,wn=85|Jt,En=150|Jt,Sn=215|Jt,Cn=280|Jt,Tn=281|Jt,On=282|Jt,Rn=283|Jt,An=348|Jt,In=349|Jt,Nn=350|Jt,kn=351|Jt,Pn=416|Jt|Zt,xn=417|Jt|Zt,Dn=482|Jt,Mn=483|Jt,Ln=484|Jt,Fn=37,Vn=38|Zt,jn=Object.create(null,{true:{value:nn},null:{value:rn},false:{value:tn},undefined:{value:on},$this:{value:an},$parent:{value:sn}}),Un=[!1,!0,null,void 0,"$this","$parent","(","{",".","}",")",";",",","[","]",":","?","'",'"',"&","|","||","&&","^","==","!=","===","!==","<",">","<=",">=","+","-","*","%","/","=","!"],Bn=Map.prototype;function qn(e,t){return Wn.for(e,t)}e.getMapObserver=qn;var Wn=function(n){function r(e,t){return w(this,n.call(this,e,t))}return E(r,n),r.for=function(e,t){return"__map_observer__"in t||Reflect.defineProperty(t,"__map_observer__",{value:r.create(e,t),enumerable:!1,configurable:!1}),t.__map_observer__},r.create=function(e,i){var o=new r(e,i),a=Bn;return a.set===i.set&&a.delete===i.delete&&a.clear===i.clear||(a={set:i.set,delete:i.delete,clear:i.clear}),i.set=function(){var e=i.has(arguments[0]),t=e?"update":"add",n=i.get(arguments[0]),r=a.set.apply(i,arguments);return e&&n===i.get(arguments[0])||o.addChangeRecord({type:t,object:i,key:arguments[0],oldValue:n}),r},i.delete=function(){var e=i.has(arguments[0]),t=i.get(arguments[0]),n=a.delete.apply(i,arguments);return e&&o.addChangeRecord({type:"delete",object:i,key:arguments[0],oldValue:t}),n},i.clear=function(){var e=a.clear.apply(i,arguments);return o.addChangeRecord({type:"clear",object:i}),e},o},r}(ce);function Hn(e){return e.path&&e.path[0]||e.deepPath&&e.deepPath[0]||e.target}function Gn(){this.standardStopPropagation(),this.propagationStopped=!0}function Kn(e){e.propagationStopped=!1;for(var t=Hn(e),n=[];t;){if(t.capturedCallbacks){var r=t.capturedCallbacks[e.type];r&&(e.stopPropagation!==Gn&&(e.standardStopPropagation=e.stopPropagation,e.stopPropagation=Gn),n.push(r))}t=t.parentNode}for(var i=n.length-1;0<=i&&!e.propagationStopped;i--){var o=n[i];"handleEvent"in o?o.handleEvent(e):o(e)}}var $n=function(){function e(e){this.eventName=e,this.count=0}return e.prototype.increment=function(){this.count++,1===this.count&&s.DOM.addEventListener(this.eventName,Kn,!0)},e.prototype.decrement=function(){this.count--,0===this.count&&s.DOM.removeEventListener(this.eventName,Kn,!0)},e}();function zn(e){e.propagationStopped=!1;for(var t=Hn(e);t&&!e.propagationStopped;){if(t.delegatedCallbacks){var n=t.delegatedCallbacks[e.type];n&&(e.stopPropagation!==Gn&&(e.standardStopPropagation=e.stopPropagation,e.stopPropagation=Gn),"handleEvent"in n?n.handleEvent(e):n(e))}t=t.parentNode}}var Qn=function(){function e(e){this.eventName=e,this.count=0}return e.prototype.increment=function(){this.count++,1===this.count&&s.DOM.addEventListener(this.eventName,zn,!1)},e.prototype.decrement=function(){this.count--,0===this.count&&s.DOM.removeEventListener(this.eventName,zn,!1)},e}(),Yn=function(){function e(e,t,n){this.entry=e,this.lookup=t,this.targetEvent=n}return e.prototype.dispose=function(){this.entry.decrement(),this.lookup[this.targetEvent]=null,this.entry=this.lookup=this.targetEvent=null},e}(),Xn=function(){function e(e,t,n){this.target=e,this.targetEvent=t,this.callback=n}return e.prototype.dispose=function(){this.target.removeEventListener(this.targetEvent,this.callback),this.target=this.targetEvent=this.callback=null},e}(),Jn=function(){function e(){this.delegatedHandlers={},this.capturedHandlers={}}return e.prototype.subscribe=function(e,t,n,r,i){var o=void 0,a=void 0,s=void 0;if(r===Zn.bubbling){o=this.delegatedHandlers,s=o[t]||(o[t]=new Qn(t));var u=e.delegatedCallbacks||(e.delegatedCallbacks={});return s.increment(),u[t]=n,!0===i?new Yn(s,u,t):function(){s.decrement(),u[t]=null}}if(r===Zn.capturing){a=this.capturedHandlers,s=a[t]||(a[t]=new $n(t));var c=e.capturedCallbacks||(e.capturedCallbacks={});return s.increment(),c[t]=n,!0===i?new Yn(s,c,t):function(){s.decrement(),c[t]=null}}return e.addEventListener(t,n),!0===i?new Xn(e,t,n):function(){e.removeEventListener(t,n)}},e}(),Zn=e.delegationStrategy={none:0,capturing:1,bubbling:2},er=e.EventManager=function(){function e(){this.elementHandlerLookup={},this.eventStrategyLookup={},this.registerElementConfig({tagName:"input",properties:{value:["change","input"],checked:["change","input"],files:["change","input"]}}),this.registerElementConfig({tagName:"textarea",properties:{value:["change","input"]}}),this.registerElementConfig({tagName:"select",properties:{value:["change"]}}),this.registerElementConfig({tagName:"content editable",properties:{value:["change","input","blur","keyup","paste"]}}),this.registerElementConfig({tagName:"scrollable element",properties:{scrollTop:["scroll"],scrollLeft:["scroll"]}}),this.defaultEventStrategy=new Jn}return e.prototype.registerElementConfig=function(e){var t=e.tagName.toLowerCase(),n=e.properties,r=void 0,i=this.elementHandlerLookup[t]={};for(r in n)n.hasOwnProperty(r)&&(i[r]=n[r])},e.prototype.registerEventStrategy=function(e,t){this.eventStrategyLookup[e]=t},e.prototype.getElementHandler=function(e,t){var n=void 0,r=this.elementHandlerLookup;if(e.tagName){if(r[n=e.tagName.toLowerCase()]&&r[n][t])return new tr(r[n][t]);if("textContent"===t||"innerHTML"===t)return new tr(r["content editable"].value);if("scrollTop"===t||"scrollLeft"===t)return new tr(r["scrollable element"][t])}return null},e.prototype.addEventListener=function(e,t,n,r,i){return(this.eventStrategyLookup[t]||this.defaultEventStrategy).subscribe(e,t,n,r,i)},e}(),tr=e.EventSubscriber=function(){function e(e){this.events=e,this.element=null,this.handler=null}return e.prototype.subscribe=function(e,t){this.element=e,this.handler=t;for(var n=this.events,r=0,i=n.length;r<i;++r)e.addEventListener(n[r],t)},e.prototype.dispose=function(){if(null!==this.element){for(var e=this.element,t=this.handler,n=this.events,r=0,i=n.length;r<i;++r)e.removeEventListener(n[r],t);this.element=this.handler=null}},e}(),nr=e.DirtyChecker=function(){function e(){this.tracked=[],this.checkDelay=120}return e.prototype.addProperty=function(e){var t=this.tracked;t.push(e),1===t.length&&this.scheduleDirtyCheck()},e.prototype.removeProperty=function(e){var t=this.tracked;t.splice(t.indexOf(e),1)},e.prototype.scheduleDirtyCheck=function(){var e=this;setTimeout(function(){return e.check()},this.checkDelay)},e.prototype.check=function(){for(var e=this.tracked,t=e.length;t--;){var n=e[t];n.isDirty()&&n.call()}e.length&&this.scheduleDirtyCheck()},e}(),rr=e.DirtyCheckProperty=ee()(c=function(){function e(e,t,n){this.dirtyChecker=e,this.obj=t,this.propertyName=n}return e.prototype.getValue=function(){return this.obj[this.propertyName]},e.prototype.setValue=function(e){this.obj[this.propertyName]=e},e.prototype.call=function(){var e=this.oldValue,t=this.getValue();this.callSubscribers(t,e),this.oldValue=t},e.prototype.isDirty=function(){return this.oldValue!==this.obj[this.propertyName]},e.prototype.subscribe=function(e,t){this.hasSubscribers()||(this.oldValue=this.getValue(),this.dirtyChecker.addProperty(this)),this.addSubscriber(e,t)},e.prototype.unsubscribe=function(e,t){this.removeSubscriber(e,t)&&!this.hasSubscribers()&&this.dirtyChecker.removeProperty(this)},e}())||c,ir=o.getLogger("property-observation"),or=e.propertyAccessor={getValue:function(e,t){return e[t]},setValue:function(e,t,n){t[n]=e}},ar=e.PrimitiveObserver=function(){function e(e,t){this.doNotCache=!0,this.primitive=e,this.propertyName=t}return e.prototype.getValue=function(){return this.primitive[this.propertyName]},e.prototype.setValue=function(){var e=b(this.primitive);throw new Error("The "+this.propertyName+" property of a "+e+" ("+this.primitive+") cannot be assigned.")},e.prototype.subscribe=function(){},e.prototype.unsubscribe=function(){},e}(),sr=e.SetterObserver=ee()(l=function(){function e(e,t,n){this.taskQueue=e,this.obj=t,this.propertyName=n,this.queued=!1,this.observing=!1}return e.prototype.getValue=function(){return this.obj[this.propertyName]},e.prototype.setValue=function(e){this.obj[this.propertyName]=e},e.prototype.getterValue=function(){return this.currentValue},e.prototype.setterValue=function(e){var t=this.currentValue;t!==e&&(this.queued||(this.oldValue=t,this.queued=!0,this.taskQueue.queueMicroTask(this)),this.currentValue=e)},e.prototype.call=function(){var e=this.oldValue,t=this.currentValue;this.queued=!1,this.callSubscribers(t,e)},e.prototype.subscribe=function(e,t){this.observing||this.convertProperty(),this.addSubscriber(e,t)},e.prototype.unsubscribe=function(e,t){this.removeSubscriber(e,t)},e.prototype.convertProperty=function(){this.observing=!0,this.currentValue=this.obj[this.propertyName],this.setValue=this.setterValue,this.getValue=this.getterValue,Reflect.defineProperty(this.obj,this.propertyName,{configurable:!0,enumerable:!(this.propertyName in this.obj)||this.obj.propertyIsEnumerable(this.propertyName),get:this.getValue.bind(this),set:this.setValue.bind(this)})||ir.warn("Cannot observe property '"+this.propertyName+"' of object",this.obj)},e}())||l,ur=e.XLinkAttributeObserver=function(){function e(e,t,n){this.element=e,this.propertyName=t,this.attributeName=n}return e.prototype.getValue=function(){return this.element.getAttributeNS("http://www.w3.org/1999/xlink",this.attributeName)},e.prototype.setValue=function(e){return this.element.setAttributeNS("http://www.w3.org/1999/xlink",this.attributeName,e)},e.prototype.subscribe=function(){throw new Error('Observation of a "'+this.element.nodeName+'" element\'s "'+this.propertyName+'" property is not supported.')},e}(),cr=e.dataAttributeAccessor={getValue:function(e,t){return e.getAttribute(t)},setValue:function(e,t,n){null==e?t.removeAttribute(n):t.setAttribute(n,e)}},lr=e.DataAttributeObserver=function(){function e(e,t){this.element=e,this.propertyName=t}return e.prototype.getValue=function(){return this.element.getAttribute(this.propertyName)},e.prototype.setValue=function(e){return null==e?this.element.removeAttribute(this.propertyName):this.element.setAttribute(this.propertyName,e)},e.prototype.subscribe=function(){throw new Error('Observation of a "'+this.element.nodeName+'" element\'s "'+this.propertyName+'" property is not supported.')},e}(),hr=e.StyleObserver=function(){function e(e,t){this.element=e,this.propertyName=t,this.styles=null,this.version=0}return e.prototype.getValue=function(){return this.element.style.cssText},e.prototype._setProperty=function(e,t){var n="";null!=t&&"function"==typeof t.indexOf&&-1!==t.indexOf("!important")&&(n="important",t=t.replace("!important","")),this.element.style.setProperty(e,t,n)},e.prototype.setValue=function(e){var t=this.styles||{},n=void 0,r=this.version;if(null!=e)if(e instanceof Object){var i=void 0;for(n in e)e.hasOwnProperty(n)&&(i=e[n],t[n=n.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})]=r,this._setProperty(n,i))}else if(e.length)for(var o=/\s*([\w\-]+)\s*:\s*((?:(?:[\w\-]+\(\s*(?:"(?:\\"|[^"])*"|'(?:\\'|[^'])*'|[\w\-]+\(\s*(?:^"(?:\\"|[^"])*"|'(?:\\'|[^'])*'|[^\)]*)\),?|[^\)]*)\),?|"(?:\\"|[^"])*"|'(?:\\'|[^'])*'|[^;]*),?\s*)+);?/g,a=void 0;null!==(a=o.exec(e));)(n=a[1])&&(t[n]=r,this._setProperty(n,a[2]));if(this.styles=t,this.version+=1,0!==r)for(n in r-=1,t)t.hasOwnProperty(n)&&t[n]===r&&this.element.style.removeProperty(n)},e.prototype.subscribe=function(){throw new Error('Observation of a "'+this.element.nodeName+'" element\'s "'+this.propertyName+'" property is not supported.')},e}(),fr=e.ValueAttributeObserver=ee()(h=function(){function e(e,t,n){this.element=e,this.propertyName=t,this.handler=n,"files"===t&&(this.setValue=function(){})}return e.prototype.getValue=function(){return this.element[this.propertyName]},e.prototype.setValue=function(e){e=null==e?"":e,this.element[this.propertyName]!==e&&(this.element[this.propertyName]=e,this.notify())},e.prototype.notify=function(){var e=this.oldValue,t=this.getValue();this.callSubscribers(t,e),this.oldValue=t},e.prototype.handleEvent=function(){this.notify()},e.prototype.subscribe=function(e,t){this.hasSubscribers()||(this.oldValue=this.getValue(),this.handler.subscribe(this.element,this)),this.addSubscriber(e,t)},e.prototype.unsubscribe=function(e,t){this.removeSubscriber(e,t)&&!this.hasSubscribers()&&this.handler.dispose()},e}())||h,dr="CheckedObserver:array",pr="CheckedObserver:value",vr=e.CheckedObserver=ee()(f=function(){function e(e,t,n){this.element=e,this.handler=t,this.observerLocator=n}return e.prototype.getValue=function(){return this.value},e.prototype.setValue=function(e){this.initialSync&&this.value===e||(this.arrayObserver&&(this.arrayObserver.unsubscribe(dr,this),this.arrayObserver=null),"checkbox"===this.element.type&&Array.isArray(e)&&(this.arrayObserver=this.observerLocator.getArrayObserver(e),this.arrayObserver.subscribe(dr,this)),this.oldValue=this.value,this.value=e,this.synchronizeElement(),this.notify(),this.initialSync||(this.initialSync=!0,this.observerLocator.taskQueue.queueMicroTask(this)))},e.prototype.call=function(e,t){this.synchronizeElement(),this.valueObserver||(this.valueObserver=this.element.__observers__.model||this.element.__observers__.value,this.valueObserver&&this.valueObserver.subscribe(pr,this))},e.prototype.synchronizeElement=function(){var e=this.value,t=this.element,n=t.hasOwnProperty("model")?t.model:t.value,r="radio"===t.type,i=t.matcher||function(e,t){return e===t};t.checked=r&&!!i(e,n)||!r&&!0===e||!r&&Array.isArray(e)&&-1!==e.findIndex(function(e){return!!i(e,n)})},e.prototype.synchronizeValue=function(){var e=this.value,t=this.element,n=t.hasOwnProperty("model")?t.model:t.value,r=void 0,i=t.matcher||function(e,t){return e===t};if("checkbox"===t.type){if(Array.isArray(e))return r=e.findIndex(function(e){return!!i(e,n)}),void(t.checked&&-1===r?e.push(n):t.checked||-1===r||e.splice(r,1));e=t.checked}else{if(!t.checked)return;e=n}this.oldValue=this.value,this.value=e,this.notify()},e.prototype.notify=function(){var e=this.oldValue,t=this.value;t!==e&&this.callSubscribers(t,e)},e.prototype.handleEvent=function(){this.synchronizeValue()},e.prototype.subscribe=function(e,t){this.hasSubscribers()||this.handler.subscribe(this.element,this),this.addSubscriber(e,t)},e.prototype.unsubscribe=function(e,t){this.removeSubscriber(e,t)&&!this.hasSubscribers()&&this.handler.dispose()},e.prototype.unbind=function(){this.arrayObserver&&(this.arrayObserver.unsubscribe(dr,this),this.arrayObserver=null),this.valueObserver&&this.valueObserver.unsubscribe(pr,this)},e}())||f,mr="SelectValueObserver:array",gr=e.SelectValueObserver=ee()(d=function(){function e(e,t,n){this.element=e,this.handler=t,this.observerLocator=n}return e.prototype.getValue=function(){return this.value},e.prototype.setValue=function(e){if(null!=e&&this.element.multiple&&!Array.isArray(e))throw new Error("Only null or Array instances can be bound to a multi-select.");this.value!==e&&(this.arrayObserver&&(this.arrayObserver.unsubscribe(mr,this),this.arrayObserver=null),Array.isArray(e)&&(this.arrayObserver=this.observerLocator.getArrayObserver(e),this.arrayObserver.subscribe(mr,this)),this.oldValue=this.value,this.value=e,this.synchronizeOptions(),this.notify(),this.initialSync||(this.initialSync=!0,this.observerLocator.taskQueue.queueMicroTask(this)))},e.prototype.call=function(e,t){this.synchronizeOptions()},e.prototype.synchronizeOptions=function(){var n=this.value,r=void 0;Array.isArray(n)&&(r=!0);for(var i=this.element.options,o=i.length,a=this.element.matcher||function(e,t){return e===t},e=function(){var e=i.item(o),t=e.hasOwnProperty("model")?e.model:e.value;if(r)return e.selected=-1!==n.findIndex(function(e){return!!a(t,e)}),"continue";e.selected=!!a(t,n)};o--;)e()},e.prototype.synchronizeValue=function(){for(var i=this,e=this.element.options,t=0,o=[],n=0,r=e.length;n<r;n++){var a=e.item(n);a.selected&&(o.push(a.hasOwnProperty("model")?a.model:a.value),t++)}if(this.element.multiple){if(Array.isArray(this.value)){var s=function(){for(var n=i.element.matcher||function(e,t){return e===t},e=0,t=function(){var t=i.value[e];-1===o.findIndex(function(e){return n(t,e)})?i.value.splice(e,1):e++};e<i.value.length;)t();e=0;for(var r=function(){var t=o[e];-1===i.value.findIndex(function(e){return n(t,e)})&&i.value.push(t),e++};e<o.length;)r();return{v:void 0}}();if("object"===(void 0===s?"undefined":b(s)))return s.v}}else o=0===t?null:o[0];o!==this.value&&(this.oldValue=this.value,this.value=o,this.notify())},e.prototype.notify=function(){var e=this.oldValue,t=this.value;this.callSubscribers(t,e)},e.prototype.handleEvent=function(){this.synchronizeValue()},e.prototype.subscribe=function(e,t){this.hasSubscribers()||this.handler.subscribe(this.element,this),this.addSubscriber(e,t)},e.prototype.unsubscribe=function(e,t){this.removeSubscriber(e,t)&&!this.hasSubscribers()&&this.handler.dispose()},e.prototype.bind=function(){var e=this;this.domObserver=s.DOM.createMutationObserver(function(){e.synchronizeOptions(),e.synchronizeValue()}),this.domObserver.observe(this.element,{childList:!0,subtree:!0,characterData:!0})},e.prototype.unbind=function(){this.domObserver.disconnect(),this.domObserver=null,this.arrayObserver&&(this.arrayObserver.unsubscribe(mr,this),this.arrayObserver=null)},e}())||d,yr=e.ClassObserver=function(){function e(e){this.element=e,this.doNotCache=!0,this.value="",this.version=0}return e.prototype.getValue=function(){return this.value},e.prototype.setValue=function(e){var t=this.nameIndex||{},n=this.version,r=void 0,i=void 0;if(null!=e&&e.length)for(var o=0,a=(r=e.split(/\s+/)).length;o<a;o++)""!==(i=r[o])&&(t[i]=n,this.element.classList.add(i));if(this.value=e,this.nameIndex=t,this.version+=1,0!==n)for(i in n-=1,t)t.hasOwnProperty(i)&&t[i]===n&&this.element.classList.remove(i)},e.prototype.subscribe=function(){throw new Error('Observation of a "'+this.element.nodeName+'" element\'s "class" property is not supported.')},e}();function br(e){return!!(e&&e.get&&e.get.dependencies)}var _r=e.ComputedExpression=function(r){function e(e,t){var n=w(this,r.call(this));return n.name=e,n.dependencies=t,n.isAssignable=!0,n}return E(e,r),e.prototype.evaluate=function(e,t){return e.bindingContext[this.name]},e.prototype.assign=function(e,t){e.bindingContext[this.name]=t},e.prototype.accept=function(e){throw new Error("not implemented")},e.prototype.connect=function(e,t){for(var n=this.dependencies,r=n.length;r--;)n[r].connect(e,t)},e}(_e);function wr(e,t,n,r){var i=n.get.dependencies;if(!(i instanceof _r)){for(var o=i.length;o--;)i[o]=r.parser.parse(i[o]);i=n.get.dependencies=new _r(t,i)}var a={bindingContext:e,overrideContext:R(e)};return new te(a,i,r)}var Er=void 0,Sr=void 0,Cr=void 0,Tr=void 0;if("undefined"==typeof FEATURE_NO_SVG){Er={a:["class","externalResourcesRequired","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","requiredExtensions","requiredFeatures","style","systemLanguage","target","transform","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space"],altGlyph:["class","dx","dy","externalResourcesRequired","format","glyphRef","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","requiredExtensions","requiredFeatures","rotate","style","systemLanguage","x","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space","y"],altGlyphDef:["id","xml:base","xml:lang","xml:space"],altGlyphItem:["id","xml:base","xml:lang","xml:space"],animate:["accumulate","additive","attributeName","attributeType","begin","by","calcMode","dur","end","externalResourcesRequired","fill","from","id","keySplines","keyTimes","max","min","onbegin","onend","onload","onrepeat","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","systemLanguage","to","values","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space"],animateColor:["accumulate","additive","attributeName","attributeType","begin","by","calcMode","dur","end","externalResourcesRequired","fill","from","id","keySplines","keyTimes","max","min","onbegin","onend","onload","onrepeat","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","systemLanguage","to","values","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space"],animateMotion:["accumulate","additive","begin","by","calcMode","dur","end","externalResourcesRequired","fill","from","id","keyPoints","keySplines","keyTimes","max","min","onbegin","onend","onload","onrepeat","origin","path","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","rotate","systemLanguage","to","values","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space"],animateTransform:["accumulate","additive","attributeName","attributeType","begin","by","calcMode","dur","end","externalResourcesRequired","fill","from","id","keySplines","keyTimes","max","min","onbegin","onend","onload","onrepeat","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","systemLanguage","to","type","values","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space"],circle:["class","cx","cy","externalResourcesRequired","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","r","requiredExtensions","requiredFeatures","style","systemLanguage","transform","xml:base","xml:lang","xml:space"],clipPath:["class","clipPathUnits","externalResourcesRequired","id","requiredExtensions","requiredFeatures","style","systemLanguage","transform","xml:base","xml:lang","xml:space"],"color-profile":["id","local","name","rendering-intent","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space"],cursor:["externalResourcesRequired","id","requiredExtensions","requiredFeatures","systemLanguage","x","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space","y"],defs:["class","externalResourcesRequired","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","requiredExtensions","requiredFeatures","style","systemLanguage","transform","xml:base","xml:lang","xml:space"],desc:["class","id","style","xml:base","xml:lang","xml:space"],ellipse:["class","cx","cy","externalResourcesRequired","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","requiredExtensions","requiredFeatures","rx","ry","style","systemLanguage","transform","xml:base","xml:lang","xml:space"],feBlend:["class","height","id","in","in2","mode","result","style","width","x","xml:base","xml:lang","xml:space","y"],feColorMatrix:["class","height","id","in","result","style","type","values","width","x","xml:base","xml:lang","xml:space","y"],feComponentTransfer:["class","height","id","in","result","style","width","x","xml:base","xml:lang","xml:space","y"],feComposite:["class","height","id","in","in2","k1","k2","k3","k4","operator","result","style","width","x","xml:base","xml:lang","xml:space","y"],feConvolveMatrix:["bias","class","divisor","edgeMode","height","id","in","kernelMatrix","kernelUnitLength","order","preserveAlpha","result","style","targetX","targetY","width","x","xml:base","xml:lang","xml:space","y"],feDiffuseLighting:["class","diffuseConstant","height","id","in","kernelUnitLength","result","style","surfaceScale","width","x","xml:base","xml:lang","xml:space","y"],feDisplacementMap:["class","height","id","in","in2","result","scale","style","width","x","xChannelSelector","xml:base","xml:lang","xml:space","y","yChannelSelector"],feDistantLight:["azimuth","elevation","id","xml:base","xml:lang","xml:space"],feFlood:["class","height","id","result","style","width","x","xml:base","xml:lang","xml:space","y"],feFuncA:["amplitude","exponent","id","intercept","offset","slope","tableValues","type","xml:base","xml:lang","xml:space"],feFuncB:["amplitude","exponent","id","intercept","offset","slope","tableValues","type","xml:base","xml:lang","xml:space"],feFuncG:["amplitude","exponent","id","intercept","offset","slope","tableValues","type","xml:base","xml:lang","xml:space"],feFuncR:["amplitude","exponent","id","intercept","offset","slope","tableValues","type","xml:base","xml:lang","xml:space"],feGaussianBlur:["class","height","id","in","result","stdDeviation","style","width","x","xml:base","xml:lang","xml:space","y"],feImage:["class","externalResourcesRequired","height","id","preserveAspectRatio","result","style","width","x","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space","y"],feMerge:["class","height","id","result","style","width","x","xml:base","xml:lang","xml:space","y"],feMergeNode:["id","xml:base","xml:lang","xml:space"],feMorphology:["class","height","id","in","operator","radius","result","style","width","x","xml:base","xml:lang","xml:space","y"],feOffset:["class","dx","dy","height","id","in","result","style","width","x","xml:base","xml:lang","xml:space","y"],fePointLight:["id","x","xml:base","xml:lang","xml:space","y","z"],feSpecularLighting:["class","height","id","in","kernelUnitLength","result","specularConstant","specularExponent","style","surfaceScale","width","x","xml:base","xml:lang","xml:space","y"],feSpotLight:["id","limitingConeAngle","pointsAtX","pointsAtY","pointsAtZ","specularExponent","x","xml:base","xml:lang","xml:space","y","z"],feTile:["class","height","id","in","result","style","width","x","xml:base","xml:lang","xml:space","y"],feTurbulence:["baseFrequency","class","height","id","numOctaves","result","seed","stitchTiles","style","type","width","x","xml:base","xml:lang","xml:space","y"],filter:["class","externalResourcesRequired","filterRes","filterUnits","height","id","primitiveUnits","style","width","x","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space","y"],font:["class","externalResourcesRequired","horiz-adv-x","horiz-origin-x","horiz-origin-y","id","style","vert-adv-y","vert-origin-x","vert-origin-y","xml:base","xml:lang","xml:space"],"font-face":["accent-height","alphabetic","ascent","bbox","cap-height","descent","font-family","font-size","font-stretch","font-style","font-variant","font-weight","hanging","id","ideographic","mathematical","overline-position","overline-thickness","panose-1","slope","stemh","stemv","strikethrough-position","strikethrough-thickness","underline-position","underline-thickness","unicode-range","units-per-em","v-alphabetic","v-hanging","v-ideographic","v-mathematical","widths","x-height","xml:base","xml:lang","xml:space"],"font-face-format":["id","string","xml:base","xml:lang","xml:space"],"font-face-name":["id","name","xml:base","xml:lang","xml:space"],"font-face-src":["id","xml:base","xml:lang","xml:space"],"font-face-uri":["id","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space"],foreignObject:["class","externalResourcesRequired","height","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","requiredExtensions","requiredFeatures","style","systemLanguage","transform","width","x","xml:base","xml:lang","xml:space","y"],g:["class","externalResourcesRequired","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","requiredExtensions","requiredFeatures","style","systemLanguage","transform","xml:base","xml:lang","xml:space"],glyph:["arabic-form","class","d","glyph-name","horiz-adv-x","id","lang","orientation","style","unicode","vert-adv-y","vert-origin-x","vert-origin-y","xml:base","xml:lang","xml:space"],glyphRef:["class","dx","dy","format","glyphRef","id","style","x","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space","y"],hkern:["g1","g2","id","k","u1","u2","xml:base","xml:lang","xml:space"],image:["class","externalResourcesRequired","height","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","preserveAspectRatio","requiredExtensions","requiredFeatures","style","systemLanguage","transform","width","x","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space","y"],line:["class","externalResourcesRequired","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","requiredExtensions","requiredFeatures","style","systemLanguage","transform","x1","x2","xml:base","xml:lang","xml:space","y1","y2"],linearGradient:["class","externalResourcesRequired","gradientTransform","gradientUnits","id","spreadMethod","style","x1","x2","xlink:arcrole","xlink:href","xlink:role","xlink:title","xlink:type","xml:base","xml:lang","xml:space","y1","y2"],marker:["class","externalResourcesRequired","id","markerHeight","markerUnits","markerWidth","orient","preserveAspectRatio","refX","refY","style","viewBox","xml:base","xml:lang","xml:space"],mask:["class","externalResourcesRequired","height","id","maskContentUnits","maskUnits","requiredExtensions","requiredFeatures","style","systemLanguage","width","x","xml:base","xml:lang","xml:space","y"],metadata:["id","xml:base","xml:lang","xml:space"],"missing-glyph":["class","d","horiz-adv-x","id","style","vert-adv-y","vert-origin-x","vert-origin-y","xml:base","xml:lang","xml:space"],mpath:["externalResourcesRequired","id","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space"],path:["class","d","externalResourcesRequired","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","pathLength","requiredExtensions","requiredFeatures","style","systemLanguage","transform","xml:base","xml:lang","xml:space"],pattern:["class","externalResourcesRequired","height","id","patternContentUnits","patternTransform","patternUnits","preserveAspectRatio","requiredExtensions","requiredFeatures","style","systemLanguage","viewBox","width","x","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space","y"],polygon:["class","externalResourcesRequired","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","points","requiredExtensions","requiredFeatures","style","systemLanguage","transform","xml:base","xml:lang","xml:space"],polyline:["class","externalResourcesRequired","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","points","requiredExtensions","requiredFeatures","style","systemLanguage","transform","xml:base","xml:lang","xml:space"],radialGradient:["class","cx","cy","externalResourcesRequired","fx","fy","gradientTransform","gradientUnits","id","r","spreadMethod","style","xlink:arcrole","xlink:href","xlink:role","xlink:title","xlink:type","xml:base","xml:lang","xml:space"],rect:["class","externalResourcesRequired","height","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","requiredExtensions","requiredFeatures","rx","ry","style","systemLanguage","transform","width","x","xml:base","xml:lang","xml:space","y"],script:["externalResourcesRequired","id","type","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space"],set:["attributeName","attributeType","begin","dur","end","externalResourcesRequired","fill","id","max","min","onbegin","onend","onload","onrepeat","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","systemLanguage","to","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space"],stop:["class","id","offset","style","xml:base","xml:lang","xml:space"],style:["id","media","title","type","xml:base","xml:lang","xml:space"],svg:["baseProfile","class","contentScriptType","contentStyleType","externalResourcesRequired","height","id","onabort","onactivate","onclick","onerror","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","onresize","onscroll","onunload","onzoom","preserveAspectRatio","requiredExtensions","requiredFeatures","style","systemLanguage","version","viewBox","width","x","xml:base","xml:lang","xml:space","y","zoomAndPan"],switch:["class","externalResourcesRequired","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","requiredExtensions","requiredFeatures","style","systemLanguage","transform","xml:base","xml:lang","xml:space"],symbol:["class","externalResourcesRequired","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","preserveAspectRatio","style","viewBox","xml:base","xml:lang","xml:space"],text:["class","dx","dy","externalResourcesRequired","id","lengthAdjust","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","requiredExtensions","requiredFeatures","rotate","style","systemLanguage","textLength","transform","x","xml:base","xml:lang","xml:space","y"],textPath:["class","externalResourcesRequired","id","lengthAdjust","method","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","requiredExtensions","requiredFeatures","spacing","startOffset","style","systemLanguage","textLength","xlink:arcrole","xlink:href","xlink:role","xlink:title","xlink:type","xml:base","xml:lang","xml:space"],title:["class","id","style","xml:base","xml:lang","xml:space"],tref:["class","dx","dy","externalResourcesRequired","id","lengthAdjust","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","requiredExtensions","requiredFeatures","rotate","style","systemLanguage","textLength","x","xlink:arcrole","xlink:href","xlink:role","xlink:title","xlink:type","xml:base","xml:lang","xml:space","y"],tspan:["class","dx","dy","externalResourcesRequired","id","lengthAdjust","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","requiredExtensions","requiredFeatures","rotate","style","systemLanguage","textLength","x","xml:base","xml:lang","xml:space","y"],use:["class","externalResourcesRequired","height","id","onactivate","onclick","onfocusin","onfocusout","onload","onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","requiredExtensions","requiredFeatures","style","systemLanguage","transform","width","x","xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space","y"],view:["externalResourcesRequired","id","preserveAspectRatio","viewBox","viewTarget","xml:base","xml:lang","xml:space","zoomAndPan"],vkern:["g1","g2","id","k","u1","u2","xml:base","xml:lang","xml:space"]},Sr={a:!0,altGlyph:!0,animate:!0,animateColor:!0,circle:!0,clipPath:!0,defs:!0,ellipse:!0,feBlend:!0,feColorMatrix:!0,feComponentTransfer:!0,feComposite:!0,feConvolveMatrix:!0,feDiffuseLighting:!0,feDisplacementMap:!0,feFlood:!0,feGaussianBlur:!0,feImage:!0,feMerge:!0,feMorphology:!0,feOffset:!0,feSpecularLighting:!0,feTile:!0,feTurbulence:!0,filter:!0,font:!0,foreignObject:!0,g:!0,glyph:!0,glyphRef:!0,image:!0,line:!0,linearGradient:!0,marker:!0,mask:!0,"missing-glyph":!0,path:!0,pattern:!0,polygon:!0,polyline:!0,radialGradient:!0,rect:!0,stop:!0,svg:!0,switch:!0,symbol:!0,text:!0,textPath:!0,tref:!0,tspan:!0,use:!0},Cr={"alignment-baseline":!0,"baseline-shift":!0,"clip-path":!0,"clip-rule":!0,clip:!0,"color-interpolation-filters":!0,"color-interpolation":!0,"color-profile":!0,"color-rendering":!0,color:!0,cursor:!0,direction:!0,display:!0,"dominant-baseline":!0,"enable-background":!0,"fill-opacity":!0,"fill-rule":!0,fill:!0,filter:!0,"flood-color":!0,"flood-opacity":!0,"font-family":!0,"font-size-adjust":!0,"font-size":!0,"font-stretch":!0,"font-style":!0,"font-variant":!0,"font-weight":!0,"glyph-orientation-horizontal":!0,"glyph-orientation-vertical":!0,"image-rendering":!0,kerning:!0,"letter-spacing":!0,"lighting-color":!0,"marker-end":!0,"marker-mid":!0,"marker-start":!0,mask:!0,opacity:!0,overflow:!0,"pointer-events":!0,"shape-rendering":!0,"stop-color":!0,"stop-opacity":!0,"stroke-dasharray":!0,"stroke-dashoffset":!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-miterlimit":!0,"stroke-opacity":!0,"stroke-width":!0,stroke:!0,"text-anchor":!0,"text-decoration":!0,"text-rendering":!0,"unicode-bidi":!0,visibility:!0,"word-spacing":!0,"writing-mode":!0};Tr=function(){function e(){var e,t;"altglyph"===(e="<svg><altGlyph /></svg>",t=s.DOM.createElement("div"),t.innerHTML=e,t.firstChild).firstElementChild.nodeName&&Or.altGlyph&&(Or.altglyph=Or.altGlyph,delete Or.altGlyph,Or.altglyphdef=Or.altGlyphDef,delete Or.altGlyphDef,Or.altglyphitem=Or.altGlyphItem,delete Or.altGlyphItem,Or.glyphref=Or.glyphRef,delete Or.glyphRef)}return e.prototype.isStandardSvgAttribute=function(e,t){return Rr[e]&&Ar[t]||Or[e]&&-1!==Or[e].indexOf(t)},e}()}var Or=e.elements=Er,Rr=e.presentationElements=Sr,Ar=e.presentationAttributes=Cr,Ir=e.SVGAnalyzer=Tr||function(){function e(){}return e.prototype.isStandardSvgAttribute=function(){return!1},e}(),Nr=e.ObserverLocator=(v=p=function(){function e(e,t,n,r,i){this.taskQueue=e,this.eventManager=t,this.dirtyChecker=n,this.svgAnalyzer=r,this.parser=i,this.adapters=[],this.logger=o.getLogger("observer-locator")}return e.prototype.getObserver=function(e,t){var n,r=e.__observers__;return r&&t in r?r[t]:((n=this.createPropertyObserver(e,t)).doNotCache||(void 0===r&&(r=this.getOrCreateObserversLookup(e)),r[t]=n),n)},e.prototype.getOrCreateObserversLookup=function(e){return e.__observers__||this.createObserversLookup(e)},e.prototype.createObserversLookup=function(e){var t={};return Reflect.defineProperty(e,"__observers__",{enumerable:!1,configurable:!1,writable:!1,value:t})||this.logger.warn("Cannot add observers to object",e),t},e.prototype.addAdapter=function(e){this.adapters.push(e)},e.prototype.getAdapterObserver=function(e,t,n){for(var r=0,i=this.adapters.length;r<i;r++){var o=this.adapters[r].getObserver(e,t,n);if(o)return o}return null},e.prototype.createPropertyObserver=function(e,t){var n,r=void 0,i=void 0;if(!(e instanceof Object))return new ar(e,t);if(e instanceof s.DOM.Element){if("class"===t)return new yr(e);if("style"===t||"css"===t)return new hr(e,t);if(r=this.eventManager.getElementHandler(e,t),"value"===t&&"select"===e.tagName.toLowerCase())return new gr(e,r,this);if("checked"===t&&"input"===e.tagName.toLowerCase())return new vr(e,r,this);if(r)return new fr(e,t,r);if(i=/^xlink:(.+)$/.exec(t))return new ur(e,t,i[1]);if("role"===t&&(e instanceof s.DOM.Element||e instanceof s.DOM.SVGElement)||/^\w+:|^data-|^aria-/.test(t)||e instanceof s.DOM.SVGElement&&this.svgAnalyzer.isStandardSvgAttribute(e.nodeName,t))return new lr(e,t)}if(br(n=Object.getPropertyDescriptor(e,t)))return wr(e,t,n,this);if(n){var o=n.get||n.set;if(o){if(o.getObserver)return o.getObserver(e);var a=this.getAdapterObserver(e,t,n);return a||new rr(this.dirtyChecker,e,t)}}return e instanceof Array?"length"===t?this.getArrayObserver(e).getLengthObserver():new rr(this.dirtyChecker,e,t):e instanceof Map?"size"===t?this.getMapObserver(e).getLengthObserver():new rr(this.dirtyChecker,e,t):e instanceof Set?"size"===t?this.getSetObserver(e).getLengthObserver():new rr(this.dirtyChecker,e,t):new sr(this.taskQueue,e,t)},e.prototype.getAccessor=function(e,t){if(e instanceof s.DOM.Element){if("class"===t||"style"===t||"css"===t||"value"===t&&("input"===e.tagName.toLowerCase()||"select"===e.tagName.toLowerCase())||"checked"===t&&"input"===e.tagName.toLowerCase()||"model"===t&&"input"===e.tagName.toLowerCase()||/^xlink:.+$/.exec(t))return this.getObserver(e,t);if(/^\w+:|^data-|^aria-/.test(t)||e instanceof s.DOM.SVGElement&&this.svgAnalyzer.isStandardSvgAttribute(e.nodeName,t)||"img"===e.tagName.toLowerCase()&&"src"===t||"a"===e.tagName.toLowerCase()&&"href"===t)return cr}return or},e.prototype.getArrayObserver=function(e){return ye(this.taskQueue,e)},e.prototype.getMapObserver=function(e){return qn(this.taskQueue,e)},e.prototype.getSetObserver=function(e){return Br(this.taskQueue,e)},e}(),p.inject=[n.TaskQueue,er,nr,Ir,He],v),kr=(e.ObjectObservationAdapter=function(){function e(){}return e.prototype.getObserver=function(e,t,n){throw new Error("BindingAdapters must implement getObserver(object, propertyName).")},e}(),e.BindingExpression=function(){function e(e,t,n,r,i,o){this.observerLocator=e,this.targetProperty=t,this.sourceExpression=n,this.mode=r,this.lookupFunctions=i,this.attribute=o,this.discrete=!1}return e.prototype.createBinding=function(e){return new Pr(this.observerLocator,this.sourceExpression,e,this.targetProperty,this.mode,this.lookupFunctions)},e}()),Pr=e.Binding=L()(m=function(){function e(e,t,n,r,i,o){this.observerLocator=e,this.sourceExpression=t,this.target=n,this.targetProperty=r,this.mode=i,this.lookupFunctions=o}return e.prototype.updateTarget=function(e){this.targetObserver.setValue(e,this.target,this.targetProperty)},e.prototype.updateSource=function(e){this.sourceExpression.assign(this.source,e,this.lookupFunctions)},e.prototype.call=function(e,t,n){if(this.isBound){if(e===C)return n=this.targetObserver.getValue(this.target,this.targetProperty),(t=this.sourceExpression.evaluate(this.source,this.lookupFunctions))!==n&&this.updateTarget(t),void(this.mode!==We.oneTime&&(this._version++,this.sourceExpression.connect(this,this.source),this.unobserve(!1)));if(e!==S)throw new Error("Unexpected call context "+e);t!==this.sourceExpression.evaluate(this.source,this.lookupFunctions)&&this.updateSource(t)}},e.prototype.bind=function(e){if(this.isBound){if(this.source===e)return;this.unbind()}this.isBound=!0,this.source=e,this.sourceExpression.bind&&this.sourceExpression.bind(this,e,this.lookupFunctions);var t=this.mode;if(!this.targetObserver){var n=t===We.twoWay||t===We.fromView?"getObserver":"getAccessor";this.targetObserver=this.observerLocator[n](this.target,this.targetProperty)}if("bind"in this.targetObserver&&this.targetObserver.bind(),this.mode!==We.fromView){var r=this.sourceExpression.evaluate(e,this.lookupFunctions);this.updateTarget(r)}t!==We.oneTime&&(t===We.toView?G(this):t===We.twoWay?(this.sourceExpression.connect(this,e),this.targetObserver.subscribe(S,this)):t===We.fromView&&this.targetObserver.subscribe(S,this))},e.prototype.unbind=function(){this.isBound&&(this.isBound=!1,this.sourceExpression.unbind&&this.sourceExpression.unbind(this,this.source),this.source=null,"unbind"in this.targetObserver&&this.targetObserver.unbind(),this.targetObserver.unsubscribe&&this.targetObserver.unsubscribe(S,this),this.unobserve(!0))},e.prototype.connect=function(e){if(this.isBound){if(e){var t=this.sourceExpression.evaluate(this.source,this.lookupFunctions);this.updateTarget(t)}this.sourceExpression.connect(this,this.source)}},e}())||m,xr=(e.CallExpression=function(){function e(e,t,n,r){this.observerLocator=e,this.targetProperty=t,this.sourceExpression=n,this.lookupFunctions=r}return e.prototype.createBinding=function(e){return new xr(this.observerLocator,this.sourceExpression,e,this.targetProperty,this.lookupFunctions)},e}(),e.Call=function(){function e(e,t,n,r,i){this.sourceExpression=t,this.target=n,this.targetProperty=e.getObserver(n,r),this.lookupFunctions=i}return e.prototype.callSource=function(e){var t=this.source.overrideContext;Object.assign(t,e),t.$event=e;var n=this.sourceExpression.evaluate(this.source,this.lookupFunctions,!0);for(var r in delete t.$event,e)delete t[r];return n},e.prototype.bind=function(e){var t=this;if(this.isBound){if(this.source===e)return;this.unbind()}this.isBound=!0,this.source=e,this.sourceExpression.bind&&this.sourceExpression.bind(this,e,this.lookupFunctions),this.targetProperty.setValue(function(e){return t.callSource(e)})},e.prototype.unbind=function(){this.isBound&&(this.isBound=!1,this.sourceExpression.unbind&&this.sourceExpression.unbind(this,this.source),this.source=null,this.targetProperty.setValue(null))},e}()),Dr=e.ValueConverterResource=function(){function t(e){this.name=e}return t.convention=function(e){if(e.endsWith("ValueConverter"))return new t(O(e.substring(0,e.length-14)))},t.prototype.initialize=function(e,t){this.instance=e.get(t)},t.prototype.register=function(e,t){e.registerValueConverter(t||this.name,this.instance)},t.prototype.load=function(e,t){},t}();var Mr=e.BindingBehaviorResource=function(){function t(e){this.name=e}return t.convention=function(e){if(e.endsWith("BindingBehavior"))return new t(O(e.substring(0,e.length-15)))},t.prototype.initialize=function(e,t){this.instance=e.get(t)},t.prototype.register=function(e,t){e.registerBindingBehavior(t||this.name,this.instance)},t.prototype.load=function(e,t){},t}();e.ListenerExpression=function(){function e(e,t,n,r,i,o){this.eventManager=e,this.targetEvent=t,this.sourceExpression=n,this.delegationStrategy=r,this.discrete=!0,this.preventDefault=i,this.lookupFunctions=o}return e.prototype.createBinding=function(e){return new Lr(this.eventManager,this.targetEvent,this.delegationStrategy,this.sourceExpression,e,this.preventDefault,this.lookupFunctions)},e}();var Lr=e.Listener=function(){function e(e,t,n,r,i,o,a){this.eventManager=e,this.targetEvent=t,this.delegationStrategy=n,this.sourceExpression=r,this.target=i,this.preventDefault=o,this.lookupFunctions=a}return e.prototype.callSource=function(e){var t=this.source.overrideContext;t.$event=e;var n=this.sourceExpression.evaluate(this.source,this.lookupFunctions,!0);return delete t.$event,!0!==n&&this.preventDefault&&e.preventDefault(),n},e.prototype.handleEvent=function(e){this.callSource(e)},e.prototype.bind=function(e){if(this.isBound){if(this.source===e)return;this.unbind()}this.isBound=!0,this.source=e,this.sourceExpression.bind&&this.sourceExpression.bind(this,e,this.lookupFunctions),this._handler=this.eventManager.addEventListener(this.target,this.targetEvent,this,this.delegationStrategy,!0)},e.prototype.unbind=function(){this.isBound&&(this.isBound=!1,this.sourceExpression.unbind&&this.sourceExpression.unbind(this,this.source),this.source=null,this._handler.dispose(),this._handler=null)},e}();function Fr(e){var t=e.au;if(void 0===t)throw new Error('No Aurelia APIs are defined for the element: "'+e.tagName+'".');return t}e.NameExpression=function(){function t(e,t,n){this.sourceExpression=e,this.apiName=t,this.lookupFunctions=n,this.discrete=!0}return t.prototype.createBinding=function(e){return new Vr(this.sourceExpression,t.locateAPI(e,this.apiName),this.lookupFunctions)},t.locateAPI=function(e,t){switch(t){case"element":return e;case"controller":return Fr(e).controller;case"view-model":return Fr(e).controller.viewModel;case"view":return Fr(e).controller.view;default:var n=Fr(e)[t];if(void 0===n)throw new Error('Attempted to reference "'+t+"\", but it was not found amongst the target's API.");return n.viewModel}},t}();var Vr=function(){function e(e,t,n){this.sourceExpression=e,this.target=t,this.lookupFunctions=n}return e.prototype.bind=function(e){if(this.isBound){if(this.source===e)return;this.unbind()}this.isBound=!0,this.source=e,this.sourceExpression.bind&&this.sourceExpression.bind(this,e,this.lookupFunctions),this.sourceExpression.assign(this.source,this.target,this.lookupFunctions)},e.prototype.unbind=function(){this.isBound&&(this.isBound=!1,this.sourceExpression.evaluate(this.source,this.lookupFunctions)===this.target&&this.sourceExpression.assign(this.source,null,this.lookupFunctions),this.sourceExpression.unbind&&this.sourceExpression.unbind(this,this.source),this.source=null)},e}(),jr={bindingBehaviors:function(e){return null},valueConverters:function(e){return null}},Ur=(e.BindingEngine=(y=g=function(){function e(e,t){this.observerLocator=e,this.parser=t}return e.prototype.createBindingExpression=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:We.toView,r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:jr;return new kr(this.observerLocator,e,this.parser.parse(t),n,r)},e.prototype.propertyObserver=function(n,r){var i=this;return{subscribe:function(e){var t=i.observerLocator.getObserver(n,r);return t.subscribe(e),{dispose:function(){return t.unsubscribe(e)}}}}},e.prototype.collectionObserver=function(n){var r=this;return{subscribe:function(e){var t=void 0;if(n instanceof Array)t=r.observerLocator.getArrayObserver(n);else if(n instanceof Map)t=r.observerLocator.getMapObserver(n);else{if(!(n instanceof Set))throw new Error("collection must be an instance of Array, Map or Set.");t=r.observerLocator.getSetObserver(n)}return t.subscribe(e),{dispose:function(){return t.unsubscribe(e)}}}}},e.prototype.expressionObserver=function(e,t){var n={bindingContext:e,overrideContext:R(e)};return new te(n,this.parser.parse(t),this.observerLocator,jr)},e.prototype.parseExpression=function(e){return this.parser.parse(e)},e.prototype.registerAdapter=function(e){this.observerLocator.addAdapter(e)},e}(),g.inject=[Nr,He],y),Set.prototype);function Br(e,t){return qr.for(e,t)}e.getSetObserver=Br;var qr=function(n){function o(e,t){return w(this,n.call(this,e,t))}return E(o,n),o.for=function(e,t){return"__set_observer__"in t||Reflect.defineProperty(t,"__set_observer__",{value:o.create(e,t),enumerable:!1,configurable:!1}),t.__set_observer__},o.create=function(e,n){var r=new o(e,n),i=Ur;return i.add===n.add&&i.delete===n.delete&&i.clear===n.clear||(i={add:n.add,delete:n.delete,clear:n.clear}),n.add=function(){var e=n.size,t=i.add.apply(n,arguments);return n.size===e||r.addChangeRecord({type:"add",object:n,value:Array.from(n).pop()}),t},n.delete=function(){var e=n.has(arguments[0]),t=i.delete.apply(n,arguments);return e&&r.addChangeRecord({type:"delete",object:n,value:arguments[0]}),t},n.clear=function(){var e=i.clear.apply(n,arguments);return r.addChangeRecord({type:"clear",object:n}),e},r},o}(ce);var Wr={};function Hr(e,t){Wr.hasOwnProperty(t)||(Wr[t]=0),e.observeProperty(Wr,t)}}),define("aurelia-animator-css",["exports","aurelia-templating","aurelia-pal"],function(e,y,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CssAnimator=void 0,e.configure=function(e,t){var n=e.container.get(r);e.container.get(y.TemplatingEngine).configureAnimator(n),"function"==typeof t&&t(n)};var r=e.CssAnimator=function(){function e(){this.useAnimationDoneClasses=!1,this.animationEnteredClass="au-entered",this.animationLeftClass="au-left",this.isAnimating=!1,this.verifyKeyframesExist=!0}return e.prototype._addMultipleEventListener=function(e,t,n){for(var r=t.split(" "),i=0,o=r.length;i<o;++i)e.addEventListener(r[i],n,!1)},e.prototype._removeMultipleEventListener=function(e,t,n){for(var r=t.split(" "),i=0,o=r.length;i<o;++i)e.removeEventListener(r[i],n,!1)},e.prototype._getElementAnimationDelay=function(e){var t=i.DOM.getComputedStyle(e),n=void 0,r=void 0;if(t.getPropertyValue("animation-delay"))n="animation-delay";else if(t.getPropertyValue("-webkit-animation-delay"))n="-webkit-animation-delay";else{if(!t.getPropertyValue("-moz-animation-delay"))return 0;n="-moz-animation-delay"}return r=t.getPropertyValue(n),1e3*(r=Number(r.replace(/[^\d\.]/g,"")))},e.prototype._getElementAnimationNames=function(e){var t=i.DOM.getComputedStyle(e),n=void 0;if(t.getPropertyValue("animation-name"))n="";else if(t.getPropertyValue("-webkit-animation-name"))n="-webkit-";else{if(!t.getPropertyValue("-moz-animation-name"))return[];n="-moz-"}var r=t.getPropertyValue(n+"animation-name");return r?r.split(" "):[]},e.prototype._performSingleAnimate=function(t,n){var r=this;return this._triggerDOMEvent(y.animationEvent.animateBegin,t),this.addClass(t,n,!0).then(function(e){return r._triggerDOMEvent(y.animationEvent.animateActive,t),!1!==e&&r.removeClass(t,n,!0).then(function(){r._triggerDOMEvent(y.animationEvent.animateDone,t)})}).catch(function(){r._triggerDOMEvent(y.animationEvent.animateTimeout,t)})},e.prototype._triggerDOMEvent=function(e,t){var n=i.DOM.createCustomEvent(e,{bubbles:!0,cancelable:!0,detail:t});i.DOM.dispatchEvent(n)},e.prototype._animationChangeWithValidKeyframe=function(e,t){var n=e.filter(function(e){return-1===t.indexOf(e)});if(0===n.length)return!1;if(!this.verifyKeyframesExist)return!0;var r=window.CSSRule.KEYFRAMES_RULE||window.CSSRule.MOZ_KEYFRAMES_RULE||window.CSSRule.WEBKIT_KEYFRAMES_RULE,i=document.styleSheets;try{for(var o=0;o<i.length;++o){var a=null;try{a=i[o].cssRules}catch(e){}if(a)for(var s=0;s<a.length;++s){var u=a[s];if(u.type===r&&-1!==n.indexOf(u.name))return!0}}}catch(e){}return!1},e.prototype.animate=function(e,t){var n=this;return Array.isArray(e)?Promise.all(e.map(function(e){return n._performSingleAnimate(e,t)})):this._performSingleAnimate(e,t)},e.prototype.runSequence=function(e){var n=this;return this._triggerDOMEvent(y.animationEvent.sequenceBegin,null),e.reduce(function(e,t){return e.then(function(){return n.animate(t.element,t.className)})},Promise.resolve(!0)).then(function(){n._triggerDOMEvent(y.animationEvent.sequenceDone,null)})},e.prototype._stateAnim=function(f,d,p){var v=this,m="au-"+d,g=m+"-active";return new Promise(function(t,e){var n=f.classList;v._triggerDOMEvent(y.animationEvent[d+"Begin"],f),v.useAnimationDoneClasses&&(n.remove(v.animationEnteredClass),n.remove(v.animationLeftClass)),n.add(m);var r=v._getElementAnimationNames(f),i=void 0,o=!1;v._addMultipleEventListener(f,"webkitAnimationStart animationstart",i=function(e){e.target===f&&(o=!0,v.isAnimating=!0,v._triggerDOMEvent(y.animationEvent[d+"Active"],f),e.stopPropagation(),e.target.removeEventListener(e.type,i))},!1);var a=void 0;v._addMultipleEventListener(f,"webkitAnimationEnd animationend",a=function(e){o&&e.target===f&&(e.stopPropagation(),n.remove(g),n.remove(m),e.target.removeEventListener(e.type,a),v.useAnimationDoneClasses&&null!=p&&n.add(p),v.isAnimating=!1,v._triggerDOMEvent(y.animationEvent[d+"Done"],f),t(!0))},!1);var s=f.parentElement,u="data-animator-pending"+d,c=function(){var e=v._getElementAnimationNames(f);v._animationChangeWithValidKeyframe(e,r)||(n.remove(g),n.remove(m),v._removeMultipleEventListener(f,"webkitAnimationEnd animationend",a),v._removeMultipleEventListener(f,"webkitAnimationStart animationstart",i),v._triggerDOMEvent(y.animationEvent[d+"Timeout"],f),t(!1)),s&&s.setAttribute(u,+(s.getAttribute(u)||1)-1)};if(null!=s&&(s.classList.contains("au-stagger")||s.classList.contains("au-stagger-"+d))){var l=+(s.getAttribute(u)||0);s.setAttribute(u,l+1);var h=v._getElementAnimationDelay(s)*l;v._triggerDOMEvent(y.animationEvent.staggerNext,f),setTimeout(function(){n.add(g),c()},h)}else n.add(g),c()})},e.prototype.enter=function(e){return this._stateAnim(e,"enter",this.animationEnteredClass)},e.prototype.leave=function(e){return this._stateAnim(e,"leave",this.animationLeftClass)},e.prototype.removeClass=function(u,c){var l=this,h=!(arguments.length<=2||void 0===arguments[2])&&arguments[2];return new Promise(function(t,e){var n=u.classList;if(n.contains(c)||n.contains(c+"-add")){!0!==h&&l._triggerDOMEvent(y.animationEvent.removeClassBegin,u),n.contains(c+"-add")&&(n.remove(c+"-add"),n.add(c)),n.remove(c);var r=l._getElementAnimationNames(u),i=void 0,o=!1;l._addMultipleEventListener(u,"webkitAnimationStart animationstart",i=function(e){e.target===u&&(o=!0,(l.isAnimating=!0)!==h&&l._triggerDOMEvent(y.animationEvent.removeClassActive,u),e.stopPropagation(),e.target.removeEventListener(e.type,i))},!1);var a=void 0;l._addMultipleEventListener(u,"webkitAnimationEnd animationend",a=function(e){o&&e.target===u&&(u.classList.contains(c+"-remove")||t(!0),e.stopPropagation(),n.remove(c),n.remove(c+"-remove"),e.target.removeEventListener(e.type,a),!(l.isAnimating=!1)!==h&&l._triggerDOMEvent(y.animationEvent.removeClassDone,u),t(!0))},!1),n.add(c+"-remove");var s=l._getElementAnimationNames(u);l._animationChangeWithValidKeyframe(s,r)||(n.remove(c+"-remove"),n.remove(c),l._removeMultipleEventListener(u,"webkitAnimationEnd animationend",a),l._removeMultipleEventListener(u,"webkitAnimationStart animationstart",i),!0!==h&&l._triggerDOMEvent(y.animationEvent.removeClassTimeout,u),t(!1))}else t(!1)})},e.prototype.addClass=function(u,c){var l=this,h=!(arguments.length<=2||void 0===arguments[2])&&arguments[2];return new Promise(function(t,e){var n=u.classList;!0!==h&&l._triggerDOMEvent(y.animationEvent.addClassBegin,u),n.contains(c+"-remove")&&(n.remove(c+"-remove"),n.remove(c));var r=void 0,i=!1;l._addMultipleEventListener(u,"webkitAnimationStart animationstart",r=function(e){e.target===u&&(i=!0,(l.isAnimating=!0)!==h&&l._triggerDOMEvent(y.animationEvent.addClassActive,u),e.stopPropagation(),e.target.removeEventListener(e.type,r))},!1);var o=void 0;l._addMultipleEventListener(u,"webkitAnimationEnd animationend",o=function(e){i&&e.target===u&&(u.classList.contains(c+"-add")||t(!0),e.stopPropagation(),n.add(c),n.remove(c+"-add"),e.target.removeEventListener(e.type,o),!(l.isAnimating=!1)!==h&&l._triggerDOMEvent(y.animationEvent.addClassDone,u),t(!0))},!1);var a=l._getElementAnimationNames(u);n.add(c+"-add");var s=l._getElementAnimationNames(u);l._animationChangeWithValidKeyframe(s,a)||(n.remove(c+"-add"),n.add(c),l._removeMultipleEventListener(u,"webkitAnimationEnd animationend",o),l._removeMultipleEventListener(u,"webkitAnimationStart animationstart",r),!0!==h&&l._triggerDOMEvent(y.animationEvent.addClassTimeout,u),t(!1))})},e}()});